{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.366666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": -324.97459716796874, "policy_loss": -6527096.3734375, "vf_loss": 20786404.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 121800, "num_env_steps_trained": 121800, "num_agent_steps_sampled": 121800, "num_agent_steps_trained": 121800}, "sampler_results": {"episode_reward_max": -3528.103758166464, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3529.484500064107, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252], "episode_lengths": [360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.367831413908709, "mean_inference_ms": 0.238988347876939, "mean_action_processing_ms": 0.057920358500038495, "mean_env_wait_ms": 1.5635193883545326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025415420532226562, "StateBufferConnector_ms": 0.0017499923706054688, "ViewRequirementAgentConnector_ms": 0.04329681396484375}}, "episode_reward_max": -3528.103758166464, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3529.484500064107, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252], "episode_lengths": [360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.367831413908709, "mean_inference_ms": 0.238988347876939, "mean_action_processing_ms": 0.057920358500038495, "mean_env_wait_ms": 1.5635193883545326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025415420532226562, "StateBufferConnector_ms": 0.0017499923706054688, "ViewRequirementAgentConnector_ms": 0.04329681396484375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121800, "num_agent_steps_trained": 121800, "num_env_steps_sampled": 121800, "num_env_steps_trained": 121800, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.3766849898994, "num_env_steps_trained_throughput_per_sec": 159.3766849898994, "timesteps_total": 121800, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 121800, "timers": {"training_iteration_time_ms": 2258.788, "sample_time_ms": 2249.199, "load_time_ms": 0.261, "load_throughput": 1376686.214, "learn_time_ms": 8.766, "learn_throughput": 41069.626, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 121800, "num_env_steps_trained": 121800, "num_agent_steps_sampled": 121800, "num_agent_steps_trained": 121800}, "done": false, "episodes_total": 819, "training_iteration": 161, "trial_id": "71c6f_00000", "date": "2023-08-04_10-06-48", "timestamp": 1691132808, "time_this_iter_s": 11.296083927154541, "time_total_s": 1741.1268107891083, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.296083927154541, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 66.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": -324.276953125, "policy_loss": -84897.1625, "vf_loss": 20753932.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "sampler_results": {"episode_reward_max": -3527.4060070452165, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.756766011249, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.364330612598223, "mean_inference_ms": 0.23801725307780786, "mean_action_processing_ms": 0.05768121617960619, "mean_env_wait_ms": 1.2661256248998514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002570585771040483, "StateBufferConnector_ms": 0.0017339533025568182, "ViewRequirementAgentConnector_ms": 0.043830004605379974}}, "episode_reward_max": -3527.4060070452165, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.756766011249, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.364330612598223, "mean_inference_ms": 0.23801725307780786, "mean_action_processing_ms": 0.05768121617960619, "mean_env_wait_ms": 1.2661256248998514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002570585771040483, "StateBufferConnector_ms": 0.0017339533025568182, "ViewRequirementAgentConnector_ms": 0.043830004605379974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.52073035896822, "num_env_steps_trained_throughput_per_sec": 190.52073035896822, "timesteps_total": 123960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 123960, "timers": {"training_iteration_time_ms": 1893.763, "sample_time_ms": 1886.668, "load_time_ms": 0.217, "load_throughput": 1660745.095, "learn_time_ms": 6.32, "learn_throughput": 56959.45, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "done": false, "episodes_total": 825, "training_iteration": 162, "trial_id": "71c6f_00000", "date": "2023-08-04_10-07-00", "timestamp": 1691132820, "time_this_iter_s": 11.339215755462646, "time_total_s": 1752.466026544571, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.635299682617188, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.84375, "ram_util_percent": 66.23125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.227777777777777e-07, "entropy_coeff": 0.1, "policy_entropy": -323.84669189453126, "policy_loss": -13637213.096875, "vf_loss": 20779581.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 126120, "num_env_steps_trained": 126120, "num_agent_steps_sampled": 126120, "num_agent_steps_trained": 126120}, "sampler_results": {"episode_reward_max": -3527.4060070452165, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.66331008248, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.361781862489981, "mean_inference_ms": 0.23767273509016965, "mean_action_processing_ms": 0.057580198018076116, "mean_env_wait_ms": 1.1230049012901333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024206498089958638, "StateBufferConnector_ms": 0.0016969792983111214, "ViewRequirementAgentConnector_ms": 0.04362779505112592}}, "episode_reward_max": -3527.4060070452165, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.66331008248, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.361781862489981, "mean_inference_ms": 0.23767273509016965, "mean_action_processing_ms": 0.057580198018076116, "mean_env_wait_ms": 1.1230049012901333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024206498089958638, "StateBufferConnector_ms": 0.0016969792983111214, "ViewRequirementAgentConnector_ms": 0.04362779505112592}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126120, "num_agent_steps_trained": 126120, "num_env_steps_sampled": 126120, "num_env_steps_trained": 126120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.47226340849798, "num_env_steps_trained_throughput_per_sec": 190.47226340849798, "timesteps_total": 126120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 126120, "timers": {"training_iteration_time_ms": 1890.466, "sample_time_ms": 1883.365, "load_time_ms": 0.207, "load_throughput": 1735574.069, "learn_time_ms": 6.345, "learn_throughput": 56734.303, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 126120, "num_env_steps_trained": 126120, "num_agent_steps_sampled": 126120, "num_agent_steps_trained": 126120}, "done": false, "episodes_total": 831, "training_iteration": 163, "trial_id": "71c6f_00000", "date": "2023-08-04_10-07-11", "timestamp": 1691132831, "time_this_iter_s": 11.342084169387817, "time_total_s": 1763.8081107139587, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.977383852005005, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.475, "ram_util_percent": 66.18125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9277777777777767e-07, "entropy_coeff": 0.1, "policy_entropy": -323.68109741210935, "policy_loss": -15657004.975, "vf_loss": 20772836.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "sampler_results": {"episode_reward_max": -3527.373103192358, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.506468235803, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.360843696569682, "mean_inference_ms": 0.23737037980524264, "mean_action_processing_ms": 0.05749957189419295, "mean_env_wait_ms": 1.0349194876051293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024453453395677648, "StateBufferConnector_ms": 0.0017093575519064198, "ViewRequirementAgentConnector_ms": 0.04366480785867442}}, "episode_reward_max": -3527.373103192358, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.506468235803, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.360843696569682, "mean_inference_ms": 0.23737037980524264, "mean_action_processing_ms": 0.05749957189419295, "mean_env_wait_ms": 1.0349194876051293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024453453395677648, "StateBufferConnector_ms": 0.0017093575519064198, "ViewRequirementAgentConnector_ms": 0.04366480785867442}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.10810966659082, "num_env_steps_trained_throughput_per_sec": 190.10810966659082, "timesteps_total": 128280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 128280, "timers": {"training_iteration_time_ms": 1890.883, "sample_time_ms": 1884.0, "load_time_ms": 0.208, "load_throughput": 1732388.068, "learn_time_ms": 6.14, "learn_throughput": 58632.893, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "done": false, "episodes_total": 837, "training_iteration": 164, "trial_id": "71c6f_00000", "date": "2023-08-04_10-07-22", "timestamp": 1691132842, "time_this_iter_s": 11.363894701004028, "time_total_s": 1775.1720054149628, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 45.34127855300903, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.825, "ram_util_percent": 66.20625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.1, "policy_entropy": -323.41485595703125, "policy_loss": -3893388.603125, "vf_loss": 20754235.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 130440, "num_env_steps_trained": 130440, "num_agent_steps_sampled": 130440, "num_agent_steps_trained": 130440}, "sampler_results": {"episode_reward_max": -3527.292315035736, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.4100901469774, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.359909809193824, "mean_inference_ms": 0.2371586890461463, "mean_action_processing_ms": 0.05744399764258494, "mean_env_wait_ms": 0.9744534794361328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002492707351158405, "StateBufferConnector_ms": 0.0017289457650020205, "ViewRequirementAgentConnector_ms": 0.04359853678736193}}, "episode_reward_max": -3527.292315035736, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.4100901469774, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.359909809193824, "mean_inference_ms": 0.2371586890461463, "mean_action_processing_ms": 0.05744399764258494, "mean_env_wait_ms": 0.9744534794361328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002492707351158405, "StateBufferConnector_ms": 0.0017289457650020205, "ViewRequirementAgentConnector_ms": 0.04359853678736193}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130440, "num_agent_steps_trained": 130440, "num_env_steps_sampled": 130440, "num_env_steps_trained": 130440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2428331592182, "num_env_steps_trained_throughput_per_sec": 190.2428331592182, "timesteps_total": 130440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 130440, "timers": {"training_iteration_time_ms": 1892.519, "sample_time_ms": 1885.581, "load_time_ms": 0.216, "load_throughput": 1667531.132, "learn_time_ms": 6.179, "learn_throughput": 58264.113, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 130440, "num_env_steps_trained": 130440, "num_agent_steps_sampled": 130440, "num_agent_steps_trained": 130440}, "done": false, "episodes_total": 843, "training_iteration": 165, "trial_id": "71c6f_00000", "date": "2023-08-04_10-07-34", "timestamp": 1691132854, "time_this_iter_s": 11.3558828830719, "time_total_s": 1786.5278882980347, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 56.69716143608093, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.9625, "ram_util_percent": 66.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.1, "policy_entropy": -323.5075439453125, "policy_loss": -3447050.13125, "vf_loss": 20754951.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "sampler_results": {"episode_reward_max": -3527.292315035736, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.3637474481798, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.358781802862139, "mean_inference_ms": 0.23700647084567486, "mean_action_processing_ms": 0.05740591026410829, "mean_env_wait_ms": 0.9299449860184152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024298259190150668, "StateBufferConnector_ms": 0.0017193385532924107, "ViewRequirementAgentConnector_ms": 0.043624469212123325}}, "episode_reward_max": -3527.292315035736, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.3637474481798, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.358781802862139, "mean_inference_ms": 0.23700647084567486, "mean_action_processing_ms": 0.05740591026410829, "mean_env_wait_ms": 0.9299449860184152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024298259190150668, "StateBufferConnector_ms": 0.0017193385532924107, "ViewRequirementAgentConnector_ms": 0.043624469212123325}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.55558572669838, "num_env_steps_trained_throughput_per_sec": 190.55558572669838, "timesteps_total": 132600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 132600, "timers": {"training_iteration_time_ms": 1892.114, "sample_time_ms": 1885.06, "load_time_ms": 0.218, "load_throughput": 1652204.224, "learn_time_ms": 6.294, "learn_throughput": 57195.921, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "done": false, "episodes_total": 849, "training_iteration": 166, "trial_id": "71c6f_00000", "date": "2023-08-04_10-07-45", "timestamp": 1691132865, "time_this_iter_s": 11.337573289871216, "time_total_s": 1797.8654615879059, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 68.03473472595215, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.8625, "ram_util_percent": 66.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.1, "policy_entropy": -323.3664123535156, "policy_loss": -446854.61875, "vf_loss": 20743080.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 134760, "num_env_steps_trained": 134760, "num_agent_steps_sampled": 134760, "num_agent_steps_trained": 134760}, "sampler_results": {"episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.2490682133885, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.358032310421209, "mean_inference_ms": 0.23687291636338206, "mean_action_processing_ms": 0.0573750387756949, "mean_env_wait_ms": 0.8953939367673005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542356165443979, "StateBufferConnector_ms": 0.0017212658393673782, "ViewRequirementAgentConnector_ms": 0.04359047587324933}}, "episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.2490682133885, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.358032310421209, "mean_inference_ms": 0.23687291636338206, "mean_action_processing_ms": 0.0573750387756949, "mean_env_wait_ms": 0.8953939367673005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542356165443979, "StateBufferConnector_ms": 0.0017212658393673782, "ViewRequirementAgentConnector_ms": 0.04359047587324933}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134760, "num_agent_steps_trained": 134760, "num_env_steps_sampled": 134760, "num_env_steps_trained": 134760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.3239116831346, "num_env_steps_trained_throughput_per_sec": 190.3239116831346, "timesteps_total": 134760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 134760, "timers": {"training_iteration_time_ms": 1892.485, "sample_time_ms": 1885.555, "load_time_ms": 0.213, "load_throughput": 1687660.042, "learn_time_ms": 6.177, "learn_throughput": 58282.554, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 134760, "num_env_steps_trained": 134760, "num_agent_steps_sampled": 134760, "num_agent_steps_trained": 134760}, "done": false, "episodes_total": 855, "training_iteration": 167, "trial_id": "71c6f_00000", "date": "2023-08-04_10-07-57", "timestamp": 1691132877, "time_this_iter_s": 11.350959062576294, "time_total_s": 1809.2164206504822, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 79.38569378852844, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.288235294117644, "ram_util_percent": 66.21176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.1, "policy_entropy": -323.20249633789064, "policy_loss": -2155715.6875, "vf_loss": 20759296.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "sampler_results": {"episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.121499851814, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.357633845569502, "mean_inference_ms": 0.23675244510066976, "mean_action_processing_ms": 0.05734920926850945, "mean_env_wait_ms": 0.8675169863410154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025312951270570145, "StateBufferConnector_ms": 0.001718642863821476, "ViewRequirementAgentConnector_ms": 0.04355045075112201}}, "episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.121499851814, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.357633845569502, "mean_inference_ms": 0.23675244510066976, "mean_action_processing_ms": 0.05734920926850945, "mean_env_wait_ms": 0.8675169863410154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025312951270570145, "StateBufferConnector_ms": 0.001718642863821476, "ViewRequirementAgentConnector_ms": 0.04355045075112201}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.3805121495518, "num_env_steps_trained_throughput_per_sec": 190.3805121495518, "timesteps_total": 136920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 136920, "timers": {"training_iteration_time_ms": 1889.348, "sample_time_ms": 1882.418, "load_time_ms": 0.219, "load_throughput": 1647517.119, "learn_time_ms": 6.182, "learn_throughput": 58229.96, "synch_weights_time_ms": 0.497}, "counters": {"num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "done": false, "episodes_total": 861, "training_iteration": 168, "trial_id": "71c6f_00000", "date": "2023-08-04_10-08-08", "timestamp": 1691132888, "time_this_iter_s": 11.347550868988037, "time_total_s": 1820.5639715194702, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 90.73324465751648, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.09375, "ram_util_percent": 66.01875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.1, "policy_entropy": -322.9539428710938, "policy_loss": -456030.79375, "vf_loss": 20746460.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 262.0}}, "num_env_steps_sampled": 139080, "num_env_steps_trained": 139080, "num_agent_steps_sampled": 139080, "num_agent_steps_trained": 139080}, "sampler_results": {"episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.013762698984, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.357113977950522, "mean_inference_ms": 0.23670104963145258, "mean_action_processing_ms": 0.05733637505982396, "mean_env_wait_ms": 0.8446327657442437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024804529154075767, "StateBufferConnector_ms": 0.0017076168420179835, "ViewRequirementAgentConnector_ms": 0.04358921410902491}}, "episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.013762698984, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.357113977950522, "mean_inference_ms": 0.23670104963145258, "mean_action_processing_ms": 0.05733637505982396, "mean_env_wait_ms": 0.8446327657442437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024804529154075767, "StateBufferConnector_ms": 0.0017076168420179835, "ViewRequirementAgentConnector_ms": 0.04358921410902491}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139080, "num_agent_steps_trained": 139080, "num_env_steps_sampled": 139080, "num_env_steps_trained": 139080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.6462260694675, "num_env_steps_trained_throughput_per_sec": 190.6462260694675, "timesteps_total": 139080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 139080, "timers": {"training_iteration_time_ms": 1888.981, "sample_time_ms": 1881.926, "load_time_ms": 0.223, "load_throughput": 1612849.22, "learn_time_ms": 6.296, "learn_throughput": 57176.862, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 139080, "num_env_steps_trained": 139080, "num_agent_steps_sampled": 139080, "num_agent_steps_trained": 139080}, "done": false, "episodes_total": 867, "training_iteration": 169, "trial_id": "71c6f_00000", "date": "2023-08-04_10-08-19", "timestamp": 1691132899, "time_this_iter_s": 11.331812858581543, "time_total_s": 1831.8957843780518, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.06505751609802, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.799999999999997, "ram_util_percent": 65.96249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7166666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": -322.9422973632812, "policy_loss": -9831986.475, "vf_loss": 20775681.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "sampler_results": {"episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.0069124682864, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356901631591526, "mean_inference_ms": 0.23665536091643516, "mean_action_processing_ms": 0.057323529983442936, "mean_env_wait_ms": 0.8254939308407121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002452882669739804, "StateBufferConnector_ms": 0.0017036825923596398, "ViewRequirementAgentConnector_ms": 0.04355624570684918}}, "episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3528.0069124682864, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356901631591526, "mean_inference_ms": 0.23665536091643516, "mean_action_processing_ms": 0.057323529983442936, "mean_env_wait_ms": 0.8254939308407121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002452882669739804, "StateBufferConnector_ms": 0.0017036825923596398, "ViewRequirementAgentConnector_ms": 0.04355624570684918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.4489748522531, "num_env_steps_trained_throughput_per_sec": 189.4489748522531, "timesteps_total": 141240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 141240, "timers": {"training_iteration_time_ms": 1894.855, "sample_time_ms": 1887.775, "load_time_ms": 0.221, "load_throughput": 1625874.276, "learn_time_ms": 6.308, "learn_throughput": 57073.989, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "done": false, "episodes_total": 873, "training_iteration": 170, "trial_id": "71c6f_00000", "date": "2023-08-04_10-08-31", "timestamp": 1691132911, "time_this_iter_s": 11.403558254241943, "time_total_s": 1843.2993426322937, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 113.46861577033997, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.293750000000003, "ram_util_percent": 66.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -322.73607177734374, "policy_loss": -255516.0875, "vf_loss": 20741158.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 322.0}}, "num_env_steps_sampled": 143400, "num_env_steps_trained": 143400, "num_agent_steps_sampled": 143400, "num_agent_steps_trained": 143400}, "sampler_results": {"episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.9054907194386, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356715376057512, "mean_inference_ms": 0.23662672601445187, "mean_action_processing_ms": 0.05731444364987127, "mean_env_wait_ms": 0.8090918767256353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024571785560021033, "StateBufferConnector_ms": 0.0017063434307391827, "ViewRequirementAgentConnector_ms": 0.0435480704674354}}, "episode_reward_max": -3526.2957982698845, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.9054907194386, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356715376057512, "mean_inference_ms": 0.23662672601445187, "mean_action_processing_ms": 0.05731444364987127, "mean_env_wait_ms": 0.8090918767256353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024571785560021033, "StateBufferConnector_ms": 0.0017063434307391827, "ViewRequirementAgentConnector_ms": 0.0435480704674354}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143400, "num_agent_steps_trained": 143400, "num_env_steps_sampled": 143400, "num_env_steps_trained": 143400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.59967210288738, "num_env_steps_trained_throughput_per_sec": 190.59967210288738, "timesteps_total": 143400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 143400, "timers": {"training_iteration_time_ms": 1896.008, "sample_time_ms": 1888.981, "load_time_ms": 0.222, "load_throughput": 1625174.298, "learn_time_ms": 6.248, "learn_throughput": 57621.761, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 143400, "num_env_steps_trained": 143400, "num_agent_steps_sampled": 143400, "num_agent_steps_trained": 143400}, "done": false, "episodes_total": 879, "training_iteration": 171, "trial_id": "71c6f_00000", "date": "2023-08-04_10-08-42", "timestamp": 1691132922, "time_this_iter_s": 11.334620714187622, "time_total_s": 1854.6339633464813, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 124.80323648452759, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.8625, "ram_util_percent": 66.23750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -322.7094299316406, "policy_loss": -2641719.6859375, "vf_loss": 20749806.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "sampler_results": {"episode_reward_max": -3526.261720931092, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.8716029265133, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356476502304866, "mean_inference_ms": 0.23660984019224995, "mean_action_processing_ms": 0.05730780344631928, "mean_env_wait_ms": 0.7949664949076793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024735088079748018, "StateBufferConnector_ms": 0.001714598964637434, "ViewRequirementAgentConnector_ms": 0.0437514882692149}}, "episode_reward_max": -3526.261720931092, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.8716029265133, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356476502304866, "mean_inference_ms": 0.23660984019224995, "mean_action_processing_ms": 0.05730780344631928, "mean_env_wait_ms": 0.7949664949076793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024735088079748018, "StateBufferConnector_ms": 0.001714598964637434, "ViewRequirementAgentConnector_ms": 0.0437514882692149}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.41572044119414, "num_env_steps_trained_throughput_per_sec": 190.41572044119414, "timesteps_total": 145560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 145560, "timers": {"training_iteration_time_ms": 1891.031, "sample_time_ms": 1884.034, "load_time_ms": 0.221, "load_throughput": 1627276.043, "learn_time_ms": 6.223, "learn_throughput": 57848.036, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "done": false, "episodes_total": 885, "training_iteration": 172, "trial_id": "71c6f_00000", "date": "2023-08-04_10-08-53", "timestamp": 1691132933, "time_this_iter_s": 11.34566617012024, "time_total_s": 1865.9796295166016, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 136.14890265464783, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.16875, "ram_util_percent": 66.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -322.6992126464844, "policy_loss": -5794628.475, "vf_loss": 20749249.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 382.0}}, "num_env_steps_sampled": 147720, "num_env_steps_trained": 147720, "num_agent_steps_sampled": 147720, "num_agent_steps_trained": 147720}, "sampler_results": {"episode_reward_max": -3526.261720931092, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.8362238572468, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356355340372758, "mean_inference_ms": 0.23659177924424912, "mean_action_processing_ms": 0.05730165081024771, "mean_env_wait_ms": 0.7825815182085105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024433259840135452, "StateBufferConnector_ms": 0.001711040348201603, "ViewRequirementAgentConnector_ms": 0.04369779066606001}}, "episode_reward_max": -3526.261720931092, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.8362238572468, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356355340372758, "mean_inference_ms": 0.23659177924424912, "mean_action_processing_ms": 0.05730165081024771, "mean_env_wait_ms": 0.7825815182085105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024433259840135452, "StateBufferConnector_ms": 0.001711040348201603, "ViewRequirementAgentConnector_ms": 0.04369779066606001}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147720, "num_agent_steps_trained": 147720, "num_env_steps_sampled": 147720, "num_env_steps_trained": 147720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.05281127728074, "num_env_steps_trained_throughput_per_sec": 190.05281127728074, "timesteps_total": 147720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 147720, "timers": {"training_iteration_time_ms": 1893.163, "sample_time_ms": 1886.149, "load_time_ms": 0.228, "load_throughput": 1580767.839, "learn_time_ms": 6.229, "learn_throughput": 57791.799, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 147720, "num_env_steps_trained": 147720, "num_agent_steps_sampled": 147720, "num_agent_steps_trained": 147720}, "done": false, "episodes_total": 891, "training_iteration": 173, "trial_id": "71c6f_00000", "date": "2023-08-04_10-09-05", "timestamp": 1691132945, "time_this_iter_s": 11.367232084274292, "time_total_s": 1877.3468616008759, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 147.51613473892212, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 23.28125, "ram_util_percent": 66.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -322.6086669921875, "policy_loss": -1079168.08125, "vf_loss": 20747897.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 412.0}}, "num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880}, "sampler_results": {"episode_reward_max": -3526.261720931092, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.8031800242125, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356198254164174, "mean_inference_ms": 0.2365892925976615, "mean_action_processing_ms": 0.05729806734252472, "mean_env_wait_ms": 0.7716849517643513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024680631706513554, "StateBufferConnector_ms": 0.0017117304974291698, "ViewRequirementAgentConnector_ms": 0.043718786124723505}}, "episode_reward_max": -3526.261720931092, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.8031800242125, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356198254164174, "mean_inference_ms": 0.2365892925976615, "mean_action_processing_ms": 0.05729806734252472, "mean_env_wait_ms": 0.7716849517643513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024680631706513554, "StateBufferConnector_ms": 0.0017117304974291698, "ViewRequirementAgentConnector_ms": 0.043718786124723505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880, "num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.29227456599568, "num_env_steps_trained_throughput_per_sec": 190.29227456599568, "timesteps_total": 149880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 149880, "timers": {"training_iteration_time_ms": 1892.92, "sample_time_ms": 1885.852, "load_time_ms": 0.221, "load_throughput": 1628153.375, "learn_time_ms": 6.293, "learn_throughput": 57206.106, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880}, "done": false, "episodes_total": 897, "training_iteration": 174, "trial_id": "71c6f_00000", "date": "2023-08-04_10-09-16", "timestamp": 1691132956, "time_this_iter_s": 11.352937936782837, "time_total_s": 1888.6997995376587, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 158.86907267570496, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.9, "ram_util_percent": 65.88823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.388888888888888e-08, "entropy_coeff": 0.1, "policy_entropy": -322.4953552246094, "policy_loss": -1967535.61875, "vf_loss": 20737594.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 442.0}}, "num_env_steps_sampled": 152040, "num_env_steps_trained": 152040, "num_agent_steps_sampled": 152040, "num_agent_steps_trained": 152040}, "sampler_results": {"episode_reward_max": -3526.2127080684627, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.7626895105404, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356023856561295, "mean_inference_ms": 0.23658602050404004, "mean_action_processing_ms": 0.05729458454961827, "mean_env_wait_ms": 0.7619597553675777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002488929234193952, "StateBufferConnector_ms": 0.0017136670230479723, "ViewRequirementAgentConnector_ms": 0.04385294539205144}}, "episode_reward_max": -3526.2127080684627, "episode_reward_min": -3531.453741157246, "episode_reward_mean": -3527.7626895105404, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356023856561295, "mean_inference_ms": 0.23658602050404004, "mean_action_processing_ms": 0.05729458454961827, "mean_env_wait_ms": 0.7619597553675777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002488929234193952, "StateBufferConnector_ms": 0.0017136670230479723, "ViewRequirementAgentConnector_ms": 0.04385294539205144}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152040, "num_agent_steps_trained": 152040, "num_env_steps_sampled": 152040, "num_env_steps_trained": 152040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.80112028016777, "num_env_steps_trained_throughput_per_sec": 190.80112028016777, "timesteps_total": 152040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 152040, "timers": {"training_iteration_time_ms": 1890.092, "sample_time_ms": 1883.018, "load_time_ms": 0.228, "load_throughput": 1581761.408, "learn_time_ms": 6.294, "learn_throughput": 57196.571, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 152040, "num_env_steps_trained": 152040, "num_agent_steps_sampled": 152040, "num_agent_steps_trained": 152040}, "done": false, "episodes_total": 903, "training_iteration": 175, "trial_id": "71c6f_00000", "date": "2023-08-04_10-09-27", "timestamp": 1691132967, "time_this_iter_s": 11.322896003723145, "time_total_s": 1900.0226955413818, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 170.1919686794281, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 22.33125, "ram_util_percent": 66.00625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.6497009277344, "policy_loss": -7484625.46875, "vf_loss": 20749171.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200}, "sampler_results": {"episode_reward_max": -3526.184149326885, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.78480539177, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.355828047386936, "mean_inference_ms": 0.23658144617777635, "mean_action_processing_ms": 0.057291018604435175, "mean_env_wait_ms": 0.7532186828245837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002471522281044408, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.04386876758776213}}, "episode_reward_max": -3526.184149326885, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.78480539177, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3531.453741157246, -3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.355828047386936, "mean_inference_ms": 0.23658144617777635, "mean_action_processing_ms": 0.057291018604435175, "mean_env_wait_ms": 0.7532186828245837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002471522281044408, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.04386876758776213}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200, "num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.93338762261322, "num_env_steps_trained_throughput_per_sec": 190.93338762261322, "timesteps_total": 154200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 154200, "timers": {"training_iteration_time_ms": 1885.264, "sample_time_ms": 1878.277, "load_time_ms": 0.227, "load_throughput": 1583586.198, "learn_time_ms": 6.207, "learn_throughput": 57997.574, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200}, "done": false, "episodes_total": 909, "training_iteration": 176, "trial_id": "71c6f_00000", "date": "2023-08-04_10-09-39", "timestamp": 1691132979, "time_this_iter_s": 11.31507396697998, "time_total_s": 1911.3377695083618, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 181.50704264640808, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.987499999999997, "ram_util_percent": 66.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.5079040527344, "policy_loss": -1217140.16875, "vf_loss": 20750348.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 502.0}}, "num_env_steps_sampled": 156360, "num_env_steps_trained": 156360, "num_agent_steps_sampled": 156360, "num_agent_steps_trained": 156360}, "sampler_results": {"episode_reward_max": -3526.184149326885, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.7041670049157, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.355564575891708, "mean_inference_ms": 0.23654755170024394, "mean_action_processing_ms": 0.05728114706462675, "mean_env_wait_ms": 0.7371111183398412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024607181549072266, "StateBufferConnector_ms": 0.0017237663269042969, "ViewRequirementAgentConnector_ms": 0.04381203651428223}}, "episode_reward_max": -3526.184149326885, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.7041670049157, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.693746969846, -3529.474720217727, -3528.103758166464, -3529.696533809252, -3527.5834141083255, -3528.179291950725, -3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.355564575891708, "mean_inference_ms": 0.23654755170024394, "mean_action_processing_ms": 0.05728114706462675, "mean_env_wait_ms": 0.7371111183398412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024607181549072266, "StateBufferConnector_ms": 0.0017237663269042969, "ViewRequirementAgentConnector_ms": 0.04381203651428223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156360, "num_agent_steps_trained": 156360, "num_env_steps_sampled": 156360, "num_env_steps_trained": 156360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.5089317930584, "num_env_steps_trained_throughput_per_sec": 190.5089317930584, "timesteps_total": 156360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 156360, "timers": {"training_iteration_time_ms": 1886.311, "sample_time_ms": 1879.395, "load_time_ms": 0.216, "load_throughput": 1670113.306, "learn_time_ms": 6.169, "learn_throughput": 58354.406, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 156360, "num_env_steps_trained": 156360, "num_agent_steps_sampled": 156360, "num_agent_steps_trained": 156360}, "done": false, "episodes_total": 915, "training_iteration": 177, "trial_id": "71c6f_00000", "date": "2023-08-04_10-09-50", "timestamp": 1691132990, "time_this_iter_s": 11.340131759643555, "time_total_s": 1922.6779012680054, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 192.84717440605164, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.66875, "ram_util_percent": 65.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.5895568847656, "policy_loss": -4743509.3375, "vf_loss": 20757802.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 532.0}}, "num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520}, "sampler_results": {"episode_reward_max": -3526.184149326885, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.6261082766364, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354798160961598, "mean_inference_ms": 0.23643009632615816, "mean_action_processing_ms": 0.05724837878819599, "mean_env_wait_ms": 0.6912445255229498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002452373504638672, "StateBufferConnector_ms": 0.0017209053039550781, "ViewRequirementAgentConnector_ms": 0.04379725456237793}}, "episode_reward_max": -3526.184149326885, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.6261082766364, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.477362863689, -3527.837515113722, -3529.4183347215253, -3527.4060070452165, -3527.635046617572, -3527.8450809954534, -3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354798160961598, "mean_inference_ms": 0.23643009632615816, "mean_action_processing_ms": 0.05724837878819599, "mean_env_wait_ms": 0.6912445255229498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002452373504638672, "StateBufferConnector_ms": 0.0017209053039550781, "ViewRequirementAgentConnector_ms": 0.04379725456237793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520, "num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.5019935565695, "num_env_steps_trained_throughput_per_sec": 190.5019935565695, "timesteps_total": 158520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 158520, "timers": {"training_iteration_time_ms": 1886.646, "sample_time_ms": 1879.72, "load_time_ms": 0.217, "load_throughput": 1662390.664, "learn_time_ms": 6.182, "learn_throughput": 58232.655, "synch_weights_time_ms": 0.496}, "counters": {"num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520}, "done": false, "episodes_total": 921, "training_iteration": 178, "trial_id": "71c6f_00000", "date": "2023-08-04_10-10-02", "timestamp": 1691133002, "time_this_iter_s": 11.3406400680542, "time_total_s": 1934.0185413360596, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 204.18781447410583, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.643749999999997, "ram_util_percent": 65.73125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.35101928710935, "policy_loss": 328687.215625, "vf_loss": 20731136.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 562.0}}, "num_env_steps_sampled": 160680, "num_env_steps_trained": 160680, "num_agent_steps_sampled": 160680, "num_agent_steps_trained": 160680}, "sampler_results": {"episode_reward_max": -3525.7280575753916, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.5459051100793, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354344984901246, "mean_inference_ms": 0.23638408970193545, "mean_action_processing_ms": 0.05723404830225458, "mean_env_wait_ms": 0.6701552102893561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002444744110107422, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.043775081634521484}}, "episode_reward_max": -3525.7280575753916, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.5459051100793, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.9224822398132, -3528.5663680161574, -3529.3851781138733, -3529.5976892955523, -3527.7940566207594, -3528.469109144819, -3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354344984901246, "mean_inference_ms": 0.23638408970193545, "mean_action_processing_ms": 0.05723404830225458, "mean_env_wait_ms": 0.6701552102893561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002444744110107422, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.043775081634521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160680, "num_agent_steps_trained": 160680, "num_env_steps_sampled": 160680, "num_env_steps_trained": 160680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.18352027283183, "num_env_steps_trained_throughput_per_sec": 191.18352027283183, "timesteps_total": 160680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 160680, "timers": {"training_iteration_time_ms": 1886.315, "sample_time_ms": 1879.392, "load_time_ms": 0.217, "load_throughput": 1656372.795, "learn_time_ms": 6.164, "learn_throughput": 58402.708, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 160680, "num_env_steps_trained": 160680, "num_agent_steps_sampled": 160680, "num_agent_steps_trained": 160680}, "done": false, "episodes_total": 927, "training_iteration": 179, "trial_id": "71c6f_00000", "date": "2023-08-04_10-10-13", "timestamp": 1691133013, "time_this_iter_s": 11.300111293792725, "time_total_s": 1945.3186526298523, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 215.48792576789856, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.29375, "ram_util_percent": 65.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.1, "policy_entropy": -322.47246704101565, "policy_loss": -3089408.428125, "vf_loss": 20746937.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840}, "sampler_results": {"episode_reward_max": -3525.7280575753916, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.460804991647, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35403809284938, "mean_inference_ms": 0.23635809909464464, "mean_action_processing_ms": 0.057225754777774016, "mean_env_wait_ms": 0.656757652003655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002454042434692383, "StateBufferConnector_ms": 0.001722574234008789, "ViewRequirementAgentConnector_ms": 0.04388928413391113}}, "episode_reward_max": -3525.7280575753916, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.460804991647, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.373103192358, -3527.716126781064, -3528.12675322961, -3528.893349052709, -3528.607419890293, -3527.5735415266804, -3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35403809284938, "mean_inference_ms": 0.23635809909464464, "mean_action_processing_ms": 0.057225754777774016, "mean_env_wait_ms": 0.656757652003655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002454042434692383, "StateBufferConnector_ms": 0.001722574234008789, "ViewRequirementAgentConnector_ms": 0.04388928413391113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840, "num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.27130088706988, "num_env_steps_trained_throughput_per_sec": 190.27130088706988, "timesteps_total": 162840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 162840, "timers": {"training_iteration_time_ms": 1887.843, "sample_time_ms": 1880.878, "load_time_ms": 0.217, "load_throughput": 1658920.501, "learn_time_ms": 6.21, "learn_throughput": 57966.848, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840}, "done": false, "episodes_total": 933, "training_iteration": 180, "trial_id": "71c6f_00000", "date": "2023-08-04_10-10-24", "timestamp": 1691133024, "time_this_iter_s": 11.354298114776611, "time_total_s": 1956.672950744629, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 226.84222388267517, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.43125, "ram_util_percent": 65.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.511111111111111e-08, "entropy_coeff": 0.1, "policy_entropy": -322.2894653320312, "policy_loss": 328679.640625, "vf_loss": 20734999.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 623.0, "diff_num_grad_updates_vs_sampler_policy": 622.0}}, "num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000}, "sampler_results": {"episode_reward_max": -3525.703012389238, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.391881118932, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35368798164377, "mean_inference_ms": 0.23635850760139224, "mean_action_processing_ms": 0.057223610948335606, "mean_env_wait_ms": 0.6470620691583343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002451658248901367, "StateBufferConnector_ms": 0.0017132759094238281, "ViewRequirementAgentConnector_ms": 0.0438845157623291}}, "episode_reward_max": -3525.703012389238, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.391881118932, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.292315035736, -3528.0382745395395, -3529.3285198141316, -3527.403774032467, -3527.5789085235097, -3528.4420731627943, -3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35368798164377, "mean_inference_ms": 0.23635850760139224, "mean_action_processing_ms": 0.057223610948335606, "mean_env_wait_ms": 0.6470620691583343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002451658248901367, "StateBufferConnector_ms": 0.0017132759094238281, "ViewRequirementAgentConnector_ms": 0.0438845157623291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000, "num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.3425988210958, "num_env_steps_trained_throughput_per_sec": 191.3425988210958, "timesteps_total": 165000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 165000, "timers": {"training_iteration_time_ms": 1884.492, "sample_time_ms": 1877.435, "load_time_ms": 0.225, "load_throughput": 1602068.371, "learn_time_ms": 6.284, "learn_throughput": 57286.409, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000}, "done": false, "episodes_total": 939, "training_iteration": 181, "trial_id": "71c6f_00000", "date": "2023-08-04_10-10-36", "timestamp": 1691133036, "time_this_iter_s": 11.290725946426392, "time_total_s": 1967.9636766910553, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 238.13294982910156, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.85625, "ram_util_percent": 65.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1111111111111107e-08, "entropy_coeff": 0.1, "policy_entropy": -322.4887634277344, "policy_loss": -1620067.4875, "vf_loss": 20753644.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 652.0}}, "num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160}, "sampler_results": {"episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.326597105281, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353469292514819, "mean_inference_ms": 0.23636755040976215, "mean_action_processing_ms": 0.0572229272513305, "mean_env_wait_ms": 0.6395106571053472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024466514587402344, "StateBufferConnector_ms": 0.001711130142211914, "ViewRequirementAgentConnector_ms": 0.04386591911315918}}, "episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.326597105281, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.979693971568, -3528.1565021623273, -3528.2405444564856, -3527.4408241472847, -3528.6357247548526, -3528.821451272932, -3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353469292514819, "mean_inference_ms": 0.23636755040976215, "mean_action_processing_ms": 0.0572229272513305, "mean_env_wait_ms": 0.6395106571053472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024466514587402344, "StateBufferConnector_ms": 0.001711130142211914, "ViewRequirementAgentConnector_ms": 0.04386591911315918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160, "num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.6219816386591, "num_env_steps_trained_throughput_per_sec": 190.6219816386591, "timesteps_total": 167160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 167160, "timers": {"training_iteration_time_ms": 1885.213, "sample_time_ms": 1878.134, "load_time_ms": 0.223, "load_throughput": 1613193.846, "learn_time_ms": 6.316, "learn_throughput": 56999.873, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160}, "done": false, "episodes_total": 945, "training_iteration": 182, "trial_id": "71c6f_00000", "date": "2023-08-04_10-10-47", "timestamp": 1691133047, "time_this_iter_s": 11.333452939987183, "time_total_s": 1979.2971296310425, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 249.46640276908875, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 21.211764705882356, "ram_util_percent": 65.6705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.5583129882813, "policy_loss": -9033153.35, "vf_loss": 20759678.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 682.0}}, "num_env_steps_sampled": 169320, "num_env_steps_trained": 169320, "num_agent_steps_sampled": 169320, "num_agent_steps_trained": 169320}, "sampler_results": {"episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.240104486047, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353314271465251, "mean_inference_ms": 0.2363862003318296, "mean_action_processing_ms": 0.057223649675570004, "mean_env_wait_ms": 0.6334018045107074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024492740631103516, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.04394173622131348}}, "episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.240104486047, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.017504483251, -3528.0667931953317, -3526.2957982698845, -3526.6433640863756, -3526.7311093788103, -3526.678759595166, -3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353314271465251, "mean_inference_ms": 0.2363862003318296, "mean_action_processing_ms": 0.057223649675570004, "mean_env_wait_ms": 0.6334018045107074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024492740631103516, "StateBufferConnector_ms": 0.0017163753509521484, "ViewRequirementAgentConnector_ms": 0.04394173622131348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169320, "num_agent_steps_trained": 169320, "num_env_steps_sampled": 169320, "num_env_steps_trained": 169320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.97005263761977, "num_env_steps_trained_throughput_per_sec": 190.97005263761977, "timesteps_total": 169320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 169320, "timers": {"training_iteration_time_ms": 1886.985, "sample_time_ms": 1880.03, "load_time_ms": 0.217, "load_throughput": 1658556.063, "learn_time_ms": 6.202, "learn_throughput": 58046.625, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 169320, "num_env_steps_trained": 169320, "num_agent_steps_sampled": 169320, "num_agent_steps_trained": 169320}, "done": false, "episodes_total": 951, "training_iteration": 183, "trial_id": "71c6f_00000", "date": "2023-08-04_10-10-58", "timestamp": 1691133058, "time_this_iter_s": 11.312752962112427, "time_total_s": 1990.609882593155, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 260.7791557312012, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.55, "ram_util_percent": 65.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.26435546875, "policy_loss": -3417108.390625, "vf_loss": 20738705.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 713.0, "diff_num_grad_updates_vs_sampler_policy": 712.0}}, "num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480}, "sampler_results": {"episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.2708263693057, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353073482320188, "mean_inference_ms": 0.2364122627310595, "mean_action_processing_ms": 0.05722536421449303, "mean_env_wait_ms": 0.628379393549393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024466514587402344, "StateBufferConnector_ms": 0.0017075538635253906, "ViewRequirementAgentConnector_ms": 0.04389333724975586}}, "episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.2708263693057, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.481662485766, -3527.6703346531185, -3527.011990337428, -3527.924839836039, -3526.979290720969, -3527.6617865880157, -3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353073482320188, "mean_inference_ms": 0.2364122627310595, "mean_action_processing_ms": 0.05722536421449303, "mean_env_wait_ms": 0.628379393549393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024466514587402344, "StateBufferConnector_ms": 0.0017075538635253906, "ViewRequirementAgentConnector_ms": 0.04389333724975586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480, "num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.1856505004642, "num_env_steps_trained_throughput_per_sec": 191.1856505004642, "timesteps_total": 171480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 171480, "timers": {"training_iteration_time_ms": 1884.507, "sample_time_ms": 1877.517, "load_time_ms": 0.219, "load_throughput": 1647337.377, "learn_time_ms": 6.227, "learn_throughput": 57810.163, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480}, "done": false, "episodes_total": 957, "training_iteration": 184, "trial_id": "71c6f_00000", "date": "2023-08-04_10-11-10", "timestamp": 1691133070, "time_this_iter_s": 11.300047874450684, "time_total_s": 2001.9099304676056, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 272.07920360565186, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.75625, "ram_util_percent": 65.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.35419311523435, "policy_loss": -2495109.025, "vf_loss": 20742066.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 742.0}}, "num_env_steps_sampled": 173640, "num_env_steps_trained": 173640, "num_agent_steps_sampled": 173640, "num_agent_steps_trained": 173640}, "sampler_results": {"episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.261627469745, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352829271830386, "mean_inference_ms": 0.23643580576113585, "mean_action_processing_ms": 0.057226340202471714, "mean_env_wait_ms": 0.6241905096166893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024585723876953125, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.043949127197265625}}, "episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.261627469745, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.540616353993, -3526.6763883209396, -3527.197550813965, -3526.9632972129984, -3526.7418474291085, -3527.748235661396, -3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352829271830386, "mean_inference_ms": 0.23643580576113585, "mean_action_processing_ms": 0.057226340202471714, "mean_env_wait_ms": 0.6241905096166893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024585723876953125, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.043949127197265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173640, "num_agent_steps_trained": 173640, "num_env_steps_sampled": 173640, "num_env_steps_trained": 173640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.2245903247148, "num_env_steps_trained_throughput_per_sec": 190.2245903247148, "timesteps_total": 173640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 173640, "timers": {"training_iteration_time_ms": 1887.724, "sample_time_ms": 1880.684, "load_time_ms": 0.219, "load_throughput": 1646618.8, "learn_time_ms": 6.271, "learn_throughput": 57403.359, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 173640, "num_env_steps_trained": 173640, "num_agent_steps_sampled": 173640, "num_agent_steps_trained": 173640}, "done": false, "episodes_total": 963, "training_iteration": 185, "trial_id": "71c6f_00000", "date": "2023-08-04_10-11-21", "timestamp": 1691133081, "time_this_iter_s": 11.357128143310547, "time_total_s": 2013.2670586109161, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 283.4363317489624, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.1875, "ram_util_percent": 65.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.5978576660156, "policy_loss": -3603570.05625, "vf_loss": 20758699.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 773.0, "diff_num_grad_updates_vs_sampler_policy": 772.0}}, "num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800}, "sampler_results": {"episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.282493607006, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352629409947626, "mean_inference_ms": 0.23644466795644398, "mean_action_processing_ms": 0.05722532653154297, "mean_env_wait_ms": 0.6205764855488669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00244903564453125, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.04393339157104492}}, "episode_reward_max": -3525.678494146834, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.282493607006, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.9827349128336, -3528.286235295227, -3527.407254196455, -3529.512105087746, -3526.7270032936563, -3526.5264679125708, -3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.352629409947626, "mean_inference_ms": 0.23644466795644398, "mean_action_processing_ms": 0.05722532653154297, "mean_env_wait_ms": 0.6205764855488669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00244903564453125, "StateBufferConnector_ms": 0.00171661376953125, "ViewRequirementAgentConnector_ms": 0.04393339157104492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800, "num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.25580539564632, "num_env_steps_trained_throughput_per_sec": 190.25580539564632, "timesteps_total": 175800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 175800, "timers": {"training_iteration_time_ms": 1891.259, "sample_time_ms": 1884.244, "load_time_ms": 0.219, "load_throughput": 1644108.711, "learn_time_ms": 6.25, "learn_throughput": 57597.144, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800}, "done": false, "episodes_total": 969, "training_iteration": 186, "trial_id": "71c6f_00000", "date": "2023-08-04_10-11-32", "timestamp": 1691133092, "time_this_iter_s": 11.355175018310547, "time_total_s": 2024.6222336292267, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.79150676727295, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.4, "ram_util_percent": 65.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.1, "policy_entropy": -322.2371337890625, "policy_loss": 328589.303125, "vf_loss": 20730136.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 803.0, "diff_num_grad_updates_vs_sampler_policy": 802.0}}, "num_env_steps_sampled": 177960, "num_env_steps_trained": 177960, "num_agent_steps_sampled": 177960, "num_agent_steps_trained": 177960}, "sampler_results": {"episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.239347390644, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35230893496803, "mean_inference_ms": 0.23645347230998479, "mean_action_processing_ms": 0.05722475169112354, "mean_env_wait_ms": 0.6173783103684063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002441883087158203, "StateBufferConnector_ms": 0.0017209053039550781, "ViewRequirementAgentConnector_ms": 0.04393768310546875}}, "episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.239347390644, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.162894384649, -3527.2808406167405, -3527.1342531514806, -3526.6176017755292, -3526.261720931092, -3527.7524364171554, -3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35230893496803, "mean_inference_ms": 0.23645347230998479, "mean_action_processing_ms": 0.05722475169112354, "mean_env_wait_ms": 0.6173783103684063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002441883087158203, "StateBufferConnector_ms": 0.0017209053039550781, "ViewRequirementAgentConnector_ms": 0.04393768310546875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177960, "num_agent_steps_trained": 177960, "num_env_steps_sampled": 177960, "num_env_steps_trained": 177960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.92014634379984, "num_env_steps_trained_throughput_per_sec": 191.92014634379984, "timesteps_total": 177960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 177960, "timers": {"training_iteration_time_ms": 1883.953, "sample_time_ms": 1876.958, "load_time_ms": 0.219, "load_throughput": 1645900.85, "learn_time_ms": 6.227, "learn_throughput": 57814.812, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 177960, "num_env_steps_trained": 177960, "num_agent_steps_sampled": 177960, "num_agent_steps_trained": 177960}, "done": false, "episodes_total": 975, "training_iteration": 187, "trial_id": "71c6f_00000", "date": "2023-08-04_10-11-44", "timestamp": 1691133104, "time_this_iter_s": 11.256695985794067, "time_total_s": 2035.8789296150208, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 306.048202753067, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 35.09375, "ram_util_percent": 65.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.388888888888889e-09, "entropy_coeff": 0.1, "policy_entropy": -322.45274047851564, "policy_loss": -4654363.440625, "vf_loss": 20747125.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 832.0}}, "num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120}, "sampler_results": {"episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.2459612817447, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351960352924351, "mean_inference_ms": 0.2364527605159153, "mean_action_processing_ms": 0.05722230270337359, "mean_env_wait_ms": 0.6145427384791995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440214157104492, "StateBufferConnector_ms": 0.0017218589782714844, "ViewRequirementAgentConnector_ms": 0.04387974739074707}}, "episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.2459612817447, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6257970799275, -3527.655849673363, -3527.9088250807645, -3527.822281836621, -3527.587248688497, -3527.051602975446, -3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351960352924351, "mean_inference_ms": 0.2364527605159153, "mean_action_processing_ms": 0.05722230270337359, "mean_env_wait_ms": 0.6145427384791995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440214157104492, "StateBufferConnector_ms": 0.0017218589782714844, "ViewRequirementAgentConnector_ms": 0.04387974739074707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120, "num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 192.112040440048, "num_env_steps_trained_throughput_per_sec": 192.112040440048, "timesteps_total": 180120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 180120, "timers": {"training_iteration_time_ms": 1874.134, "sample_time_ms": 1867.125, "load_time_ms": 0.219, "load_throughput": 1647157.674, "learn_time_ms": 6.228, "learn_throughput": 57804.409, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120}, "done": false, "episodes_total": 981, "training_iteration": 188, "trial_id": "71c6f_00000", "date": "2023-08-04_10-11-55", "timestamp": 1691133115, "time_this_iter_s": 11.24555516242981, "time_total_s": 2047.1244847774506, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 317.2937579154968, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 33.775, "ram_util_percent": 65.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.388888888888889e-09, "entropy_coeff": 0.1, "policy_entropy": -322.42347412109376, "policy_loss": -5503535.875, "vf_loss": 20760113.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 863.0, "diff_num_grad_updates_vs_sampler_policy": 862.0}}, "num_env_steps_sampled": 182280, "num_env_steps_trained": 182280, "num_agent_steps_sampled": 182280, "num_agent_steps_trained": 182280}, "sampler_results": {"episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.2297226580285, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351599666457713, "mean_inference_ms": 0.23644740063222364, "mean_action_processing_ms": 0.05721892799797242, "mean_env_wait_ms": 0.611976379516112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024399757385253906, "StateBufferConnector_ms": 0.0017206668853759766, "ViewRequirementAgentConnector_ms": 0.043882131576538086}}, "episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.2297226580285, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.1480106542326, -3527.2322232423367, -3527.4759628878446, -3527.0103807771725, -3527.6216229129795, -3526.5936989710303, -3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351599666457713, "mean_inference_ms": 0.23644740063222364, "mean_action_processing_ms": 0.05721892799797242, "mean_env_wait_ms": 0.611976379516112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024399757385253906, "StateBufferConnector_ms": 0.0017206668853759766, "ViewRequirementAgentConnector_ms": 0.043882131576538086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182280, "num_agent_steps_trained": 182280, "num_env_steps_sampled": 182280, "num_env_steps_trained": 182280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.59436060124662, "num_env_steps_trained_throughput_per_sec": 191.59436060124662, "timesteps_total": 182280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 182280, "timers": {"training_iteration_time_ms": 1877.905, "sample_time_ms": 1870.908, "load_time_ms": 0.219, "load_throughput": 1647157.674, "learn_time_ms": 6.235, "learn_throughput": 57740.748, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 182280, "num_env_steps_trained": 182280, "num_agent_steps_sampled": 182280, "num_agent_steps_trained": 182280}, "done": false, "episodes_total": 987, "training_iteration": 189, "trial_id": "71c6f_00000", "date": "2023-08-04_10-12-06", "timestamp": 1691133126, "time_this_iter_s": 11.27640986442566, "time_total_s": 2058.400894641876, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 328.5701677799225, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 33.00625, "ram_util_percent": 65.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.33900146484376, "policy_loss": -1127796.25, "vf_loss": 20740823.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 892.0}}, "num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440}, "sampler_results": {"episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.22155676088, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351150784865653, "mean_inference_ms": 0.23643897363275962, "mean_action_processing_ms": 0.057215015494284656, "mean_env_wait_ms": 0.6096601549836245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002442598342895508, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.04386162757873535}}, "episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.22155676088, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.014645654867, -3528.254433340817, -3527.733117543201, -3527.05718657876, -3527.6768295447987, -3528.240348846565, -3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351150784865653, "mean_inference_ms": 0.23643897363275962, "mean_action_processing_ms": 0.057215015494284656, "mean_env_wait_ms": 0.6096601549836245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002442598342895508, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.04386162757873535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440, "num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 192.02102687932938, "num_env_steps_trained_throughput_per_sec": 192.02102687932938, "timesteps_total": 184440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 184440, "timers": {"training_iteration_time_ms": 1876.879, "sample_time_ms": 1869.924, "load_time_ms": 0.219, "load_throughput": 1643750.751, "learn_time_ms": 6.199, "learn_throughput": 58077.212, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440}, "done": false, "episodes_total": 993, "training_iteration": 190, "trial_id": "71c6f_00000", "date": "2023-08-04_10-12-17", "timestamp": 1691133137, "time_this_iter_s": 11.250778198242188, "time_total_s": 2069.6516728401184, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 339.8209459781647, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 32.05, "ram_util_percent": 65.76249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.694444444444445e-09, "entropy_coeff": 0.1, "policy_entropy": -322.44190673828126, "policy_loss": -5281614.234375, "vf_loss": 20743425.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 922.0}}, "num_env_steps_sampled": 186600, "num_env_steps_trained": 186600, "num_agent_steps_sampled": 186600, "num_agent_steps_trained": 186600}, "sampler_results": {"episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.199483510314, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3506964867376, "mean_inference_ms": 0.23641844591682168, "mean_action_processing_ms": 0.05720934213368789, "mean_env_wait_ms": 0.6075175360724899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024290084838867188, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.043770551681518555}}, "episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.199483510314, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.4471292680983, -3527.5482891421675, -3527.0901195583265, -3526.2127080684627, -3527.4804024080663, -3526.571341356385, -3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3506964867376, "mean_inference_ms": 0.23641844591682168, "mean_action_processing_ms": 0.05720934213368789, "mean_env_wait_ms": 0.6075175360724899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024290084838867188, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.043770551681518555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186600, "num_agent_steps_trained": 186600, "num_env_steps_sampled": 186600, "num_env_steps_trained": 186600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 192.19826360238068, "num_env_steps_trained_throughput_per_sec": 192.19826360238068, "timesteps_total": 186600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 186600, "timers": {"training_iteration_time_ms": 1874.95, "sample_time_ms": 1867.965, "load_time_ms": 0.218, "load_throughput": 1650037.635, "learn_time_ms": 6.224, "learn_throughput": 57842.939, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 186600, "num_env_steps_trained": 186600, "num_agent_steps_sampled": 186600, "num_agent_steps_trained": 186600}, "done": false, "episodes_total": 999, "training_iteration": 191, "trial_id": "71c6f_00000", "date": "2023-08-04_10-12-29", "timestamp": 1691133149, "time_this_iter_s": 11.240443229675293, "time_total_s": 2080.8921160697937, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 351.06138920783997, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.06875, "ram_util_percent": 65.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1944444444444446e-09, "entropy_coeff": 0.1, "policy_entropy": -322.3416748046875, "policy_loss": -2842385.940625, "vf_loss": 20746530.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 953.0, "diff_num_grad_updates_vs_sampler_policy": 952.0}}, "num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760}, "sampler_results": {"episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.1959766415794, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350864708084531, "mean_inference_ms": 0.23646183056951867, "mean_action_processing_ms": 0.05721806945661008, "mean_env_wait_ms": 0.6056958353264907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002417325973510742, "StateBufferConnector_ms": 0.0017201900482177734, "ViewRequirementAgentConnector_ms": 0.04394245147705078}}, "episode_reward_max": -3525.6518873063583, "episode_reward_min": -3532.737042392773, "episode_reward_mean": -3527.1959766415794, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.1384625534606, -3532.737042392773, -3526.184149326885, -3527.5657477425325, -3527.108547466423, -3527.5342885884734, -3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.350864708084531, "mean_inference_ms": 0.23646183056951867, "mean_action_processing_ms": 0.05721806945661008, "mean_env_wait_ms": 0.6056958353264907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002417325973510742, "StateBufferConnector_ms": 0.0017201900482177734, "ViewRequirementAgentConnector_ms": 0.04394245147705078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760, "num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 176.66873625616, "num_env_steps_trained_throughput_per_sec": 176.66873625616, "timesteps_total": 188760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 188760, "timers": {"training_iteration_time_ms": 1972.885, "sample_time_ms": 1965.597, "load_time_ms": 0.224, "load_throughput": 1606671.036, "learn_time_ms": 6.487, "learn_throughput": 55497.952, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760}, "done": false, "episodes_total": 1005, "training_iteration": 192, "trial_id": "71c6f_00000", "date": "2023-08-04_10-12-41", "timestamp": 1691133161, "time_this_iter_s": 12.22847580909729, "time_total_s": 2093.120591878891, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 363.28986501693726, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 47.635294117647064, "ram_util_percent": 65.78235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.4936889648437, "policy_loss": -5678021.33125, "vf_loss": 20751781.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 983.0, "diff_num_grad_updates_vs_sampler_policy": 982.0}}, "num_env_steps_sampled": 190920, "num_env_steps_trained": 190920, "num_agent_steps_sampled": 190920, "num_agent_steps_trained": 190920}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.0644189913473, "episode_reward_mean": -3527.1417341063625, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351195449157614, "mean_inference_ms": 0.2365555516488012, "mean_action_processing_ms": 0.05723561027103515, "mean_env_wait_ms": 0.6041619768730624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024318695068359375, "StateBufferConnector_ms": 0.0017197132110595703, "ViewRequirementAgentConnector_ms": 0.04417920112609863}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.0644189913473, "episode_reward_mean": -3527.1417341063625, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.9482265702272, -3526.5661267829933, -3527.083452869212, -3527.073287153408, -3527.253072684502, -3527.8097251432555, -3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351195449157614, "mean_inference_ms": 0.2365555516488012, "mean_action_processing_ms": 0.05723561027103515, "mean_env_wait_ms": 0.6041619768730624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024318695068359375, "StateBufferConnector_ms": 0.0017197132110595703, "ViewRequirementAgentConnector_ms": 0.04417920112609863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190920, "num_agent_steps_trained": 190920, "num_env_steps_sampled": 190920, "num_env_steps_trained": 190920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 184.26001577733453, "num_env_steps_trained_throughput_per_sec": 184.26001577733453, "timesteps_total": 190920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 190920, "timers": {"training_iteration_time_ms": 2019.86, "sample_time_ms": 2012.254, "load_time_ms": 0.231, "load_throughput": 1560187.477, "learn_time_ms": 6.778, "learn_throughput": 53116.549, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 190920, "num_env_steps_trained": 190920, "num_agent_steps_sampled": 190920, "num_agent_steps_trained": 190920}, "done": false, "episodes_total": 1011, "training_iteration": 193, "trial_id": "71c6f_00000", "date": "2023-08-04_10-12-53", "timestamp": 1691133173, "time_this_iter_s": 11.724495887756348, "time_total_s": 2104.8450877666473, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 375.0143609046936, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 35.06470588235294, "ram_util_percent": 66.29411764705884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-09, "entropy_coeff": 0.1, "policy_entropy": -322.3290100097656, "policy_loss": -551555.165625, "vf_loss": 20744980.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 1012.0}}, "num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.543334618402, "episode_reward_mean": -3527.1594079514284, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351841176330144, "mean_inference_ms": 0.23667922164321378, "mean_action_processing_ms": 0.05725810885258575, "mean_env_wait_ms": 0.6028350661806349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024750232696533203, "StateBufferConnector_ms": 0.0017271041870117188, "ViewRequirementAgentConnector_ms": 0.04459500312805176}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.543334618402, "episode_reward_mean": -3527.1594079514284, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.435078178291, -3526.566429094048, -3527.016144009677, -3527.8451432844677, -3527.636588564919, -3526.162927252217, -3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.351841176330144, "mean_inference_ms": 0.23667922164321378, "mean_action_processing_ms": 0.05725810885258575, "mean_env_wait_ms": 0.6028350661806349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024750232696533203, "StateBufferConnector_ms": 0.0017271041870117188, "ViewRequirementAgentConnector_ms": 0.04459500312805176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080, "num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 182.0095211042586, "num_env_steps_trained_throughput_per_sec": 182.0095211042586, "timesteps_total": 193080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 193080, "timers": {"training_iteration_time_ms": 1959.131, "sample_time_ms": 1951.723, "load_time_ms": 0.231, "load_throughput": 1557130.494, "learn_time_ms": 6.568, "learn_throughput": 54811.78, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080}, "done": false, "episodes_total": 1017, "training_iteration": 194, "trial_id": "71c6f_00000", "date": "2023-08-04_10-13-04", "timestamp": 1691133184, "time_this_iter_s": 11.869817018508911, "time_total_s": 2116.7149047851562, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 386.8841779232025, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.35294117647059, "ram_util_percent": 66.29411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7166666666666667e-09, "entropy_coeff": 0.1, "policy_entropy": -322.3450988769531, "policy_loss": -5345730.46875, "vf_loss": 20753158.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1043.0, "diff_num_grad_updates_vs_sampler_policy": 1042.0}}, "num_env_steps_sampled": 195240, "num_env_steps_trained": 195240, "num_agent_steps_sampled": 195240, "num_agent_steps_trained": 195240}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.8625700390908, "episode_reward_mean": -3527.18063385357, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3527826234725016, "mean_inference_ms": 0.23682408644040756, "mean_action_processing_ms": 0.057285030918189615, "mean_env_wait_ms": 0.6016706480957806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024919509887695312, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.04468536376953125}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.8625700390908, "episode_reward_mean": -3527.18063385357, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5744418136696, -3528.198545586767, -3526.2984699085146, -3525.7280575753916, -3526.5906481325173, -3526.8860612236217, -3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3527826234725016, "mean_inference_ms": 0.23682408644040756, "mean_action_processing_ms": 0.057285030918189615, "mean_env_wait_ms": 0.6016706480957806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024919509887695312, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.04468536376953125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195240, "num_agent_steps_trained": 195240, "num_env_steps_sampled": 195240, "num_env_steps_trained": 195240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 183.0462362393011, "num_env_steps_trained_throughput_per_sec": 183.0462362393011, "timesteps_total": 195240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 195240, "timers": {"training_iteration_time_ms": 1981.881, "sample_time_ms": 1974.431, "load_time_ms": 0.23, "load_throughput": 1565038.806, "learn_time_ms": 6.608, "learn_throughput": 54479.145, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 195240, "num_env_steps_trained": 195240, "num_agent_steps_sampled": 195240, "num_agent_steps_trained": 195240}, "done": false, "episodes_total": 1023, "training_iteration": 195, "trial_id": "71c6f_00000", "date": "2023-08-04_10-13-16", "timestamp": 1691133196, "time_this_iter_s": 11.802478075027466, "time_total_s": 2128.5173828601837, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 398.68665599823, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 32.2125, "ram_util_percent": 66.30625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.1, "policy_entropy": -322.41737670898436, "policy_loss": -6982035.69375, "vf_loss": 20736538.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1073.0, "diff_num_grad_updates_vs_sampler_policy": 1072.0}}, "num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.8625700390908, "episode_reward_mean": -3527.2136810091893, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353790517459815, "mean_inference_ms": 0.23698367564817466, "mean_action_processing_ms": 0.05731435123748083, "mean_env_wait_ms": 0.6006650700302323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017445087432861328, "ViewRequirementAgentConnector_ms": 0.044873714447021484}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.8625700390908, "episode_reward_mean": -3527.2136810091893, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.653868044202, -3526.9969831597336, -3527.1097279293494, -3526.987583098396, -3525.703012389238, -3528.799478344227, -3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.353790517459815, "mean_inference_ms": 0.23698367564817466, "mean_action_processing_ms": 0.05731435123748083, "mean_env_wait_ms": 0.6006650700302323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0017445087432861328, "ViewRequirementAgentConnector_ms": 0.044873714447021484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400, "num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.57190269288566, "num_env_steps_trained_throughput_per_sec": 187.57190269288566, "timesteps_total": 197400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 197400, "timers": {"training_iteration_time_ms": 1925.557, "sample_time_ms": 1918.453, "load_time_ms": 0.224, "load_throughput": 1605816.697, "learn_time_ms": 6.305, "learn_throughput": 57094.059, "synch_weights_time_ms": 0.541}, "counters": {"num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400}, "done": false, "episodes_total": 1029, "training_iteration": 196, "trial_id": "71c6f_00000", "date": "2023-08-04_10-13-28", "timestamp": 1691133208, "time_this_iter_s": 11.517508745193481, "time_total_s": 2140.034891605377, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 410.20416474342346, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.93529411764706, "ram_util_percent": 66.20588235294119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.1, "policy_entropy": -322.33111572265625, "policy_loss": -66096.38125, "vf_loss": 20735280.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 1102.0}}, "num_env_steps_sampled": 199560, "num_env_steps_trained": 199560, "num_agent_steps_sampled": 199560, "num_agent_steps_trained": 199560}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.8625700390908, "episode_reward_mean": -3527.193520062452, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354911315955606, "mean_inference_ms": 0.23715321777400838, "mean_action_processing_ms": 0.0573449542278777, "mean_env_wait_ms": 0.5997868310301302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513408660888672, "StateBufferConnector_ms": 0.0017499923706054688, "ViewRequirementAgentConnector_ms": 0.0449676513671875}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.8625700390908, "episode_reward_mean": -3527.193520062452, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.9656849551543, -3526.56016555293, -3526.2916741735426, -3526.077890986058, -3526.9926078417375, -3526.328617064943, -3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354911315955606, "mean_inference_ms": 0.23715321777400838, "mean_action_processing_ms": 0.0573449542278777, "mean_env_wait_ms": 0.5997868310301302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513408660888672, "StateBufferConnector_ms": 0.0017499923706054688, "ViewRequirementAgentConnector_ms": 0.0449676513671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199560, "num_agent_steps_trained": 199560, "num_env_steps_sampled": 199560, "num_env_steps_trained": 199560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.48743073797812, "num_env_steps_trained_throughput_per_sec": 186.48743073797812, "timesteps_total": 199560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 199560, "timers": {"training_iteration_time_ms": 1927.284, "sample_time_ms": 1920.326, "load_time_ms": 0.219, "load_throughput": 1642141.86, "learn_time_ms": 6.187, "learn_throughput": 58183.289, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 199560, "num_env_steps_trained": 199560, "num_agent_steps_sampled": 199560, "num_agent_steps_trained": 199560}, "done": false, "episodes_total": 1035, "training_iteration": 197, "trial_id": "71c6f_00000", "date": "2023-08-04_10-13-39", "timestamp": 1691133219, "time_this_iter_s": 11.584688901901245, "time_total_s": 2151.6195805072784, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 421.7888536453247, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 25.56875, "ram_util_percent": 66.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.388888888888889e-10, "entropy_coeff": 0.1, "policy_entropy": -322.26976318359374, "policy_loss": 303437.4625, "vf_loss": 20743094.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1133.0, "diff_num_grad_updates_vs_sampler_policy": 1132.0}}, "num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.8625700390908, "episode_reward_mean": -3527.1989457759323, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356165131455007, "mean_inference_ms": 0.23734537188120647, "mean_action_processing_ms": 0.05737962396661893, "mean_env_wait_ms": 0.5990323898911853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025212764739990234, "StateBufferConnector_ms": 0.0017542839050292969, "ViewRequirementAgentConnector_ms": 0.04502248764038086}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3529.8625700390908, "episode_reward_mean": -3527.1989457759323, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3447906082743, -3525.678494146834, -3526.971815047952, -3527.23913903338, -3527.450708253568, -3525.9582454562, -3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356165131455007, "mean_inference_ms": 0.23734537188120647, "mean_action_processing_ms": 0.05737962396661893, "mean_env_wait_ms": 0.5990323898911853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025212764739990234, "StateBufferConnector_ms": 0.0017542839050292969, "ViewRequirementAgentConnector_ms": 0.04502248764038086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720, "num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.15700131877952, "num_env_steps_trained_throughput_per_sec": 186.15700131877952, "timesteps_total": 201720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 201720, "timers": {"training_iteration_time_ms": 1927.965, "sample_time_ms": 1920.812, "load_time_ms": 0.227, "load_throughput": 1588584.366, "learn_time_ms": 6.353, "learn_throughput": 56669.786, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720}, "done": false, "episodes_total": 1041, "training_iteration": 198, "trial_id": "71c6f_00000", "date": "2023-08-04_10-13-51", "timestamp": 1691133231, "time_this_iter_s": 11.60508918762207, "time_total_s": 2163.2246696949005, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 433.3939428329468, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 42.4125, "ram_util_percent": 66.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.388888888888888e-10, "entropy_coeff": 0.1, "policy_entropy": -322.5592346191406, "policy_loss": -5267363.315625, "vf_loss": 20842368.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1163.0, "diff_num_grad_updates_vs_sampler_policy": 1162.0}}, "num_env_steps_sampled": 203880, "num_env_steps_trained": 203880, "num_agent_steps_sampled": 203880, "num_agent_steps_trained": 203880}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.292555482291, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.357521902252422, "mean_inference_ms": 0.2375379315237497, "mean_action_processing_ms": 0.05741399593334389, "mean_env_wait_ms": 0.5983460372658087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025293827056884766, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.04504513740539551}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.292555482291, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.124679373649, -3526.114646664285, -3527.1343858862624, -3527.842813208134, -3528.4419644713453, -3526.041197390667, -3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.357521902252422, "mean_inference_ms": 0.2375379315237497, "mean_action_processing_ms": 0.05741399593334389, "mean_env_wait_ms": 0.5983460372658087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025293827056884766, "StateBufferConnector_ms": 0.001753091812133789, "ViewRequirementAgentConnector_ms": 0.04504513740539551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203880, "num_agent_steps_trained": 203880, "num_env_steps_sampled": 203880, "num_env_steps_trained": 203880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.60326321333403, "num_env_steps_trained_throughput_per_sec": 187.60326321333403, "timesteps_total": 203880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 203880, "timers": {"training_iteration_time_ms": 1926.684, "sample_time_ms": 1919.497, "load_time_ms": 0.23, "load_throughput": 1568126.95, "learn_time_ms": 6.377, "learn_throughput": 56452.828, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 203880, "num_env_steps_trained": 203880, "num_agent_steps_sampled": 203880, "num_agent_steps_trained": 203880}, "done": false, "episodes_total": 1047, "training_iteration": 199, "trial_id": "71c6f_00000", "date": "2023-08-04_10-14-03", "timestamp": 1691133243, "time_this_iter_s": 11.515924215316772, "time_total_s": 2174.7405939102173, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 444.90986704826355, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 39.14705882352941, "ram_util_percent": 66.42941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.1, "policy_entropy": -322.33966064453125, "policy_loss": -166791.675, "vf_loss": 20750521.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 1192.0}}, "num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2762045115414, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35898686257597, "mean_inference_ms": 0.23774385365787, "mean_action_processing_ms": 0.057450377886108815, "mean_env_wait_ms": 0.597716898422948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025305747985839844, "StateBufferConnector_ms": 0.0017547607421875, "ViewRequirementAgentConnector_ms": 0.04503488540649414}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2762045115414, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.6363249386695, -3527.567207662842, -3527.4763741455117, -3526.342448725591, -3529.0644189913473, -3527.057952009296, -3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.35898686257597, "mean_inference_ms": 0.23774385365787, "mean_action_processing_ms": 0.057450377886108815, "mean_env_wait_ms": 0.597716898422948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025305747985839844, "StateBufferConnector_ms": 0.0017547607421875, "ViewRequirementAgentConnector_ms": 0.04503488540649414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040, "num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.55520906595228, "num_env_steps_trained_throughput_per_sec": 187.55520906595228, "timesteps_total": 206040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 206040, "timers": {"training_iteration_time_ms": 1917.303, "sample_time_ms": 1910.218, "load_time_ms": 0.226, "load_throughput": 1591934.043, "learn_time_ms": 6.286, "learn_throughput": 57267.724, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040}, "done": false, "episodes_total": 1053, "training_iteration": 200, "trial_id": "71c6f_00000", "date": "2023-08-04_10-14-14", "timestamp": 1691133254, "time_this_iter_s": 11.518813133239746, "time_total_s": 2186.259407043457, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 456.4286801815033, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 38.09375, "ram_util_percent": 66.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5111111111111117e-10, "entropy_coeff": 0.1, "policy_entropy": -322.44688720703124, "policy_loss": -4866388.3625, "vf_loss": 20749307.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1223.0, "diff_num_grad_updates_vs_sampler_policy": 1222.0}}, "num_env_steps_sampled": 208200, "num_env_steps_trained": 208200, "num_agent_steps_sampled": 208200, "num_agent_steps_trained": 208200}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2510377935837, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.360545258984874, "mean_inference_ms": 0.2379758477321262, "mean_action_processing_ms": 0.05749117211411121, "mean_env_wait_ms": 0.5972024529718822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025446414947509766, "StateBufferConnector_ms": 0.001764059066772461, "ViewRequirementAgentConnector_ms": 0.04530000686645508}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2510377935837, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.683658977806, -3526.6622255819625, -3527.865353492034, -3526.4764056128874, -3527.0168580495942, -3526.285340898079, -3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.360545258984874, "mean_inference_ms": 0.2379758477321262, "mean_action_processing_ms": 0.05749117211411121, "mean_env_wait_ms": 0.5972024529718822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025446414947509766, "StateBufferConnector_ms": 0.001764059066772461, "ViewRequirementAgentConnector_ms": 0.04530000686645508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208200, "num_agent_steps_trained": 208200, "num_env_steps_sampled": 208200, "num_env_steps_trained": 208200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.53917492881232, "num_env_steps_trained_throughput_per_sec": 185.53917492881232, "timesteps_total": 208200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 208200, "timers": {"training_iteration_time_ms": 1938.509, "sample_time_ms": 1931.31, "load_time_ms": 0.233, "load_throughput": 1548031.003, "learn_time_ms": 6.385, "learn_throughput": 56381.369, "synch_weights_time_ms": 0.547}, "counters": {"num_env_steps_sampled": 208200, "num_env_steps_trained": 208200, "num_agent_steps_sampled": 208200, "num_agent_steps_trained": 208200}, "done": false, "episodes_total": 1059, "training_iteration": 201, "trial_id": "71c6f_00000", "date": "2023-08-04_10-14-26", "timestamp": 1691133266, "time_this_iter_s": 11.643949031829834, "time_total_s": 2197.903356075287, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 468.07262921333313, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 38.33529411764705, "ram_util_percent": 66.3529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1111111111111112e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4149963378906, "policy_loss": -1280365.5, "vf_loss": 20734553.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1253.0, "diff_num_grad_updates_vs_sampler_policy": 1252.0}}, "num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2663334657123, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.362215375663527, "mean_inference_ms": 0.2382174711771445, "mean_action_processing_ms": 0.05753351525843112, "mean_env_wait_ms": 0.5967554802177947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025603771209716797, "StateBufferConnector_ms": 0.0017659664154052734, "ViewRequirementAgentConnector_ms": 0.04545021057128906}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2663334657123, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.19976626068, -3528.0686072069816, -3526.840165918395, -3528.543811184745, -3526.326931040268, -3528.2211556539223, -3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.362215375663527, "mean_inference_ms": 0.2382174711771445, "mean_action_processing_ms": 0.05753351525843112, "mean_env_wait_ms": 0.5967554802177947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025603771209716797, "StateBufferConnector_ms": 0.0017659664154052734, "ViewRequirementAgentConnector_ms": 0.04545021057128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360, "num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.3930862024863, "num_env_steps_trained_throughput_per_sec": 185.3930862024863, "timesteps_total": 210360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 210360, "timers": {"training_iteration_time_ms": 1941.546, "sample_time_ms": 1934.461, "load_time_ms": 0.237, "load_throughput": 1516622.579, "learn_time_ms": 6.277, "learn_throughput": 57353.428, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360}, "done": false, "episodes_total": 1065, "training_iteration": 202, "trial_id": "71c6f_00000", "date": "2023-08-04_10-14-37", "timestamp": 1691133277, "time_this_iter_s": 11.653311014175415, "time_total_s": 2209.5566670894623, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 479.72594022750854, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.3, "ram_util_percent": 64.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4543823242187, "policy_loss": -4129435.753125, "vf_loss": 20826426.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 1282.0}}, "num_env_steps_sampled": 212520, "num_env_steps_trained": 212520, "num_agent_steps_sampled": 212520, "num_agent_steps_trained": 212520}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.286826995327, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.363980778224922, "mean_inference_ms": 0.23846326933547377, "mean_action_processing_ms": 0.057576413120591356, "mean_env_wait_ms": 0.596377216619825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025739669799804688, "StateBufferConnector_ms": 0.0017786026000976562, "ViewRequirementAgentConnector_ms": 0.04555201530456543}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.286826995327, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.311517653373, -3527.687611849859, -3527.9280755585833, -3525.6518873063583, -3526.2766372164233, -3526.904081943843, -3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.363980778224922, "mean_inference_ms": 0.23846326933547377, "mean_action_processing_ms": 0.057576413120591356, "mean_env_wait_ms": 0.596377216619825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025739669799804688, "StateBufferConnector_ms": 0.0017786026000976562, "ViewRequirementAgentConnector_ms": 0.04555201530456543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212520, "num_agent_steps_trained": 212520, "num_env_steps_sampled": 212520, "num_env_steps_trained": 212520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.51098804725103, "num_env_steps_trained_throughput_per_sec": 186.51098804725103, "timesteps_total": 212520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 212520, "timers": {"training_iteration_time_ms": 1936.575, "sample_time_ms": 1929.41, "load_time_ms": 0.237, "load_throughput": 1519675.362, "learn_time_ms": 6.356, "learn_throughput": 56636.201, "synch_weights_time_ms": 0.537}, "counters": {"num_env_steps_sampled": 212520, "num_env_steps_trained": 212520, "num_agent_steps_sampled": 212520, "num_agent_steps_trained": 212520}, "done": false, "episodes_total": 1071, "training_iteration": 203, "trial_id": "71c6f_00000", "date": "2023-08-04_10-14-49", "timestamp": 1691133289, "time_this_iter_s": 11.583424091339111, "time_total_s": 2221.1400911808014, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 491.30936431884766, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 37.54705882352942, "ram_util_percent": 65.28235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4479553222656, "policy_loss": -4599115.93125, "vf_loss": 20751227.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1313.0, "diff_num_grad_updates_vs_sampler_policy": 1312.0}}, "num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.341554872488, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3658878129987695, "mean_inference_ms": 0.2387142607349955, "mean_action_processing_ms": 0.05762021336419086, "mean_env_wait_ms": 0.5960823171736478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574443817138672, "StateBufferConnector_ms": 0.0017728805541992188, "ViewRequirementAgentConnector_ms": 0.04566359519958496}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.341554872488, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6907138848214, -3529.0522131287435, -3527.174373231835, -3526.7731169809135, -3528.029825812495, -3526.024129089748, -3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3658878129987695, "mean_inference_ms": 0.2387142607349955, "mean_action_processing_ms": 0.05762021336419086, "mean_env_wait_ms": 0.5960823171736478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574443817138672, "StateBufferConnector_ms": 0.0017728805541992188, "ViewRequirementAgentConnector_ms": 0.04566359519958496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680, "num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.53307266968588, "num_env_steps_trained_throughput_per_sec": 186.53307266968588, "timesteps_total": 214680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 214680, "timers": {"training_iteration_time_ms": 1930.611, "sample_time_ms": 1923.66, "load_time_ms": 0.223, "load_throughput": 1612160.41, "learn_time_ms": 6.179, "learn_throughput": 58261.415, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680}, "done": false, "episodes_total": 1077, "training_iteration": 204, "trial_id": "71c6f_00000", "date": "2023-08-04_10-15-01", "timestamp": 1691133301, "time_this_iter_s": 11.581727027893066, "time_total_s": 2232.7218182086945, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 502.8910913467407, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 39.95, "ram_util_percent": 66.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.36069946289064, "policy_loss": -5118884.05625, "vf_loss": 20742058.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1343.0, "diff_num_grad_updates_vs_sampler_policy": 1342.0}}, "num_env_steps_sampled": 216840, "num_env_steps_trained": 216840, "num_agent_steps_sampled": 216840, "num_agent_steps_trained": 216840}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.307924724515, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3678559264317025, "mean_inference_ms": 0.23897667757061697, "mean_action_processing_ms": 0.05766589586938904, "mean_env_wait_ms": 0.5958520635174609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026051998138427734, "StateBufferConnector_ms": 0.0017743110656738281, "ViewRequirementAgentConnector_ms": 0.045883893966674805}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.307924724515, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.85628408156, -3528.453971816203, -3525.852572205635, -3527.8109599573345, -3526.867253453278, -3527.4383628266305, -3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3678559264317025, "mean_inference_ms": 0.23897667757061697, "mean_action_processing_ms": 0.05766589586938904, "mean_env_wait_ms": 0.5958520635174609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026051998138427734, "StateBufferConnector_ms": 0.0017743110656738281, "ViewRequirementAgentConnector_ms": 0.045883893966674805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216840, "num_agent_steps_trained": 216840, "num_env_steps_sampled": 216840, "num_env_steps_trained": 216840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 188.47229952122063, "num_env_steps_trained_throughput_per_sec": 188.47229952122063, "timesteps_total": 216840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 216840, "timers": {"training_iteration_time_ms": 1919.898, "sample_time_ms": 1912.947, "load_time_ms": 0.221, "load_throughput": 1630967.207, "learn_time_ms": 6.18, "learn_throughput": 58252.2, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 216840, "num_env_steps_trained": 216840, "num_agent_steps_sampled": 216840, "num_agent_steps_trained": 216840}, "done": false, "episodes_total": 1083, "training_iteration": 205, "trial_id": "71c6f_00000", "date": "2023-08-04_10-15-12", "timestamp": 1691133312, "time_this_iter_s": 11.462738990783691, "time_total_s": 2244.184557199478, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 514.3538303375244, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 38.65, "ram_util_percent": 65.83749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.31060180664065, "policy_loss": -3404820.3875, "vf_loss": 20746973.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 1372.0}}, "num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2749451985455, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.369991541837117, "mean_inference_ms": 0.23926265137080954, "mean_action_processing_ms": 0.05771629685324904, "mean_env_wait_ms": 0.5957127695460044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026214122772216797, "StateBufferConnector_ms": 0.0017833709716796875, "ViewRequirementAgentConnector_ms": 0.04614114761352539}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2749451985455, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7034591413144, -3528.8922874993877, -3526.9224121131697, -3526.4415346970004, -3526.7954664093413, -3526.32727916511, -3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.369991541837117, "mean_inference_ms": 0.23926265137080954, "mean_action_processing_ms": 0.05771629685324904, "mean_env_wait_ms": 0.5957127695460044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026214122772216797, "StateBufferConnector_ms": 0.0017833709716796875, "ViewRequirementAgentConnector_ms": 0.04614114761352539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000, "num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 183.94536923853306, "num_env_steps_trained_throughput_per_sec": 183.94536923853306, "timesteps_total": 219000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 219000, "timers": {"training_iteration_time_ms": 1939.024, "sample_time_ms": 1931.797, "load_time_ms": 0.224, "load_throughput": 1608896.58, "learn_time_ms": 6.425, "learn_throughput": 56029.888, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000}, "done": false, "episodes_total": 1089, "training_iteration": 206, "trial_id": "71c6f_00000", "date": "2023-08-04_10-15-24", "timestamp": 1691133324, "time_this_iter_s": 11.744776010513306, "time_total_s": 2255.9293332099915, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 526.0986063480377, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 42.58823529411764, "ram_util_percent": 66.45882352941175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.46128540039064, "policy_loss": -4882814.8375, "vf_loss": 20826769.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1403.0, "diff_num_grad_updates_vs_sampler_policy": 1402.0}}, "num_env_steps_sampled": 221160, "num_env_steps_trained": 221160, "num_agent_steps_sampled": 221160, "num_agent_steps_trained": 221160}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.363296235625, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.372361281306347, "mean_inference_ms": 0.23955845936718143, "mean_action_processing_ms": 0.0577684329557556, "mean_env_wait_ms": 0.5956168534233073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002619504928588867, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.04626774787902832}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.363296235625, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.9375790074405, -3526.811626875849, -3528.984246502163, -3526.913038492561, -3525.833078230033, -3527.1218688781496, -3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.372361281306347, "mean_inference_ms": 0.23955845936718143, "mean_action_processing_ms": 0.0577684329557556, "mean_env_wait_ms": 0.5956168534233073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002619504928588867, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.04626774787902832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221160, "num_agent_steps_trained": 221160, "num_env_steps_sampled": 221160, "num_env_steps_trained": 221160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 184.00921116773455, "num_env_steps_trained_throughput_per_sec": 184.00921116773455, "timesteps_total": 221160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 221160, "timers": {"training_iteration_time_ms": 1953.699, "sample_time_ms": 1946.648, "load_time_ms": 0.235, "load_throughput": 1533722.133, "learn_time_ms": 6.247, "learn_throughput": 57631.438, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 221160, "num_env_steps_trained": 221160, "num_agent_steps_sampled": 221160, "num_agent_steps_trained": 221160}, "done": false, "episodes_total": 1095, "training_iteration": 207, "trial_id": "71c6f_00000", "date": "2023-08-04_10-15-36", "timestamp": 1691133336, "time_this_iter_s": 11.740526914596558, "time_total_s": 2267.669860124588, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 537.8391332626343, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 41.237500000000004, "ram_util_percent": 67.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4069580078125, "policy_loss": -4331124.334375, "vf_loss": 20747399.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1433.0, "diff_num_grad_updates_vs_sampler_policy": 1432.0}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.356617476889, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.374645626863081, "mean_inference_ms": 0.23984332152584073, "mean_action_processing_ms": 0.05781776380573703, "mean_env_wait_ms": 0.5955325328355212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002624034881591797, "StateBufferConnector_ms": 0.0017886161804199219, "ViewRequirementAgentConnector_ms": 0.04628705978393555}}, "episode_reward_max": -3525.5354456802843, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.356617476889, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.053585282844, -3526.2814327377396, -3527.9509741603138, -3526.7583636389286, -3526.6634531920963, -3525.5354456802843, -3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.374645626863081, "mean_inference_ms": 0.23984332152584073, "mean_action_processing_ms": 0.05781776380573703, "mean_env_wait_ms": 0.5955325328355212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002624034881591797, "StateBufferConnector_ms": 0.0017886161804199219, "ViewRequirementAgentConnector_ms": 0.04628705978393555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.17837854533468, "num_env_steps_trained_throughput_per_sec": 186.17837854533468, "timesteps_total": 223320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 1940.242, "sample_time_ms": 1932.741, "load_time_ms": 0.248, "load_throughput": 1450479.769, "learn_time_ms": 6.63, "learn_throughput": 54297.15, "synch_weights_time_ms": 0.585}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 1101, "training_iteration": 208, "trial_id": "71c6f_00000", "date": "2023-08-04_10-15-47", "timestamp": 1691133347, "time_this_iter_s": 11.603938102722168, "time_total_s": 2279.27379822731, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 549.4430713653564, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 38.75882352941176, "ram_util_percent": 67.17647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2986206054687, "policy_loss": -951901.78125, "vf_loss": 20753036.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 1462.0}}, "num_env_steps_sampled": 225480, "num_env_steps_trained": 225480, "num_agent_steps_sampled": 225480, "num_agent_steps_trained": 225480}, "sampler_results": {"episode_reward_max": -3525.63493246477, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.3713047697, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3765440623919005, "mean_inference_ms": 0.2400890525609349, "mean_action_processing_ms": 0.05785860972445242, "mean_env_wait_ms": 0.5953972624451743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026297569274902344, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.04612016677856445}}, "episode_reward_max": -3525.63493246477, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.3713047697, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.372276537343, -3527.954134383524, -3527.432177287294, -3527.886497468324, -3527.1918641939624, -3526.4942879863975, -3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3765440623919005, "mean_inference_ms": 0.2400890525609349, "mean_action_processing_ms": 0.05785860972445242, "mean_env_wait_ms": 0.5953972624451743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026297569274902344, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.04612016677856445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225480, "num_agent_steps_trained": 225480, "num_env_steps_sampled": 225480, "num_env_steps_trained": 225480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.5769865688153, "num_env_steps_trained_throughput_per_sec": 185.5769865688153, "timesteps_total": 225480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 225480, "timers": {"training_iteration_time_ms": 1942.897, "sample_time_ms": 1935.595, "load_time_ms": 0.235, "load_throughput": 1532943.594, "learn_time_ms": 6.461, "learn_throughput": 55718.103, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 225480, "num_env_steps_trained": 225480, "num_agent_steps_sampled": 225480, "num_agent_steps_trained": 225480}, "done": false, "episodes_total": 1107, "training_iteration": 209, "trial_id": "71c6f_00000", "date": "2023-08-04_10-15-59", "timestamp": 1691133359, "time_this_iter_s": 11.641515731811523, "time_total_s": 2290.9153139591217, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 561.084587097168, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 36.368750000000006, "ram_util_percent": 65.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4636169433594, "policy_loss": -2701190.1125, "vf_loss": 20766769.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1493.0, "diff_num_grad_updates_vs_sampler_policy": 1492.0}}, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "sampler_results": {"episode_reward_max": -3525.63493246477, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.355360396494, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.378393443750318, "mean_inference_ms": 0.24030360602093417, "mean_action_processing_ms": 0.05789419018966743, "mean_env_wait_ms": 0.5952197912530803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002617359161376953, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.04607796669006348}}, "episode_reward_max": -3525.63493246477, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.355360396494, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4949760763943, -3526.7558191657104, -3529.543334618402, -3527.0209936692736, -3528.0534578646066, -3526.258082376226, -3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.378393443750318, "mean_inference_ms": 0.24030360602093417, "mean_action_processing_ms": 0.05789419018966743, "mean_env_wait_ms": 0.5952197912530803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002617359161376953, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.04607796669006348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 183.27834643733098, "num_env_steps_trained_throughput_per_sec": 183.27834643733098, "timesteps_total": 227640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 227640, "timers": {"training_iteration_time_ms": 1957.086, "sample_time_ms": 1950.141, "load_time_ms": 0.222, "load_throughput": 1618207.523, "learn_time_ms": 6.168, "learn_throughput": 58361.173, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "done": false, "episodes_total": 1113, "training_iteration": 210, "trial_id": "71c6f_00000", "date": "2023-08-04_10-16-11", "timestamp": 1691133371, "time_this_iter_s": 11.787552118301392, "time_total_s": 2302.702866077423, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 572.8721392154694, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 26.388235294117646, "ram_util_percent": 65.56470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.23240356445314, "policy_loss": -352134.753125, "vf_loss": 20737621.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1523.0, "diff_num_grad_updates_vs_sampler_policy": 1522.0}}, "num_env_steps_sampled": 229800, "num_env_steps_trained": 229800, "num_agent_steps_sampled": 229800, "num_agent_steps_trained": 229800}, "sampler_results": {"episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2969554568926, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.380102040156458, "mean_inference_ms": 0.2404970277925142, "mean_action_processing_ms": 0.0579258200327772, "mean_env_wait_ms": 0.5950071436872013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025963783264160156, "StateBufferConnector_ms": 0.001802682876586914, "ViewRequirementAgentConnector_ms": 0.04589080810546875}}, "episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2969554568926, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.311966432236, -3526.641781198908, -3529.8625700390908, -3527.6570426867456, -3527.378125277943, -3526.8517292955107, -3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.380102040156458, "mean_inference_ms": 0.2404970277925142, "mean_action_processing_ms": 0.0579258200327772, "mean_env_wait_ms": 0.5950071436872013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025963783264160156, "StateBufferConnector_ms": 0.001802682876586914, "ViewRequirementAgentConnector_ms": 0.04589080810546875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229800, "num_agent_steps_trained": 229800, "num_env_steps_sampled": 229800, "num_env_steps_trained": 229800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 183.8694539990307, "num_env_steps_trained_throughput_per_sec": 183.8694539990307, "timesteps_total": 229800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 229800, "timers": {"training_iteration_time_ms": 1956.018, "sample_time_ms": 1948.981, "load_time_ms": 0.226, "load_throughput": 1591598.44, "learn_time_ms": 6.254, "learn_throughput": 57562.671, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 229800, "num_env_steps_trained": 229800, "num_agent_steps_sampled": 229800, "num_agent_steps_trained": 229800}, "done": false, "episodes_total": 1119, "training_iteration": 211, "trial_id": "71c6f_00000", "date": "2023-08-04_10-16-23", "timestamp": 1691133383, "time_this_iter_s": 11.749541282653809, "time_total_s": 2314.452407360077, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 584.6216804981232, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 28.099999999999994, "ram_util_percent": 65.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.39921875, "policy_loss": -10717255.7625, "vf_loss": 20744395.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 1552.0}}, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "sampler_results": {"episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2689946216306, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3817895743271125, "mean_inference_ms": 0.24068153002070083, "mean_action_processing_ms": 0.05795593768169427, "mean_env_wait_ms": 0.5947928669108637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002599477767944336, "StateBufferConnector_ms": 0.0018031597137451172, "ViewRequirementAgentConnector_ms": 0.04604196548461914}}, "episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.2689946216306, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3398890073677, -3526.842699947875, -3527.597046587022, -3526.571449686761, -3528.134478280635, -3526.0644013814117, -3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3817895743271125, "mean_inference_ms": 0.24068153002070083, "mean_action_processing_ms": 0.05795593768169427, "mean_env_wait_ms": 0.5947928669108637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002599477767944336, "StateBufferConnector_ms": 0.0018031597137451172, "ViewRequirementAgentConnector_ms": 0.04604196548461914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 182.48583763784035, "num_env_steps_trained_throughput_per_sec": 182.48583763784035, "timesteps_total": 231960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 231960, "timers": {"training_iteration_time_ms": 1967.217, "sample_time_ms": 1960.03, "load_time_ms": 0.227, "load_throughput": 1585914.757, "learn_time_ms": 6.364, "learn_throughput": 56569.363, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "done": false, "episodes_total": 1125, "training_iteration": 212, "trial_id": "71c6f_00000", "date": "2023-08-04_10-16-34", "timestamp": 1691133394, "time_this_iter_s": 11.838742733001709, "time_total_s": 2326.2911500930786, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 596.4604232311249, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.762500000000003, "ram_util_percent": 65.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.31806640625, "policy_loss": 56200.25, "vf_loss": 20747832.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1583.0, "diff_num_grad_updates_vs_sampler_policy": 1582.0}}, "num_env_steps_sampled": 234120, "num_env_steps_trained": 234120, "num_agent_steps_sampled": 234120, "num_agent_steps_trained": 234120}, "sampler_results": {"episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.3720920666524, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.383503375117569, "mean_inference_ms": 0.2408557492174992, "mean_action_processing_ms": 0.057984988192314166, "mean_env_wait_ms": 0.5945792712097728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025861263275146484, "StateBufferConnector_ms": 0.0017995834350585938, "ViewRequirementAgentConnector_ms": 0.0458827018737793}}, "episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.3720920666524, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.5626511893965, -3525.63493246477, -3527.807933034195, -3526.030161941002, -3526.7870481692853, -3526.66215805727, -3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.383503375117569, "mean_inference_ms": 0.2408557492174992, "mean_action_processing_ms": 0.057984988192314166, "mean_env_wait_ms": 0.5945792712097728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025861263275146484, "StateBufferConnector_ms": 0.0017995834350585938, "ViewRequirementAgentConnector_ms": 0.0458827018737793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234120, "num_agent_steps_trained": 234120, "num_env_steps_sampled": 234120, "num_env_steps_trained": 234120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.07417576008484, "num_env_steps_trained_throughput_per_sec": 185.07417576008484, "timesteps_total": 234120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 234120, "timers": {"training_iteration_time_ms": 1956.757, "sample_time_ms": 1949.689, "load_time_ms": 0.22, "load_throughput": 1633260.617, "learn_time_ms": 6.286, "learn_throughput": 57269.679, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 234120, "num_env_steps_trained": 234120, "num_agent_steps_sampled": 234120, "num_agent_steps_trained": 234120}, "done": false, "episodes_total": 1131, "training_iteration": 213, "trial_id": "71c6f_00000", "date": "2023-08-04_10-16-46", "timestamp": 1691133406, "time_this_iter_s": 11.673115015029907, "time_total_s": 2337.9642651081085, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 608.1335382461548, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 26.082352941176474, "ram_util_percent": 65.52352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.228076171875, "policy_loss": 303598.9875, "vf_loss": 20731934.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1613.0, "diff_num_grad_updates_vs_sampler_policy": 1612.0}}, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "sampler_results": {"episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.3694207568306, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.385161204789691, "mean_inference_ms": 0.24101729769061925, "mean_action_processing_ms": 0.05801179011401079, "mean_env_wait_ms": 0.5943631358278273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002585887908935547, "StateBufferConnector_ms": 0.0018079280853271484, "ViewRequirementAgentConnector_ms": 0.04596900939941406}}, "episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.3694207568306, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.287078342551, -3527.2110427403136, -3527.0953596416066, -3526.7165249713366, -3526.9660178963018, -3528.061631578294, -3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.385161204789691, "mean_inference_ms": 0.24101729769061925, "mean_action_processing_ms": 0.05801179011401079, "mean_env_wait_ms": 0.5943631358278273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002585887908935547, "StateBufferConnector_ms": 0.0018079280853271484, "ViewRequirementAgentConnector_ms": 0.04596900939941406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.67980639790426, "num_env_steps_trained_throughput_per_sec": 186.67980639790426, "timesteps_total": 236280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 236280, "timers": {"training_iteration_time_ms": 1934.875, "sample_time_ms": 1927.975, "load_time_ms": 0.216, "load_throughput": 1663306.279, "learn_time_ms": 6.153, "learn_throughput": 58509.978, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "done": false, "episodes_total": 1137, "training_iteration": 214, "trial_id": "71c6f_00000", "date": "2023-08-04_10-16-58", "timestamp": 1691133418, "time_this_iter_s": 11.572723150253296, "time_total_s": 2349.536988258362, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 619.7062613964081, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.237499999999997, "ram_util_percent": 65.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3593505859375, "policy_loss": -898786.7625, "vf_loss": 20756908.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 1642.0}}, "num_env_steps_sampled": 238440, "num_env_steps_trained": 238440, "num_agent_steps_sampled": 238440, "num_agent_steps_trained": 238440}, "sampler_results": {"episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.3709985262244, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.386742967841318, "mean_inference_ms": 0.24117686669746274, "mean_action_processing_ms": 0.05803872727666692, "mean_env_wait_ms": 0.5941916308758559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025870800018310547, "StateBufferConnector_ms": 0.0018167495727539062, "ViewRequirementAgentConnector_ms": 0.046059370040893555}}, "episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.8959288839806, "episode_reward_mean": -3527.3709985262244, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.1661649663715, -3527.6703343497848, -3528.2440855073733, -3533.8959288839806, -3527.237101066366, -3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.386742967841318, "mean_inference_ms": 0.24117686669746274, "mean_action_processing_ms": 0.05803872727666692, "mean_env_wait_ms": 0.5941916308758559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025870800018310547, "StateBufferConnector_ms": 0.0018167495727539062, "ViewRequirementAgentConnector_ms": 0.046059370040893555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238440, "num_agent_steps_trained": 238440, "num_env_steps_sampled": 238440, "num_env_steps_trained": 238440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.87109641727415, "num_env_steps_trained_throughput_per_sec": 185.87109641727415, "timesteps_total": 238440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 238440, "timers": {"training_iteration_time_ms": 1932.941, "sample_time_ms": 1925.793, "load_time_ms": 0.218, "load_throughput": 1649857.343, "learn_time_ms": 6.34, "learn_throughput": 56782.948, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 238440, "num_env_steps_trained": 238440, "num_agent_steps_sampled": 238440, "num_agent_steps_trained": 238440}, "done": false, "episodes_total": 1143, "training_iteration": 215, "trial_id": "71c6f_00000", "date": "2023-08-04_10-17-09", "timestamp": 1691133429, "time_this_iter_s": 11.623025894165039, "time_total_s": 2361.160014152527, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 631.3292872905731, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 27.25294117647059, "ram_util_percent": 65.66470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3342590332031, "policy_loss": -933754.08125, "vf_loss": 20745349.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1668.0, "diff_num_grad_updates_vs_sampler_policy": 1667.0}}, "num_env_steps_sampled": 240240, "num_env_steps_trained": 240240, "num_agent_steps_sampled": 240240, "num_agent_steps_trained": 240240}, "sampler_results": {"episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.272947074212, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.388281749505157, "mean_inference_ms": 0.2413366616457213, "mean_action_processing_ms": 0.05806844906332564, "mean_env_wait_ms": 0.5941114184500803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00260162353515625, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.04632139205932617}}, "episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.272947074212, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.92058266636, -3526.766247673725, -3525.70261234972, -3527.365172915694, -3527.072873247531, -3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.388281749505157, "mean_inference_ms": 0.2413366616457213, "mean_action_processing_ms": 0.05806844906332564, "mean_env_wait_ms": 0.5941114184500803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00260162353515625, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.04632139205932617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240240, "num_agent_steps_trained": 240240, "num_env_steps_sampled": 240240, "num_env_steps_trained": 240240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.4041814551971, "num_env_steps_trained_throughput_per_sec": 172.4041814551971, "timesteps_total": 240240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 240240, "timers": {"training_iteration_time_ms": 2015.334, "sample_time_ms": 2007.649, "load_time_ms": 0.233, "load_throughput": 1545970.554, "learn_time_ms": 6.841, "learn_throughput": 52624.131, "synch_weights_time_ms": 0.575}, "counters": {"num_env_steps_sampled": 240240, "num_env_steps_trained": 240240, "num_agent_steps_sampled": 240240, "num_agent_steps_trained": 240240}, "done": false, "episodes_total": 1148, "training_iteration": 216, "trial_id": "71c6f_00000", "date": "2023-08-04_10-17-20", "timestamp": 1691133440, "time_this_iter_s": 10.443105936050415, "time_total_s": 2371.6031200885773, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 641.7723932266235, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 30.353333333333335, "ram_util_percent": 65.71333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.31659545898435, "policy_loss": -2732438.0125, "vf_loss": 20737628.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1693.0, "diff_num_grad_updates_vs_sampler_policy": 1692.0}}, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "sampler_results": {"episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.3108394676424, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3901348637425315, "mean_inference_ms": 0.2415017662081806, "mean_action_processing_ms": 0.05810090224513763, "mean_env_wait_ms": 0.5940740087677499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026030540466308594, "StateBufferConnector_ms": 0.0018360614776611328, "ViewRequirementAgentConnector_ms": 0.04642820358276367}}, "episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.3108394676424, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5916165957174, -3527.9878828797277, -3526.8530282298825, -3526.35310828955, -3528.5391914915176, -3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3901348637425315, "mean_inference_ms": 0.2415017662081806, "mean_action_processing_ms": 0.05810090224513763, "mean_env_wait_ms": 0.5940740087677499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026030540466308594, "StateBufferConnector_ms": 0.0018360614776611328, "ViewRequirementAgentConnector_ms": 0.04642820358276367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.24039221813453, "num_env_steps_trained_throughput_per_sec": 170.24039221813453, "timesteps_total": 242040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 242040, "timers": {"training_iteration_time_ms": 2101.375, "sample_time_ms": 2093.325, "load_time_ms": 0.241, "load_throughput": 1495147.48, "learn_time_ms": 7.179, "learn_throughput": 50146.774, "synch_weights_time_ms": 0.592}, "counters": {"num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "done": false, "episodes_total": 1153, "training_iteration": 217, "trial_id": "71c6f_00000", "date": "2023-08-04_10-17-30", "timestamp": 1691133450, "time_this_iter_s": 10.575332880020142, "time_total_s": 2382.1784529685974, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 652.3477261066437, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.493333333333336, "ram_util_percent": 65.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.48997802734374, "policy_loss": -6214943.39375, "vf_loss": 20759938.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1718.0, "diff_num_grad_updates_vs_sampler_policy": 1717.0}}, "num_env_steps_sampled": 243840, "num_env_steps_trained": 243840, "num_agent_steps_sampled": 243840, "num_agent_steps_trained": 243840}, "sampler_results": {"episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.3168405999827, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.392248679814198, "mean_inference_ms": 0.24167546337858603, "mean_action_processing_ms": 0.05813737646404845, "mean_env_wait_ms": 0.5940555538106881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026137828826904297, "StateBufferConnector_ms": 0.001842498779296875, "ViewRequirementAgentConnector_ms": 0.04654526710510254}}, "episode_reward_max": -3525.6331743306996, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.3168405999827, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.303227191078, -3527.5493956234686, -3527.076512652505, -3527.194587497107, -3527.3522071448538, -3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.392248679814198, "mean_inference_ms": 0.24167546337858603, "mean_action_processing_ms": 0.05813737646404845, "mean_env_wait_ms": 0.5940555538106881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026137828826904297, "StateBufferConnector_ms": 0.001842498779296875, "ViewRequirementAgentConnector_ms": 0.04654526710510254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243840, "num_agent_steps_trained": 243840, "num_env_steps_sampled": 243840, "num_env_steps_trained": 243840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 169.6657313614324, "num_env_steps_trained_throughput_per_sec": 169.6657313614324, "timesteps_total": 243840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 243840, "timers": {"training_iteration_time_ms": 2118.227, "sample_time_ms": 2110.055, "load_time_ms": 0.242, "load_throughput": 1490277.773, "learn_time_ms": 7.299, "learn_throughput": 49324.121, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 243840, "num_env_steps_trained": 243840, "num_agent_steps_sampled": 243840, "num_agent_steps_trained": 243840}, "done": false, "episodes_total": 1158, "training_iteration": 218, "trial_id": "71c6f_00000", "date": "2023-08-04_10-17-41", "timestamp": 1691133461, "time_this_iter_s": 10.611425161361694, "time_total_s": 2392.789878129959, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 662.9591512680054, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 26.246666666666666, "ram_util_percent": 65.79333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3958435058594, "policy_loss": -3842058.03125, "vf_loss": 20745184.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1743.0, "diff_num_grad_updates_vs_sampler_policy": 1742.0}}, "num_env_steps_sampled": 245640, "num_env_steps_trained": 245640, "num_agent_steps_sampled": 245640, "num_agent_steps_trained": 245640}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.2758793160033, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.39493625803272, "mean_inference_ms": 0.2418680717592452, "mean_action_processing_ms": 0.05817939359151982, "mean_env_wait_ms": 0.5940722666408113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026230812072753906, "StateBufferConnector_ms": 0.0018558502197265625, "ViewRequirementAgentConnector_ms": 0.04677009582519531}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.2758793160033, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.816369107555, -3526.5303377997598, -3527.1919397163406, -3527.184346753136, -3526.3476379157905, -3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.39493625803272, "mean_inference_ms": 0.2418680717592452, "mean_action_processing_ms": 0.05817939359151982, "mean_env_wait_ms": 0.5940722666408113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026230812072753906, "StateBufferConnector_ms": 0.0018558502197265625, "ViewRequirementAgentConnector_ms": 0.04677009582519531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245640, "num_agent_steps_trained": 245640, "num_env_steps_sampled": 245640, "num_env_steps_trained": 245640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.2754300387548, "num_env_steps_trained_throughput_per_sec": 157.2754300387548, "timesteps_total": 245640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 245640, "timers": {"training_iteration_time_ms": 2205.387, "sample_time_ms": 2197.198, "load_time_ms": 0.249, "load_throughput": 1443408.317, "learn_time_ms": 7.321, "learn_throughput": 49171.047, "synch_weights_time_ms": 0.581}, "counters": {"num_env_steps_sampled": 245640, "num_env_steps_trained": 245640, "num_agent_steps_sampled": 245640, "num_agent_steps_trained": 245640}, "done": false, "episodes_total": 1163, "training_iteration": 219, "trial_id": "71c6f_00000", "date": "2023-08-04_10-17-52", "timestamp": 1691133472, "time_this_iter_s": 11.447220087051392, "time_total_s": 2404.2370982170105, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 674.4063713550568, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 30.9, "ram_util_percent": 65.93125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.42152099609376, "policy_loss": -1696805.575, "vf_loss": 20750204.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1768.0, "diff_num_grad_updates_vs_sampler_policy": 1767.0}}, "num_env_steps_sampled": 247440, "num_env_steps_trained": 247440, "num_agent_steps_sampled": 247440, "num_agent_steps_trained": 247440}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.3185218867225, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.398024485524427, "mean_inference_ms": 0.24208287914823845, "mean_action_processing_ms": 0.05822763342495294, "mean_env_wait_ms": 0.5941360003495371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002628803253173828, "StateBufferConnector_ms": 0.0018601417541503906, "ViewRequirementAgentConnector_ms": 0.046953439712524414}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.3185218867225, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.623850403742, -3527.373027754281, -3533.528987683064, -3527.3212752877907, -3527.6039773577977, -3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.398024485524427, "mean_inference_ms": 0.24208287914823845, "mean_action_processing_ms": 0.05822763342495294, "mean_env_wait_ms": 0.5941360003495371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002628803253173828, "StateBufferConnector_ms": 0.0018601417541503906, "ViewRequirementAgentConnector_ms": 0.046953439712524414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247440, "num_agent_steps_trained": 247440, "num_env_steps_sampled": 247440, "num_env_steps_trained": 247440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.16493694155605, "num_env_steps_trained_throughput_per_sec": 163.16493694155605, "timesteps_total": 247440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 247440, "timers": {"training_iteration_time_ms": 2247.656, "sample_time_ms": 2239.543, "load_time_ms": 0.248, "load_throughput": 1449087.754, "learn_time_ms": 7.241, "learn_throughput": 49719.109, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 247440, "num_env_steps_trained": 247440, "num_agent_steps_sampled": 247440, "num_agent_steps_trained": 247440}, "done": false, "episodes_total": 1168, "training_iteration": 220, "trial_id": "71c6f_00000", "date": "2023-08-04_10-18-03", "timestamp": 1691133483, "time_this_iter_s": 11.033929109573364, "time_total_s": 2415.271027326584, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 685.4403004646301, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 27.25333333333333, "ram_util_percent": 66.38666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.451708984375, "policy_loss": -8970945.90625, "vf_loss": 20746181.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1793.0, "diff_num_grad_updates_vs_sampler_policy": 1792.0}}, "num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.2426057125176, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401565892971283, "mean_inference_ms": 0.24232007651390539, "mean_action_processing_ms": 0.058282097645876885, "mean_env_wait_ms": 0.5942501742058063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002651214599609375, "StateBufferConnector_ms": 0.0018720626831054688, "ViewRequirementAgentConnector_ms": 0.047225236892700195}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.2426057125176, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.5420792129516, -3527.5532587396897, -3528.4721924990636, -3527.739816147265, -3526.5256089719687, -3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.401565892971283, "mean_inference_ms": 0.24232007651390539, "mean_action_processing_ms": 0.058282097645876885, "mean_env_wait_ms": 0.5942501742058063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002651214599609375, "StateBufferConnector_ms": 0.0018720626831054688, "ViewRequirementAgentConnector_ms": 0.047225236892700195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240, "num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.8058881207222, "num_env_steps_trained_throughput_per_sec": 160.8058881207222, "timesteps_total": 249240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 249240, "timers": {"training_iteration_time_ms": 2222.528, "sample_time_ms": 2214.114, "load_time_ms": 0.249, "load_throughput": 1445896.237, "learn_time_ms": 7.511, "learn_throughput": 47930.642, "synch_weights_time_ms": 0.617}, "counters": {"num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240}, "done": false, "episodes_total": 1173, "training_iteration": 221, "trial_id": "71c6f_00000", "date": "2023-08-04_10-18-15", "timestamp": 1691133495, "time_this_iter_s": 11.19638466835022, "time_total_s": 2426.467411994934, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 696.6366851329803, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.4125, "ram_util_percent": 66.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.47600708007815, "policy_loss": -2683831.671875, "vf_loss": 20746879.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1818.0, "diff_num_grad_updates_vs_sampler_policy": 1817.0}}, "num_env_steps_sampled": 251040, "num_env_steps_trained": 251040, "num_agent_steps_sampled": 251040, "num_agent_steps_trained": 251040}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.2566267739817, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405315144217554, "mean_inference_ms": 0.24257420234376526, "mean_action_processing_ms": 0.058341662724069716, "mean_env_wait_ms": 0.5944213343622449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026388168334960938, "StateBufferConnector_ms": 0.0018780231475830078, "ViewRequirementAgentConnector_ms": 0.04719138145446777}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.2566267739817, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.209763642591, -3526.5815918801954, -3526.25360618273, -3526.614970149587, -3527.195816504228, -3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.405315144217554, "mean_inference_ms": 0.24257420234376526, "mean_action_processing_ms": 0.058341662724069716, "mean_env_wait_ms": 0.5944213343622449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026388168334960938, "StateBufferConnector_ms": 0.0018780231475830078, "ViewRequirementAgentConnector_ms": 0.04719138145446777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251040, "num_agent_steps_trained": 251040, "num_env_steps_sampled": 251040, "num_env_steps_trained": 251040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.61934954200618, "num_env_steps_trained_throughput_per_sec": 170.61934954200618, "timesteps_total": 251040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 251040, "timers": {"training_iteration_time_ms": 2174.33, "sample_time_ms": 2166.19, "load_time_ms": 0.243, "load_throughput": 1478892.693, "learn_time_ms": 7.273, "learn_throughput": 49499.236, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 251040, "num_env_steps_trained": 251040, "num_agent_steps_sampled": 251040, "num_agent_steps_trained": 251040}, "done": false, "episodes_total": 1178, "training_iteration": 222, "trial_id": "71c6f_00000", "date": "2023-08-04_10-18-25", "timestamp": 1691133505, "time_this_iter_s": 10.551977157592773, "time_total_s": 2437.019389152527, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 707.1886622905731, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 24.566666666666663, "ram_util_percent": 66.67333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.27556762695315, "policy_loss": -1126517.8875, "vf_loss": 20732690.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1843.0, "diff_num_grad_updates_vs_sampler_policy": 1842.0}}, "num_env_steps_sampled": 252840, "num_env_steps_trained": 252840, "num_agent_steps_sampled": 252840, "num_agent_steps_trained": 252840}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.2718856370625, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409224578571493, "mean_inference_ms": 0.24282070070944406, "mean_action_processing_ms": 0.05840047443906045, "mean_env_wait_ms": 0.5946051902089772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002637147903442383, "StateBufferConnector_ms": 0.0018925666809082031, "ViewRequirementAgentConnector_ms": 0.04727005958557129}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.2718856370625, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.658409382207, -3526.222813851726, -3526.6226084580067, -3526.149528607802, -3527.3401433859476, -3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409224578571493, "mean_inference_ms": 0.24282070070944406, "mean_action_processing_ms": 0.05840047443906045, "mean_env_wait_ms": 0.5946051902089772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002637147903442383, "StateBufferConnector_ms": 0.0018925666809082031, "ViewRequirementAgentConnector_ms": 0.04727005958557129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252840, "num_agent_steps_trained": 252840, "num_env_steps_sampled": 252840, "num_env_steps_trained": 252840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.53428090118194, "num_env_steps_trained_throughput_per_sec": 177.53428090118194, "timesteps_total": 252840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 252840, "timers": {"training_iteration_time_ms": 2068.858, "sample_time_ms": 2061.397, "load_time_ms": 0.233, "load_throughput": 1544863.352, "learn_time_ms": 6.654, "learn_throughput": 54099.11, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 252840, "num_env_steps_trained": 252840, "num_agent_steps_sampled": 252840, "num_agent_steps_trained": 252840}, "done": false, "episodes_total": 1183, "training_iteration": 223, "trial_id": "71c6f_00000", "date": "2023-08-04_10-18-35", "timestamp": 1691133515, "time_this_iter_s": 10.141144037246704, "time_total_s": 2447.1605331897736, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 717.3298063278198, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 22.9, "ram_util_percent": 66.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3485900878906, "policy_loss": -4050373.646875, "vf_loss": 20745589.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1868.0, "diff_num_grad_updates_vs_sampler_policy": 1867.0}}, "num_env_steps_sampled": 254640, "num_env_steps_trained": 254640, "num_agent_steps_sampled": 254640, "num_agent_steps_trained": 254640}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.265247472142, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413454227473564, "mean_inference_ms": 0.24306101659848664, "mean_action_processing_ms": 0.05845936311803799, "mean_env_wait_ms": 0.5947927010944142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002636432647705078, "StateBufferConnector_ms": 0.001890420913696289, "ViewRequirementAgentConnector_ms": 0.04728269577026367}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.265247472142, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.9879480580526, -3527.333806779054, -3527.967989907119, -3527.350690442478, -3527.8815928489757, -3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413454227473564, "mean_inference_ms": 0.24306101659848664, "mean_action_processing_ms": 0.05845936311803799, "mean_env_wait_ms": 0.5947927010944142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002636432647705078, "StateBufferConnector_ms": 0.001890420913696289, "ViewRequirementAgentConnector_ms": 0.04728269577026367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254640, "num_agent_steps_trained": 254640, "num_env_steps_sampled": 254640, "num_env_steps_trained": 254640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 164.41251090875429, "num_env_steps_trained_throughput_per_sec": 164.41251090875429, "timesteps_total": 254640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 254640, "timers": {"training_iteration_time_ms": 2108.685, "sample_time_ms": 2101.017, "load_time_ms": 0.237, "load_throughput": 1520899.919, "learn_time_ms": 6.834, "learn_throughput": 52679.025, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 254640, "num_env_steps_trained": 254640, "num_agent_steps_sampled": 254640, "num_agent_steps_trained": 254640}, "done": false, "episodes_total": 1188, "training_iteration": 224, "trial_id": "71c6f_00000", "date": "2023-08-04_10-18-46", "timestamp": 1691133526, "time_this_iter_s": 10.950304985046387, "time_total_s": 2458.11083817482, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 728.2801113128662, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 26.813333333333336, "ram_util_percent": 66.23999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.52955322265626, "policy_loss": -5440421.86875, "vf_loss": 20752747.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1893.0, "diff_num_grad_updates_vs_sampler_policy": 1892.0}}, "num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.328480731798, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417917816315423, "mean_inference_ms": 0.24332585298447057, "mean_action_processing_ms": 0.05852482990990723, "mean_env_wait_ms": 0.5950512389337145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002643108367919922, "StateBufferConnector_ms": 0.0018982887268066406, "ViewRequirementAgentConnector_ms": 0.04747962951660156}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.863178487299, "episode_reward_mean": -3527.328480731798, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5202842682893, -3533.863178487299, -3527.4802934466015, -3526.4535003741616, -3528.03967633158, -3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417917816315423, "mean_inference_ms": 0.24332585298447057, "mean_action_processing_ms": 0.05852482990990723, "mean_env_wait_ms": 0.5950512389337145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002643108367919922, "StateBufferConnector_ms": 0.0018982887268066406, "ViewRequirementAgentConnector_ms": 0.04747962951660156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440, "num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 164.46986819836593, "num_env_steps_trained_throughput_per_sec": 164.46986819836593, "timesteps_total": 256440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 256440, "timers": {"training_iteration_time_ms": 2189.221, "sample_time_ms": 2180.985, "load_time_ms": 0.244, "load_throughput": 1477879.456, "learn_time_ms": 7.37, "learn_throughput": 48849.711, "synch_weights_time_ms": 0.586}, "counters": {"num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440}, "done": false, "episodes_total": 1193, "training_iteration": 225, "trial_id": "71c6f_00000", "date": "2023-08-04_10-18-57", "timestamp": 1691133537, "time_this_iter_s": 10.946211099624634, "time_total_s": 2469.0570492744446, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 739.2263224124908, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 27.21875, "ram_util_percent": 66.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.29523315429685, "policy_loss": -3749668.84375, "vf_loss": 20746136.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1918.0, "diff_num_grad_updates_vs_sampler_policy": 1917.0}}, "num_env_steps_sampled": 258240, "num_env_steps_trained": 258240, "num_agent_steps_sampled": 258240, "num_agent_steps_trained": 258240}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.284716898817, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422949253082529, "mean_inference_ms": 0.24361750287995976, "mean_action_processing_ms": 0.058597734897664934, "mean_env_wait_ms": 0.5953722685004263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026624202728271484, "StateBufferConnector_ms": 0.0019183158874511719, "ViewRequirementAgentConnector_ms": 0.04787302017211914}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.284716898817, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.696929926373, -3526.541884819041, -3527.721277214811, -3527.678357928454, -3527.268942265654, -3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422949253082529, "mean_inference_ms": 0.24361750287995976, "mean_action_processing_ms": 0.058597734897664934, "mean_env_wait_ms": 0.5953722685004263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026624202728271484, "StateBufferConnector_ms": 0.0019183158874511719, "ViewRequirementAgentConnector_ms": 0.04787302017211914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258240, "num_agent_steps_trained": 258240, "num_env_steps_sampled": 258240, "num_env_steps_trained": 258240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 152.96807925430124, "num_env_steps_trained_throughput_per_sec": 152.96807925430124, "timesteps_total": 258240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 258240, "timers": {"training_iteration_time_ms": 2271.129, "sample_time_ms": 2262.243, "load_time_ms": 0.256, "load_throughput": 1406304.778, "learn_time_ms": 7.987, "learn_throughput": 45071.234, "synch_weights_time_ms": 0.605}, "counters": {"num_env_steps_sampled": 258240, "num_env_steps_trained": 258240, "num_agent_steps_sampled": 258240, "num_agent_steps_trained": 258240}, "done": false, "episodes_total": 1198, "training_iteration": 226, "trial_id": "71c6f_00000", "date": "2023-08-04_10-19-09", "timestamp": 1691133549, "time_this_iter_s": 11.769406080245972, "time_total_s": 2480.8264553546906, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 750.9957284927368, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 42.0, "ram_util_percent": 66.56875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4222778320312, "policy_loss": -7641358.115625, "vf_loss": 20739768.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1943.0, "diff_num_grad_updates_vs_sampler_policy": 1942.0}}, "num_env_steps_sampled": 260040, "num_env_steps_trained": 260040, "num_agent_steps_sampled": 260040, "num_agent_steps_trained": 260040}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.267758316251, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42841425761328, "mean_inference_ms": 0.24392658080463164, "mean_action_processing_ms": 0.05867573669480953, "mean_env_wait_ms": 0.5957396698824062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00269317626953125, "StateBufferConnector_ms": 0.0019376277923583984, "ViewRequirementAgentConnector_ms": 0.04827713966369629}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.267758316251, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.7147648153536, -3526.2129912676874, -3526.2611218787974, -3527.5758058173747, -3527.6579729322216, -3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42841425761328, "mean_inference_ms": 0.24392658080463164, "mean_action_processing_ms": 0.05867573669480953, "mean_env_wait_ms": 0.5957396698824062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00269317626953125, "StateBufferConnector_ms": 0.0019376277923583984, "ViewRequirementAgentConnector_ms": 0.04827713966369629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260040, "num_agent_steps_trained": 260040, "num_env_steps_sampled": 260040, "num_env_steps_trained": 260040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.79923732587685, "num_env_steps_trained_throughput_per_sec": 158.79923732587685, "timesteps_total": 260040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 260040, "timers": {"training_iteration_time_ms": 2310.211, "sample_time_ms": 2301.418, "load_time_ms": 0.255, "load_throughput": 1414340.052, "learn_time_ms": 7.889, "learn_throughput": 45634.904, "synch_weights_time_ms": 0.612}, "counters": {"num_env_steps_sampled": 260040, "num_env_steps_trained": 260040, "num_agent_steps_sampled": 260040, "num_agent_steps_trained": 260040}, "done": false, "episodes_total": 1203, "training_iteration": 227, "trial_id": "71c6f_00000", "date": "2023-08-04_10-19-20", "timestamp": 1691133560, "time_this_iter_s": 11.33741283416748, "time_total_s": 2492.163868188858, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 762.3331413269043, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.264705882352946, "ram_util_percent": 66.4764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3464660644531, "policy_loss": -1720664.38125, "vf_loss": 20756859.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1968.0, "diff_num_grad_updates_vs_sampler_policy": 1967.0}}, "num_env_steps_sampled": 261840, "num_env_steps_trained": 261840, "num_agent_steps_sampled": 261840, "num_agent_steps_trained": 261840}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.283130604771, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.434327429819295, "mean_inference_ms": 0.2442585268870514, "mean_action_processing_ms": 0.058760076403856186, "mean_env_wait_ms": 0.5961603332457922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027081966400146484, "StateBufferConnector_ms": 0.0019495487213134766, "ViewRequirementAgentConnector_ms": 0.04870343208312988}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.283130604771, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6455370295016, -3526.3044798196993, -3526.7888431251504, -3528.08301411042, -3528.2569535192897, -3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.434327429819295, "mean_inference_ms": 0.2442585268870514, "mean_action_processing_ms": 0.058760076403856186, "mean_env_wait_ms": 0.5961603332457922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027081966400146484, "StateBufferConnector_ms": 0.0019495487213134766, "ViewRequirementAgentConnector_ms": 0.04870343208312988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261840, "num_agent_steps_trained": 261840, "num_env_steps_sampled": 261840, "num_env_steps_trained": 261840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 156.30804838664196, "num_env_steps_trained_throughput_per_sec": 156.30804838664196, "timesteps_total": 261840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 261840, "timers": {"training_iteration_time_ms": 2285.068, "sample_time_ms": 2276.769, "load_time_ms": 0.246, "load_throughput": 1461854.429, "learn_time_ms": 7.408, "learn_throughput": 48595.649, "synch_weights_time_ms": 0.607}, "counters": {"num_env_steps_sampled": 261840, "num_env_steps_trained": 261840, "num_agent_steps_sampled": 261840, "num_agent_steps_trained": 261840}, "done": false, "episodes_total": 1208, "training_iteration": 228, "trial_id": "71c6f_00000", "date": "2023-08-04_10-19-32", "timestamp": 1691133572, "time_this_iter_s": 11.518346071243286, "time_total_s": 2503.6822142601013, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 773.8514873981476, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 29.5125, "ram_util_percent": 66.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3315673828125, "policy_loss": -4712465.028125, "vf_loss": 20734430.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1993.0, "diff_num_grad_updates_vs_sampler_policy": 1992.0}}, "num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640}, "sampler_results": {"episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.280152049548, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4404492434903, "mean_inference_ms": 0.24459768697243522, "mean_action_processing_ms": 0.05884696593169433, "mean_env_wait_ms": 0.5966018089705171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027217864990234375, "StateBufferConnector_ms": 0.0019524097442626953, "ViewRequirementAgentConnector_ms": 0.048802852630615234}}, "episode_reward_max": -3525.6330377754603, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.280152049548, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.5465572396897, -3527.2558813301966, -3526.18852368549, -3525.6331743306996, -3526.395726510547, -3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4404492434903, "mean_inference_ms": 0.24459768697243522, "mean_action_processing_ms": 0.05884696593169433, "mean_env_wait_ms": 0.5966018089705171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027217864990234375, "StateBufferConnector_ms": 0.0019524097442626953, "ViewRequirementAgentConnector_ms": 0.048802852630615234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640, "num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 166.1821110963511, "num_env_steps_trained_throughput_per_sec": 166.1821110963511, "timesteps_total": 263640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 263640, "timers": {"training_iteration_time_ms": 2234.71, "sample_time_ms": 2226.372, "load_time_ms": 0.247, "load_throughput": 1455653.562, "learn_time_ms": 7.453, "learn_throughput": 48301.844, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640}, "done": false, "episodes_total": 1213, "training_iteration": 229, "trial_id": "71c6f_00000", "date": "2023-08-04_10-19-43", "timestamp": 1691133583, "time_this_iter_s": 10.834056854248047, "time_total_s": 2514.5162711143494, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 784.6855442523956, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 26.84, "ram_util_percent": 66.37333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.40321044921876, "policy_loss": -5064024.55, "vf_loss": 20752163.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2018.0, "diff_num_grad_updates_vs_sampler_policy": 2017.0}}, "num_env_steps_sampled": 265440, "num_env_steps_trained": 265440, "num_agent_steps_sampled": 265440, "num_agent_steps_trained": 265440}, "sampler_results": {"episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.2910337468848, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.446862596414577, "mean_inference_ms": 0.24496173844289656, "mean_action_processing_ms": 0.058940710265312946, "mean_env_wait_ms": 0.5971063870766595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027313232421875, "StateBufferConnector_ms": 0.001959085464477539, "ViewRequirementAgentConnector_ms": 0.049027442932128906}}, "episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.2910337468848, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2663067138155, -3527.444517946918, -3526.7572952902033, -3527.4949071822653, -3526.9525809938505, -3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.446862596414577, "mean_inference_ms": 0.24496173844289656, "mean_action_processing_ms": 0.058940710265312946, "mean_env_wait_ms": 0.5971063870766595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027313232421875, "StateBufferConnector_ms": 0.001959085464477539, "ViewRequirementAgentConnector_ms": 0.049027442932128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265440, "num_agent_steps_trained": 265440, "num_env_steps_sampled": 265440, "num_env_steps_trained": 265440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.29850606757734, "num_env_steps_trained_throughput_per_sec": 159.29850606757734, "timesteps_total": 265440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 265440, "timers": {"training_iteration_time_ms": 2213.091, "sample_time_ms": 2204.833, "load_time_ms": 0.244, "load_throughput": 1473984.225, "learn_time_ms": 7.388, "learn_throughput": 48724.864, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 265440, "num_env_steps_trained": 265440, "num_agent_steps_sampled": 265440, "num_agent_steps_trained": 265440}, "done": false, "episodes_total": 1218, "training_iteration": 230, "trial_id": "71c6f_00000", "date": "2023-08-04_10-19-54", "timestamp": 1691133594, "time_this_iter_s": 11.30196213722229, "time_total_s": 2525.8182332515717, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 795.9875063896179, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 31.331249999999997, "ram_util_percent": 66.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3005310058594, "policy_loss": 275728.1359375, "vf_loss": 20734642.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2043.0, "diff_num_grad_updates_vs_sampler_policy": 2042.0}}, "num_env_steps_sampled": 267240, "num_env_steps_trained": 267240, "num_agent_steps_sampled": 267240, "num_agent_steps_trained": 267240}, "sampler_results": {"episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.2775416494296, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.453507126830448, "mean_inference_ms": 0.24534502281536544, "mean_action_processing_ms": 0.05903975616530051, "mean_env_wait_ms": 0.5976470597246017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027532577514648438, "StateBufferConnector_ms": 0.001973390579223633, "ViewRequirementAgentConnector_ms": 0.04929971694946289}}, "episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.2775416494296, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.99257945227, -3527.265250538585, -3526.741936938166, -3533.494012268035, -3533.0284797910263, -3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.453507126830448, "mean_inference_ms": 0.24534502281536544, "mean_action_processing_ms": 0.05903975616530051, "mean_env_wait_ms": 0.5976470597246017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027532577514648438, "StateBufferConnector_ms": 0.001973390579223633, "ViewRequirementAgentConnector_ms": 0.04929971694946289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267240, "num_agent_steps_trained": 267240, "num_env_steps_sampled": 267240, "num_env_steps_trained": 267240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.55754164459955, "num_env_steps_trained_throughput_per_sec": 162.55754164459955, "timesteps_total": 267240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 267240, "timers": {"training_iteration_time_ms": 2237.242, "sample_time_ms": 2228.837, "load_time_ms": 0.25, "load_throughput": 1442443.103, "learn_time_ms": 7.493, "learn_throughput": 48041.662, "synch_weights_time_ms": 0.623}, "counters": {"num_env_steps_sampled": 267240, "num_env_steps_trained": 267240, "num_agent_steps_sampled": 267240, "num_agent_steps_trained": 267240}, "done": false, "episodes_total": 1223, "training_iteration": 231, "trial_id": "71c6f_00000", "date": "2023-08-04_10-20-05", "timestamp": 1691133605, "time_this_iter_s": 11.075157165527344, "time_total_s": 2536.893390417099, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 807.0626635551453, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 27.49375, "ram_util_percent": 66.91875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.261669921875, "policy_loss": 303975.93125, "vf_loss": 20736376.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2068.0, "diff_num_grad_updates_vs_sampler_policy": 2067.0}}, "num_env_steps_sampled": 269040, "num_env_steps_trained": 269040, "num_agent_steps_sampled": 269040, "num_agent_steps_trained": 269040}, "sampler_results": {"episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1807352799206, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.460483523946423, "mean_inference_ms": 0.24575418058650214, "mean_action_processing_ms": 0.05914540623418443, "mean_env_wait_ms": 0.5982401699778812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002788066864013672, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.049900054931640625}}, "episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1807352799206, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6733345481475, -3525.901984403905, -3527.0199614441563, -3526.8963423119008, -3527.529152924004, -3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.460483523946423, "mean_inference_ms": 0.24575418058650214, "mean_action_processing_ms": 0.05914540623418443, "mean_env_wait_ms": 0.5982401699778812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002788066864013672, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.049900054931640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269040, "num_agent_steps_trained": 269040, "num_env_steps_sampled": 269040, "num_env_steps_trained": 269040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.79802820511478, "num_env_steps_trained_throughput_per_sec": 158.79802820511478, "timesteps_total": 269040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 269040, "timers": {"training_iteration_time_ms": 2240.803, "sample_time_ms": 2232.326, "load_time_ms": 0.252, "load_throughput": 1430418.189, "learn_time_ms": 7.564, "learn_throughput": 47592.539, "synch_weights_time_ms": 0.623}, "counters": {"num_env_steps_sampled": 269040, "num_env_steps_trained": 269040, "num_agent_steps_sampled": 269040, "num_agent_steps_trained": 269040}, "done": false, "episodes_total": 1228, "training_iteration": 232, "trial_id": "71c6f_00000", "date": "2023-08-04_10-20-17", "timestamp": 1691133617, "time_this_iter_s": 11.337448120117188, "time_total_s": 2548.230838537216, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 818.4001116752625, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 27.93125, "ram_util_percent": 66.91875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.33525390625, "policy_loss": -326953.45, "vf_loss": 20738012.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 2092.0}}, "num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840}, "sampler_results": {"episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.18491706729, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4677459091460126, "mean_inference_ms": 0.2461870662304898, "mean_action_processing_ms": 0.059257555460877194, "mean_env_wait_ms": 0.5988815905296073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028107166290283203, "StateBufferConnector_ms": 0.002020120620727539, "ViewRequirementAgentConnector_ms": 0.05038166046142578}}, "episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.18491706729, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6792751396642, -3526.5881842491626, -3527.7563241130097, -3525.768475135936, -3526.394312230684, -3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4677459091460126, "mean_inference_ms": 0.2461870662304898, "mean_action_processing_ms": 0.059257555460877194, "mean_env_wait_ms": 0.5988815905296073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028107166290283203, "StateBufferConnector_ms": 0.002020120620727539, "ViewRequirementAgentConnector_ms": 0.05038166046142578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840, "num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.0493894139441, "num_env_steps_trained_throughput_per_sec": 162.0493894139441, "timesteps_total": 270840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 270840, "timers": {"training_iteration_time_ms": 2244.276, "sample_time_ms": 2236.152, "load_time_ms": 0.247, "load_throughput": 1457620.851, "learn_time_ms": 7.256, "learn_throughput": 49616.509, "synch_weights_time_ms": 0.584}, "counters": {"num_env_steps_sampled": 270840, "num_env_steps_trained": 270840, "num_agent_steps_sampled": 270840, "num_agent_steps_trained": 270840}, "done": false, "episodes_total": 1233, "training_iteration": 233, "trial_id": "71c6f_00000", "date": "2023-08-04_10-20-28", "timestamp": 1691133628, "time_this_iter_s": 11.109594106674194, "time_total_s": 2559.3404326438904, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 829.5097057819366, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 30.924999999999997, "ram_util_percent": 66.99375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.68950805664065, "policy_loss": -9952333.35, "vf_loss": 20758568.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2118.0, "diff_num_grad_updates_vs_sampler_policy": 2117.0}}, "num_env_steps_sampled": 272640, "num_env_steps_trained": 272640, "num_agent_steps_sampled": 272640, "num_agent_steps_trained": 272640}, "sampler_results": {"episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.194763664266, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.475341195138306, "mean_inference_ms": 0.24661825958948583, "mean_action_processing_ms": 0.05937017348277962, "mean_env_wait_ms": 0.5995273772651701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028107166290283203, "StateBufferConnector_ms": 0.0020198822021484375, "ViewRequirementAgentConnector_ms": 0.050438880920410156}}, "episode_reward_max": -3525.6328288447066, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.194763664266, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.224701355596, -3527.7978712555214, -3527.509088123309, -3526.94341943105, -3527.626039713596, -3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.475341195138306, "mean_inference_ms": 0.24661825958948583, "mean_action_processing_ms": 0.05937017348277962, "mean_env_wait_ms": 0.5995273772651701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028107166290283203, "StateBufferConnector_ms": 0.0020198822021484375, "ViewRequirementAgentConnector_ms": 0.050438880920410156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272640, "num_agent_steps_trained": 272640, "num_env_steps_sampled": 272640, "num_env_steps_trained": 272640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.5992697810871, "num_env_steps_trained_throughput_per_sec": 163.5992697810871, "timesteps_total": 272640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 272640, "timers": {"training_iteration_time_ms": 2211.011, "sample_time_ms": 2203.312, "load_time_ms": 0.234, "load_throughput": 1537000.651, "learn_time_ms": 6.885, "learn_throughput": 52286.103, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 272640, "num_env_steps_trained": 272640, "num_agent_steps_sampled": 272640, "num_agent_steps_trained": 272640}, "done": false, "episodes_total": 1238, "training_iteration": 234, "trial_id": "71c6f_00000", "date": "2023-08-04_10-20-39", "timestamp": 1691133639, "time_this_iter_s": 11.004520177841187, "time_total_s": 2570.3449528217316, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 840.5142259597778, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 27.206666666666667, "ram_util_percent": 66.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4047607421875, "policy_loss": -3202666.4125, "vf_loss": 20749789.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2143.0, "diff_num_grad_updates_vs_sampler_policy": 2142.0}}, "num_env_steps_sampled": 274440, "num_env_steps_trained": 274440, "num_agent_steps_sampled": 274440, "num_agent_steps_trained": 274440}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.148207989954, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.483206051717087, "mean_inference_ms": 0.24705195865313892, "mean_action_processing_ms": 0.0594843127395154, "mean_env_wait_ms": 0.6001700100586986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028121471405029297, "StateBufferConnector_ms": 0.0020246505737304688, "ViewRequirementAgentConnector_ms": 0.05052757263183594}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.148207989954, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.9671926997285, -3526.466248092107, -3526.7717601845698, -3527.2296352956564, -3526.973633300683, -3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.483206051717087, "mean_inference_ms": 0.24705195865313892, "mean_action_processing_ms": 0.0594843127395154, "mean_env_wait_ms": 0.6001700100586986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028121471405029297, "StateBufferConnector_ms": 0.0020246505737304688, "ViewRequirementAgentConnector_ms": 0.05052757263183594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274440, "num_agent_steps_trained": 274440, "num_env_steps_sampled": 274440, "num_env_steps_trained": 274440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 165.65922808421237, "num_env_steps_trained_throughput_per_sec": 165.65922808421237, "timesteps_total": 274440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 274440, "timers": {"training_iteration_time_ms": 2186.806, "sample_time_ms": 2178.976, "load_time_ms": 0.233, "load_throughput": 1547555.027, "learn_time_ms": 7.017, "learn_throughput": 51306.471, "synch_weights_time_ms": 0.547}, "counters": {"num_env_steps_sampled": 274440, "num_env_steps_trained": 274440, "num_agent_steps_sampled": 274440, "num_agent_steps_trained": 274440}, "done": false, "episodes_total": 1243, "training_iteration": 235, "trial_id": "71c6f_00000", "date": "2023-08-04_10-20-50", "timestamp": 1691133650, "time_this_iter_s": 10.868070125579834, "time_total_s": 2581.2130229473114, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 851.3822960853577, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 25.393749999999997, "ram_util_percent": 66.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3889953613281, "policy_loss": -5928949.725, "vf_loss": 20743020.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2168.0, "diff_num_grad_updates_vs_sampler_policy": 2167.0}}, "num_env_steps_sampled": 276240, "num_env_steps_trained": 276240, "num_agent_steps_sampled": 276240, "num_agent_steps_trained": 276240}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.168916387018, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.491174357087604, "mean_inference_ms": 0.24747772648035662, "mean_action_processing_ms": 0.059596586885996145, "mean_env_wait_ms": 0.6008153277539013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002828836441040039, "StateBufferConnector_ms": 0.0020301342010498047, "ViewRequirementAgentConnector_ms": 0.05075788497924805}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.168916387018, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.4491888272655, -3527.108197169609, -3527.955103745319, -3529.9028619567944, -3526.201376496987, -3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.491174357087604, "mean_inference_ms": 0.24747772648035662, "mean_action_processing_ms": 0.059596586885996145, "mean_env_wait_ms": 0.6008153277539013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002828836441040039, "StateBufferConnector_ms": 0.0020301342010498047, "ViewRequirementAgentConnector_ms": 0.05075788497924805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276240, "num_agent_steps_trained": 276240, "num_env_steps_sampled": 276240, "num_env_steps_trained": 276240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.02890623038402, "num_env_steps_trained_throughput_per_sec": 159.02890623038402, "timesteps_total": 276240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 276240, "timers": {"training_iteration_time_ms": 2218.426, "sample_time_ms": 2210.334, "load_time_ms": 0.244, "load_throughput": 1476001.408, "learn_time_ms": 7.239, "learn_throughput": 49729.261, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 276240, "num_env_steps_trained": 276240, "num_agent_steps_sampled": 276240, "num_agent_steps_trained": 276240}, "done": false, "episodes_total": 1248, "training_iteration": 236, "trial_id": "71c6f_00000", "date": "2023-08-04_10-21-01", "timestamp": 1691133661, "time_this_iter_s": 11.32124400138855, "time_total_s": 2592.5342669487, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 862.7035400867462, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 29.3875, "ram_util_percent": 66.79375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.66338500976565, "policy_loss": -3915609.6640625, "vf_loss": 20756514.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2193.0, "diff_num_grad_updates_vs_sampler_policy": 2192.0}}, "num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1769060145307, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.499107144547475, "mean_inference_ms": 0.24790613337279685, "mean_action_processing_ms": 0.059709305213089044, "mean_env_wait_ms": 0.6014752609173213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002849578857421875, "StateBufferConnector_ms": 0.002040863037109375, "ViewRequirementAgentConnector_ms": 0.05096912384033203}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1769060145307, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6740673813797, -3526.2331063239267, -3526.5640708365263, -3528.2887643974327, -3528.1649317811703, -3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.499107144547475, "mean_inference_ms": 0.24790613337279685, "mean_action_processing_ms": 0.059709305213089044, "mean_env_wait_ms": 0.6014752609173213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002849578857421875, "StateBufferConnector_ms": 0.002040863037109375, "ViewRequirementAgentConnector_ms": 0.05096912384033203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040, "num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.7124564571954, "num_env_steps_trained_throughput_per_sec": 161.7124564571954, "timesteps_total": 278040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 278040, "timers": {"training_iteration_time_ms": 2244.945, "sample_time_ms": 2236.894, "load_time_ms": 0.242, "load_throughput": 1488955.172, "learn_time_ms": 7.192, "learn_throughput": 50055.177, "synch_weights_time_ms": 0.581}, "counters": {"num_env_steps_sampled": 278040, "num_env_steps_trained": 278040, "num_agent_steps_sampled": 278040, "num_agent_steps_trained": 278040}, "done": false, "episodes_total": 1253, "training_iteration": 237, "trial_id": "71c6f_00000", "date": "2023-08-04_10-21-12", "timestamp": 1691133672, "time_this_iter_s": 11.133382797241211, "time_total_s": 2603.667649745941, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 873.8369228839874, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 26.4625, "ram_util_percent": 66.61250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.33180541992186, "policy_loss": -1602516.56875, "vf_loss": 20747673.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2218.0, "diff_num_grad_updates_vs_sampler_policy": 2217.0}}, "num_env_steps_sampled": 279840, "num_env_steps_trained": 279840, "num_agent_steps_sampled": 279840, "num_agent_steps_trained": 279840}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1577144829516, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.507039239523415, "mean_inference_ms": 0.24833029724921118, "mean_action_processing_ms": 0.05982117325001902, "mean_env_wait_ms": 0.6021307744661493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028488636016845703, "StateBufferConnector_ms": 0.002042055130004883, "ViewRequirementAgentConnector_ms": 0.05106925964355469}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1577144829516, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.140163909582, -3525.6330377754603, -3526.735864793248, -3526.1409917588817, -3526.729743473919, -3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.507039239523415, "mean_inference_ms": 0.24833029724921118, "mean_action_processing_ms": 0.05982117325001902, "mean_env_wait_ms": 0.6021307744661493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028488636016845703, "StateBufferConnector_ms": 0.002042055130004883, "ViewRequirementAgentConnector_ms": 0.05106925964355469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279840, "num_agent_steps_trained": 279840, "num_env_steps_sampled": 279840, "num_env_steps_trained": 279840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.84756166425575, "num_env_steps_trained_throughput_per_sec": 160.84756166425575, "timesteps_total": 279840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 279840, "timers": {"training_iteration_time_ms": 2232.147, "sample_time_ms": 2223.845, "load_time_ms": 0.242, "load_throughput": 1490277.773, "learn_time_ms": 7.432, "learn_throughput": 48437.733, "synch_weights_time_ms": 0.592}, "counters": {"num_env_steps_sampled": 279840, "num_env_steps_trained": 279840, "num_agent_steps_sampled": 279840, "num_agent_steps_trained": 279840}, "done": false, "episodes_total": 1258, "training_iteration": 238, "trial_id": "71c6f_00000", "date": "2023-08-04_10-21-23", "timestamp": 1691133683, "time_this_iter_s": 11.193055152893066, "time_total_s": 2614.8607048988342, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 885.0299780368805, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 27.15333333333333, "ram_util_percent": 66.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.5378784179687, "policy_loss": -8625762.5078125, "vf_loss": 20750649.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2243.0, "diff_num_grad_updates_vs_sampler_policy": 2242.0}}, "num_env_steps_sampled": 281640, "num_env_steps_trained": 281640, "num_agent_steps_sampled": 281640, "num_agent_steps_trained": 281640}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1637991435978, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.514632604118903, "mean_inference_ms": 0.24874195421746959, "mean_action_processing_ms": 0.05992993942551664, "mean_env_wait_ms": 0.6027665043257895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028438568115234375, "StateBufferConnector_ms": 0.0020415782928466797, "ViewRequirementAgentConnector_ms": 0.05090832710266113}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1637991435978, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5279606365416, -3530.2031089647985, -3526.2128065766287, -3527.614319781844, -3527.7766924047155, -3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.514632604118903, "mean_inference_ms": 0.24874195421746959, "mean_action_processing_ms": 0.05992993942551664, "mean_env_wait_ms": 0.6027665043257895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028438568115234375, "StateBufferConnector_ms": 0.0020415782928466797, "ViewRequirementAgentConnector_ms": 0.05090832710266113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281640, "num_agent_steps_trained": 281640, "num_env_steps_sampled": 281640, "num_env_steps_trained": 281640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 162.455472530259, "num_env_steps_trained_throughput_per_sec": 162.455472530259, "timesteps_total": 281640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 281640, "timers": {"training_iteration_time_ms": 2227.057, "sample_time_ms": 2218.849, "load_time_ms": 0.243, "load_throughput": 1482231.707, "learn_time_ms": 7.337, "learn_throughput": 49068.941, "synch_weights_time_ms": 0.59}, "counters": {"num_env_steps_sampled": 281640, "num_env_steps_trained": 281640, "num_agent_steps_sampled": 281640, "num_agent_steps_trained": 281640}, "done": false, "episodes_total": 1263, "training_iteration": 239, "trial_id": "71c6f_00000", "date": "2023-08-04_10-21-34", "timestamp": 1691133694, "time_this_iter_s": 11.082046031951904, "time_total_s": 2625.942750930786, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 896.1120240688324, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 27.63125, "ram_util_percent": 66.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3466064453125, "policy_loss": -4092181.01875, "vf_loss": 20743093.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2268.0, "diff_num_grad_updates_vs_sampler_policy": 2267.0}}, "num_env_steps_sampled": 283440, "num_env_steps_trained": 283440, "num_agent_steps_sampled": 283440, "num_agent_steps_trained": 283440}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1233826024704, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.522093169089164, "mean_inference_ms": 0.24913849352828366, "mean_action_processing_ms": 0.06003495243974756, "mean_env_wait_ms": 0.6033733157935413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028603076934814453, "StateBufferConnector_ms": 0.0020492076873779297, "ViewRequirementAgentConnector_ms": 0.05104351043701172}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.1233826024704, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4773085292927, -3527.404212582715, -3527.2843246154857, -3525.8610198921037, -3526.8326354465084, -3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.522093169089164, "mean_inference_ms": 0.24913849352828366, "mean_action_processing_ms": 0.06003495243974756, "mean_env_wait_ms": 0.6033733157935413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028603076934814453, "StateBufferConnector_ms": 0.0020492076873779297, "ViewRequirementAgentConnector_ms": 0.05104351043701172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283440, "num_agent_steps_trained": 283440, "num_env_steps_sampled": 283440, "num_env_steps_trained": 283440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.60429505942432, "num_env_steps_trained_throughput_per_sec": 161.60429505942432, "timesteps_total": 283440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 283440, "timers": {"training_iteration_time_ms": 2221.817, "sample_time_ms": 2213.92, "load_time_ms": 0.237, "load_throughput": 1517994.813, "learn_time_ms": 7.055, "learn_throughput": 51025.596, "synch_weights_time_ms": 0.568}, "counters": {"num_env_steps_sampled": 283440, "num_env_steps_trained": 283440, "num_agent_steps_sampled": 283440, "num_agent_steps_trained": 283440}, "done": false, "episodes_total": 1268, "training_iteration": 240, "trial_id": "71c6f_00000", "date": "2023-08-04_10-21-46", "timestamp": 1691133706, "time_this_iter_s": 11.140686988830566, "time_total_s": 2637.0834379196167, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 907.252711057663, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.38125, "ram_util_percent": 66.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.39063720703126, "policy_loss": -7035453.34375, "vf_loss": 20750977.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2293.0, "diff_num_grad_updates_vs_sampler_policy": 2292.0}}, "num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.131599961821, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.529407349717123, "mean_inference_ms": 0.24953540013088996, "mean_action_processing_ms": 0.06013979358287447, "mean_env_wait_ms": 0.603984403921871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002871274948120117, "StateBufferConnector_ms": 0.0020554065704345703, "ViewRequirementAgentConnector_ms": 0.05128788948059082}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3533.669527405014, "episode_reward_mean": -3527.131599961821, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.7519335553175, -3528.0456095800305, -3526.6183842591035, -3528.4026201466163, -3527.416514176357, -3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.529407349717123, "mean_inference_ms": 0.24953540013088996, "mean_action_processing_ms": 0.06013979358287447, "mean_env_wait_ms": 0.603984403921871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002871274948120117, "StateBufferConnector_ms": 0.0020554065704345703, "ViewRequirementAgentConnector_ms": 0.05128788948059082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240, "num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.15931377574572, "num_env_steps_trained_throughput_per_sec": 157.15931377574572, "timesteps_total": 285240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 285240, "timers": {"training_iteration_time_ms": 2259.155, "sample_time_ms": 2250.8, "load_time_ms": 0.242, "load_throughput": 1490277.773, "learn_time_ms": 7.47, "learn_throughput": 48195.464, "synch_weights_time_ms": 0.606}, "counters": {"num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240}, "done": false, "episodes_total": 1273, "training_iteration": 241, "trial_id": "71c6f_00000", "date": "2023-08-04_10-21-57", "timestamp": 1691133717, "time_this_iter_s": 11.455758094787598, "time_total_s": 2648.5391960144043, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 918.7084691524506, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 32.625, "ram_util_percent": 66.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3574951171875, "policy_loss": -1361651.575, "vf_loss": 20747841.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2318.0, "diff_num_grad_updates_vs_sampler_policy": 2317.0}}, "num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.174890109647, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.536725906246088, "mean_inference_ms": 0.24992568863646647, "mean_action_processing_ms": 0.060242745738121835, "mean_env_wait_ms": 0.6045794184928912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028831958770751953, "StateBufferConnector_ms": 0.0020513534545898438, "ViewRequirementAgentConnector_ms": 0.05131173133850098}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.174890109647, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.550919382666, -3527.186371734165, -3527.446928788162, -3528.3780528246034, -3525.8193619378017, -3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.536725906246088, "mean_inference_ms": 0.24992568863646647, "mean_action_processing_ms": 0.060242745738121835, "mean_env_wait_ms": 0.6045794184928912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028831958770751953, "StateBufferConnector_ms": 0.0020513534545898438, "ViewRequirementAgentConnector_ms": 0.05131173133850098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040, "num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.3188116776298, "num_env_steps_trained_throughput_per_sec": 163.3188116776298, "timesteps_total": 287040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 287040, "timers": {"training_iteration_time_ms": 2247.461, "sample_time_ms": 2238.901, "load_time_ms": 0.253, "load_throughput": 1422199.717, "learn_time_ms": 7.638, "learn_throughput": 47133.925, "synch_weights_time_ms": 0.63}, "counters": {"num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040}, "done": false, "episodes_total": 1278, "training_iteration": 242, "trial_id": "71c6f_00000", "date": "2023-08-04_10-22-08", "timestamp": 1691133728, "time_this_iter_s": 11.024030923843384, "time_total_s": 2659.5632269382477, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 929.732500076294, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 25.80625, "ram_util_percent": 66.91875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.34588012695315, "policy_loss": -201123.73125, "vf_loss": 20757095.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2343.0, "diff_num_grad_updates_vs_sampler_policy": 2342.0}}, "num_env_steps_sampled": 288840, "num_env_steps_trained": 288840, "num_agent_steps_sampled": 288840, "num_agent_steps_trained": 288840}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.181285238889, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.544206120550312, "mean_inference_ms": 0.25032946620120866, "mean_action_processing_ms": 0.060348812679987054, "mean_env_wait_ms": 0.6051966922825969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00289154052734375, "StateBufferConnector_ms": 0.0020515918731689453, "ViewRequirementAgentConnector_ms": 0.051406145095825195}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.181285238889, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.8534110812234, -3527.485710616333, -3526.529922340076, -3526.543580213124, -3526.9170629429127, -3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.544206120550312, "mean_inference_ms": 0.25032946620120866, "mean_action_processing_ms": 0.060348812679987054, "mean_env_wait_ms": 0.6051966922825969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00289154052734375, "StateBufferConnector_ms": 0.0020515918731689453, "ViewRequirementAgentConnector_ms": 0.051406145095825195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288840, "num_agent_steps_trained": 288840, "num_env_steps_sampled": 288840, "num_env_steps_trained": 288840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.1359083964783, "num_env_steps_trained_throughput_per_sec": 160.1359083964783, "timesteps_total": 288840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 288840, "timers": {"training_iteration_time_ms": 2226.172, "sample_time_ms": 2217.985, "load_time_ms": 0.247, "load_throughput": 1457902.327, "learn_time_ms": 7.326, "learn_throughput": 49140.483, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 288840, "num_env_steps_trained": 288840, "num_agent_steps_sampled": 288840, "num_agent_steps_trained": 288840}, "done": false, "episodes_total": 1283, "training_iteration": 243, "trial_id": "71c6f_00000", "date": "2023-08-04_10-22-19", "timestamp": 1691133739, "time_this_iter_s": 11.242965698242188, "time_total_s": 2670.80619263649, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 940.9754657745361, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 26.987499999999997, "ram_util_percent": 66.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.36497192382814, "policy_loss": -3821411.0625, "vf_loss": 20751593.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2368.0, "diff_num_grad_updates_vs_sampler_policy": 2367.0}}, "num_env_steps_sampled": 290640, "num_env_steps_trained": 290640, "num_agent_steps_sampled": 290640, "num_agent_steps_trained": 290640}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.204467961051, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.551661281267647, "mean_inference_ms": 0.250738173145643, "mean_action_processing_ms": 0.06045537138728962, "mean_env_wait_ms": 0.6058252172017654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002899169921875, "StateBufferConnector_ms": 0.0020596981048583984, "ViewRequirementAgentConnector_ms": 0.05155587196350098}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.204467961051, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.2514956151567, -3526.7242920832186, -3533.669527405014, -3527.017816711505, -3528.1822221863913, -3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.551661281267647, "mean_inference_ms": 0.250738173145643, "mean_action_processing_ms": 0.06045537138728962, "mean_env_wait_ms": 0.6058252172017654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002899169921875, "StateBufferConnector_ms": 0.0020596981048583984, "ViewRequirementAgentConnector_ms": 0.05155587196350098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290640, "num_agent_steps_trained": 290640, "num_env_steps_sampled": 290640, "num_env_steps_trained": 290640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.7598174986727, "num_env_steps_trained_throughput_per_sec": 155.7598174986727, "timesteps_total": 290640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 290640, "timers": {"training_iteration_time_ms": 2279.66, "sample_time_ms": 2271.624, "load_time_ms": 0.237, "load_throughput": 1517537.126, "learn_time_ms": 7.19, "learn_throughput": 50070.281, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 290640, "num_env_steps_trained": 290640, "num_agent_steps_sampled": 290640, "num_agent_steps_trained": 290640}, "done": false, "episodes_total": 1288, "training_iteration": 244, "trial_id": "71c6f_00000", "date": "2023-08-04_10-22-31", "timestamp": 1691133751, "time_this_iter_s": 11.558467864990234, "time_total_s": 2682.36466050148, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 952.5339336395264, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 27.83125, "ram_util_percent": 66.83749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4112915039062, "policy_loss": -1378122.04375, "vf_loss": 20761414.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2393.0, "diff_num_grad_updates_vs_sampler_policy": 2392.0}}, "num_env_steps_sampled": 292440, "num_env_steps_trained": 292440, "num_agent_steps_sampled": 292440, "num_agent_steps_trained": 292440}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.1088877589646, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5590845693826605, "mean_inference_ms": 0.2511358371093069, "mean_action_processing_ms": 0.06055911648345154, "mean_env_wait_ms": 0.6064263378536411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029006004333496094, "StateBufferConnector_ms": 0.0020554065704345703, "ViewRequirementAgentConnector_ms": 0.05154919624328613}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.1088877589646, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.3463668066684, -3529.4697854438527, -3529.2868354149755, -3525.853163049299, -3527.024398894985, -3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5590845693826605, "mean_inference_ms": 0.2511358371093069, "mean_action_processing_ms": 0.06055911648345154, "mean_env_wait_ms": 0.6064263378536411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029006004333496094, "StateBufferConnector_ms": 0.0020554065704345703, "ViewRequirementAgentConnector_ms": 0.05154919624328613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292440, "num_agent_steps_trained": 292440, "num_env_steps_sampled": 292440, "num_env_steps_trained": 292440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.0241128016233, "num_env_steps_trained_throughput_per_sec": 159.0241128016233, "timesteps_total": 292440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 292440, "timers": {"training_iteration_time_ms": 2287.518, "sample_time_ms": 2279.153, "load_time_ms": 0.243, "load_throughput": 1483688.16, "learn_time_ms": 7.499, "learn_throughput": 48007.6, "synch_weights_time_ms": 0.586}, "counters": {"num_env_steps_sampled": 292440, "num_env_steps_trained": 292440, "num_agent_steps_sampled": 292440, "num_agent_steps_trained": 292440}, "done": false, "episodes_total": 1293, "training_iteration": 245, "trial_id": "71c6f_00000", "date": "2023-08-04_10-22-42", "timestamp": 1691133762, "time_this_iter_s": 11.32145881652832, "time_total_s": 2693.6861193180084, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 963.8553924560547, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 26.106250000000003, "ram_util_percent": 66.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.448828125, "policy_loss": -3974043.684375, "vf_loss": 20744297.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2418.0, "diff_num_grad_updates_vs_sampler_policy": 2417.0}}, "num_env_steps_sampled": 294240, "num_env_steps_trained": 294240, "num_agent_steps_sampled": 294240, "num_agent_steps_trained": 294240}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.061341818588, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.566190744323524, "mean_inference_ms": 0.251524379789615, "mean_action_processing_ms": 0.060659986240767676, "mean_env_wait_ms": 0.6070042842716569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028955936431884766, "StateBufferConnector_ms": 0.002048969268798828, "ViewRequirementAgentConnector_ms": 0.051522254943847656}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.061341818588, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0998289234058, -3526.285272994853, -3527.357427679833, -3526.6393443591633, -3526.8296599405257, -3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.566190744323524, "mean_inference_ms": 0.251524379789615, "mean_action_processing_ms": 0.060659986240767676, "mean_env_wait_ms": 0.6070042842716569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028955936431884766, "StateBufferConnector_ms": 0.002048969268798828, "ViewRequirementAgentConnector_ms": 0.051522254943847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294240, "num_agent_steps_trained": 294240, "num_env_steps_sampled": 294240, "num_env_steps_trained": 294240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.44027098096973, "num_env_steps_trained_throughput_per_sec": 158.44027098096973, "timesteps_total": 294240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 294240, "timers": {"training_iteration_time_ms": 2267.966, "sample_time_ms": 2259.372, "load_time_ms": 0.254, "load_throughput": 1417127.583, "learn_time_ms": 7.704, "learn_throughput": 46730.444, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 294240, "num_env_steps_trained": 294240, "num_agent_steps_sampled": 294240, "num_agent_steps_trained": 294240}, "done": false, "episodes_total": 1298, "training_iteration": 246, "trial_id": "71c6f_00000", "date": "2023-08-04_10-22-54", "timestamp": 1691133774, "time_this_iter_s": 11.363172054290771, "time_total_s": 2705.049291372299, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 975.2185645103455, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 27.9625, "ram_util_percent": 66.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.5340515136719, "policy_loss": -4472240.925, "vf_loss": 20742526.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2443.0, "diff_num_grad_updates_vs_sampler_policy": 2442.0}}, "num_env_steps_sampled": 296040, "num_env_steps_trained": 296040, "num_agent_steps_sampled": 296040, "num_agent_steps_trained": 296040}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.0875505847866, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.573219476195527, "mean_inference_ms": 0.2519048311546215, "mean_action_processing_ms": 0.06075864847197021, "mean_env_wait_ms": 0.6075691397349668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002883434295654297, "StateBufferConnector_ms": 0.0020384788513183594, "ViewRequirementAgentConnector_ms": 0.051438331604003906}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.0875505847866, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.289310972431, -3527.342833344951, -3525.8652122422586, -3527.675809201192, -3527.786719802567, -3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.573219476195527, "mean_inference_ms": 0.2519048311546215, "mean_action_processing_ms": 0.06075864847197021, "mean_env_wait_ms": 0.6075691397349668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002883434295654297, "StateBufferConnector_ms": 0.0020384788513183594, "ViewRequirementAgentConnector_ms": 0.051438331604003906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296040, "num_agent_steps_trained": 296040, "num_env_steps_sampled": 296040, "num_env_steps_trained": 296040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.19601944045968, "num_env_steps_trained_throughput_per_sec": 154.19601944045968, "timesteps_total": 296040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 296040, "timers": {"training_iteration_time_ms": 2303.408, "sample_time_ms": 2295.079, "load_time_ms": 0.25, "load_throughput": 1438184.056, "learn_time_ms": 7.423, "learn_throughput": 48497.941, "synch_weights_time_ms": 0.613}, "counters": {"num_env_steps_sampled": 296040, "num_env_steps_trained": 296040, "num_agent_steps_sampled": 296040, "num_agent_steps_trained": 296040}, "done": false, "episodes_total": 1303, "training_iteration": 247, "trial_id": "71c6f_00000", "date": "2023-08-04_10-23-05", "timestamp": 1691133785, "time_this_iter_s": 11.6754789352417, "time_total_s": 2716.724770307541, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 986.8940434455872, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 27.535294117647055, "ram_util_percent": 66.68823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.40374755859375, "policy_loss": -6827803.2375, "vf_loss": 20749558.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2468.0, "diff_num_grad_updates_vs_sampler_policy": 2467.0}}, "num_env_steps_sampled": 297840, "num_env_steps_trained": 297840, "num_agent_steps_sampled": 297840, "num_agent_steps_trained": 297840}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.0926845524064, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.580103433697983, "mean_inference_ms": 0.25227570633246926, "mean_action_processing_ms": 0.06085472583197646, "mean_env_wait_ms": 0.6081120307651975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002875804901123047, "StateBufferConnector_ms": 0.0020380020141601562, "ViewRequirementAgentConnector_ms": 0.05125784873962402}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.0926845524064, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6890511637625, -3528.3038841126627, -3527.055033606441, -3527.2344087946726, -3526.498594404249, -3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.580103433697983, "mean_inference_ms": 0.25227570633246926, "mean_action_processing_ms": 0.06085472583197646, "mean_env_wait_ms": 0.6081120307651975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002875804901123047, "StateBufferConnector_ms": 0.0020380020141601562, "ViewRequirementAgentConnector_ms": 0.05125784873962402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297840, "num_agent_steps_trained": 297840, "num_env_steps_sampled": 297840, "num_env_steps_trained": 297840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.09911473445732, "num_env_steps_trained_throughput_per_sec": 155.09911473445732, "timesteps_total": 297840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 297840, "timers": {"training_iteration_time_ms": 2327.881, "sample_time_ms": 2319.444, "load_time_ms": 0.246, "load_throughput": 1461005.747, "learn_time_ms": 7.551, "learn_throughput": 47677.294, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 297840, "num_env_steps_trained": 297840, "num_agent_steps_sampled": 297840, "num_agent_steps_trained": 297840}, "done": false, "episodes_total": 1308, "training_iteration": 248, "trial_id": "71c6f_00000", "date": "2023-08-04_10-23-17", "timestamp": 1691133797, "time_this_iter_s": 11.607964992523193, "time_total_s": 2728.332735300064, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 998.5020084381104, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 27.38125, "ram_util_percent": 66.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4726928710937, "policy_loss": -808403.925, "vf_loss": 20741225.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2493.0, "diff_num_grad_updates_vs_sampler_policy": 2492.0}}, "num_env_steps_sampled": 299640, "num_env_steps_trained": 299640, "num_agent_steps_sampled": 299640, "num_agent_steps_trained": 299640}, "sampler_results": {"episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.086753155801, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.587038219506793, "mean_inference_ms": 0.252654792592923, "mean_action_processing_ms": 0.06095235387937821, "mean_env_wait_ms": 0.6086708123770355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028829574584960938, "StateBufferConnector_ms": 0.002045869827270508, "ViewRequirementAgentConnector_ms": 0.05146598815917969}}, "episode_reward_max": -3525.6327216826726, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.086753155801, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.4152875981626, -3525.8659420878075, -3527.9089398072756, -3525.6328288447066, -3527.2850344922967, -3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.587038219506793, "mean_inference_ms": 0.252654792592923, "mean_action_processing_ms": 0.06095235387937821, "mean_env_wait_ms": 0.6086708123770355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028829574584960938, "StateBufferConnector_ms": 0.002045869827270508, "ViewRequirementAgentConnector_ms": 0.05146598815917969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299640, "num_agent_steps_trained": 299640, "num_env_steps_sampled": 299640, "num_env_steps_trained": 299640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.55655767969552, "num_env_steps_trained_throughput_per_sec": 154.55655767969552, "timesteps_total": 299640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 299640, "timers": {"training_iteration_time_ms": 2325.159, "sample_time_ms": 2316.505, "load_time_ms": 0.252, "load_throughput": 1427443.222, "learn_time_ms": 7.765, "learn_throughput": 46361.127, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 299640, "num_env_steps_trained": 299640, "num_agent_steps_sampled": 299640, "num_agent_steps_trained": 299640}, "done": false, "episodes_total": 1313, "training_iteration": 249, "trial_id": "71c6f_00000", "date": "2023-08-04_10-23-29", "timestamp": 1691133809, "time_this_iter_s": 11.648413896560669, "time_total_s": 2739.9811491966248, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1010.150422334671, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 27.54705882352941, "ram_util_percent": 66.68235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2857299804688, "policy_loss": -3482242.371875, "vf_loss": 20737637.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2518.0, "diff_num_grad_updates_vs_sampler_policy": 2517.0}}, "num_env_steps_sampled": 301440, "num_env_steps_trained": 301440, "num_agent_steps_sampled": 301440, "num_agent_steps_trained": 301440}, "sampler_results": {"episode_reward_max": -3525.6324939456963, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.0949091593466, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5938488411010745, "mean_inference_ms": 0.2530232803230285, "mean_action_processing_ms": 0.06104702358521017, "mean_env_wait_ms": 0.6092177577532786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002889394760131836, "StateBufferConnector_ms": 0.0020551681518554688, "ViewRequirementAgentConnector_ms": 0.051641225814819336}}, "episode_reward_max": -3525.6324939456963, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.0949091593466, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.591066390537, -3526.2884270325353, -3527.6902725069676, -3526.968375725188, -3526.0282567262666, -3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5938488411010745, "mean_inference_ms": 0.2530232803230285, "mean_action_processing_ms": 0.06104702358521017, "mean_env_wait_ms": 0.6092177577532786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002889394760131836, "StateBufferConnector_ms": 0.0020551681518554688, "ViewRequirementAgentConnector_ms": 0.051641225814819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301440, "num_agent_steps_trained": 301440, "num_env_steps_sampled": 301440, "num_env_steps_trained": 301440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.82476658294217, "num_env_steps_trained_throughput_per_sec": 157.82476658294217, "timesteps_total": 301440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 301440, "timers": {"training_iteration_time_ms": 2305.116, "sample_time_ms": 2296.704, "load_time_ms": 0.246, "load_throughput": 1460864.396, "learn_time_ms": 7.541, "learn_throughput": 47740.606, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 301440, "num_env_steps_trained": 301440, "num_agent_steps_sampled": 301440, "num_agent_steps_trained": 301440}, "done": false, "episodes_total": 1318, "training_iteration": 250, "trial_id": "71c6f_00000", "date": "2023-08-04_10-23-40", "timestamp": 1691133820, "time_this_iter_s": 11.407184839248657, "time_total_s": 2751.3883340358734, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1021.5576071739197, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 26.65, "ram_util_percent": 66.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.67039794921874, "policy_loss": -18712779.0, "vf_loss": 20773242.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2543.0, "diff_num_grad_updates_vs_sampler_policy": 2542.0}}, "num_env_steps_sampled": 303240, "num_env_steps_trained": 303240, "num_agent_steps_sampled": 303240, "num_agent_steps_trained": 303240}, "sampler_results": {"episode_reward_max": -3525.6324939456963, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.133710471733, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.600717429083936, "mean_inference_ms": 0.2533767233118266, "mean_action_processing_ms": 0.061137862070054755, "mean_env_wait_ms": 0.609754407313324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028839111328125, "StateBufferConnector_ms": 0.0020525455474853516, "ViewRequirementAgentConnector_ms": 0.05152463912963867}}, "episode_reward_max": -3525.6324939456963, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.133710471733, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.368548412442, -3528.7666807980895, -3528.100139706471, -3526.3117981586124, -3526.294454961694, -3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.600717429083936, "mean_inference_ms": 0.2533767233118266, "mean_action_processing_ms": 0.061137862070054755, "mean_env_wait_ms": 0.609754407313324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028839111328125, "StateBufferConnector_ms": 0.0020525455474853516, "ViewRequirementAgentConnector_ms": 0.05152463912963867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303240, "num_agent_steps_trained": 303240, "num_env_steps_sampled": 303240, "num_env_steps_trained": 303240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 153.13993215045036, "num_env_steps_trained_throughput_per_sec": 153.13993215045036, "timesteps_total": 303240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 303240, "timers": {"training_iteration_time_ms": 2315.89, "sample_time_ms": 2307.602, "load_time_ms": 0.242, "load_throughput": 1488808.361, "learn_time_ms": 7.433, "learn_throughput": 48435.557, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 303240, "num_env_steps_trained": 303240, "num_agent_steps_sampled": 303240, "num_agent_steps_trained": 303240}, "done": false, "episodes_total": 1323, "training_iteration": 251, "trial_id": "71c6f_00000", "date": "2023-08-04_10-23-52", "timestamp": 1691133832, "time_this_iter_s": 11.75639796257019, "time_total_s": 2763.1447319984436, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1033.3140051364899, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 31.08235294117647, "ram_util_percent": 66.67058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.616845703125, "policy_loss": -7651433.5, "vf_loss": 20775642.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2568.0, "diff_num_grad_updates_vs_sampler_policy": 2567.0}}, "num_env_steps_sampled": 305040, "num_env_steps_trained": 305040, "num_agent_steps_sampled": 305040, "num_agent_steps_trained": 305040}, "sampler_results": {"episode_reward_max": -3525.6324939456963, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.133292317174, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.607448332059724, "mean_inference_ms": 0.25371841772003784, "mean_action_processing_ms": 0.06122566252462348, "mean_env_wait_ms": 0.6102741341311559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002878427505493164, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.05139493942260742}}, "episode_reward_max": -3525.6324939456963, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.133292317174, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.8932301794957, -3528.377348177334, -3527.039095945576, -3525.918275947799, -3526.211004118812, -3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.607448332059724, "mean_inference_ms": 0.25371841772003784, "mean_action_processing_ms": 0.06122566252462348, "mean_env_wait_ms": 0.6102741341311559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002878427505493164, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.05139493942260742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 305040, "num_agent_steps_trained": 305040, "num_env_steps_sampled": 305040, "num_env_steps_trained": 305040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.67572497898473, "num_env_steps_trained_throughput_per_sec": 158.67572497898473, "timesteps_total": 305040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 305040, "timers": {"training_iteration_time_ms": 2309.773, "sample_time_ms": 2301.422, "load_time_ms": 0.243, "load_throughput": 1481940.76, "learn_time_ms": 7.472, "learn_throughput": 48182.546, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 305040, "num_env_steps_trained": 305040, "num_agent_steps_sampled": 305040, "num_agent_steps_trained": 305040}, "done": false, "episodes_total": 1328, "training_iteration": 252, "trial_id": "71c6f_00000", "date": "2023-08-04_10-24-03", "timestamp": 1691133843, "time_this_iter_s": 11.346411943435669, "time_total_s": 2774.4911439418793, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1044.6604170799255, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 26.531250000000004, "ram_util_percent": 66.86875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2575744628906, "policy_loss": -3642092.9625, "vf_loss": 20740271.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2593.0, "diff_num_grad_updates_vs_sampler_policy": 2592.0}}, "num_env_steps_sampled": 306840, "num_env_steps_trained": 306840, "num_agent_steps_sampled": 306840, "num_agent_steps_trained": 306840}, "sampler_results": {"episode_reward_max": -3525.6324939456963, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.12237168868, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.61397437823931, "mean_inference_ms": 0.2540357850608709, "mean_action_processing_ms": 0.06130717468895467, "mean_env_wait_ms": 0.6107484025163722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028519630432128906, "StateBufferConnector_ms": 0.002038717269897461, "ViewRequirementAgentConnector_ms": 0.05101275444030762}}, "episode_reward_max": -3525.6324939456963, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.12237168868, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.393475369093, -3525.972764998162, -3526.619582639574, -3526.5379145706747, -3528.647492988479, -3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.61397437823931, "mean_inference_ms": 0.2540357850608709, "mean_action_processing_ms": 0.06130717468895467, "mean_env_wait_ms": 0.6107484025163722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028519630432128906, "StateBufferConnector_ms": 0.002038717269897461, "ViewRequirementAgentConnector_ms": 0.05101275444030762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306840, "num_agent_steps_trained": 306840, "num_env_steps_sampled": 306840, "num_env_steps_trained": 306840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 169.45886314569188, "num_env_steps_trained_throughput_per_sec": 169.45886314569188, "timesteps_total": 306840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 306840, "timers": {"training_iteration_time_ms": 2196.582, "sample_time_ms": 2188.657, "load_time_ms": 0.235, "load_throughput": 1531388.884, "learn_time_ms": 7.099, "learn_throughput": 50712.158, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 306840, "num_env_steps_trained": 306840, "num_agent_steps_sampled": 306840, "num_agent_steps_trained": 306840}, "done": false, "episodes_total": 1333, "training_iteration": 253, "trial_id": "71c6f_00000", "date": "2023-08-04_10-24-14", "timestamp": 1691133854, "time_this_iter_s": 10.624200820922852, "time_total_s": 2785.115344762802, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1055.2846179008484, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 22.286666666666672, "ram_util_percent": 66.85999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.62794189453126, "policy_loss": -12917281.05, "vf_loss": 20792016.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2618.0, "diff_num_grad_updates_vs_sampler_policy": 2617.0}}, "num_env_steps_sampled": 308640, "num_env_steps_trained": 308640, "num_agent_steps_sampled": 308640, "num_agent_steps_trained": 308640}, "sampler_results": {"episode_reward_max": -3525.632429431151, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.1391336164147, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.620377730567544, "mean_inference_ms": 0.25435737767745276, "mean_action_processing_ms": 0.061389455417296485, "mean_env_wait_ms": 0.6112344531045151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002864360809326172, "StateBufferConnector_ms": 0.002054452896118164, "ViewRequirementAgentConnector_ms": 0.0511324405670166}}, "episode_reward_max": -3525.632429431151, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.1391336164147, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.8936645411713, -3526.158928312766, -3525.6327216826726, -3526.318067960947, -3527.442169950363, -3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.620377730567544, "mean_inference_ms": 0.25435737767745276, "mean_action_processing_ms": 0.061389455417296485, "mean_env_wait_ms": 0.6112344531045151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002864360809326172, "StateBufferConnector_ms": 0.002054452896118164, "ViewRequirementAgentConnector_ms": 0.0511324405670166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308640, "num_agent_steps_trained": 308640, "num_env_steps_sampled": 308640, "num_env_steps_trained": 308640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.6726462565426, "num_env_steps_trained_throughput_per_sec": 161.6726462565426, "timesteps_total": 308640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 308640, "timers": {"training_iteration_time_ms": 2175.555, "sample_time_ms": 2167.807, "load_time_ms": 0.232, "load_throughput": 1552487.6, "learn_time_ms": 6.955, "learn_throughput": 51762.715, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 308640, "num_env_steps_trained": 308640, "num_agent_steps_sampled": 308640, "num_agent_steps_trained": 308640}, "done": false, "episodes_total": 1338, "training_iteration": 254, "trial_id": "71c6f_00000", "date": "2023-08-04_10-24-25", "timestamp": 1691133865, "time_this_iter_s": 11.13638710975647, "time_total_s": 2796.2517318725586, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1066.4210050106049, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 24.139999999999993, "ram_util_percent": 66.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.49131469726564, "policy_loss": -4676746.871875, "vf_loss": 20736273.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2643.0, "diff_num_grad_updates_vs_sampler_policy": 2642.0}}, "num_env_steps_sampled": 310440, "num_env_steps_trained": 310440, "num_agent_steps_sampled": 310440, "num_agent_steps_trained": 310440}, "sampler_results": {"episode_reward_max": -3525.632429431151, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.1580498955327, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.62674892424074, "mean_inference_ms": 0.25469459830818403, "mean_action_processing_ms": 0.06147537037494161, "mean_env_wait_ms": 0.6117616675675066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002905130386352539, "StateBufferConnector_ms": 0.002069711685180664, "ViewRequirementAgentConnector_ms": 0.051642417907714844}}, "episode_reward_max": -3525.632429431151, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.1580498955327, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.1010286215287, -3528.7410023090533, -3526.521538580522, -3526.5669853880227, -3526.548754379986, -3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.62674892424074, "mean_inference_ms": 0.25469459830818403, "mean_action_processing_ms": 0.06147537037494161, "mean_env_wait_ms": 0.6117616675675066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002905130386352539, "StateBufferConnector_ms": 0.002069711685180664, "ViewRequirementAgentConnector_ms": 0.051642417907714844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310440, "num_agent_steps_trained": 310440, "num_env_steps_sampled": 310440, "num_env_steps_trained": 310440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.0479880667823, "num_env_steps_trained_throughput_per_sec": 157.0479880667823, "timesteps_total": 310440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 310440, "timers": {"training_iteration_time_ms": 2259.496, "sample_time_ms": 2251.298, "load_time_ms": 0.241, "load_throughput": 1496036.302, "learn_time_ms": 7.33, "learn_throughput": 49112.352, "synch_weights_time_ms": 0.592}, "counters": {"num_env_steps_sampled": 310440, "num_env_steps_trained": 310440, "num_agent_steps_sampled": 310440, "num_agent_steps_trained": 310440}, "done": false, "episodes_total": 1343, "training_iteration": 255, "trial_id": "71c6f_00000", "date": "2023-08-04_10-24-37", "timestamp": 1691133877, "time_this_iter_s": 11.463580131530762, "time_total_s": 2807.7153120040894, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1077.8845851421356, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 27.18235294117647, "ram_util_percent": 66.70588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4447937011719, "policy_loss": -5492386.521875, "vf_loss": 20754475.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2668.0, "diff_num_grad_updates_vs_sampler_policy": 2667.0}}, "num_env_steps_sampled": 312240, "num_env_steps_trained": 312240, "num_agent_steps_sampled": 312240, "num_agent_steps_trained": 312240}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.1687808136326, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.633028035018369, "mean_inference_ms": 0.2550225056049317, "mean_action_processing_ms": 0.06155886322163445, "mean_env_wait_ms": 0.6122729183357808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002888917922973633, "StateBufferConnector_ms": 0.0020599365234375, "ViewRequirementAgentConnector_ms": 0.05139017105102539}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.1687808136326, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.979783871895, -3528.9510390920077, -3526.5215244204187, -3527.1187733872175, -3527.8445701757373, -3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.633028035018369, "mean_inference_ms": 0.2550225056049317, "mean_action_processing_ms": 0.06155886322163445, "mean_env_wait_ms": 0.6122729183357808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002888917922973633, "StateBufferConnector_ms": 0.0020599365234375, "ViewRequirementAgentConnector_ms": 0.05139017105102539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312240, "num_agent_steps_trained": 312240, "num_env_steps_sampled": 312240, "num_env_steps_trained": 312240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.31288427953882, "num_env_steps_trained_throughput_per_sec": 157.31288427953882, "timesteps_total": 312240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 312240, "timers": {"training_iteration_time_ms": 2290.351, "sample_time_ms": 2282.112, "load_time_ms": 0.24, "load_throughput": 1496926.182, "learn_time_ms": 7.354, "learn_throughput": 48951.223, "synch_weights_time_ms": 0.604}, "counters": {"num_env_steps_sampled": 312240, "num_env_steps_trained": 312240, "num_agent_steps_sampled": 312240, "num_agent_steps_trained": 312240}, "done": false, "episodes_total": 1348, "training_iteration": 256, "trial_id": "71c6f_00000", "date": "2023-08-04_10-24-48", "timestamp": 1691133888, "time_this_iter_s": 11.44417405128479, "time_total_s": 2819.159486055374, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1089.3287591934204, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 26.7875, "ram_util_percent": 66.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3544677734375, "policy_loss": -5693745.4, "vf_loss": 20744736.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2693.0, "diff_num_grad_updates_vs_sampler_policy": 2692.0}}, "num_env_steps_sampled": 314040, "num_env_steps_trained": 314040, "num_agent_steps_sampled": 314040, "num_agent_steps_trained": 314040}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.152444457987, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.639278775051188, "mean_inference_ms": 0.25534828288421485, "mean_action_processing_ms": 0.06164141519880781, "mean_env_wait_ms": 0.6127711086082681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002886533737182617, "StateBufferConnector_ms": 0.002058267593383789, "ViewRequirementAgentConnector_ms": 0.05141758918762207}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.152444457987, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.704797904669, -3528.041996743796, -3526.608798388258, -3526.664624283543, -3526.9855702421905, -3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.639278775051188, "mean_inference_ms": 0.25534828288421485, "mean_action_processing_ms": 0.06164141519880781, "mean_env_wait_ms": 0.6127711086082681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002886533737182617, "StateBufferConnector_ms": 0.002058267593383789, "ViewRequirementAgentConnector_ms": 0.05141758918762207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314040, "num_agent_steps_trained": 314040, "num_env_steps_sampled": 314040, "num_env_steps_trained": 314040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 156.62324413240637, "num_env_steps_trained_throughput_per_sec": 156.62324413240637, "timesteps_total": 314040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 314040, "timers": {"training_iteration_time_ms": 2293.459, "sample_time_ms": 2285.076, "load_time_ms": 0.243, "load_throughput": 1483250.923, "learn_time_ms": 7.497, "learn_throughput": 48017.523, "synch_weights_time_ms": 0.602}, "counters": {"num_env_steps_sampled": 314040, "num_env_steps_trained": 314040, "num_agent_steps_sampled": 314040, "num_agent_steps_trained": 314040}, "done": false, "episodes_total": 1353, "training_iteration": 257, "trial_id": "71c6f_00000", "date": "2023-08-04_10-25-00", "timestamp": 1691133900, "time_this_iter_s": 11.495096683502197, "time_total_s": 2830.6545827388763, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1100.8238558769226, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 26.35625, "ram_util_percent": 66.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2667297363281, "policy_loss": 310762.153125, "vf_loss": 20730419.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2718.0, "diff_num_grad_updates_vs_sampler_policy": 2717.0}}, "num_env_steps_sampled": 315840, "num_env_steps_trained": 315840, "num_agent_steps_sampled": 315840, "num_agent_steps_trained": 315840}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.16054802622, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.645537776041235, "mean_inference_ms": 0.25566610596839656, "mean_action_processing_ms": 0.06172159789713829, "mean_env_wait_ms": 0.6132569252603236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028982162475585938, "StateBufferConnector_ms": 0.002062559127807617, "ViewRequirementAgentConnector_ms": 0.051572322845458984}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.16054802622, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.359128093588, -3526.9427148058985, -3526.122095560016, -3526.2452510797266, -3527.319078236563, -3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.645537776041235, "mean_inference_ms": 0.25566610596839656, "mean_action_processing_ms": 0.06172159789713829, "mean_env_wait_ms": 0.6132569252603236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028982162475585938, "StateBufferConnector_ms": 0.002062559127807617, "ViewRequirementAgentConnector_ms": 0.051572322845458984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315840, "num_agent_steps_trained": 315840, "num_env_steps_sampled": 315840, "num_env_steps_trained": 315840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.2900896729286, "num_env_steps_trained_throughput_per_sec": 154.2900896729286, "timesteps_total": 315840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 315840, "timers": {"training_iteration_time_ms": 2315.877, "sample_time_ms": 2307.507, "load_time_ms": 0.244, "load_throughput": 1474128.127, "learn_time_ms": 7.496, "learn_throughput": 48023.479, "synch_weights_time_ms": 0.593}, "counters": {"num_env_steps_sampled": 315840, "num_env_steps_trained": 315840, "num_agent_steps_sampled": 315840, "num_agent_steps_trained": 315840}, "done": false, "episodes_total": 1358, "training_iteration": 258, "trial_id": "71c6f_00000", "date": "2023-08-04_10-25-11", "timestamp": 1691133911, "time_this_iter_s": 11.668532848358154, "time_total_s": 2842.3231155872345, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1112.4923887252808, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 26.805882352941175, "ram_util_percent": 66.81176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3671447753906, "policy_loss": -4964191.66875, "vf_loss": 20739168.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2743.0, "diff_num_grad_updates_vs_sampler_policy": 2742.0}}, "num_env_steps_sampled": 317640, "num_env_steps_trained": 317640, "num_agent_steps_sampled": 317640, "num_agent_steps_trained": 317640}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.2372532259888, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6516980803571935, "mean_inference_ms": 0.2559785520541855, "mean_action_processing_ms": 0.06180004151186758, "mean_env_wait_ms": 0.6137375596499983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002895832061767578, "StateBufferConnector_ms": 0.002060413360595703, "ViewRequirementAgentConnector_ms": 0.05166769027709961}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.2372532259888, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.0289173610468, -3526.6535926563643, -3526.6134199631433, -3527.283871869082, -3526.713432402099, -3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6516980803571935, "mean_inference_ms": 0.2559785520541855, "mean_action_processing_ms": 0.06180004151186758, "mean_env_wait_ms": 0.6137375596499983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002895832061767578, "StateBufferConnector_ms": 0.002060413360595703, "ViewRequirementAgentConnector_ms": 0.05166769027709961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317640, "num_agent_steps_trained": 317640, "num_env_steps_sampled": 317640, "num_env_steps_trained": 317640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.46738603544364, "num_env_steps_trained_throughput_per_sec": 161.46738603544364, "timesteps_total": 317640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 317640, "timers": {"training_iteration_time_ms": 2281.399, "sample_time_ms": 2273.202, "load_time_ms": 0.241, "load_throughput": 1494999.446, "learn_time_ms": 7.356, "learn_throughput": 48942.655, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 317640, "num_env_steps_trained": 317640, "num_agent_steps_sampled": 317640, "num_agent_steps_trained": 317640}, "done": false, "episodes_total": 1363, "training_iteration": 259, "trial_id": "71c6f_00000", "date": "2023-08-04_10-25-22", "timestamp": 1691133922, "time_this_iter_s": 11.150348901748657, "time_total_s": 2853.473464488983, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1123.6427376270294, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 24.500000000000004, "ram_util_percent": 66.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.5198608398438, "policy_loss": -11003149.01875, "vf_loss": 20761695.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2768.0, "diff_num_grad_updates_vs_sampler_policy": 2767.0}}, "num_env_steps_sampled": 319440, "num_env_steps_trained": 319440, "num_agent_steps_sampled": 319440, "num_agent_steps_trained": 319440}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.236276793063, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.658031097770391, "mean_inference_ms": 0.25630522384399557, "mean_action_processing_ms": 0.06188141306071757, "mean_env_wait_ms": 0.6142505665642003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029561519622802734, "StateBufferConnector_ms": 0.0021071434020996094, "ViewRequirementAgentConnector_ms": 0.0522463321685791}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.236276793063, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.6142406183803, -3526.255804700766, -3527.8060693279044, -3527.5200738228345, -3527.485048531344, -3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.658031097770391, "mean_inference_ms": 0.25630522384399557, "mean_action_processing_ms": 0.06188141306071757, "mean_env_wait_ms": 0.6142505665642003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029561519622802734, "StateBufferConnector_ms": 0.0021071434020996094, "ViewRequirementAgentConnector_ms": 0.0522463321685791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319440, "num_agent_steps_trained": 319440, "num_env_steps_sampled": 319440, "num_env_steps_trained": 319440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 143.52784199728399, "num_env_steps_trained_throughput_per_sec": 143.52784199728399, "timesteps_total": 319440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 319440, "timers": {"training_iteration_time_ms": 2368.876, "sample_time_ms": 2360.224, "load_time_ms": 0.245, "load_throughput": 1468108.352, "learn_time_ms": 7.77, "learn_throughput": 46330.542, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 319440, "num_env_steps_trained": 319440, "num_agent_steps_sampled": 319440, "num_agent_steps_trained": 319440}, "done": false, "episodes_total": 1368, "training_iteration": 260, "trial_id": "71c6f_00000", "date": "2023-08-04_10-25-35", "timestamp": 1691133935, "time_this_iter_s": 12.544717073440552, "time_total_s": 2866.0181815624237, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1136.18745470047, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 29.0, "ram_util_percent": 66.77222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.27705078125, "policy_loss": -357382.525, "vf_loss": 20732566.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2793.0, "diff_num_grad_updates_vs_sampler_policy": 2792.0}}, "num_env_steps_sampled": 321240, "num_env_steps_trained": 321240, "num_agent_steps_sampled": 321240, "num_agent_steps_trained": 321240}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.2162458859793, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.664309368813252, "mean_inference_ms": 0.2566339818241579, "mean_action_processing_ms": 0.06196321114008576, "mean_env_wait_ms": 0.6147639333743518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029571056365966797, "StateBufferConnector_ms": 0.0021126270294189453, "ViewRequirementAgentConnector_ms": 0.05226707458496094}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3534.1035023464315, "episode_reward_mean": -3527.2162458859793, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.5607421095524, -3534.1035023464315, -3526.7457141070195, -3528.315546532783, -3526.8385714042593, -3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.664309368813252, "mean_inference_ms": 0.2566339818241579, "mean_action_processing_ms": 0.06196321114008576, "mean_env_wait_ms": 0.6147639333743518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029571056365966797, "StateBufferConnector_ms": 0.0021126270294189453, "ViewRequirementAgentConnector_ms": 0.05226707458496094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321240, "num_agent_steps_trained": 321240, "num_env_steps_sampled": 321240, "num_env_steps_trained": 321240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 152.27300175835825, "num_env_steps_trained_throughput_per_sec": 152.27300175835825, "timesteps_total": 321240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 321240, "timers": {"training_iteration_time_ms": 2436.186, "sample_time_ms": 2427.464, "load_time_ms": 0.252, "load_throughput": 1425825.722, "learn_time_ms": 7.816, "learn_throughput": 46062.007, "synch_weights_time_ms": 0.616}, "counters": {"num_env_steps_sampled": 321240, "num_env_steps_trained": 321240, "num_agent_steps_sampled": 321240, "num_agent_steps_trained": 321240}, "done": false, "episodes_total": 1373, "training_iteration": 261, "trial_id": "71c6f_00000", "date": "2023-08-04_10-25-47", "timestamp": 1691133947, "time_this_iter_s": 11.823207139968872, "time_total_s": 2877.8413887023926, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1148.0106618404388, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 26.270588235294117, "ram_util_percent": 66.80588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4497375488281, "policy_loss": -9510385.7875, "vf_loss": 20755759.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2818.0, "diff_num_grad_updates_vs_sampler_policy": 2817.0}}, "num_env_steps_sampled": 323040, "num_env_steps_trained": 323040, "num_agent_steps_sampled": 323040, "num_agent_steps_trained": 323040}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.163962498203, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.670615355954042, "mean_inference_ms": 0.25695981251915745, "mean_action_processing_ms": 0.0620443509798694, "mean_env_wait_ms": 0.6152786224706414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029647350311279297, "StateBufferConnector_ms": 0.0021178722381591797, "ViewRequirementAgentConnector_ms": 0.052420854568481445}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.163962498203, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.4484358043383, -3526.966860779049, -3526.085176292514, -3526.7454405259678, -3527.7752341896503, -3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.670615355954042, "mean_inference_ms": 0.25695981251915745, "mean_action_processing_ms": 0.0620443509798694, "mean_env_wait_ms": 0.6152786224706414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029647350311279297, "StateBufferConnector_ms": 0.0021178722381591797, "ViewRequirementAgentConnector_ms": 0.052420854568481445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323040, "num_agent_steps_trained": 323040, "num_env_steps_sampled": 323040, "num_env_steps_trained": 323040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.20776704585776, "num_env_steps_trained_throughput_per_sec": 155.20776704585776, "timesteps_total": 323040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 323040, "timers": {"training_iteration_time_ms": 2341.812, "sample_time_ms": 2333.699, "load_time_ms": 0.244, "load_throughput": 1475424.507, "learn_time_ms": 7.25, "learn_throughput": 49654.526, "synch_weights_time_ms": 0.583}, "counters": {"num_env_steps_sampled": 323040, "num_env_steps_trained": 323040, "num_agent_steps_sampled": 323040, "num_agent_steps_trained": 323040}, "done": false, "episodes_total": 1378, "training_iteration": 262, "trial_id": "71c6f_00000", "date": "2023-08-04_10-25-58", "timestamp": 1691133958, "time_this_iter_s": 11.599668264389038, "time_total_s": 2889.4410569667816, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1159.6103301048279, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 27.770588235294117, "ram_util_percent": 66.61176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.35203857421874, "policy_loss": -771243.30625, "vf_loss": 20744768.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2843.0, "diff_num_grad_updates_vs_sampler_policy": 2842.0}}, "num_env_steps_sampled": 324840, "num_env_steps_trained": 324840, "num_agent_steps_sampled": 324840, "num_agent_steps_trained": 324840}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1652548862544, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6769138909219885, "mean_inference_ms": 0.2572756846127328, "mean_action_processing_ms": 0.06212307674482889, "mean_env_wait_ms": 0.6157800454129485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002966642379760742, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.05245518684387207}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1652548862544, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3381155145335, -3526.916037141601, -3527.01905222572, -3526.9479155151575, -3527.426839012814, -3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6769138909219885, "mean_inference_ms": 0.2572756846127328, "mean_action_processing_ms": 0.06212307674482889, "mean_env_wait_ms": 0.6157800454129485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002966642379760742, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.05245518684387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324840, "num_agent_steps_trained": 324840, "num_env_steps_sampled": 324840, "num_env_steps_trained": 324840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.85048572173284, "num_env_steps_trained_throughput_per_sec": 154.85048572173284, "timesteps_total": 324840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 324840, "timers": {"training_iteration_time_ms": 2322.136, "sample_time_ms": 2314.242, "load_time_ms": 0.233, "load_throughput": 1541866.068, "learn_time_ms": 7.061, "learn_throughput": 50985.451, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 324840, "num_env_steps_trained": 324840, "num_agent_steps_sampled": 324840, "num_agent_steps_trained": 324840}, "done": false, "episodes_total": 1383, "training_iteration": 263, "trial_id": "71c6f_00000", "date": "2023-08-04_10-26-10", "timestamp": 1691133970, "time_this_iter_s": 11.626621961593628, "time_total_s": 2901.0676789283752, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1171.2369520664215, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 28.3125, "ram_util_percent": 66.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.5894409179688, "policy_loss": -6231652.24375, "vf_loss": 20757848.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2868.0, "diff_num_grad_updates_vs_sampler_policy": 2867.0}}, "num_env_steps_sampled": 326640, "num_env_steps_trained": 326640, "num_agent_steps_sampled": 326640, "num_agent_steps_trained": 326640}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1773955251574, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.683055874905278, "mean_inference_ms": 0.2575863427205535, "mean_action_processing_ms": 0.062200435545546086, "mean_env_wait_ms": 0.6162771511260027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002992391586303711, "StateBufferConnector_ms": 0.002126932144165039, "ViewRequirementAgentConnector_ms": 0.05263066291809082}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1773955251574, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.2840225784175, -3526.48329010414, -3526.4872304935375, -3526.9578711998156, -3528.074919416885, -3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.683055874905278, "mean_inference_ms": 0.2575863427205535, "mean_action_processing_ms": 0.062200435545546086, "mean_env_wait_ms": 0.6162771511260027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002992391586303711, "StateBufferConnector_ms": 0.002126932144165039, "ViewRequirementAgentConnector_ms": 0.05263066291809082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326640, "num_agent_steps_trained": 326640, "num_env_steps_sampled": 326640, "num_env_steps_trained": 326640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.27285815160957, "num_env_steps_trained_throughput_per_sec": 157.27285815160957, "timesteps_total": 326640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 326640, "timers": {"training_iteration_time_ms": 2306.908, "sample_time_ms": 2298.818, "load_time_ms": 0.238, "load_throughput": 1511007.145, "learn_time_ms": 7.256, "learn_throughput": 49616.998, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 326640, "num_env_steps_trained": 326640, "num_agent_steps_sampled": 326640, "num_agent_steps_trained": 326640}, "done": false, "episodes_total": 1388, "training_iteration": 264, "trial_id": "71c6f_00000", "date": "2023-08-04_10-26-22", "timestamp": 1691133982, "time_this_iter_s": 11.447808027267456, "time_total_s": 2912.5154869556427, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1182.684760093689, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 25.14375, "ram_util_percent": 66.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.26458129882815, "policy_loss": -3746024.6, "vf_loss": 20732239.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2893.0, "diff_num_grad_updates_vs_sampler_policy": 2892.0}}, "num_env_steps_sampled": 328440, "num_env_steps_trained": 328440, "num_agent_steps_sampled": 328440, "num_agent_steps_trained": 328440}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1529911691014, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.689262923615002, "mean_inference_ms": 0.2578963359518234, "mean_action_processing_ms": 0.06227766428558021, "mean_env_wait_ms": 0.6167697860590102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003008127212524414, "StateBufferConnector_ms": 0.002138376235961914, "ViewRequirementAgentConnector_ms": 0.05280900001525879}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1529911691014, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5704439503343, -3527.519623390114, -3525.7488194201665, -3526.499194394755, -3526.8878744167423, -3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.689262923615002, "mean_inference_ms": 0.2578963359518234, "mean_action_processing_ms": 0.06227766428558021, "mean_env_wait_ms": 0.6167697860590102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003008127212524414, "StateBufferConnector_ms": 0.002138376235961914, "ViewRequirementAgentConnector_ms": 0.05280900001525879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328440, "num_agent_steps_trained": 328440, "num_env_steps_sampled": 328440, "num_env_steps_trained": 328440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 148.9538120391698, "num_env_steps_trained_throughput_per_sec": 148.9538120391698, "timesteps_total": 328440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 328440, "timers": {"training_iteration_time_ms": 2352.925, "sample_time_ms": 2344.617, "load_time_ms": 0.246, "load_throughput": 1462987.54, "learn_time_ms": 7.434, "learn_throughput": 48423.442, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 328440, "num_env_steps_trained": 328440, "num_agent_steps_sampled": 328440, "num_agent_steps_trained": 328440}, "done": false, "episodes_total": 1393, "training_iteration": 265, "trial_id": "71c6f_00000", "date": "2023-08-04_10-26-34", "timestamp": 1691133994, "time_this_iter_s": 12.086811780929565, "time_total_s": 2924.6022987365723, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1194.7715718746185, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 28.41764705882353, "ram_util_percent": 66.55882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.33869018554685, "policy_loss": -3879739.875, "vf_loss": 20750403.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2918.0, "diff_num_grad_updates_vs_sampler_policy": 2917.0}}, "num_env_steps_sampled": 330240, "num_env_steps_trained": 330240, "num_agent_steps_sampled": 330240, "num_agent_steps_trained": 330240}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1750969258496, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.69545880985882, "mean_inference_ms": 0.25820208922839427, "mean_action_processing_ms": 0.06235420183624221, "mean_env_wait_ms": 0.6172683974686125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003039836883544922, "StateBufferConnector_ms": 0.0021538734436035156, "ViewRequirementAgentConnector_ms": 0.053156375885009766}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1750969258496, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.8987442665857, -3526.930703953084, -3527.7302305129692, -3526.712654717239, -3527.5600770676847, -3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.69545880985882, "mean_inference_ms": 0.25820208922839427, "mean_action_processing_ms": 0.06235420183624221, "mean_env_wait_ms": 0.6172683974686125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003039836883544922, "StateBufferConnector_ms": 0.0021538734436035156, "ViewRequirementAgentConnector_ms": 0.053156375885009766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 330240, "num_agent_steps_trained": 330240, "num_env_steps_sampled": 330240, "num_env_steps_trained": 330240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 151.9921492922918, "num_env_steps_trained_throughput_per_sec": 151.9921492922918, "timesteps_total": 330240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 330240, "timers": {"training_iteration_time_ms": 2392.688, "sample_time_ms": 2384.087, "load_time_ms": 0.255, "load_throughput": 1411827.433, "learn_time_ms": 7.697, "learn_throughput": 46773.147, "synch_weights_time_ms": 0.612}, "counters": {"num_env_steps_sampled": 330240, "num_env_steps_trained": 330240, "num_agent_steps_sampled": 330240, "num_agent_steps_trained": 330240}, "done": false, "episodes_total": 1398, "training_iteration": 266, "trial_id": "71c6f_00000", "date": "2023-08-04_10-26-46", "timestamp": 1691134006, "time_this_iter_s": 11.845338106155396, "time_total_s": 2936.4476368427277, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1206.616909980774, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 27.029411764705884, "ram_util_percent": 66.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.312939453125, "policy_loss": -1279602.63125, "vf_loss": 20735614.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2943.0, "diff_num_grad_updates_vs_sampler_policy": 2942.0}}, "num_env_steps_sampled": 332040, "num_env_steps_trained": 332040, "num_agent_steps_sampled": 332040, "num_agent_steps_trained": 332040}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1389524295378, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.701500978420509, "mean_inference_ms": 0.25850495668742757, "mean_action_processing_ms": 0.06242993516921243, "mean_env_wait_ms": 0.6177597655773148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003049612045288086, "StateBufferConnector_ms": 0.002167224884033203, "ViewRequirementAgentConnector_ms": 0.05329632759094238}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3533.3285311343475, "episode_reward_mean": -3527.1389524295378, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.823973606805, -3526.860205979997, -3528.6945750695304, -3526.97140023262, -3527.1231274364577, -3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.701500978420509, "mean_inference_ms": 0.25850495668742757, "mean_action_processing_ms": 0.06242993516921243, "mean_env_wait_ms": 0.6177597655773148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003049612045288086, "StateBufferConnector_ms": 0.002167224884033203, "ViewRequirementAgentConnector_ms": 0.05329632759094238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332040, "num_agent_steps_trained": 332040, "num_env_steps_sampled": 332040, "num_env_steps_trained": 332040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.7796730390871, "num_env_steps_trained_throughput_per_sec": 155.7796730390871, "timesteps_total": 332040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 332040, "timers": {"training_iteration_time_ms": 2339.739, "sample_time_ms": 2331.425, "load_time_ms": 0.247, "load_throughput": 1459029.317, "learn_time_ms": 7.461, "learn_throughput": 48250.445, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 332040, "num_env_steps_trained": 332040, "num_agent_steps_sampled": 332040, "num_agent_steps_trained": 332040}, "done": false, "episodes_total": 1403, "training_iteration": 267, "trial_id": "71c6f_00000", "date": "2023-08-04_10-26-57", "timestamp": 1691134017, "time_this_iter_s": 11.556885004043579, "time_total_s": 2948.0045218467712, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1218.1737949848175, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 25.917647058823526, "ram_util_percent": 66.32352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2797912597656, "policy_loss": -2152705.434375, "vf_loss": 20733827.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2968.0, "diff_num_grad_updates_vs_sampler_policy": 2967.0}}, "num_env_steps_sampled": 333840, "num_env_steps_trained": 333840, "num_agent_steps_sampled": 333840, "num_agent_steps_trained": 333840}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.230063611558, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.707517955069724, "mean_inference_ms": 0.2588068021230028, "mean_action_processing_ms": 0.06250529617532238, "mean_env_wait_ms": 0.6182598764809119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003049612045288086, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.05344200134277344}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.230063611558, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.337800254927, -3527.35181747027, -3526.52952406738, -3526.728530383129, -3527.2401602455743, -3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.707517955069724, "mean_inference_ms": 0.2588068021230028, "mean_action_processing_ms": 0.06250529617532238, "mean_env_wait_ms": 0.6182598764809119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003049612045288086, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.05344200134277344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 333840, "num_agent_steps_trained": 333840, "num_env_steps_sampled": 333840, "num_env_steps_trained": 333840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 148.90506733613998, "num_env_steps_trained_throughput_per_sec": 148.90506733613998, "timesteps_total": 333840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 333840, "timers": {"training_iteration_time_ms": 2364.291, "sample_time_ms": 2355.715, "load_time_ms": 0.249, "load_throughput": 1447420.859, "learn_time_ms": 7.677, "learn_throughput": 46890.801, "synch_weights_time_ms": 0.611}, "counters": {"num_env_steps_sampled": 333840, "num_env_steps_trained": 333840, "num_agent_steps_sampled": 333840, "num_agent_steps_trained": 333840}, "done": false, "episodes_total": 1408, "training_iteration": 268, "trial_id": "71c6f_00000", "date": "2023-08-04_10-27-09", "timestamp": 1691134029, "time_this_iter_s": 12.09079623222351, "time_total_s": 2960.0953180789948, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1230.264591217041, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 27.564705882352943, "ram_util_percent": 66.31764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3354797363281, "policy_loss": -915515.03125, "vf_loss": 20741789.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2993.0, "diff_num_grad_updates_vs_sampler_policy": 2992.0}}, "num_env_steps_sampled": 335640, "num_env_steps_trained": 335640, "num_agent_steps_sampled": 335640, "num_agent_steps_trained": 335640}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2113961498153, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.713373855662504, "mean_inference_ms": 0.25909981091085227, "mean_action_processing_ms": 0.0625784975066507, "mean_env_wait_ms": 0.6187422464242487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030486583709716797, "StateBufferConnector_ms": 0.0021631717681884766, "ViewRequirementAgentConnector_ms": 0.053415775299072266}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2113961498153, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.6324939456963, -3527.3310637198515, -3527.8708848949404, -3527.940591387494, -3526.148599236769, -3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.713373855662504, "mean_inference_ms": 0.25909981091085227, "mean_action_processing_ms": 0.0625784975066507, "mean_env_wait_ms": 0.6187422464242487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030486583709716797, "StateBufferConnector_ms": 0.0021631717681884766, "ViewRequirementAgentConnector_ms": 0.053415775299072266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 335640, "num_agent_steps_trained": 335640, "num_env_steps_sampled": 335640, "num_env_steps_trained": 335640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.199477949387, "num_env_steps_trained_throughput_per_sec": 158.199477949387, "timesteps_total": 335640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 335640, "timers": {"training_iteration_time_ms": 2346.616, "sample_time_ms": 2338.051, "load_time_ms": 0.25, "load_throughput": 1439555.191, "learn_time_ms": 7.662, "learn_throughput": 46988.129, "synch_weights_time_ms": 0.615}, "counters": {"num_env_steps_sampled": 335640, "num_env_steps_trained": 335640, "num_agent_steps_sampled": 335640, "num_agent_steps_trained": 335640}, "done": false, "episodes_total": 1413, "training_iteration": 269, "trial_id": "71c6f_00000", "date": "2023-08-04_10-27-21", "timestamp": 1691134041, "time_this_iter_s": 11.380056619644165, "time_total_s": 2971.475374698639, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1241.6446478366852, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 25.36875, "ram_util_percent": 66.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.46222534179685, "policy_loss": -7901073.375, "vf_loss": 20753204.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3018.0, "diff_num_grad_updates_vs_sampler_policy": 3017.0}}, "num_env_steps_sampled": 337440, "num_env_steps_trained": 337440, "num_agent_steps_sampled": 337440, "num_agent_steps_trained": 337440}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2835022279296, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.719185872524925, "mean_inference_ms": 0.25938618899507027, "mean_action_processing_ms": 0.06265014294774543, "mean_env_wait_ms": 0.619216592588327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030395984649658203, "StateBufferConnector_ms": 0.0021543502807617188, "ViewRequirementAgentConnector_ms": 0.05339360237121582}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2835022279296, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.109030024094, -3526.1522652757008, -3527.559826053824, -3526.3738790069647, -3529.2515292596913, -3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.719185872524925, "mean_inference_ms": 0.25938618899507027, "mean_action_processing_ms": 0.06265014294774543, "mean_env_wait_ms": 0.619216592588327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030395984649658203, "StateBufferConnector_ms": 0.0021543502807617188, "ViewRequirementAgentConnector_ms": 0.05339360237121582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337440, "num_agent_steps_trained": 337440, "num_env_steps_sampled": 337440, "num_env_steps_trained": 337440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.65464195780405, "num_env_steps_trained_throughput_per_sec": 154.65464195780405, "timesteps_total": 337440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 337440, "timers": {"training_iteration_time_ms": 2301.676, "sample_time_ms": 2293.608, "load_time_ms": 0.242, "load_throughput": 1488808.361, "learn_time_ms": 7.224, "learn_throughput": 49835.782, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 337440, "num_env_steps_trained": 337440, "num_agent_steps_sampled": 337440, "num_agent_steps_trained": 337440}, "done": false, "episodes_total": 1418, "training_iteration": 270, "trial_id": "71c6f_00000", "date": "2023-08-04_10-27-32", "timestamp": 1691134052, "time_this_iter_s": 11.64096188545227, "time_total_s": 2983.116336584091, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1253.2856097221375, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 28.1625, "ram_util_percent": 66.30625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4490234375, "policy_loss": -6282624.0375, "vf_loss": 20754163.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3043.0, "diff_num_grad_updates_vs_sampler_policy": 3042.0}}, "num_env_steps_sampled": 339240, "num_env_steps_trained": 339240, "num_agent_steps_sampled": 339240, "num_agent_steps_trained": 339240}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2762666470185, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.724841258827834, "mean_inference_ms": 0.2596762907195305, "mean_action_processing_ms": 0.06272259210369296, "mean_env_wait_ms": 0.6196923160171949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003038644790649414, "StateBufferConnector_ms": 0.0021562576293945312, "ViewRequirementAgentConnector_ms": 0.05348634719848633}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2762666470185, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.559279525252, -3526.855054467738, -3526.3636455398087, -3526.7112130441774, -3529.3106140043324, -3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.724841258827834, "mean_inference_ms": 0.2596762907195305, "mean_action_processing_ms": 0.06272259210369296, "mean_env_wait_ms": 0.6196923160171949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003038644790649414, "StateBufferConnector_ms": 0.0021562576293945312, "ViewRequirementAgentConnector_ms": 0.05348634719848633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 339240, "num_agent_steps_trained": 339240, "num_env_steps_sampled": 339240, "num_env_steps_trained": 339240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.5163689582307, "num_env_steps_trained_throughput_per_sec": 154.5163689582307, "timesteps_total": 339240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 339240, "timers": {"training_iteration_time_ms": 2328.798, "sample_time_ms": 2320.548, "load_time_ms": 0.242, "load_throughput": 1485439.685, "learn_time_ms": 7.399, "learn_throughput": 48657.819, "synch_weights_time_ms": 0.573}, "counters": {"num_env_steps_sampled": 339240, "num_env_steps_trained": 339240, "num_agent_steps_sampled": 339240, "num_agent_steps_trained": 339240}, "done": false, "episodes_total": 1423, "training_iteration": 271, "trial_id": "71c6f_00000", "date": "2023-08-04_10-27-44", "timestamp": 1691134064, "time_this_iter_s": 11.651476860046387, "time_total_s": 2994.7678134441376, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1264.9370865821838, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 25.776470588235295, "ram_util_percent": 66.33529411764708}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3403686523437, "policy_loss": -3249562.9, "vf_loss": 20741597.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3068.0, "diff_num_grad_updates_vs_sampler_policy": 3067.0}}, "num_env_steps_sampled": 341040, "num_env_steps_trained": 341040, "num_agent_steps_sampled": 341040, "num_agent_steps_trained": 341040}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2643326602183, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.730530034545138, "mean_inference_ms": 0.259966277031441, "mean_action_processing_ms": 0.06279518384351689, "mean_env_wait_ms": 0.6201651910634971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003040313720703125, "StateBufferConnector_ms": 0.002143383026123047, "ViewRequirementAgentConnector_ms": 0.05357527732849121}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2643326602183, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.711685324369, -3526.2380825133314, -3527.1532266116974, -3526.778305853402, -3526.465591216739, -3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.730530034545138, "mean_inference_ms": 0.259966277031441, "mean_action_processing_ms": 0.06279518384351689, "mean_env_wait_ms": 0.6201651910634971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003040313720703125, "StateBufferConnector_ms": 0.002143383026123047, "ViewRequirementAgentConnector_ms": 0.05357527732849121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 341040, "num_agent_steps_trained": 341040, "num_env_steps_sampled": 341040, "num_env_steps_trained": 341040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 150.68275344410438, "num_env_steps_trained_throughput_per_sec": 150.68275344410438, "timesteps_total": 341040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 341040, "timers": {"training_iteration_time_ms": 2359.477, "sample_time_ms": 2351.121, "load_time_ms": 0.245, "load_throughput": 1466682.312, "learn_time_ms": 7.489, "learn_throughput": 48067.814, "synch_weights_time_ms": 0.584}, "counters": {"num_env_steps_sampled": 341040, "num_env_steps_trained": 341040, "num_agent_steps_sampled": 341040, "num_agent_steps_trained": 341040}, "done": false, "episodes_total": 1428, "training_iteration": 272, "trial_id": "71c6f_00000", "date": "2023-08-04_10-27-56", "timestamp": 1691134076, "time_this_iter_s": 11.947643756866455, "time_total_s": 3006.715457201004, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1276.8847303390503, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 27.905882352941177, "ram_util_percent": 66.47058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4810363769531, "policy_loss": -2513300.96875, "vf_loss": 20751741.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3093.0, "diff_num_grad_updates_vs_sampler_policy": 3092.0}}, "num_env_steps_sampled": 342840, "num_env_steps_trained": 342840, "num_agent_steps_sampled": 342840, "num_agent_steps_trained": 342840}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.280735815734, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7363935605194145, "mean_inference_ms": 0.26026945452078193, "mean_action_processing_ms": 0.06287095971576846, "mean_env_wait_ms": 0.6206714583582037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003062725067138672, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.05402803421020508}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.280735815734, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.890343176665, -3527.282882143075, -3525.632429431151, -3526.970294697089, -3530.071473891521, -3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7363935605194145, "mean_inference_ms": 0.26026945452078193, "mean_action_processing_ms": 0.06287095971576846, "mean_env_wait_ms": 0.6206714583582037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003062725067138672, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.05402803421020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342840, "num_agent_steps_trained": 342840, "num_env_steps_sampled": 342840, "num_env_steps_trained": 342840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 150.57090020799822, "num_env_steps_trained_throughput_per_sec": 150.57090020799822, "timesteps_total": 342840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 342840, "timers": {"training_iteration_time_ms": 2390.002, "sample_time_ms": 2381.566, "load_time_ms": 0.25, "load_throughput": 1439280.755, "learn_time_ms": 7.558, "learn_throughput": 47632.174, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 342840, "num_env_steps_trained": 342840, "num_agent_steps_sampled": 342840, "num_agent_steps_trained": 342840}, "done": false, "episodes_total": 1433, "training_iteration": 273, "trial_id": "71c6f_00000", "date": "2023-08-04_10-28-08", "timestamp": 1691134088, "time_this_iter_s": 11.956575870513916, "time_total_s": 3018.672033071518, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1288.8413062095642, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 26.758823529411764, "ram_util_percent": 66.63529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.41356201171874, "policy_loss": -1859424.084375, "vf_loss": 20754980.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3118.0, "diff_num_grad_updates_vs_sampler_policy": 3117.0}}, "num_env_steps_sampled": 344640, "num_env_steps_trained": 344640, "num_agent_steps_sampled": 344640, "num_agent_steps_trained": 344640}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2765425964144, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.742253668649835, "mean_inference_ms": 0.26057095605880926, "mean_action_processing_ms": 0.06294618206087504, "mean_env_wait_ms": 0.621175514900116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030612945556640625, "StateBufferConnector_ms": 0.0021622180938720703, "ViewRequirementAgentConnector_ms": 0.0540921688079834}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2765425964144, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5243743902306, -3526.3073798229557, -3527.148763144549, -3526.1887222031637, -3527.16794079891, -3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.742253668649835, "mean_inference_ms": 0.26057095605880926, "mean_action_processing_ms": 0.06294618206087504, "mean_env_wait_ms": 0.621175514900116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030612945556640625, "StateBufferConnector_ms": 0.0021622180938720703, "ViewRequirementAgentConnector_ms": 0.0540921688079834}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344640, "num_agent_steps_trained": 344640, "num_env_steps_sampled": 344640, "num_env_steps_trained": 344640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 156.15215951086293, "num_env_steps_trained_throughput_per_sec": 156.15215951086293, "timesteps_total": 344640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 344640, "timers": {"training_iteration_time_ms": 2348.159, "sample_time_ms": 2339.812, "load_time_ms": 0.246, "load_throughput": 1466112.671, "learn_time_ms": 7.491, "learn_throughput": 48060.317, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 344640, "num_env_steps_trained": 344640, "num_agent_steps_sampled": 344640, "num_agent_steps_trained": 344640}, "done": false, "episodes_total": 1438, "training_iteration": 274, "trial_id": "71c6f_00000", "date": "2023-08-04_10-28-19", "timestamp": 1691134099, "time_this_iter_s": 11.529419898986816, "time_total_s": 3030.2014529705048, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1300.370726108551, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 24.3625, "ram_util_percent": 66.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2805236816406, "policy_loss": 83913.396875, "vf_loss": 20742915.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3143.0, "diff_num_grad_updates_vs_sampler_policy": 3142.0}}, "num_env_steps_sampled": 346440, "num_env_steps_trained": 346440, "num_agent_steps_sampled": 346440, "num_agent_steps_trained": 346440}, "sampler_results": {"episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2978035021406, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.748104252517963, "mean_inference_ms": 0.2608562614727264, "mean_action_processing_ms": 0.06301715702031079, "mean_env_wait_ms": 0.6216507084713102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030329227447509766, "StateBufferConnector_ms": 0.0021538734436035156, "ViewRequirementAgentConnector_ms": 0.053801536560058594}}, "episode_reward_max": -3525.529024706111, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2978035021406, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.4787734647734, -3528.3993336828307, -3525.529024706111, -3528.7792582288525, -3527.366011006549, -3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.748104252517963, "mean_inference_ms": 0.2608562614727264, "mean_action_processing_ms": 0.06301715702031079, "mean_env_wait_ms": 0.6216507084713102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030329227447509766, "StateBufferConnector_ms": 0.0021538734436035156, "ViewRequirementAgentConnector_ms": 0.053801536560058594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 346440, "num_agent_steps_trained": 346440, "num_env_steps_sampled": 346440, "num_env_steps_trained": 346440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.14590833650618, "num_env_steps_trained_throughput_per_sec": 154.14590833650618, "timesteps_total": 346440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 346440, "timers": {"training_iteration_time_ms": 2320.434, "sample_time_ms": 2312.075, "load_time_ms": 0.244, "load_throughput": 1473696.506, "learn_time_ms": 7.495, "learn_throughput": 48028.979, "synch_weights_time_ms": 0.582}, "counters": {"num_env_steps_sampled": 346440, "num_env_steps_trained": 346440, "num_agent_steps_sampled": 346440, "num_agent_steps_trained": 346440}, "done": false, "episodes_total": 1443, "training_iteration": 275, "trial_id": "71c6f_00000", "date": "2023-08-04_10-28-31", "timestamp": 1691134111, "time_this_iter_s": 11.679502248764038, "time_total_s": 3041.880955219269, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1312.050228357315, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 24.51764705882353, "ram_util_percent": 66.54117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.44548950195315, "policy_loss": -1029472.89375, "vf_loss": 20740478.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3168.0, "diff_num_grad_updates_vs_sampler_policy": 3167.0}}, "num_env_steps_sampled": 348240, "num_env_steps_trained": 348240, "num_agent_steps_sampled": 348240, "num_agent_steps_trained": 348240}, "sampler_results": {"episode_reward_max": -3525.63208587563, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.295635653333, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.753976434150439, "mean_inference_ms": 0.26114563887279113, "mean_action_processing_ms": 0.06308918448912802, "mean_env_wait_ms": 0.6221393284681125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003042936325073242, "StateBufferConnector_ms": 0.0021674633026123047, "ViewRequirementAgentConnector_ms": 0.0541071891784668}}, "episode_reward_max": -3525.63208587563, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.295635653333, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3111850544055, -3526.3063576711747, -3528.0700230959624, -3528.28045977512, -3526.8140297859773, -3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.753976434150439, "mean_inference_ms": 0.26114563887279113, "mean_action_processing_ms": 0.06308918448912802, "mean_env_wait_ms": 0.6221393284681125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003042936325073242, "StateBufferConnector_ms": 0.0021674633026123047, "ViewRequirementAgentConnector_ms": 0.0541071891784668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348240, "num_agent_steps_trained": 348240, "num_env_steps_sampled": 348240, "num_env_steps_trained": 348240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 148.7314564817576, "num_env_steps_trained_throughput_per_sec": 148.7314564817576, "timesteps_total": 348240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 348240, "timers": {"training_iteration_time_ms": 2377.948, "sample_time_ms": 2369.608, "load_time_ms": 0.245, "load_throughput": 1469680.202, "learn_time_ms": 7.476, "learn_throughput": 48156.115, "synch_weights_time_ms": 0.583}, "counters": {"num_env_steps_sampled": 348240, "num_env_steps_trained": 348240, "num_agent_steps_sampled": 348240, "num_agent_steps_trained": 348240}, "done": false, "episodes_total": 1448, "training_iteration": 276, "trial_id": "71c6f_00000", "date": "2023-08-04_10-28-43", "timestamp": 1691134123, "time_this_iter_s": 12.10453987121582, "time_total_s": 3053.9854950904846, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1324.1547682285309, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 27.394117647058824, "ram_util_percent": 66.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4204467773437, "policy_loss": -9355584.95625, "vf_loss": 20742038.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3193.0, "diff_num_grad_updates_vs_sampler_policy": 3192.0}}, "num_env_steps_sampled": 350040, "num_env_steps_trained": 350040, "num_agent_steps_sampled": 350040, "num_agent_steps_trained": 350040}, "sampler_results": {"episode_reward_max": -3525.63208587563, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.267920249371, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7598846079703465, "mean_inference_ms": 0.26144130412827965, "mean_action_processing_ms": 0.06316286907039655, "mean_env_wait_ms": 0.6226417358471784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030608177185058594, "StateBufferConnector_ms": 0.0021827220916748047, "ViewRequirementAgentConnector_ms": 0.05444908142089844}}, "episode_reward_max": -3525.63208587563, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.267920249371, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.8553218293473, -3525.9438474415037, -3528.342801459517, -3528.996873190223, -3525.6773004651814, -3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7598846079703465, "mean_inference_ms": 0.26144130412827965, "mean_action_processing_ms": 0.06316286907039655, "mean_env_wait_ms": 0.6226417358471784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030608177185058594, "StateBufferConnector_ms": 0.0021827220916748047, "ViewRequirementAgentConnector_ms": 0.05444908142089844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 350040, "num_agent_steps_trained": 350040, "num_env_steps_sampled": 350040, "num_env_steps_trained": 350040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 147.04512662207162, "num_env_steps_trained_throughput_per_sec": 147.04512662207162, "timesteps_total": 350040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 350040, "timers": {"training_iteration_time_ms": 2434.337, "sample_time_ms": 2425.813, "load_time_ms": 0.249, "load_throughput": 1443960.448, "learn_time_ms": 7.652, "learn_throughput": 47044.199, "synch_weights_time_ms": 0.585}, "counters": {"num_env_steps_sampled": 350040, "num_env_steps_trained": 350040, "num_agent_steps_sampled": 350040, "num_agent_steps_trained": 350040}, "done": false, "episodes_total": 1453, "training_iteration": 277, "trial_id": "71c6f_00000", "date": "2023-08-04_10-28-55", "timestamp": 1691134135, "time_this_iter_s": 12.2433340549469, "time_total_s": 3066.2288291454315, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1336.3981022834778, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 31.41764705882353, "ram_util_percent": 66.38235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4869079589844, "policy_loss": -13226105.31875, "vf_loss": 20782671.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3218.0, "diff_num_grad_updates_vs_sampler_policy": 3217.0}}, "num_env_steps_sampled": 351840, "num_env_steps_trained": 351840, "num_agent_steps_sampled": 351840, "num_agent_steps_trained": 351840}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.25838882379, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.765812592190507, "mean_inference_ms": 0.2617315685565711, "mean_action_processing_ms": 0.06323537491272294, "mean_env_wait_ms": 0.6231290978670648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030405521392822266, "StateBufferConnector_ms": 0.0021708011627197266, "ViewRequirementAgentConnector_ms": 0.054143667221069336}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.25838882379, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3533.3285311343475, -3526.3780821193677, -3525.9566652850726, -3528.530417408952, -3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.765812592190507, "mean_inference_ms": 0.2617315685565711, "mean_action_processing_ms": 0.06323537491272294, "mean_env_wait_ms": 0.6231290978670648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030405521392822266, "StateBufferConnector_ms": 0.0021708011627197266, "ViewRequirementAgentConnector_ms": 0.054143667221069336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 351840, "num_agent_steps_trained": 351840, "num_env_steps_sampled": 351840, "num_env_steps_trained": 351840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 147.84575548528568, "num_env_steps_trained_throughput_per_sec": 147.84575548528568, "timesteps_total": 351840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 351840, "timers": {"training_iteration_time_ms": 2441.587, "sample_time_ms": 2432.735, "load_time_ms": 0.257, "load_throughput": 1398619.34, "learn_time_ms": 7.947, "learn_throughput": 45301.111, "synch_weights_time_ms": 0.608}, "counters": {"num_env_steps_sampled": 351840, "num_env_steps_trained": 351840, "num_agent_steps_sampled": 351840, "num_agent_steps_trained": 351840}, "done": false, "episodes_total": 1458, "training_iteration": 278, "trial_id": "71c6f_00000", "date": "2023-08-04_10-29-08", "timestamp": 1691134148, "time_this_iter_s": 12.177045106887817, "time_total_s": 3078.4058742523193, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1348.5751473903656, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 32.14705882352941, "ram_util_percent": 66.34117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4555358886719, "policy_loss": -4365863.31875, "vf_loss": 20752947.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3238.0, "diff_num_grad_updates_vs_sampler_policy": 3237.0}}, "num_env_steps_sampled": 353280, "num_env_steps_trained": 353280, "num_agent_steps_sampled": 353280, "num_agent_steps_trained": 353280}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2107886224576, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.770645433027866, "mean_inference_ms": 0.26196219262907644, "mean_action_processing_ms": 0.06329303674322193, "mean_env_wait_ms": 0.6235227382515178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030536651611328125, "StateBufferConnector_ms": 0.002175569534301758, "ViewRequirementAgentConnector_ms": 0.054344892501831055}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2107886224576, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.46509180494, -3526.8658674981057, -3525.825424315171, -3527.017795827684, -3526.2758419047955, -3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.770645433027866, "mean_inference_ms": 0.26196219262907644, "mean_action_processing_ms": 0.06329303674322193, "mean_env_wait_ms": 0.6235227382515178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030536651611328125, "StateBufferConnector_ms": 0.002175569534301758, "ViewRequirementAgentConnector_ms": 0.054344892501831055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 353280, "num_agent_steps_trained": 353280, "num_env_steps_sampled": 353280, "num_env_steps_trained": 353280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 143.98852706772183, "num_env_steps_trained_throughput_per_sec": 143.98852706772183, "timesteps_total": 353280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 353280, "timers": {"training_iteration_time_ms": 2516.962, "sample_time_ms": 2508.437, "load_time_ms": 0.251, "load_throughput": 1431774.55, "learn_time_ms": 7.647, "learn_throughput": 47077.495, "synch_weights_time_ms": 0.59}, "counters": {"num_env_steps_sampled": 353280, "num_env_steps_trained": 353280, "num_agent_steps_sampled": 353280, "num_agent_steps_trained": 353280}, "done": false, "episodes_total": 1462, "training_iteration": 279, "trial_id": "71c6f_00000", "date": "2023-08-04_10-29-18", "timestamp": 1691134158, "time_this_iter_s": 10.003152847290039, "time_total_s": 3088.4090270996094, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1358.5783002376556, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 26.178571428571427, "ram_util_percent": 66.32142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.48157958984376, "policy_loss": -11763144.44375, "vf_loss": 20756237.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3263.0, "diff_num_grad_updates_vs_sampler_policy": 3262.0}}, "num_env_steps_sampled": 355080, "num_env_steps_trained": 355080, "num_agent_steps_sampled": 355080, "num_agent_steps_trained": 355080}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.283355936128, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.776656391299383, "mean_inference_ms": 0.26224521866693534, "mean_action_processing_ms": 0.06336408973683946, "mean_env_wait_ms": 0.6240140059632171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030455589294433594, "StateBufferConnector_ms": 0.002176046371459961, "ViewRequirementAgentConnector_ms": 0.054257869720458984}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.283355936128, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.2106614132463, -3527.5825737505565, -3526.068587470933, -3527.143642527881, -3526.927980046964, -3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.776656391299383, "mean_inference_ms": 0.26224521866693534, "mean_action_processing_ms": 0.06336408973683946, "mean_env_wait_ms": 0.6240140059632171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030455589294433594, "StateBufferConnector_ms": 0.002176046371459961, "ViewRequirementAgentConnector_ms": 0.054257869720458984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 355080, "num_agent_steps_trained": 355080, "num_env_steps_sampled": 355080, "num_env_steps_trained": 355080, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 144.11688220879364, "num_env_steps_trained_throughput_per_sec": 144.11688220879364, "timesteps_total": 355080, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 355080, "timers": {"training_iteration_time_ms": 2514.383, "sample_time_ms": 2505.366, "load_time_ms": 0.267, "load_throughput": 1346606.118, "learn_time_ms": 8.086, "learn_throughput": 44523.682, "synch_weights_time_ms": 0.625}, "counters": {"num_env_steps_sampled": 355080, "num_env_steps_trained": 355080, "num_agent_steps_sampled": 355080, "num_agent_steps_trained": 355080}, "done": false, "episodes_total": 1467, "training_iteration": 280, "trial_id": "71c6f_00000", "date": "2023-08-04_10-29-30", "timestamp": 1691134170, "time_this_iter_s": 12.493098974227905, "time_total_s": 3100.9021260738373, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1371.0713992118835, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 27.811111111111114, "ram_util_percent": 66.4388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3644714355469, "policy_loss": -1771820.5875, "vf_loss": 20739919.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3288.0, "diff_num_grad_updates_vs_sampler_policy": 3287.0}}, "num_env_steps_sampled": 356880, "num_env_steps_trained": 356880, "num_agent_steps_sampled": 356880, "num_agent_steps_trained": 356880}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2916589048773, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.782814486097119, "mean_inference_ms": 0.26251621031201056, "mean_action_processing_ms": 0.06343250524825693, "mean_env_wait_ms": 0.6244940835816908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002986431121826172, "StateBufferConnector_ms": 0.0021266937255859375, "ViewRequirementAgentConnector_ms": 0.0537874698638916}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.2916589048773, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.95536249665, -3528.2812397553494, -3528.5677137474477, -3525.940883435587, -3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.782814486097119, "mean_inference_ms": 0.26251621031201056, "mean_action_processing_ms": 0.06343250524825693, "mean_env_wait_ms": 0.6244940835816908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002986431121826172, "StateBufferConnector_ms": 0.0021266937255859375, "ViewRequirementAgentConnector_ms": 0.0537874698638916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356880, "num_agent_steps_trained": 356880, "num_env_steps_sampled": 356880, "num_env_steps_trained": 356880, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 137.44525786240052, "num_env_steps_trained_throughput_per_sec": 137.44525786240052, "timesteps_total": 356880, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 356880, "timers": {"training_iteration_time_ms": 2558.585, "sample_time_ms": 2549.106, "load_time_ms": 0.276, "load_throughput": 1305958.692, "learn_time_ms": 8.512, "learn_throughput": 42291.593, "synch_weights_time_ms": 0.651}, "counters": {"num_env_steps_sampled": 356880, "num_env_steps_trained": 356880, "num_agent_steps_sampled": 356880, "num_agent_steps_trained": 356880}, "done": false, "episodes_total": 1472, "training_iteration": 281, "trial_id": "71c6f_00000", "date": "2023-08-04_10-29-43", "timestamp": 1691134183, "time_this_iter_s": 13.098634004592896, "time_total_s": 3114.00076007843, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1384.1700332164764, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 27.49473684210527, "ram_util_percent": 66.55263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.43499145507815, "policy_loss": -5083690.56875, "vf_loss": 20751420.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 3307.0}}, "num_env_steps_sampled": 358320, "num_env_steps_trained": 358320, "num_agent_steps_sampled": 358320, "num_agent_steps_trained": 358320}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3162554009555, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.787851418477564, "mean_inference_ms": 0.2627318334715831, "mean_action_processing_ms": 0.06348686847155703, "mean_env_wait_ms": 0.6248775927589577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029866695404052734, "StateBufferConnector_ms": 0.002128124237060547, "ViewRequirementAgentConnector_ms": 0.05369853973388672}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3162554009555, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.868253125641, -3527.677647658408, -3526.947045197386, -3527.645220711325, -3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.787851418477564, "mean_inference_ms": 0.2627318334715831, "mean_action_processing_ms": 0.06348686847155703, "mean_env_wait_ms": 0.6248775927589577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029866695404052734, "StateBufferConnector_ms": 0.002128124237060547, "ViewRequirementAgentConnector_ms": 0.05369853973388672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 358320, "num_agent_steps_trained": 358320, "num_env_steps_sampled": 358320, "num_env_steps_trained": 358320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 135.81010449318492, "num_env_steps_trained_throughput_per_sec": 135.81010449318492, "timesteps_total": 358320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 358320, "timers": {"training_iteration_time_ms": 2635.189, "sample_time_ms": 2626.054, "load_time_ms": 0.267, "load_throughput": 1346966.494, "learn_time_ms": 8.204, "learn_throughput": 43883.674, "synch_weights_time_ms": 0.625}, "counters": {"num_env_steps_sampled": 358320, "num_env_steps_trained": 358320, "num_agent_steps_sampled": 358320, "num_agent_steps_trained": 358320}, "done": false, "episodes_total": 1476, "training_iteration": 282, "trial_id": "71c6f_00000", "date": "2023-08-04_10-29-54", "timestamp": 1691134194, "time_this_iter_s": 10.605413913726807, "time_total_s": 3124.606173992157, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1394.7754471302032, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 25.07333333333333, "ram_util_percent": 66.55333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4776611328125, "policy_loss": -4831775.7625, "vf_loss": 20762253.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3328.0, "diff_num_grad_updates_vs_sampler_policy": 3327.0}}, "num_env_steps_sampled": 359760, "num_env_steps_trained": 359760, "num_agent_steps_sampled": 359760, "num_agent_steps_trained": 359760}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3222699562507, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.792998462222385, "mean_inference_ms": 0.26295557579984036, "mean_action_processing_ms": 0.06354322606382302, "mean_env_wait_ms": 0.6252816432202075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030066967010498047, "StateBufferConnector_ms": 0.0021440982818603516, "ViewRequirementAgentConnector_ms": 0.05405831336975098}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3222699562507, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.517205380118, -3527.390642379786, -3526.6502727280563, -3527.702286244635, -3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.792998462222385, "mean_inference_ms": 0.26295557579984036, "mean_action_processing_ms": 0.06354322606382302, "mean_env_wait_ms": 0.6252816432202075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030066967010498047, "StateBufferConnector_ms": 0.0021440982818603516, "ViewRequirementAgentConnector_ms": 0.05405831336975098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 359760, "num_agent_steps_trained": 359760, "num_env_steps_sampled": 359760, "num_env_steps_trained": 359760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 137.73090361498947, "num_env_steps_trained_throughput_per_sec": 137.73090361498947, "timesteps_total": 359760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 359760, "timers": {"training_iteration_time_ms": 2644.445, "sample_time_ms": 2635.763, "load_time_ms": 0.255, "load_throughput": 1410508.585, "learn_time_ms": 7.782, "learn_throughput": 46262.548, "synch_weights_time_ms": 0.608}, "counters": {"num_env_steps_sampled": 359760, "num_env_steps_trained": 359760, "num_agent_steps_sampled": 359760, "num_agent_steps_trained": 359760}, "done": false, "episodes_total": 1480, "training_iteration": 283, "trial_id": "71c6f_00000", "date": "2023-08-04_10-30-04", "timestamp": 1691134204, "time_this_iter_s": 10.457374095916748, "time_total_s": 3135.0635480880737, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1405.23282122612, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 25.466666666666665, "ram_util_percent": 66.57333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.441650390625, "policy_loss": -8842790.896875, "vf_loss": 20742510.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3348.0, "diff_num_grad_updates_vs_sampler_policy": 3347.0}}, "num_env_steps_sampled": 361200, "num_env_steps_trained": 361200, "num_agent_steps_sampled": 361200, "num_agent_steps_trained": 361200}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3051499406597, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.798259798281614, "mean_inference_ms": 0.2631821330415503, "mean_action_processing_ms": 0.06360037974903279, "mean_env_wait_ms": 0.6256923959078973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003006458282470703, "StateBufferConnector_ms": 0.002137899398803711, "ViewRequirementAgentConnector_ms": 0.054032087326049805}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3051499406597, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.040674108261, -3526.2306298561907, -3526.4189582270465, -3528.469474863985, -3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.798259798281614, "mean_inference_ms": 0.2631821330415503, "mean_action_processing_ms": 0.06360037974903279, "mean_env_wait_ms": 0.6256923959078973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003006458282470703, "StateBufferConnector_ms": 0.002137899398803711, "ViewRequirementAgentConnector_ms": 0.054032087326049805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 361200, "num_agent_steps_trained": 361200, "num_env_steps_sampled": 361200, "num_env_steps_trained": 361200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 139.46442298149546, "num_env_steps_trained_throughput_per_sec": 139.46442298149546, "timesteps_total": 361200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 361200, "timers": {"training_iteration_time_ms": 2591.591, "sample_time_ms": 2582.726, "load_time_ms": 0.262, "load_throughput": 1373805.332, "learn_time_ms": 7.936, "learn_throughput": 45362.353, "synch_weights_time_ms": 0.629}, "counters": {"num_env_steps_sampled": 361200, "num_env_steps_trained": 361200, "num_agent_steps_sampled": 361200, "num_agent_steps_trained": 361200}, "done": false, "episodes_total": 1484, "training_iteration": 284, "trial_id": "71c6f_00000", "date": "2023-08-04_10-30-15", "timestamp": 1691134215, "time_this_iter_s": 10.328103065490723, "time_total_s": 3145.3916511535645, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1415.5609242916107, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 24.52142857142857, "ram_util_percent": 66.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.43760986328124, "policy_loss": -4416268.540625, "vf_loss": 20746572.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3368.0, "diff_num_grad_updates_vs_sampler_policy": 3367.0}}, "num_env_steps_sampled": 362640, "num_env_steps_trained": 362640, "num_agent_steps_sampled": 362640, "num_agent_steps_trained": 362640}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3014198069777, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8037604715018105, "mean_inference_ms": 0.26342046939057845, "mean_action_processing_ms": 0.06366078477579286, "mean_env_wait_ms": 0.6261291340756804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030062198638916016, "StateBufferConnector_ms": 0.0021600723266601562, "ViewRequirementAgentConnector_ms": 0.05442690849304199}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3014198069777, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.856439446504, -3526.586169644931, -3526.241404562718, -3526.3529857513176, -3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8037604715018105, "mean_inference_ms": 0.26342046939057845, "mean_action_processing_ms": 0.06366078477579286, "mean_env_wait_ms": 0.6261291340756804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030062198638916016, "StateBufferConnector_ms": 0.0021600723266601562, "ViewRequirementAgentConnector_ms": 0.05442690849304199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 362640, "num_agent_steps_trained": 362640, "num_env_steps_sampled": 362640, "num_env_steps_trained": 362640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 128.79927419605238, "num_env_steps_trained_throughput_per_sec": 128.79927419605238, "timesteps_total": 362640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 362640, "timers": {"training_iteration_time_ms": 2697.807, "sample_time_ms": 2688.381, "load_time_ms": 0.276, "load_throughput": 1302129.562, "learn_time_ms": 8.456, "learn_throughput": 42574.083, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 362640, "num_env_steps_trained": 362640, "num_agent_steps_sampled": 362640, "num_agent_steps_trained": 362640}, "done": false, "episodes_total": 1488, "training_iteration": 285, "trial_id": "71c6f_00000", "date": "2023-08-04_10-30-26", "timestamp": 1691134226, "time_this_iter_s": 11.183293104171753, "time_total_s": 3156.574944257736, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1426.7442173957825, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 27.8625, "ram_util_percent": 66.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3507995605469, "policy_loss": -3019573.221875, "vf_loss": 20750799.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3388.0, "diff_num_grad_updates_vs_sampler_policy": 3387.0}}, "num_env_steps_sampled": 364080, "num_env_steps_trained": 364080, "num_agent_steps_sampled": 364080, "num_agent_steps_trained": 364080}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3301833147184, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.809206360897213, "mean_inference_ms": 0.2636532673637829, "mean_action_processing_ms": 0.06372003674237826, "mean_env_wait_ms": 0.6265669384739142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030040740966796875, "StateBufferConnector_ms": 0.002156972885131836, "ViewRequirementAgentConnector_ms": 0.05448293685913086}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.3301833147184, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.8098987816916, -3526.6715366183757, -3527.7545748298894, -3527.329829938071, -3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.809206360897213, "mean_inference_ms": 0.2636532673637829, "mean_action_processing_ms": 0.06372003674237826, "mean_env_wait_ms": 0.6265669384739142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030040740966796875, "StateBufferConnector_ms": 0.002156972885131836, "ViewRequirementAgentConnector_ms": 0.05448293685913086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364080, "num_agent_steps_trained": 364080, "num_env_steps_sampled": 364080, "num_env_steps_trained": 364080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 141.35407650605583, "num_env_steps_trained_throughput_per_sec": 141.35407650605583, "timesteps_total": 364080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 364080, "timers": {"training_iteration_time_ms": 2664.472, "sample_time_ms": 2654.458, "load_time_ms": 0.291, "load_throughput": 1236649.828, "learn_time_ms": 8.992, "learn_throughput": 40036.629, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 364080, "num_env_steps_trained": 364080, "num_agent_steps_sampled": 364080, "num_agent_steps_trained": 364080}, "done": false, "episodes_total": 1492, "training_iteration": 286, "trial_id": "71c6f_00000", "date": "2023-08-04_10-30-36", "timestamp": 1691134236, "time_this_iter_s": 10.18960189819336, "time_total_s": 3166.7645461559296, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1436.9338192939758, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 22.773333333333333, "ram_util_percent": 66.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4779418945312, "policy_loss": -4719133.065625, "vf_loss": 20760031.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3408.0, "diff_num_grad_updates_vs_sampler_policy": 3407.0}}, "num_env_steps_sampled": 365520, "num_env_steps_trained": 365520, "num_agent_steps_sampled": 365520, "num_agent_steps_trained": 365520}, "sampler_results": {"episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.342851181594, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.814740872696216, "mean_inference_ms": 0.26389039902340244, "mean_action_processing_ms": 0.06378027774727105, "mean_env_wait_ms": 0.6270172745457372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030112266540527344, "StateBufferConnector_ms": 0.0021653175354003906, "ViewRequirementAgentConnector_ms": 0.05472755432128906}}, "episode_reward_max": -3525.6320469813472, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.342851181594, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.574449520046, -3527.106140340607, -3526.8235449418944, -3525.7904376488655, -3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.814740872696216, "mean_inference_ms": 0.26389039902340244, "mean_action_processing_ms": 0.06378027774727105, "mean_env_wait_ms": 0.6270172745457372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030112266540527344, "StateBufferConnector_ms": 0.0021653175354003906, "ViewRequirementAgentConnector_ms": 0.05472755432128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 365520, "num_agent_steps_trained": 365520, "num_env_steps_sampled": 365520, "num_env_steps_trained": 365520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 137.483357981389, "num_env_steps_trained_throughput_per_sec": 137.483357981389, "timesteps_total": 365520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 365520, "timers": {"training_iteration_time_ms": 2609.191, "sample_time_ms": 2599.492, "load_time_ms": 0.282, "load_throughput": 1278209.972, "learn_time_ms": 8.717, "learn_throughput": 41298.892, "synch_weights_time_ms": 0.66}, "counters": {"num_env_steps_sampled": 365520, "num_env_steps_trained": 365520, "num_agent_steps_sampled": 365520, "num_agent_steps_trained": 365520}, "done": false, "episodes_total": 1496, "training_iteration": 287, "trial_id": "71c6f_00000", "date": "2023-08-04_10-30-47", "timestamp": 1691134247, "time_this_iter_s": 10.476892232894897, "time_total_s": 3177.2414383888245, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1447.4107115268707, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 24.335714285714285, "ram_util_percent": 66.32142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2778564453125, "policy_loss": -1734526.409375, "vf_loss": 20742393.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3428.0, "diff_num_grad_updates_vs_sampler_policy": 3427.0}}, "num_env_steps_sampled": 366960, "num_env_steps_trained": 366960, "num_agent_steps_sampled": 366960, "num_agent_steps_trained": 366960}, "sampler_results": {"episode_reward_max": -3525.6319350334584, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.360411111401, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.820460953331776, "mean_inference_ms": 0.2641333872480453, "mean_action_processing_ms": 0.06384210762239656, "mean_env_wait_ms": 0.6274805997905184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030145645141601562, "StateBufferConnector_ms": 0.0021674633026123047, "ViewRequirementAgentConnector_ms": 0.054827213287353516}}, "episode_reward_max": -3525.6319350334584, "episode_reward_min": -3536.405827753621, "episode_reward_mean": -3527.360411111401, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.3686958504477, -3528.148950581707, -3526.086331863449, -3536.405827753621, -3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.820460953331776, "mean_inference_ms": 0.2641333872480453, "mean_action_processing_ms": 0.06384210762239656, "mean_env_wait_ms": 0.6274805997905184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030145645141601562, "StateBufferConnector_ms": 0.0021674633026123047, "ViewRequirementAgentConnector_ms": 0.054827213287353516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 366960, "num_agent_steps_trained": 366960, "num_env_steps_sampled": 366960, "num_env_steps_trained": 366960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 131.78247570397437, "num_env_steps_trained_throughput_per_sec": 131.78247570397437, "timesteps_total": 366960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 366960, "timers": {"training_iteration_time_ms": 2628.592, "sample_time_ms": 2619.07, "load_time_ms": 0.275, "load_throughput": 1306976.058, "learn_time_ms": 8.562, "learn_throughput": 42047.107, "synch_weights_time_ms": 0.645}, "counters": {"num_env_steps_sampled": 366960, "num_env_steps_trained": 366960, "num_agent_steps_sampled": 366960, "num_agent_steps_trained": 366960}, "done": false, "episodes_total": 1500, "training_iteration": 288, "trial_id": "71c6f_00000", "date": "2023-08-04_10-30-58", "timestamp": 1691134258, "time_this_iter_s": 10.929492950439453, "time_total_s": 3188.170931339264, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1458.3402044773102, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 24.168750000000003, "ram_util_percent": 66.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4018981933594, "policy_loss": -3269315.853125, "vf_loss": 20738071.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3448.0, "diff_num_grad_updates_vs_sampler_policy": 3447.0}}, "num_env_steps_sampled": 368400, "num_env_steps_trained": 368400, "num_agent_steps_sampled": 368400, "num_agent_steps_trained": 368400}, "sampler_results": {"episode_reward_max": -3525.6319350334584, "episode_reward_min": -3534.149797219209, "episode_reward_mean": -3527.2972723374824, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.826324198827859, "mean_inference_ms": 0.264383240359648, "mean_action_processing_ms": 0.06390577278780821, "mean_env_wait_ms": 0.6279606949691763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003018617630004883, "StateBufferConnector_ms": 0.002173900604248047, "ViewRequirementAgentConnector_ms": 0.05489158630371094}}, "episode_reward_max": -3525.6319350334584, "episode_reward_min": -3534.149797219209, "episode_reward_mean": -3527.2972723374824, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.9488064405123, -3526.7311669991063, -3527.6054906624677, -3525.8931086717207, -3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.826324198827859, "mean_inference_ms": 0.264383240359648, "mean_action_processing_ms": 0.06390577278780821, "mean_env_wait_ms": 0.6279606949691763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003018617630004883, "StateBufferConnector_ms": 0.002173900604248047, "ViewRequirementAgentConnector_ms": 0.05489158630371094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368400, "num_agent_steps_trained": 368400, "num_env_steps_sampled": 368400, "num_env_steps_trained": 368400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 133.50331615437364, "num_env_steps_trained_throughput_per_sec": 133.50331615437364, "timesteps_total": 368400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 368400, "timers": {"training_iteration_time_ms": 2705.543, "sample_time_ms": 2695.785, "load_time_ms": 0.28, "load_throughput": 1283643.152, "learn_time_ms": 8.769, "learn_throughput": 41053.1, "synch_weights_time_ms": 0.666}, "counters": {"num_env_steps_sampled": 368400, "num_env_steps_trained": 368400, "num_agent_steps_sampled": 368400, "num_agent_steps_trained": 368400}, "done": false, "episodes_total": 1504, "training_iteration": 289, "trial_id": "71c6f_00000", "date": "2023-08-04_10-31-08", "timestamp": 1691134268, "time_this_iter_s": 10.788669109344482, "time_total_s": 3198.9596004486084, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1469.1288735866547, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 25.68666666666666, "ram_util_percent": 66.27999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.59864501953126, "policy_loss": -11274662.3125, "vf_loss": 20753038.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3468.0, "diff_num_grad_updates_vs_sampler_policy": 3467.0}}, "num_env_steps_sampled": 369840, "num_env_steps_trained": 369840, "num_agent_steps_sampled": 369840, "num_agent_steps_trained": 369840}, "sampler_results": {"episode_reward_max": -3525.6319350334584, "episode_reward_min": -3534.149797219209, "episode_reward_mean": -3527.2815517884046, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.832354029332964, "mean_inference_ms": 0.2646385680092329, "mean_action_processing_ms": 0.06397107514829543, "mean_env_wait_ms": 0.6284458491341866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003038167953491211, "StateBufferConnector_ms": 0.0021910667419433594, "ViewRequirementAgentConnector_ms": 0.05522775650024414}}, "episode_reward_max": -3525.6319350334584, "episode_reward_min": -3534.149797219209, "episode_reward_mean": -3527.2815517884046, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.982714226053, -3526.746684743417, -3526.2114263783637, -3526.7832373920464, -3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.832354029332964, "mean_inference_ms": 0.2646385680092329, "mean_action_processing_ms": 0.06397107514829543, "mean_env_wait_ms": 0.6284458491341866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003038167953491211, "StateBufferConnector_ms": 0.0021910667419433594, "ViewRequirementAgentConnector_ms": 0.05522775650024414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369840, "num_agent_steps_trained": 369840, "num_env_steps_sampled": 369840, "num_env_steps_trained": 369840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 128.973480007854, "num_env_steps_trained_throughput_per_sec": 128.973480007854, "timesteps_total": 369840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 369840, "timers": {"training_iteration_time_ms": 2736.126, "sample_time_ms": 2726.339, "load_time_ms": 0.284, "load_throughput": 1267054.997, "learn_time_ms": 8.789, "learn_throughput": 40959.889, "synch_weights_time_ms": 0.671}, "counters": {"num_env_steps_sampled": 369840, "num_env_steps_trained": 369840, "num_agent_steps_sampled": 369840, "num_agent_steps_trained": 369840}, "done": false, "episodes_total": 1508, "training_iteration": 290, "trial_id": "71c6f_00000", "date": "2023-08-04_10-31-20", "timestamp": 1691134280, "time_this_iter_s": 11.167253017425537, "time_total_s": 3210.126853466034, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1480.2961266040802, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 30.031250000000004, "ram_util_percent": 66.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3581298828125, "policy_loss": -3211988.11875, "vf_loss": 20734087.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3488.0, "diff_num_grad_updates_vs_sampler_policy": 3487.0}}, "num_env_steps_sampled": 371280, "num_env_steps_trained": 371280, "num_agent_steps_sampled": 371280, "num_agent_steps_trained": 371280}, "sampler_results": {"episode_reward_max": -3525.6319350334584, "episode_reward_min": -3534.149797219209, "episode_reward_mean": -3527.329903976873, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.838495872010627, "mean_inference_ms": 0.2648926099668335, "mean_action_processing_ms": 0.06403622826397332, "mean_env_wait_ms": 0.6289404362185902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030324459075927734, "StateBufferConnector_ms": 0.0021915435791015625, "ViewRequirementAgentConnector_ms": 0.05517721176147461}}, "episode_reward_max": -3525.6319350334584, "episode_reward_min": -3534.149797219209, "episode_reward_mean": -3527.329903976873, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5970235071386, -3525.6321643403253, -3534.149797219209, -3527.5092737903756, -3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.838495872010627, "mean_inference_ms": 0.2648926099668335, "mean_action_processing_ms": 0.06403622826397332, "mean_env_wait_ms": 0.6289404362185902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030324459075927734, "StateBufferConnector_ms": 0.0021915435791015625, "ViewRequirementAgentConnector_ms": 0.05517721176147461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 371280, "num_agent_steps_trained": 371280, "num_env_steps_sampled": 371280, "num_env_steps_trained": 371280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 137.30841532576, "num_env_steps_trained_throughput_per_sec": 137.30841532576, "timesteps_total": 371280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 371280, "timers": {"training_iteration_time_ms": 2684.25, "sample_time_ms": 2674.445, "load_time_ms": 0.287, "load_throughput": 1256406.59, "learn_time_ms": 8.789, "learn_throughput": 40961.111, "synch_weights_time_ms": 0.686}, "counters": {"num_env_steps_sampled": 371280, "num_env_steps_trained": 371280, "num_agent_steps_sampled": 371280, "num_agent_steps_trained": 371280}, "done": false, "episodes_total": 1512, "training_iteration": 291, "trial_id": "71c6f_00000", "date": "2023-08-04_10-31-30", "timestamp": 1691134290, "time_this_iter_s": 10.490706205368042, "time_total_s": 3220.617559671402, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1490.7868328094482, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 24.96, "ram_util_percent": 66.24666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2801513671875, "policy_loss": -989345.15625, "vf_loss": 20739505.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3508.0, "diff_num_grad_updates_vs_sampler_policy": 3507.0}}, "num_env_steps_sampled": 372720, "num_env_steps_trained": 372720, "num_agent_steps_sampled": 372720, "num_agent_steps_trained": 372720}, "sampler_results": {"episode_reward_max": -3525.6319350334584, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.242915312558, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.844737189648154, "mean_inference_ms": 0.265156833470056, "mean_action_processing_ms": 0.06410396517381488, "mean_env_wait_ms": 0.6294541992148315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030617713928222656, "StateBufferConnector_ms": 0.002214670181274414, "ViewRequirementAgentConnector_ms": 0.05574464797973633}}, "episode_reward_max": -3525.6319350334584, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.242915312558, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6632445818427, -3527.179761064442, -3528.51930284702, -3525.8389884983844, -3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.844737189648154, "mean_inference_ms": 0.265156833470056, "mean_action_processing_ms": 0.06410396517381488, "mean_env_wait_ms": 0.6294541992148315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030617713928222656, "StateBufferConnector_ms": 0.002214670181274414, "ViewRequirementAgentConnector_ms": 0.05574464797973633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372720, "num_agent_steps_trained": 372720, "num_env_steps_sampled": 372720, "num_env_steps_trained": 372720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 137.2826391880051, "num_env_steps_trained_throughput_per_sec": 137.2826391880051, "timesteps_total": 372720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 372720, "timers": {"training_iteration_time_ms": 2647.788, "sample_time_ms": 2638.312, "load_time_ms": 0.272, "load_throughput": 1325214.534, "learn_time_ms": 8.513, "learn_throughput": 42285.79, "synch_weights_time_ms": 0.65}, "counters": {"num_env_steps_sampled": 372720, "num_env_steps_trained": 372720, "num_agent_steps_sampled": 372720, "num_agent_steps_trained": 372720}, "done": false, "episodes_total": 1516, "training_iteration": 292, "trial_id": "71c6f_00000", "date": "2023-08-04_10-31-41", "timestamp": 1691134301, "time_this_iter_s": 10.491460800170898, "time_total_s": 3231.109020471573, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1501.2782936096191, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 24.746666666666666, "ram_util_percent": 66.39333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2698608398438, "policy_loss": 301353.759375, "vf_loss": 20733521.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3528.0, "diff_num_grad_updates_vs_sampler_policy": 3527.0}}, "num_env_steps_sampled": 374160, "num_env_steps_trained": 374160, "num_agent_steps_sampled": 374160, "num_agent_steps_trained": 374160}, "sampler_results": {"episode_reward_max": -3525.6319350334584, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.225350929474, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.851191630433992, "mean_inference_ms": 0.26542546667825884, "mean_action_processing_ms": 0.064172989692012, "mean_env_wait_ms": 0.6299765000664328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030646324157714844, "StateBufferConnector_ms": 0.002210855484008789, "ViewRequirementAgentConnector_ms": 0.05561995506286621}}, "episode_reward_max": -3525.6319350334584, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.225350929474, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.7091307424994, -3526.2990643045728, -3527.356485136667, -3526.6181152347785, -3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.851191630433992, "mean_inference_ms": 0.26542546667825884, "mean_action_processing_ms": 0.064172989692012, "mean_env_wait_ms": 0.6299765000664328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030646324157714844, "StateBufferConnector_ms": 0.002210855484008789, "ViewRequirementAgentConnector_ms": 0.05561995506286621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 374160, "num_agent_steps_trained": 374160, "num_env_steps_sampled": 374160, "num_env_steps_trained": 374160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 129.54007337318225, "num_env_steps_trained_throughput_per_sec": 129.54007337318225, "timesteps_total": 374160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 374160, "timers": {"training_iteration_time_ms": 2676.871, "sample_time_ms": 2667.363, "load_time_ms": 0.272, "load_throughput": 1322197.408, "learn_time_ms": 8.55, "learn_throughput": 42104.558, "synch_weights_time_ms": 0.645}, "counters": {"num_env_steps_sampled": 374160, "num_env_steps_trained": 374160, "num_agent_steps_sampled": 374160, "num_agent_steps_trained": 374160}, "done": false, "episodes_total": 1520, "training_iteration": 293, "trial_id": "71c6f_00000", "date": "2023-08-04_10-31-52", "timestamp": 1691134312, "time_this_iter_s": 11.118458986282349, "time_total_s": 3242.227479457855, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1512.3967525959015, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 26.31875, "ram_util_percent": 66.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.27744750976564, "policy_loss": -293063.15, "vf_loss": 20741199.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3548.0, "diff_num_grad_updates_vs_sampler_policy": 3547.0}}, "num_env_steps_sampled": 375600, "num_env_steps_trained": 375600, "num_agent_steps_sampled": 375600, "num_agent_steps_trained": 375600}, "sampler_results": {"episode_reward_max": -3525.6319350334584, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1909094143293, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.857827489451372, "mean_inference_ms": 0.2657071584472341, "mean_action_processing_ms": 0.0642453120583838, "mean_env_wait_ms": 0.630523335069106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030984878540039062, "StateBufferConnector_ms": 0.002229928970336914, "ViewRequirementAgentConnector_ms": 0.05612468719482422}}, "episode_reward_max": -3525.6319350334584, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1909094143293, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.39657394835, -3526.7861026914384, -3527.2925313732067, -3526.5130846534785, -3527.971159042171, -3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.857827489451372, "mean_inference_ms": 0.2657071584472341, "mean_action_processing_ms": 0.0642453120583838, "mean_env_wait_ms": 0.630523335069106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030984878540039062, "StateBufferConnector_ms": 0.002229928970336914, "ViewRequirementAgentConnector_ms": 0.05612468719482422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375600, "num_agent_steps_trained": 375600, "num_env_steps_sampled": 375600, "num_env_steps_trained": 375600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 128.6126432463293, "num_env_steps_trained_throughput_per_sec": 128.6126432463293, "timesteps_total": 375600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 375600, "timers": {"training_iteration_time_ms": 2764.908, "sample_time_ms": 2755.025, "load_time_ms": 0.284, "load_throughput": 1269291.728, "learn_time_ms": 8.891, "learn_throughput": 40490.337, "synch_weights_time_ms": 0.667}, "counters": {"num_env_steps_sampled": 375600, "num_env_steps_trained": 375600, "num_agent_steps_sampled": 375600, "num_agent_steps_trained": 375600}, "done": false, "episodes_total": 1524, "training_iteration": 294, "trial_id": "71c6f_00000", "date": "2023-08-04_10-32-03", "timestamp": 1691134323, "time_this_iter_s": 11.19877028465271, "time_total_s": 3253.426249742508, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1523.5955228805542, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 30.68, "ram_util_percent": 66.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2775512695313, "policy_loss": -2658574.31875, "vf_loss": 20742852.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3573.0, "diff_num_grad_updates_vs_sampler_policy": 3572.0}}, "num_env_steps_sampled": 377400, "num_env_steps_trained": 377400, "num_agent_steps_sampled": 377400, "num_agent_steps_trained": 377400}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1708805253143, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.866200413466804, "mean_inference_ms": 0.26605297797319527, "mean_action_processing_ms": 0.06433429442229457, "mean_env_wait_ms": 0.6311967288782896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003093242645263672, "StateBufferConnector_ms": 0.00222015380859375, "ViewRequirementAgentConnector_ms": 0.056124210357666016}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1708805253143, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.843745134785, -3526.5531551235727, -3527.028002809339, -3527.591144961257, -3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.866200413466804, "mean_inference_ms": 0.26605297797319527, "mean_action_processing_ms": 0.06433429442229457, "mean_env_wait_ms": 0.6311967288782896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003093242645263672, "StateBufferConnector_ms": 0.00222015380859375, "ViewRequirementAgentConnector_ms": 0.056124210357666016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 377400, "num_agent_steps_trained": 377400, "num_env_steps_sampled": 377400, "num_env_steps_trained": 377400, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 141.03654007363363, "num_env_steps_trained_throughput_per_sec": 141.03654007363363, "timesteps_total": 377400, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 377400, "timers": {"training_iteration_time_ms": 2667.271, "sample_time_ms": 2657.767, "load_time_ms": 0.273, "load_throughput": 1318617.972, "learn_time_ms": 8.564, "learn_throughput": 42036.22, "synch_weights_time_ms": 0.626}, "counters": {"num_env_steps_sampled": 377400, "num_env_steps_trained": 377400, "num_agent_steps_sampled": 377400, "num_agent_steps_trained": 377400}, "done": false, "episodes_total": 1529, "training_iteration": 295, "trial_id": "71c6f_00000", "date": "2023-08-04_10-32-16", "timestamp": 1691134336, "time_this_iter_s": 12.765100002288818, "time_total_s": 3266.1913497447968, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1536.360622882843, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 23.394444444444446, "ram_util_percent": 66.54444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.48720703125, "policy_loss": -4503386.35, "vf_loss": 20759316.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3593.0, "diff_num_grad_updates_vs_sampler_policy": 3592.0}}, "num_env_steps_sampled": 378840, "num_env_steps_trained": 378840, "num_agent_steps_sampled": 378840, "num_agent_steps_trained": 378840}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1909817839496, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8729543870667875, "mean_inference_ms": 0.26633498883737866, "mean_action_processing_ms": 0.06440687277541068, "mean_env_wait_ms": 0.6317452045959865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030975341796875, "StateBufferConnector_ms": 0.0022280216217041016, "ViewRequirementAgentConnector_ms": 0.05619525909423828}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1909817839496, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.399833803255, -3527.2005584722815, -3526.0027381624063, -3526.811567078226, -3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8729543870667875, "mean_inference_ms": 0.26633498883737866, "mean_action_processing_ms": 0.06440687277541068, "mean_env_wait_ms": 0.6317452045959865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030975341796875, "StateBufferConnector_ms": 0.0022280216217041016, "ViewRequirementAgentConnector_ms": 0.05619525909423828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378840, "num_agent_steps_trained": 378840, "num_env_steps_sampled": 378840, "num_env_steps_trained": 378840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 136.96787553557309, "num_env_steps_trained_throughput_per_sec": 136.96787553557309, "timesteps_total": 378840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 378840, "timers": {"training_iteration_time_ms": 2649.031, "sample_time_ms": 2639.954, "load_time_ms": 0.266, "load_throughput": 1354214.744, "learn_time_ms": 8.16, "learn_throughput": 44115.611, "synch_weights_time_ms": 0.61}, "counters": {"num_env_steps_sampled": 378840, "num_env_steps_trained": 378840, "num_agent_steps_sampled": 378840, "num_agent_steps_trained": 378840}, "done": false, "episodes_total": 1533, "training_iteration": 296, "trial_id": "71c6f_00000", "date": "2023-08-04_10-32-26", "timestamp": 1691134346, "time_this_iter_s": 10.516424894332886, "time_total_s": 3276.7077746391296, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1546.877047777176, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 26.266666666666666, "ram_util_percent": 66.54666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4145263671875, "policy_loss": -1940294.06875, "vf_loss": 20748179.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3613.0, "diff_num_grad_updates_vs_sampler_policy": 3612.0}}, "num_env_steps_sampled": 380280, "num_env_steps_trained": 380280, "num_agent_steps_sampled": 380280, "num_agent_steps_trained": 380280}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.21235722246, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.879743637098572, "mean_inference_ms": 0.2666278392433928, "mean_action_processing_ms": 0.06448229411459662, "mean_env_wait_ms": 0.6323178083019192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031201839447021484, "StateBufferConnector_ms": 0.0022296905517578125, "ViewRequirementAgentConnector_ms": 0.05638527870178223}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.21235722246, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.013403891375, -3526.5697256349545, -3529.7119665256323, -3526.9862469851555, -3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.879743637098572, "mean_inference_ms": 0.2666278392433928, "mean_action_processing_ms": 0.06448229411459662, "mean_env_wait_ms": 0.6323178083019192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031201839447021484, "StateBufferConnector_ms": 0.0022296905517578125, "ViewRequirementAgentConnector_ms": 0.05638527870178223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380280, "num_agent_steps_trained": 380280, "num_env_steps_sampled": 380280, "num_env_steps_trained": 380280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 138.65830011812523, "num_env_steps_trained_throughput_per_sec": 138.65830011812523, "timesteps_total": 380280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 380280, "timers": {"training_iteration_time_ms": 2640.265, "sample_time_ms": 2630.245, "load_time_ms": 0.288, "load_throughput": 1250268.643, "learn_time_ms": 9.014, "learn_throughput": 39937.194, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 380280, "num_env_steps_trained": 380280, "num_agent_steps_sampled": 380280, "num_agent_steps_trained": 380280}, "done": false, "episodes_total": 1537, "training_iteration": 297, "trial_id": "71c6f_00000", "date": "2023-08-04_10-32-37", "timestamp": 1691134357, "time_this_iter_s": 10.388472080230713, "time_total_s": 3287.0962467193604, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1557.2655198574066, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 27.54, "ram_util_percent": 66.30666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4326599121094, "policy_loss": -481245.9875, "vf_loss": 20747287.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3633.0, "diff_num_grad_updates_vs_sampler_policy": 3632.0}}, "num_env_steps_sampled": 381720, "num_env_steps_trained": 381720, "num_agent_steps_sampled": 381720, "num_agent_steps_trained": 381720}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1666203990817, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.886663890254641, "mean_inference_ms": 0.26693345652582356, "mean_action_processing_ms": 0.06456094583700232, "mean_env_wait_ms": 0.6329153201452944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031418800354003906, "StateBufferConnector_ms": 0.0022492408752441406, "ViewRequirementAgentConnector_ms": 0.056800127029418945}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1666203990817, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3525.63208587563, -3526.5632459110825, -3527.678831228781, -3529.3031173585523, -3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.886663890254641, "mean_inference_ms": 0.26693345652582356, "mean_action_processing_ms": 0.06456094583700232, "mean_env_wait_ms": 0.6329153201452944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031418800354003906, "StateBufferConnector_ms": 0.0022492408752441406, "ViewRequirementAgentConnector_ms": 0.056800127029418945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 381720, "num_agent_steps_trained": 381720, "num_env_steps_sampled": 381720, "num_env_steps_trained": 381720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 132.87465753655204, "num_env_steps_trained_throughput_per_sec": 132.87465753655204, "timesteps_total": 381720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 381720, "timers": {"training_iteration_time_ms": 2634.684, "sample_time_ms": 2624.856, "load_time_ms": 0.281, "load_throughput": 1283206.799, "learn_time_ms": 8.824, "learn_throughput": 40796.544, "synch_weights_time_ms": 0.681}, "counters": {"num_env_steps_sampled": 381720, "num_env_steps_trained": 381720, "num_agent_steps_sampled": 381720, "num_agent_steps_trained": 381720}, "done": false, "episodes_total": 1541, "training_iteration": 298, "trial_id": "71c6f_00000", "date": "2023-08-04_10-32-48", "timestamp": 1691134368, "time_this_iter_s": 10.839481830596924, "time_total_s": 3297.9357285499573, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1568.1050016880035, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 26.58, "ram_util_percent": 66.27333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3709655761719, "policy_loss": -1277549.890625, "vf_loss": 20740739.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3653.0, "diff_num_grad_updates_vs_sampler_policy": 3652.0}}, "num_env_steps_sampled": 383160, "num_env_steps_trained": 383160, "num_agent_steps_sampled": 383160, "num_agent_steps_trained": 383160}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.146401454717, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8936135579926905, "mean_inference_ms": 0.2672348714061075, "mean_action_processing_ms": 0.06463855971242158, "mean_env_wait_ms": 0.633505825734628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031583309173583984, "StateBufferConnector_ms": 0.002251863479614258, "ViewRequirementAgentConnector_ms": 0.0568697452545166}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.146401454717, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.5577057414225, -3526.236113502354, -3526.559848377259, -3527.0518714540326, -3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8936135579926905, "mean_inference_ms": 0.2672348714061075, "mean_action_processing_ms": 0.06463855971242158, "mean_env_wait_ms": 0.633505825734628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031583309173583984, "StateBufferConnector_ms": 0.002251863479614258, "ViewRequirementAgentConnector_ms": 0.0568697452545166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 383160, "num_agent_steps_trained": 383160, "num_env_steps_sampled": 383160, "num_env_steps_trained": 383160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 143.00158782062994, "num_env_steps_trained_throughput_per_sec": 143.00158782062994, "timesteps_total": 383160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 383160, "timers": {"training_iteration_time_ms": 2606.3, "sample_time_ms": 2596.978, "load_time_ms": 0.267, "load_throughput": 1347206.852, "learn_time_ms": 8.38, "learn_throughput": 42957.921, "synch_weights_time_ms": 0.635}, "counters": {"num_env_steps_sampled": 383160, "num_env_steps_trained": 383160, "num_agent_steps_sampled": 383160, "num_agent_steps_trained": 383160}, "done": false, "episodes_total": 1545, "training_iteration": 299, "trial_id": "71c6f_00000", "date": "2023-08-04_10-32-58", "timestamp": 1691134378, "time_this_iter_s": 10.071975946426392, "time_total_s": 3308.0077044963837, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1578.17697763443, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 23.639999999999997, "ram_util_percent": 66.35333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.52158813476564, "policy_loss": -6576381.703125, "vf_loss": 20763738.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3673.0, "diff_num_grad_updates_vs_sampler_policy": 3672.0}}, "num_env_steps_sampled": 384600, "num_env_steps_trained": 384600, "num_agent_steps_sampled": 384600, "num_agent_steps_trained": 384600}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.173189337184, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.900669433154224, "mean_inference_ms": 0.26753463820150647, "mean_action_processing_ms": 0.06471589125950353, "mean_env_wait_ms": 0.6340935919464155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031707286834716797, "StateBufferConnector_ms": 0.002257108688354492, "ViewRequirementAgentConnector_ms": 0.05702638626098633}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.173189337184, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.603579902356, -3526.7472753800284, -3526.598729072964, -3527.0090591769876, -3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.900669433154224, "mean_inference_ms": 0.26753463820150647, "mean_action_processing_ms": 0.06471589125950353, "mean_env_wait_ms": 0.6340935919464155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031707286834716797, "StateBufferConnector_ms": 0.002257108688354492, "ViewRequirementAgentConnector_ms": 0.05702638626098633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384600, "num_agent_steps_trained": 384600, "num_env_steps_sampled": 384600, "num_env_steps_trained": 384600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 133.39665086334597, "num_env_steps_trained_throughput_per_sec": 133.39665086334597, "timesteps_total": 384600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 384600, "timers": {"training_iteration_time_ms": 2644.712, "sample_time_ms": 2635.957, "load_time_ms": 0.255, "load_throughput": 1412223.569, "learn_time_ms": 7.869, "learn_throughput": 45747.587, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 384600, "num_env_steps_trained": 384600, "num_agent_steps_sampled": 384600, "num_agent_steps_trained": 384600}, "done": false, "episodes_total": 1549, "training_iteration": 300, "trial_id": "71c6f_00000", "date": "2023-08-04_10-33-09", "timestamp": 1691134389, "time_this_iter_s": 10.797070264816284, "time_total_s": 3318.8047747612, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1588.9740478992462, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 27.646666666666665, "ram_util_percent": 66.30666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.39906005859376, "policy_loss": -2113719.29375, "vf_loss": 20737711.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3693.0, "diff_num_grad_updates_vs_sampler_policy": 3692.0}}, "num_env_steps_sampled": 386040, "num_env_steps_trained": 386040, "num_agent_steps_sampled": 386040, "num_agent_steps_trained": 386040}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1648033388456, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.907719473047436, "mean_inference_ms": 0.26782607313572343, "mean_action_processing_ms": 0.0647912465860968, "mean_env_wait_ms": 0.6346694615996129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003152608871459961, "StateBufferConnector_ms": 0.0022461414337158203, "ViewRequirementAgentConnector_ms": 0.05670499801635742}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1648033388456, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.815191692741, -3525.6320469813472, -3525.925039568821, -3526.5681066365205, -3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.907719473047436, "mean_inference_ms": 0.26782607313572343, "mean_action_processing_ms": 0.0647912465860968, "mean_env_wait_ms": 0.6346694615996129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003152608871459961, "StateBufferConnector_ms": 0.0022461414337158203, "ViewRequirementAgentConnector_ms": 0.05670499801635742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 386040, "num_agent_steps_trained": 386040, "num_env_steps_sampled": 386040, "num_env_steps_trained": 386040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 143.70164711870214, "num_env_steps_trained_throughput_per_sec": 143.70164711870214, "timesteps_total": 386040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 386040, "timers": {"training_iteration_time_ms": 2585.63, "sample_time_ms": 2576.41, "load_time_ms": 0.265, "load_throughput": 1356160.805, "learn_time_ms": 8.283, "learn_throughput": 43464.791, "synch_weights_time_ms": 0.634}, "counters": {"num_env_steps_sampled": 386040, "num_env_steps_trained": 386040, "num_agent_steps_sampled": 386040, "num_agent_steps_trained": 386040}, "done": false, "episodes_total": 1553, "training_iteration": 301, "trial_id": "71c6f_00000", "date": "2023-08-04_10-33-19", "timestamp": 1691134399, "time_this_iter_s": 10.023658037185669, "time_total_s": 3328.8284327983856, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1598.9977059364319, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 23.928571428571427, "ram_util_percent": 66.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.38670654296874, "policy_loss": -2488799.73125, "vf_loss": 20743172.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3713.0, "diff_num_grad_updates_vs_sampler_policy": 3712.0}}, "num_env_steps_sampled": 387480, "num_env_steps_trained": 387480, "num_agent_steps_sampled": 387480, "num_agent_steps_trained": 387480}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.183221934729, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.91469733949187, "mean_inference_ms": 0.26811930189959426, "mean_action_processing_ms": 0.06486690011582577, "mean_env_wait_ms": 0.6352526960413585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031800270080566406, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.05704975128173828}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.183221934729, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3529.9226169482486, -3526.2172263731113, -3529.290543750647, -3526.5350303999944, -3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.91469733949187, "mean_inference_ms": 0.26811930189959426, "mean_action_processing_ms": 0.06486690011582577, "mean_env_wait_ms": 0.6352526960413585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031800270080566406, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.05704975128173828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 387480, "num_agent_steps_trained": 387480, "num_env_steps_sampled": 387480, "num_env_steps_trained": 387480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 141.018337317118, "num_env_steps_trained_throughput_per_sec": 141.018337317118, "timesteps_total": 387480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 387480, "timers": {"training_iteration_time_ms": 2531.459, "sample_time_ms": 2522.719, "load_time_ms": 0.257, "load_throughput": 1403298.736, "learn_time_ms": 7.832, "learn_throughput": 45968.194, "synch_weights_time_ms": 0.615}, "counters": {"num_env_steps_sampled": 387480, "num_env_steps_trained": 387480, "num_agent_steps_sampled": 387480, "num_agent_steps_trained": 387480}, "done": false, "episodes_total": 1557, "training_iteration": 302, "trial_id": "71c6f_00000", "date": "2023-08-04_10-33-29", "timestamp": 1691134409, "time_this_iter_s": 10.213845014572144, "time_total_s": 3339.0422778129578, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1609.211550951004, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 25.106666666666666, "ram_util_percent": 66.45333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3996215820313, "policy_loss": -7404704.88125, "vf_loss": 20734961.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3733.0, "diff_num_grad_updates_vs_sampler_policy": 3732.0}}, "num_env_steps_sampled": 388920, "num_env_steps_trained": 388920, "num_agent_steps_sampled": 388920, "num_agent_steps_trained": 388920}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1333401218503, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.921752274048277, "mean_inference_ms": 0.2684231487205431, "mean_action_processing_ms": 0.0649453046046272, "mean_env_wait_ms": 0.6358541104180402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003190755844116211, "StateBufferConnector_ms": 0.002282381057739258, "ViewRequirementAgentConnector_ms": 0.05727720260620117}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1333401218503, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3908752908633, -3527.8382341956744, -3529.178049298041, -3526.3665069443164, -3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.921752274048277, "mean_inference_ms": 0.2684231487205431, "mean_action_processing_ms": 0.0649453046046272, "mean_env_wait_ms": 0.6358541104180402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003190755844116211, "StateBufferConnector_ms": 0.002282381057739258, "ViewRequirementAgentConnector_ms": 0.05727720260620117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388920, "num_agent_steps_trained": 388920, "num_env_steps_sampled": 388920, "num_env_steps_trained": 388920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 133.19999714183814, "num_env_steps_trained_throughput_per_sec": 133.19999714183814, "timesteps_total": 388920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 388920, "timers": {"training_iteration_time_ms": 2636.479, "sample_time_ms": 2627.089, "load_time_ms": 0.275, "load_throughput": 1310947.595, "learn_time_ms": 8.415, "learn_throughput": 42781.68, "synch_weights_time_ms": 0.66}, "counters": {"num_env_steps_sampled": 388920, "num_env_steps_trained": 388920, "num_agent_steps_sampled": 388920, "num_agent_steps_trained": 388920}, "done": false, "episodes_total": 1561, "training_iteration": 303, "trial_id": "71c6f_00000", "date": "2023-08-04_10-33-40", "timestamp": 1691134420, "time_this_iter_s": 10.813488006591797, "time_total_s": 3349.8557658195496, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1620.0250389575958, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 29.746666666666663, "ram_util_percent": 66.47333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4610595703125, "policy_loss": -7468900.94375, "vf_loss": 20742808.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3753.0, "diff_num_grad_updates_vs_sampler_policy": 3752.0}}, "num_env_steps_sampled": 390360, "num_env_steps_trained": 390360, "num_agent_steps_sampled": 390360, "num_agent_steps_trained": 390360}, "sampler_results": {"episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1132229807868, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.928702192376169, "mean_inference_ms": 0.26872835513859317, "mean_action_processing_ms": 0.06502403748374871, "mean_env_wait_ms": 0.6364576253431755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003192901611328125, "StateBufferConnector_ms": 0.0022895336151123047, "ViewRequirementAgentConnector_ms": 0.05734848976135254}}, "episode_reward_max": -3525.6318309263957, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.1132229807868, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3993905436596, -3527.9245717359327, -3527.6800109327182, -3527.436859350873, -3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.928702192376169, "mean_inference_ms": 0.26872835513859317, "mean_action_processing_ms": 0.06502403748374871, "mean_env_wait_ms": 0.6364576253431755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003192901611328125, "StateBufferConnector_ms": 0.0022895336151123047, "ViewRequirementAgentConnector_ms": 0.05734848976135254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 390360, "num_agent_steps_trained": 390360, "num_env_steps_sampled": 390360, "num_env_steps_trained": 390360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 141.27898014867958, "num_env_steps_trained_throughput_per_sec": 141.27898014867958, "timesteps_total": 390360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 390360, "timers": {"training_iteration_time_ms": 2599.243, "sample_time_ms": 2589.361, "load_time_ms": 0.287, "load_throughput": 1254423.395, "learn_time_ms": 8.862, "learn_throughput": 40624.22, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 390360, "num_env_steps_trained": 390360, "num_agent_steps_sampled": 390360, "num_agent_steps_trained": 390360}, "done": false, "episodes_total": 1565, "training_iteration": 304, "trial_id": "71c6f_00000", "date": "2023-08-04_10-33-50", "timestamp": 1691134430, "time_this_iter_s": 10.195580005645752, "time_total_s": 3360.0513458251953, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1630.2206189632416, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 25.373333333333335, "ram_util_percent": 66.51333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.27874145507815, "policy_loss": -432290.884375, "vf_loss": 20733594.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.0, "diff_num_grad_updates_vs_sampler_policy": 3772.0}}, "num_env_steps_sampled": 391800, "num_env_steps_trained": 391800, "num_agent_steps_sampled": 391800, "num_agent_steps_trained": 391800}, "sampler_results": {"episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.0692458347125, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.935583410521505, "mean_inference_ms": 0.2690388248022328, "mean_action_processing_ms": 0.06510402561608702, "mean_env_wait_ms": 0.6370724896255993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032050609588623047, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.05764341354370117}}, "episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.0692458347125, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.3395628107146, -3527.907058427077, -3526.400250563108, -3526.69575950316, -3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.935583410521505, "mean_inference_ms": 0.2690388248022328, "mean_action_processing_ms": 0.06510402561608702, "mean_env_wait_ms": 0.6370724896255993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032050609588623047, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.05764341354370117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 391800, "num_agent_steps_trained": 391800, "num_env_steps_sampled": 391800, "num_env_steps_trained": 391800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 138.3952025667212, "num_env_steps_trained_throughput_per_sec": 138.3952025667212, "timesteps_total": 391800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 391800, "timers": {"training_iteration_time_ms": 2617.624, "sample_time_ms": 2607.952, "load_time_ms": 0.28, "load_throughput": 1285391.538, "learn_time_ms": 8.68, "learn_throughput": 41477.0, "synch_weights_time_ms": 0.672}, "counters": {"num_env_steps_sampled": 391800, "num_env_steps_trained": 391800, "num_agent_steps_sampled": 391800, "num_agent_steps_trained": 391800}, "done": false, "episodes_total": 1569, "training_iteration": 305, "trial_id": "71c6f_00000", "date": "2023-08-04_10-34-00", "timestamp": 1691134440, "time_this_iter_s": 10.40767788887024, "time_total_s": 3370.4590237140656, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1640.6282968521118, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 24.45, "ram_util_percent": 66.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.36052856445315, "policy_loss": -6066711.059375, "vf_loss": 20734631.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3793.0, "diff_num_grad_updates_vs_sampler_policy": 3792.0}}, "num_env_steps_sampled": 393240, "num_env_steps_trained": 393240, "num_agent_steps_sampled": 393240, "num_agent_steps_trained": 393240}, "sampler_results": {"episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.104391545572, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.942415006105031, "mean_inference_ms": 0.2693496770727654, "mean_action_processing_ms": 0.06518398589285032, "mean_env_wait_ms": 0.6376908909106224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032105445861816406, "StateBufferConnector_ms": 0.0022988319396972656, "ViewRequirementAgentConnector_ms": 0.057819366455078125}}, "episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.104391545572, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.8963638476675, -3528.245861594297, -3527.3668640977985, -3527.4475499039804, -3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.942415006105031, "mean_inference_ms": 0.2693496770727654, "mean_action_processing_ms": 0.06518398589285032, "mean_env_wait_ms": 0.6376908909106224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032105445861816406, "StateBufferConnector_ms": 0.0022988319396972656, "ViewRequirementAgentConnector_ms": 0.057819366455078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 393240, "num_agent_steps_trained": 393240, "num_env_steps_sampled": 393240, "num_env_steps_trained": 393240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 137.06085751229844, "num_env_steps_trained_throughput_per_sec": 137.06085751229844, "timesteps_total": 393240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 393240, "timers": {"training_iteration_time_ms": 2574.457, "sample_time_ms": 2564.927, "load_time_ms": 0.267, "load_throughput": 1349494.539, "learn_time_ms": 8.578, "learn_throughput": 41966.821, "synch_weights_time_ms": 0.646}, "counters": {"num_env_steps_sampled": 393240, "num_env_steps_trained": 393240, "num_agent_steps_sampled": 393240, "num_agent_steps_trained": 393240}, "done": false, "episodes_total": 1573, "training_iteration": 306, "trial_id": "71c6f_00000", "date": "2023-08-04_10-34-11", "timestamp": 1691134451, "time_this_iter_s": 10.50870418548584, "time_total_s": 3380.9677278995514, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1651.1370010375977, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 25.96, "ram_util_percent": 66.50666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.2224365234375, "policy_loss": 328753.103125, "vf_loss": 20747205.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3813.0, "diff_num_grad_updates_vs_sampler_policy": 3812.0}}, "num_env_steps_sampled": 394680, "num_env_steps_trained": 394680, "num_agent_steps_sampled": 394680, "num_agent_steps_trained": 394680}, "sampler_results": {"episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.0636881213777, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694, -3526.2177055601114, -3526.832135923545, -3527.5064860509083, -3527.3299694897973], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.949118339234218, "mean_inference_ms": 0.26965264044941867, "mean_action_processing_ms": 0.06526199067012003, "mean_env_wait_ms": 0.6382931468574996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003199338912963867, "StateBufferConnector_ms": 0.002301931381225586, "ViewRequirementAgentConnector_ms": 0.05776619911193848}}, "episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.0636881213777, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.6919078024785, -3527.691201758438, -3527.9089627573208, -3527.1277910146773, -3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694, -3526.2177055601114, -3526.832135923545, -3527.5064860509083, -3527.3299694897973], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.949118339234218, "mean_inference_ms": 0.26965264044941867, "mean_action_processing_ms": 0.06526199067012003, "mean_env_wait_ms": 0.6382931468574996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003199338912963867, "StateBufferConnector_ms": 0.002301931381225586, "ViewRequirementAgentConnector_ms": 0.05776619911193848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 394680, "num_agent_steps_trained": 394680, "num_env_steps_sampled": 394680, "num_env_steps_trained": 394680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 142.4150899404987, "num_env_steps_trained_throughput_per_sec": 142.4150899404987, "timesteps_total": 394680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 394680, "timers": {"training_iteration_time_ms": 2597.934, "sample_time_ms": 2589.027, "load_time_ms": 0.25, "load_throughput": 1438047.086, "learn_time_ms": 8.021, "learn_throughput": 44883.935, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 394680, "num_env_steps_trained": 394680, "num_agent_steps_sampled": 394680, "num_agent_steps_trained": 394680}, "done": false, "episodes_total": 1577, "training_iteration": 307, "trial_id": "71c6f_00000", "date": "2023-08-04_10-34-21", "timestamp": 1691134461, "time_this_iter_s": 10.113910913467407, "time_total_s": 3391.081638813019, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1661.250911951065, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 23.673333333333336, "ram_util_percent": 66.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.33380737304685, "policy_loss": -1440518.90625, "vf_loss": 20736764.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3833.0, "diff_num_grad_updates_vs_sampler_policy": 3832.0}}, "num_env_steps_sampled": 396120, "num_env_steps_trained": 396120, "num_agent_steps_sampled": 396120, "num_agent_steps_trained": 396120}, "sampler_results": {"episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.0479276714177, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694, -3526.2177055601114, -3526.832135923545, -3527.5064860509083, -3527.3299694897973, -3528.06824194493, -3527.4638358188945, -3527.03853773765, -3526.2732028354662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.955723611916028, "mean_inference_ms": 0.26995480521554405, "mean_action_processing_ms": 0.06533965369871168, "mean_env_wait_ms": 0.6388902940309701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003195047378540039, "StateBufferConnector_ms": 0.002297639846801758, "ViewRequirementAgentConnector_ms": 0.05765199661254883}}, "episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.0479276714177, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.725748919738, -3526.5589596323234, -3527.1359056068304, -3526.7080921391967, -3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694, -3526.2177055601114, -3526.832135923545, -3527.5064860509083, -3527.3299694897973, -3528.06824194493, -3527.4638358188945, -3527.03853773765, -3526.2732028354662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.955723611916028, "mean_inference_ms": 0.26995480521554405, "mean_action_processing_ms": 0.06533965369871168, "mean_env_wait_ms": 0.6388902940309701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003195047378540039, "StateBufferConnector_ms": 0.002297639846801758, "ViewRequirementAgentConnector_ms": 0.05765199661254883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396120, "num_agent_steps_trained": 396120, "num_env_steps_sampled": 396120, "num_env_steps_trained": 396120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 140.07682404221816, "num_env_steps_trained_throughput_per_sec": 140.07682404221816, "timesteps_total": 396120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 396120, "timers": {"training_iteration_time_ms": 2592.19, "sample_time_ms": 2582.875, "load_time_ms": 0.262, "load_throughput": 1375306.895, "learn_time_ms": 8.388, "learn_throughput": 42919.702, "synch_weights_time_ms": 0.626}, "counters": {"num_env_steps_sampled": 396120, "num_env_steps_trained": 396120, "num_agent_steps_sampled": 396120, "num_agent_steps_trained": 396120}, "done": false, "episodes_total": 1581, "training_iteration": 308, "trial_id": "71c6f_00000", "date": "2023-08-04_10-34-31", "timestamp": 1691134471, "time_this_iter_s": 10.282471179962158, "time_total_s": 3401.364109992981, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1671.5333831310272, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 22.985714285714288, "ram_util_percent": 66.43571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.4139709472656, "policy_loss": -6845643.025, "vf_loss": 20753433.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3853.0, "diff_num_grad_updates_vs_sampler_policy": 3852.0}}, "num_env_steps_sampled": 397560, "num_env_steps_trained": 397560, "num_agent_steps_sampled": 397560, "num_agent_steps_trained": 397560}, "sampler_results": {"episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.083361610376, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694, -3526.2177055601114, -3526.832135923545, -3527.5064860509083, -3527.3299694897973, -3528.06824194493, -3527.4638358188945, -3527.03853773765, -3526.2732028354662, -3527.6409679967833, -3528.9051385401153, -3526.2103073718586, -3527.915686285059], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.962238086717918, "mean_inference_ms": 0.2702561296445098, "mean_action_processing_ms": 0.06541696825889039, "mean_env_wait_ms": 0.6394874391159734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031986236572265625, "StateBufferConnector_ms": 0.0022945404052734375, "ViewRequirementAgentConnector_ms": 0.057619571685791016}}, "episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.083361610376, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.709654148925, -3528.047376251454, -3527.3216011476734, -3528.1869284056725, -3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694, -3526.2177055601114, -3526.832135923545, -3527.5064860509083, -3527.3299694897973, -3528.06824194493, -3527.4638358188945, -3527.03853773765, -3526.2732028354662, -3527.6409679967833, -3528.9051385401153, -3526.2103073718586, -3527.915686285059], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.962238086717918, "mean_inference_ms": 0.2702561296445098, "mean_action_processing_ms": 0.06541696825889039, "mean_env_wait_ms": 0.6394874391159734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031986236572265625, "StateBufferConnector_ms": 0.0022945404052734375, "ViewRequirementAgentConnector_ms": 0.057619571685791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 397560, "num_agent_steps_trained": 397560, "num_env_steps_sampled": 397560, "num_env_steps_trained": 397560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 137.4170347587097, "num_env_steps_trained_throughput_per_sec": 137.4170347587097, "timesteps_total": 397560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 397560, "timers": {"training_iteration_time_ms": 2582.613, "sample_time_ms": 2573.692, "load_time_ms": 0.257, "load_throughput": 1402256.166, "learn_time_ms": 8.011, "learn_throughput": 44937.367, "synch_weights_time_ms": 0.615}, "counters": {"num_env_steps_sampled": 397560, "num_env_steps_trained": 397560, "num_agent_steps_sampled": 397560, "num_agent_steps_trained": 397560}, "done": false, "episodes_total": 1585, "training_iteration": 309, "trial_id": "71c6f_00000", "date": "2023-08-04_10-34-42", "timestamp": 1691134482, "time_this_iter_s": 10.481262922286987, "time_total_s": 3411.845372915268, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1682.0146460533142, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 24.779999999999998, "ram_util_percent": 66.27333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.1, "policy_entropy": -322.3281188964844, "policy_loss": -2515949.0375, "vf_loss": 20744922.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3873.0, "diff_num_grad_updates_vs_sampler_policy": 3872.0}}, "num_env_steps_sampled": 399000, "num_env_steps_trained": 399000, "num_agent_steps_sampled": 399000, "num_agent_steps_trained": 399000}, "sampler_results": {"episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.0846955541438, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694, -3526.2177055601114, -3526.832135923545, -3527.5064860509083, -3527.3299694897973, -3528.06824194493, -3527.4638358188945, -3527.03853773765, -3526.2732028354662, -3527.6409679967833, -3528.9051385401153, -3526.2103073718586, -3527.915686285059, -3528.082292514649, -3528.952848753174, -3526.2872031477946, -3527.0766099149796], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.968666068788974, "mean_inference_ms": 0.2705572581835287, "mean_action_processing_ms": 0.06549384981923886, "mean_env_wait_ms": 0.6400870777572233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003204822540283203, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.057691097259521484}}, "episode_reward_max": -3525.631651417205, "episode_reward_min": -3530.399654855684, "episode_reward_mean": -3527.0846955541438, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3526.211782765236, -3527.362853826807, -3527.1517851818608, -3526.6059777612163, -3526.6858303995637, -3527.734745887191, -3527.806072807701, -3528.0841581631075, -3525.6319350334584, -3527.7937434294777, -3526.540728805924, -3528.345625443511, -3527.8563010030425, -3527.8318850081405, -3526.662117202681, -3526.520782196063, -3526.2609544525817, -3526.9341937684944, -3527.8905874488405, -3527.8431624274685, -3526.9555062600275, -3530.399654855684, -3526.3609580436205, -3526.9540612389046, -3526.2274539562154, -3525.7318806577946, -3526.2759965727155, -3527.293657521199, -3527.3345402615982, -3526.94018803236, -3525.8764728680776, -3526.259701081366, -3526.227848442064, -3526.557020315776, -3526.4940740647758, -3526.6899177879377, -3527.4012933078734, -3525.6318309263957, -3528.633089688236, -3526.6004310966814, -3526.2739076215817, -3526.5268269064604, -3528.604895431907, -3528.6205439325236, -3529.2790594132603, -3526.665990147625, -3526.198487610883, -3527.408704195515, -3526.5227322705127, -3526.303079446969, -3526.774532121701, -3527.107316860131, -3527.6347542393596, -3526.528820606016, -3526.2599482483242, -3526.7318628438447, -3528.6206144948073, -3525.863965622013, -3526.1613893617396, -3528.438357843205, -3526.538139340244, -3526.4527197227867, -3526.4457156800245, -3526.683468955504, -3527.2019869513733, -3527.0200066493967, -3525.9671082717705, -3526.5931425951862, -3526.382946487521, -3527.5918028996202, -3526.5522654944775, -3526.4502213025044, -3528.4063430843826, -3526.973784061456, -3526.389654126883, -3526.9921703497366, -3527.45682176683, -3525.631651417205, -3528.077078264503, -3525.877566507256, -3528.1738881640636, -3529.2593329827782, -3528.0523900850685, -3526.3715911580694, -3526.2177055601114, -3526.832135923545, -3527.5064860509083, -3527.3299694897973, -3528.06824194493, -3527.4638358188945, -3527.03853773765, -3526.2732028354662, -3527.6409679967833, -3528.9051385401153, -3526.2103073718586, -3527.915686285059, -3528.082292514649, -3528.952848753174, -3526.2872031477946, -3527.0766099149796], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.968666068788974, "mean_inference_ms": 0.2705572581835287, "mean_action_processing_ms": 0.06549384981923886, "mean_env_wait_ms": 0.6400870777572233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003204822540283203, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.057691097259521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 399000, "num_agent_steps_trained": 399000, "num_env_steps_sampled": 399000, "num_env_steps_trained": 399000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 131.16344152688913, "num_env_steps_trained_throughput_per_sec": 131.16344152688913, "timesteps_total": 399000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 399000, "timers": {"training_iteration_time_ms": 2687.037, "sample_time_ms": 2677.65, "load_time_ms": 0.268, "load_throughput": 1344088.873, "learn_time_ms": 8.436, "learn_throughput": 42674.312, "synch_weights_time_ms": 0.643}, "counters": {"num_env_steps_sampled": 399000, "num_env_steps_trained": 399000, "num_agent_steps_sampled": 399000, "num_agent_steps_trained": 399000}, "done": true, "episodes_total": 1589, "training_iteration": 310, "trial_id": "71c6f_00000", "date": "2023-08-04_10-34-53", "timestamp": 1691134493, "time_this_iter_s": 10.981219053268433, "time_total_s": 3422.8265919685364, "pid": 39437, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-07], [124600, 8e-07], [128200, 2.5e-07], [131800, 2.5e-07], [135400, 2.5e-07], [139000, 2.5e-07], [142600, 1e-07], [146200, 1e-07], [149800, 1e-07], [153400, 5e-08], [157000, 5e-08], [160600, 5e-08], [164200, 5e-08], [167800, 1e-08], [171400, 1e-08], [175000, 1e-08], [178600, 1e-08], [182200, 5e-09], [185800, 5e-09], [189400, 2.5e-09], [193000, 2.5e-09], [196600, 1e-09], [200200, 1e-09], [203800, 5e-10], [207400, 5e-10], [211000, 1e-10]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157879b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1692.9958651065826, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 27.25625, "ram_util_percent": 66.2875}}
