{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -324.82468872070314, "policy_loss": -5562660.4625, "vf_loss": 20778674.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "sampler_results": {"episode_reward_max": -3528.275117480738, "episode_reward_min": -3529.247454497449, "episode_reward_mean": -3528.624035111357, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.355649861663056, "mean_inference_ms": 0.3756290227588297, "mean_action_processing_ms": 0.0924398014657923, "mean_env_wait_ms": 3.3786034385547055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030517578125, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06550153096516927}}, "episode_reward_max": -3528.275117480738, "episode_reward_min": -3529.247454497449, "episode_reward_mean": -3528.624035111357, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.355649861663056, "mean_inference_ms": 0.3756290227588297, "mean_action_processing_ms": 0.0924398014657923, "mean_env_wait_ms": 3.3786034385547055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030517578125, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06550153096516927}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 88.66540821511535, "num_env_steps_trained_throughput_per_sec": 88.66540821511535, "timesteps_total": 121080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 121080, "timers": {"training_iteration_time_ms": 4060.189, "sample_time_ms": 4045.085, "load_time_ms": 0.402, "load_throughput": 895403.898, "learn_time_ms": 13.886, "learn_throughput": 25925.291, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "done": false, "episodes_total": 817, "training_iteration": 161, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-34-35", "timestamp": 1691130875, "time_this_iter_s": 12.183230876922607, "time_total_s": 1742.0139577388763, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.183230876922607, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.977777777777774, "ram_util_percent": 63.98888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.966666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -319.18732299804685, "policy_loss": -5460732.709375, "vf_loss": 21289086.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -3572.2023026600787, "episode_reward_mean": -3535.877809328894, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.447445915779155, "mean_inference_ms": 0.37405131079963627, "mean_action_processing_ms": 0.09179807188212465, "mean_env_wait_ms": 2.5629474459222044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003589902605329241, "StateBufferConnector_ms": 0.0026566641671316965, "ViewRequirementAgentConnector_ms": 0.0660146985735212}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -3572.2023026600787, "episode_reward_mean": -3535.877809328894, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.447445915779155, "mean_inference_ms": 0.37405131079963627, "mean_action_processing_ms": 0.09179807188212465, "mean_env_wait_ms": 2.5629474459222044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003589902605329241, "StateBufferConnector_ms": 0.0026566641671316965, "ViewRequirementAgentConnector_ms": 0.0660146985735212}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.74474041132048, "num_env_steps_trained_throughput_per_sec": 110.74474041132048, "timesteps_total": 122520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 122520, "timers": {"training_iteration_time_ms": 3597.627, "sample_time_ms": 3585.152, "load_time_ms": 0.333, "load_throughput": 1079857.589, "learn_time_ms": 11.374, "learn_throughput": 31651.143, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "done": false, "episodes_total": 821, "training_iteration": 162, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-34-48", "timestamp": 1691130888, "time_this_iter_s": 13.005249977111816, "time_total_s": 1755.0192077159882, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.188480854034424, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.594444444444445, "ram_util_percent": 63.87222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -368.4148193359375, "policy_loss": -80873248.225, "vf_loss": 131136387.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8939.661805354148, "episode_reward_mean": -5121.326529649902, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.485829243173074, "mean_inference_ms": 0.37327210158269447, "mean_action_processing_ms": 0.09155402378643851, "mean_env_wait_ms": 2.20123201658854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004063953052867542, "StateBufferConnector_ms": 0.0028415159745649858, "ViewRequirementAgentConnector_ms": 0.0724250620061701}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8939.661805354148, "episode_reward_mean": -5121.326529649902, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.485829243173074, "mean_inference_ms": 0.37327210158269447, "mean_action_processing_ms": 0.09155402378643851, "mean_env_wait_ms": 2.20123201658854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004063953052867542, "StateBufferConnector_ms": 0.0028415159745649858, "ViewRequirementAgentConnector_ms": 0.0724250620061701}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.75573718800655, "num_env_steps_trained_throughput_per_sec": 110.75573718800655, "timesteps_total": 123960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 123960, "timers": {"training_iteration_time_ms": 3241.736, "sample_time_ms": 3231.117, "load_time_ms": 0.301, "load_throughput": 1194674.769, "learn_time_ms": 9.546, "learn_throughput": 37713.851, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "done": false, "episodes_total": 825, "training_iteration": 163, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-35-01", "timestamp": 1691130901, "time_this_iter_s": 13.00407886505127, "time_total_s": 1768.0232865810394, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 38.19255971908569, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.510526315789473, "ram_util_percent": 63.873684210526314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.327777777777778e-05, "entropy_coeff": 0.05, "policy_entropy": -400.28452758789064, "policy_loss": -37390173.225, "vf_loss": 131509921.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8939.661805354148, "episode_reward_mean": -6128.628367523238, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.504081921581311, "mean_inference_ms": 0.37277027186013806, "mean_action_processing_ms": 0.09141756519771636, "mean_env_wait_ms": 1.9824075171304387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795623779296875, "StateBufferConnector_ms": 0.0028053919474283853, "ViewRequirementAgentConnector_ms": 0.07057507832845052}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8939.661805354148, "episode_reward_mean": -6128.628367523238, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.504081921581311, "mean_inference_ms": 0.37277027186013806, "mean_action_processing_ms": 0.09141756519771636, "mean_env_wait_ms": 1.9824075171304387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795623779296875, "StateBufferConnector_ms": 0.0028053919474283853, "ViewRequirementAgentConnector_ms": 0.07057507832845052}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.91525167266094, "num_env_steps_trained_throughput_per_sec": 111.91525167266094, "timesteps_total": 125400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 125400, "timers": {"training_iteration_time_ms": 3240.204, "sample_time_ms": 3229.583, "load_time_ms": 0.294, "load_throughput": 1225210.516, "learn_time_ms": 9.573, "learn_throughput": 37607.051, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "done": false, "episodes_total": 829, "training_iteration": 164, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-35-13", "timestamp": 1691130913, "time_this_iter_s": 12.869488954544067, "time_total_s": 1780.8927755355835, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.06204867362976, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.450000000000003, "ram_util_percent": 63.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.127777777777778e-05, "entropy_coeff": 0.05, "policy_entropy": -425.52857666015626, "policy_loss": -29271742.475, "vf_loss": 132652548.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8980.927652500355, "episode_reward_mean": -6717.080488710565, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514640970612075, "mean_inference_ms": 0.3724008650290597, "mean_action_processing_ms": 0.09132683000277848, "mean_env_wait_ms": 1.83437769282046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036452945910002057, "StateBufferConnector_ms": 0.0027644006829512747, "ViewRequirementAgentConnector_ms": 0.06956426720870168}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8980.927652500355, "episode_reward_mean": -6717.080488710565, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514640970612075, "mean_inference_ms": 0.3724008650290597, "mean_action_processing_ms": 0.09132683000277848, "mean_env_wait_ms": 1.83437769282046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036452945910002057, "StateBufferConnector_ms": 0.0027644006829512747, "ViewRequirementAgentConnector_ms": 0.06956426720870168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.52892328034092, "num_env_steps_trained_throughput_per_sec": 111.52892328034092, "timesteps_total": 126840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 126840, "timers": {"training_iteration_time_ms": 3223.313, "sample_time_ms": 3212.629, "load_time_ms": 0.297, "load_throughput": 1214078.508, "learn_time_ms": 9.632, "learn_throughput": 37375.264, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "done": false, "episodes_total": 833, "training_iteration": 165, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-35-26", "timestamp": 1691130926, "time_this_iter_s": 12.913915157318115, "time_total_s": 1793.8066906929016, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 63.975963830947876, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.599999999999998, "ram_util_percent": 63.81052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9277777777777775e-05, "entropy_coeff": 0.05, "policy_entropy": -437.1224060058594, "policy_loss": -294914067.55, "vf_loss": 133636683.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8980.927652500355, "episode_reward_mean": -7099.238417963582, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.519110140866786, "mean_inference_ms": 0.37211156794355843, "mean_action_processing_ms": 0.09126652075950199, "mean_env_wait_ms": 1.7263314292092122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003729695859162704, "StateBufferConnector_ms": 0.002776021542756454, "ViewRequirementAgentConnector_ms": 0.06904394730277684}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8980.927652500355, "episode_reward_mean": -7099.238417963582, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.519110140866786, "mean_inference_ms": 0.37211156794355843, "mean_action_processing_ms": 0.09126652075950199, "mean_env_wait_ms": 1.7263314292092122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003729695859162704, "StateBufferConnector_ms": 0.002776021542756454, "ViewRequirementAgentConnector_ms": 0.06904394730277684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.53423624089676, "num_env_steps_trained_throughput_per_sec": 112.53423624089676, "timesteps_total": 128280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 128280, "timers": {"training_iteration_time_ms": 3207.298, "sample_time_ms": 3196.634, "load_time_ms": 0.292, "load_throughput": 1231807.342, "learn_time_ms": 9.613, "learn_throughput": 37451.093, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "done": false, "episodes_total": 837, "training_iteration": 166, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-35-39", "timestamp": 1691130939, "time_this_iter_s": 12.798662900924683, "time_total_s": 1806.6053535938263, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.77462673187256, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.094444444444445, "ram_util_percent": 63.916666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -451.2115539550781, "policy_loss": -216044863.3625, "vf_loss": 129715166.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133.0, "diff_num_grad_updates_vs_sampler_policy": 132.0}}, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8980.927652500355, "episode_reward_mean": -7367.620266765152, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52208956732478, "mean_inference_ms": 0.3718785391296931, "mean_action_processing_ms": 0.09122023263122632, "mean_env_wait_ms": 1.643949655268533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036486872920283566, "StateBufferConnector_ms": 0.0027515270091869213, "ViewRequirementAgentConnector_ms": 0.06854269239637586}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8980.927652500355, "episode_reward_mean": -7367.620266765152, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52208956732478, "mean_inference_ms": 0.3718785391296931, "mean_action_processing_ms": 0.09122023263122632, "mean_env_wait_ms": 1.643949655268533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036486872920283566, "StateBufferConnector_ms": 0.0027515270091869213, "ViewRequirementAgentConnector_ms": 0.06854269239637586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.49513372055438, "num_env_steps_trained_throughput_per_sec": 111.49513372055438, "timesteps_total": 129720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 129720, "timers": {"training_iteration_time_ms": 3227.246, "sample_time_ms": 3216.606, "load_time_ms": 0.291, "load_throughput": 1236447.298, "learn_time_ms": 9.595, "learn_throughput": 37520.517, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "done": false, "episodes_total": 841, "training_iteration": 167, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-35-52", "timestamp": 1691130952, "time_this_iter_s": 12.917946815490723, "time_total_s": 1819.523300409317, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 89.69257354736328, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.866666666666664, "ram_util_percent": 63.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -467.74183349609376, "policy_loss": -187222258.2, "vf_loss": 130042796.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 152.0}}, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8982.731430811054, "episode_reward_mean": -7570.699280168762, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.523413012967589, "mean_inference_ms": 0.3717084931405593, "mean_action_processing_ms": 0.09118709098052934, "mean_env_wait_ms": 1.5784691146602392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916425151209678, "StateBufferConnector_ms": 0.002719509986139113, "ViewRequirementAgentConnector_ms": 0.06819309726838142}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8982.731430811054, "episode_reward_mean": -7570.699280168762, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.523413012967589, "mean_inference_ms": 0.3717084931405593, "mean_action_processing_ms": 0.09118709098052934, "mean_env_wait_ms": 1.5784691146602392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916425151209678, "StateBufferConnector_ms": 0.002719509986139113, "ViewRequirementAgentConnector_ms": 0.06819309726838142}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.25733037033446, "num_env_steps_trained_throughput_per_sec": 112.25733037033446, "timesteps_total": 131160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 131160, "timers": {"training_iteration_time_ms": 3221.786, "sample_time_ms": 3211.168, "load_time_ms": 0.294, "load_throughput": 1225707.801, "learn_time_ms": 9.584, "learn_throughput": 37561.118, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "done": false, "episodes_total": 845, "training_iteration": 168, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-36-05", "timestamp": 1691130965, "time_this_iter_s": 12.830307245254517, "time_total_s": 1832.3536076545715, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.5228807926178, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.949999999999996, "ram_util_percent": 63.849999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -478.5272644042969, "policy_loss": -76003301.55, "vf_loss": 132490671.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8988.253782750087, "episode_reward_mean": -7726.851691567859, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525446483593561, "mean_inference_ms": 0.3715566479204457, "mean_action_processing_ms": 0.09115992345273455, "mean_env_wait_ms": 1.5245870660374414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036300931658063617, "StateBufferConnector_ms": 0.002693448747907366, "ViewRequirementAgentConnector_ms": 0.06795542580740792}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8988.253782750087, "episode_reward_mean": -7726.851691567859, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525446483593561, "mean_inference_ms": 0.3715566479204457, "mean_action_processing_ms": 0.09115992345273455, "mean_env_wait_ms": 1.5245870660374414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036300931658063617, "StateBufferConnector_ms": 0.002693448747907366, "ViewRequirementAgentConnector_ms": 0.06795542580740792}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.10150046864698, "num_env_steps_trained_throughput_per_sec": 111.10150046864698, "timesteps_total": 132600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 132600, "timers": {"training_iteration_time_ms": 3215.261, "sample_time_ms": 3204.653, "load_time_ms": 0.299, "load_throughput": 1203722.449, "learn_time_ms": 9.565, "learn_throughput": 37639.018, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "done": false, "episodes_total": 849, "training_iteration": 169, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-36-18", "timestamp": 1691130978, "time_this_iter_s": 12.963547945022583, "time_total_s": 1845.3171555995941, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 115.48642873764038, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.836842105263155, "ram_util_percent": 63.54210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -486.69976196289065, "policy_loss": -61150877.7, "vf_loss": 129713781.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8988.253782750087, "episode_reward_mean": -7849.178428443079, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527318854027513, "mean_inference_ms": 0.3714213990878132, "mean_action_processing_ms": 0.09113446453086864, "mean_env_wait_ms": 1.4794401360917264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035805579943534657, "StateBufferConnector_ms": 0.00267640138283754, "ViewRequirementAgentConnector_ms": 0.06771087646484375}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8988.253782750087, "episode_reward_mean": -7849.178428443079, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527318854027513, "mean_inference_ms": 0.3714213990878132, "mean_action_processing_ms": 0.09113446453086864, "mean_env_wait_ms": 1.4794401360917264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035805579943534657, "StateBufferConnector_ms": 0.00267640138283754, "ViewRequirementAgentConnector_ms": 0.06771087646484375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.55573148951393, "num_env_steps_trained_throughput_per_sec": 111.55573148951393, "timesteps_total": 134040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 134040, "timers": {"training_iteration_time_ms": 3230.673, "sample_time_ms": 3220.065, "load_time_ms": 0.299, "load_throughput": 1204875.072, "learn_time_ms": 9.561, "learn_throughput": 37654.693, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "done": false, "episodes_total": 853, "training_iteration": 170, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-36-31", "timestamp": 1691130991, "time_this_iter_s": 12.910998106002808, "time_total_s": 1858.228153705597, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 128.3974268436432, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.572222222222223, "ram_util_percent": 63.91111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -498.95317993164065, "policy_loss": -160810376.85, "vf_loss": 131085222.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 212.0}}, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8997.004572147625, "episode_reward_mean": -7950.433166734774, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529320770168132, "mean_inference_ms": 0.37133235884988536, "mean_action_processing_ms": 0.09111789637094786, "mean_env_wait_ms": 1.4411241210452923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036766362744708393, "StateBufferConnector_ms": 0.002675278242244277, "ViewRequirementAgentConnector_ms": 0.06735103074894395}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8997.004572147625, "episode_reward_mean": -7950.433166734774, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529320770168132, "mean_inference_ms": 0.37133235884988536, "mean_action_processing_ms": 0.09111789637094786, "mean_env_wait_ms": 1.4411241210452923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036766362744708393, "StateBufferConnector_ms": 0.002675278242244277, "ViewRequirementAgentConnector_ms": 0.06735103074894395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.88288755757245, "num_env_steps_trained_throughput_per_sec": 110.88288755757245, "timesteps_total": 135480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 135480, "timers": {"training_iteration_time_ms": 3239.268, "sample_time_ms": 3228.656, "load_time_ms": 0.297, "load_throughput": 1212713.388, "learn_time_ms": 9.563, "learn_throughput": 37645.681, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "done": false, "episodes_total": 857, "training_iteration": 171, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-36-44", "timestamp": 1691131004, "time_this_iter_s": 12.989322185516357, "time_total_s": 1871.2174758911133, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 141.38674902915955, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.63684210526316, "ram_util_percent": 63.83684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -511.9371643066406, "policy_loss": -366098799.603125, "vf_loss": 133876016.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8997.004572147625, "episode_reward_mean": -8037.011063715653, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531367197987014, "mean_inference_ms": 0.3712568735877288, "mean_action_processing_ms": 0.09110348398998196, "mean_env_wait_ms": 1.408096963261804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687878872485871, "StateBufferConnector_ms": 0.0026596353409138133, "ViewRequirementAgentConnector_ms": 0.06717316647793384}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8997.004572147625, "episode_reward_mean": -8037.011063715653, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.531367197987014, "mean_inference_ms": 0.3712568735877288, "mean_action_processing_ms": 0.09110348398998196, "mean_env_wait_ms": 1.408096963261804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687878872485871, "StateBufferConnector_ms": 0.0026596353409138133, "ViewRequirementAgentConnector_ms": 0.06717316647793384}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.94931856467629, "num_env_steps_trained_throughput_per_sec": 110.94931856467629, "timesteps_total": 136920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 136920, "timers": {"training_iteration_time_ms": 3232.47, "sample_time_ms": 3221.868, "load_time_ms": 0.298, "load_throughput": 1207090.447, "learn_time_ms": 9.547, "learn_throughput": 37707.258, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "done": false, "episodes_total": 861, "training_iteration": 172, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-36-57", "timestamp": 1691131017, "time_this_iter_s": 12.981541156768799, "time_total_s": 1884.199017047882, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 154.36829018592834, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.08888888888889, "ram_util_percent": 63.833333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -520.0809936523438, "policy_loss": -303357795.95, "vf_loss": 132253328.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 252.0}}, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8997.004572147625, "episode_reward_mean": -8106.7859651443305, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532180567847955, "mean_inference_ms": 0.3711948521916071, "mean_action_processing_ms": 0.09109120216362228, "mean_env_wait_ms": 1.3791712190896521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036375195372338387, "StateBufferConnector_ms": 0.0026590683880974263, "ViewRequirementAgentConnector_ms": 0.0669998281142291}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8997.004572147625, "episode_reward_mean": -8106.7859651443305, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532180567847955, "mean_inference_ms": 0.3711948521916071, "mean_action_processing_ms": 0.09109120216362228, "mean_env_wait_ms": 1.3791712190896521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036375195372338387, "StateBufferConnector_ms": 0.0026590683880974263, "ViewRequirementAgentConnector_ms": 0.0669998281142291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.68033044590683, "num_env_steps_trained_throughput_per_sec": 113.68033044590683, "timesteps_total": 138360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 138360, "timers": {"training_iteration_time_ms": 3209.598, "sample_time_ms": 3199.001, "load_time_ms": 0.296, "load_throughput": 1215936.093, "learn_time_ms": 9.528, "learn_throughput": 37783.213, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "done": false, "episodes_total": 865, "training_iteration": 173, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-37-10", "timestamp": 1691131030, "time_this_iter_s": 12.669755935668945, "time_total_s": 1896.868772983551, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 167.0380461215973, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.444444444444443, "ram_util_percent": 63.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.316666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -533.2838012695313, "policy_loss": -1046867968.0, "vf_loss": 133373607.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 273.0, "diff_num_grad_updates_vs_sampler_policy": 272.0}}, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -8997.004572147625, "episode_reward_mean": -8166.660040042384, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532980326616723, "mean_inference_ms": 0.3711362316273548, "mean_action_processing_ms": 0.09107902298502729, "mean_env_wait_ms": 1.353877063673686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036027214743874288, "StateBufferConnector_ms": 0.00265381552956321, "ViewRequirementAgentConnector_ms": 0.06691455841064453}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -8997.004572147625, "episode_reward_mean": -8166.660040042384, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532980326616723, "mean_inference_ms": 0.3711362316273548, "mean_action_processing_ms": 0.09107902298502729, "mean_env_wait_ms": 1.353877063673686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036027214743874288, "StateBufferConnector_ms": 0.00265381552956321, "ViewRequirementAgentConnector_ms": 0.06691455841064453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.05353507557648, "num_env_steps_trained_throughput_per_sec": 111.05353507557648, "timesteps_total": 139800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 139800, "timers": {"training_iteration_time_ms": 3211.536, "sample_time_ms": 3200.893, "load_time_ms": 0.298, "load_throughput": 1209992.339, "learn_time_ms": 9.572, "learn_throughput": 37609.674, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "done": false, "episodes_total": 869, "training_iteration": 174, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-37-23", "timestamp": 1691131043, "time_this_iter_s": 12.969286918640137, "time_total_s": 1909.8380599021912, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 180.00733304023743, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.763157894736846, "ram_util_percent": 63.72631578947367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7166666666666666e-05, "entropy_coeff": 0.05, "policy_entropy": -548.660986328125, "policy_loss": -489956818.975, "vf_loss": 131532508.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8221.625577205954, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533666632418473, "mean_inference_ms": 0.37107380737584994, "mean_action_processing_ms": 0.09106765662695113, "mean_env_wait_ms": 1.33148098553242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003567792601504568, "StateBufferConnector_ms": 0.0026521036180399233, "ViewRequirementAgentConnector_ms": 0.06681215965141685}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8221.625577205954, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533666632418473, "mean_inference_ms": 0.37107380737584994, "mean_action_processing_ms": 0.09106765662695113, "mean_env_wait_ms": 1.33148098553242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003567792601504568, "StateBufferConnector_ms": 0.0026521036180399233, "ViewRequirementAgentConnector_ms": 0.06681215965141685}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.49571208022466, "num_env_steps_trained_throughput_per_sec": 111.49571208022466, "timesteps_total": 141240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 141240, "timers": {"training_iteration_time_ms": 3225.587, "sample_time_ms": 3214.913, "load_time_ms": 0.297, "load_throughput": 1212226.59, "learn_time_ms": 9.621, "learn_throughput": 37417.312, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "done": false, "episodes_total": 873, "training_iteration": 175, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-37-36", "timestamp": 1691131056, "time_this_iter_s": 12.917999982833862, "time_total_s": 1922.756059885025, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 192.9253330230713, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.62777777777778, "ram_util_percent": 63.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1166666666666666e-05, "entropy_coeff": 0.05, "policy_entropy": -556.4787475585938, "policy_loss": -44681732.95, "vf_loss": 130148787.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 312.0}}, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8266.141680876704, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534395958882036, "mean_inference_ms": 0.3710143427014299, "mean_action_processing_ms": 0.09105603218011339, "mean_env_wait_ms": 1.3112974412826963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035380560254293773, "StateBufferConnector_ms": 0.002648338438972594, "ViewRequirementAgentConnector_ms": 0.066753417726547}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8266.141680876704, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534395958882036, "mean_inference_ms": 0.3710143427014299, "mean_action_processing_ms": 0.09105603218011339, "mean_env_wait_ms": 1.3112974412826963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035380560254293773, "StateBufferConnector_ms": 0.002648338438972594, "ViewRequirementAgentConnector_ms": 0.066753417726547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.68357814213361, "num_env_steps_trained_throughput_per_sec": 111.68357814213361, "timesteps_total": 142680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 142680, "timers": {"training_iteration_time_ms": 3227.823, "sample_time_ms": 3217.193, "load_time_ms": 0.295, "load_throughput": 1219766.896, "learn_time_ms": 9.583, "learn_throughput": 37565.978, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "done": false, "episodes_total": 877, "training_iteration": 176, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-37-49", "timestamp": 1691131069, "time_this_iter_s": 12.89620304107666, "time_total_s": 1935.6522629261017, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 205.82153606414795, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.831578947368424, "ram_util_percent": 63.784210526315796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -560.2431762695312, "policy_loss": -625647351.25, "vf_loss": 131697517.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 332.0}}, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8306.044807640614, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535149417463105, "mean_inference_ms": 0.37095729693767565, "mean_action_processing_ms": 0.09104595303034127, "mean_env_wait_ms": 1.292973083764323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035620447415024487, "StateBufferConnector_ms": 0.002649648865657066, "ViewRequirementAgentConnector_ms": 0.06667784790494549}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8306.044807640614, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535149417463105, "mean_inference_ms": 0.37095729693767565, "mean_action_processing_ms": 0.09104595303034127, "mean_env_wait_ms": 1.292973083764323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035620447415024487, "StateBufferConnector_ms": 0.002649648865657066, "ViewRequirementAgentConnector_ms": 0.06667784790494549}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.75967992436208, "num_env_steps_trained_throughput_per_sec": 111.75967992436208, "timesteps_total": 144120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 144120, "timers": {"training_iteration_time_ms": 3228.209, "sample_time_ms": 3217.555, "load_time_ms": 0.293, "load_throughput": 1228500.073, "learn_time_ms": 9.613, "learn_throughput": 37450.629, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "done": false, "episodes_total": 881, "training_iteration": 177, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-38-01", "timestamp": 1691131081, "time_this_iter_s": 12.887368202209473, "time_total_s": 1948.5396311283112, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 218.70890426635742, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 22.427777777777777, "ram_util_percent": 63.77222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -564.5466918945312, "policy_loss": -759721313.0375, "vf_loss": 131069460.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8342.294121190609, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53606971092378, "mean_inference_ms": 0.37091846849748555, "mean_action_processing_ms": 0.09103885910014767, "mean_env_wait_ms": 1.2764546127285579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035846737069143374, "StateBufferConnector_ms": 0.002643759821502256, "ViewRequirementAgentConnector_ms": 0.06666250631842814}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8342.294121190609, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53606971092378, "mean_inference_ms": 0.37091846849748555, "mean_action_processing_ms": 0.09103885910014767, "mean_env_wait_ms": 1.2764546127285579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035846737069143374, "StateBufferConnector_ms": 0.002643759821502256, "ViewRequirementAgentConnector_ms": 0.06666250631842814}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.29306029992901, "num_env_steps_trained_throughput_per_sec": 110.29306029992901, "timesteps_total": 145560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 145560, "timers": {"training_iteration_time_ms": 3247.217, "sample_time_ms": 3236.598, "load_time_ms": 0.292, "load_throughput": 1233417.285, "learn_time_ms": 9.582, "learn_throughput": 37569.155, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "done": false, "episodes_total": 885, "training_iteration": 178, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-38-14", "timestamp": 1691131094, "time_this_iter_s": 13.058942317962646, "time_total_s": 1961.5985734462738, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 231.76784658432007, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.4, "ram_util_percent": 63.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -569.600341796875, "policy_loss": -1359369055.3, "vf_loss": 128989342.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8371.494459367557, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537009791032417, "mean_inference_ms": 0.37088054626371675, "mean_action_processing_ms": 0.09103209395290032, "mean_env_wait_ms": 1.2615405750350839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554662068684896, "StateBufferConnector_ms": 0.0026410420735677085, "ViewRequirementAgentConnector_ms": 0.0665880839029948}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8371.494459367557, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537009791032417, "mean_inference_ms": 0.37088054626371675, "mean_action_processing_ms": 0.09103209395290032, "mean_env_wait_ms": 1.2615405750350839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554662068684896, "StateBufferConnector_ms": 0.0026410420735677085, "ViewRequirementAgentConnector_ms": 0.0665880839029948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.50525094991043, "num_env_steps_trained_throughput_per_sec": 110.50525094991043, "timesteps_total": 147000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 147000, "timers": {"training_iteration_time_ms": 3252.631, "sample_time_ms": 3241.978, "load_time_ms": 0.292, "load_throughput": 1231706.86, "learn_time_ms": 9.611, "learn_throughput": 37455.924, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "done": false, "episodes_total": 889, "training_iteration": 179, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-38-28", "timestamp": 1691131108, "time_this_iter_s": 13.03369402885437, "time_total_s": 1974.6322674751282, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 244.80154061317444, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.263157894736842, "ram_util_percent": 63.74210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -576.0335571289063, "policy_loss": -452162234.925, "vf_loss": 133989060.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 392.0}}, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8399.653115773153, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5374799526896, "mean_inference_ms": 0.370854226207754, "mean_action_processing_ms": 0.09102761144736927, "mean_env_wait_ms": 1.247859011214836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035322165187401107, "StateBufferConnector_ms": 0.0026473516150365903, "ViewRequirementAgentConnector_ms": 0.06662471384941777}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8399.653115773153, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5374799526896, "mean_inference_ms": 0.370854226207754, "mean_action_processing_ms": 0.09102761144736927, "mean_env_wait_ms": 1.247859011214836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035322165187401107, "StateBufferConnector_ms": 0.0026473516150365903, "ViewRequirementAgentConnector_ms": 0.06662471384941777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.44286972287985, "num_env_steps_trained_throughput_per_sec": 113.44286972287985, "timesteps_total": 148440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 148440, "timers": {"training_iteration_time_ms": 3223.812, "sample_time_ms": 3213.069, "load_time_ms": 0.296, "load_throughput": 1216425.876, "learn_time_ms": 9.681, "learn_throughput": 37184.645, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "done": false, "episodes_total": 893, "training_iteration": 180, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-38-40", "timestamp": 1691131120, "time_this_iter_s": 12.696211814880371, "time_total_s": 1987.3284792900085, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 257.4977524280548, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.922222222222224, "ram_util_percent": 63.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -579.050732421875, "policy_loss": -464791941.975, "vf_loss": 130279018.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 412.0}}, "num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8424.41094259948, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537863563743706, "mean_inference_ms": 0.3708259817889563, "mean_action_processing_ms": 0.09102282010813317, "mean_env_wait_ms": 1.2352318250661312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548989813011813, "StateBufferConnector_ms": 0.0026438609663262426, "ViewRequirementAgentConnector_ms": 0.0665440616837467}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8424.41094259948, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537863563743706, "mean_inference_ms": 0.3708259817889563, "mean_action_processing_ms": 0.09102282010813317, "mean_env_wait_ms": 1.2352318250661312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548989813011813, "StateBufferConnector_ms": 0.0026438609663262426, "ViewRequirementAgentConnector_ms": 0.0665440616837467}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880, "num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.14190808233236, "num_env_steps_trained_throughput_per_sec": 112.14190808233236, "timesteps_total": 149880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 149880, "timers": {"training_iteration_time_ms": 3214.202, "sample_time_ms": 3203.391, "load_time_ms": 0.296, "load_throughput": 1215153.259, "learn_time_ms": 9.75, "learn_throughput": 36922.954, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880}, "done": false, "episodes_total": 897, "training_iteration": 181, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-38-53", "timestamp": 1691131133, "time_this_iter_s": 12.843642950057983, "time_total_s": 2000.1721222400665, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 270.3413953781128, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.311111111111114, "ram_util_percent": 63.58888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.38888888888889e-06, "entropy_coeff": 0.05, "policy_entropy": -582.2021240234375, "policy_loss": -291335688.175, "vf_loss": 133314018.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 432.0}}, "num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8448.945676234069, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538232374877535, "mean_inference_ms": 0.37080369131204377, "mean_action_processing_ms": 0.09101887327073437, "mean_env_wait_ms": 1.22352714489287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035650428684278466, "StateBufferConnector_ms": 0.002661792711279858, "ViewRequirementAgentConnector_ms": 0.0665048073078024}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8448.945676234069, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538232374877535, "mean_inference_ms": 0.37080369131204377, "mean_action_processing_ms": 0.09101887327073437, "mean_env_wait_ms": 1.22352714489287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035650428684278466, "StateBufferConnector_ms": 0.002661792711279858, "ViewRequirementAgentConnector_ms": 0.0665048073078024}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320, "num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.81944568615293, "num_env_steps_trained_throughput_per_sec": 111.81944568615293, "timesteps_total": 151320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 151320, "timers": {"training_iteration_time_ms": 3206.417, "sample_time_ms": 3195.806, "load_time_ms": 0.295, "load_throughput": 1220950.465, "learn_time_ms": 9.573, "learn_throughput": 37605.834, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320}, "done": false, "episodes_total": 901, "training_iteration": 182, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-39-06", "timestamp": 1691131146, "time_this_iter_s": 12.88074803352356, "time_total_s": 2013.05287027359, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 283.22214341163635, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.27368421052632, "ram_util_percent": 63.58947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.388888888888889e-06, "entropy_coeff": 0.05, "policy_entropy": -584.5060424804688, "policy_loss": -960837691.1875, "vf_loss": 129416436.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 453.0, "diff_num_grad_updates_vs_sampler_policy": 452.0}}, "num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8468.555124894201, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538778730778841, "mean_inference_ms": 0.37077945849701294, "mean_action_processing_ms": 0.09101420946892284, "mean_env_wait_ms": 1.2126287371435847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550078842666123, "StateBufferConnector_ms": 0.002654044182745965, "ViewRequirementAgentConnector_ms": 0.06642132015018673}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8468.555124894201, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538778730778841, "mean_inference_ms": 0.37077945849701294, "mean_action_processing_ms": 0.09101420946892284, "mean_env_wait_ms": 1.2126287371435847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550078842666123, "StateBufferConnector_ms": 0.002654044182745965, "ViewRequirementAgentConnector_ms": 0.06642132015018673}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760, "num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.7351750932998, "num_env_steps_trained_throughput_per_sec": 110.7351750932998, "timesteps_total": 152760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 152760, "timers": {"training_iteration_time_ms": 3224.766, "sample_time_ms": 3214.289, "load_time_ms": 0.294, "load_throughput": 1224514.995, "learn_time_ms": 9.454, "learn_throughput": 38078.688, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760}, "done": false, "episodes_total": 905, "training_iteration": 183, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-39-19", "timestamp": 1691131159, "time_this_iter_s": 13.006866931915283, "time_total_s": 2026.0597372055054, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 296.22901034355164, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.42222222222222, "ram_util_percent": 63.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -585.5286987304687, "policy_loss": -1067782638.275, "vf_loss": 132771003.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8487.911590613707, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.539463023431036, "mean_inference_ms": 0.3707562376744795, "mean_action_processing_ms": 0.0910099393606863, "mean_env_wait_ms": 1.2024433365389686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035318575407329356, "StateBufferConnector_ms": 0.0026527204011615956, "ViewRequirementAgentConnector_ms": 0.06638677496659129}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8487.911590613707, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.539463023431036, "mean_inference_ms": 0.3707562376744795, "mean_action_processing_ms": 0.0910099393606863, "mean_env_wait_ms": 1.2024433365389686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035318575407329356, "StateBufferConnector_ms": 0.0026527204011615956, "ViewRequirementAgentConnector_ms": 0.06638677496659129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200, "num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.77901328433411, "num_env_steps_trained_throughput_per_sec": 110.77901328433411, "timesteps_total": 154200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 154200, "timers": {"training_iteration_time_ms": 3247.324, "sample_time_ms": 3236.836, "load_time_ms": 0.292, "load_throughput": 1231204.697, "learn_time_ms": 9.455, "learn_throughput": 38075.807, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200}, "done": false, "episodes_total": 909, "training_iteration": 184, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-39-32", "timestamp": 1691131172, "time_this_iter_s": 13.001513004302979, "time_total_s": 2039.0612502098083, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 309.2305233478546, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 20.457894736842103, "ram_util_percent": 63.694736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -587.0582763671875, "policy_loss": -904552695.375, "vf_loss": 129885918.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 492.0}}, "num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8506.34095548598, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.540220368062401, "mean_inference_ms": 0.3707330726639409, "mean_action_processing_ms": 0.09100572865421744, "mean_env_wait_ms": 1.1929271792940732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035218518189709595, "StateBufferConnector_ms": 0.0026548751676925505, "ViewRequirementAgentConnector_ms": 0.06637645490241773}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8506.34095548598, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.3495333558844, -3528.275117480738, -3529.247454497449, -3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.540220368062401, "mean_inference_ms": 0.3707330726639409, "mean_action_processing_ms": 0.09100572865421744, "mean_env_wait_ms": 1.1929271792940732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035218518189709595, "StateBufferConnector_ms": 0.0026548751676925505, "ViewRequirementAgentConnector_ms": 0.06637645490241773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640, "num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.83831013704057, "num_env_steps_trained_throughput_per_sec": 110.83831013704057, "timesteps_total": 155640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 155640, "timers": {"training_iteration_time_ms": 3255.533, "sample_time_ms": 3245.029, "load_time_ms": 0.295, "load_throughput": 1221938.529, "learn_time_ms": 9.464, "learn_throughput": 38037.919, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640}, "done": false, "episodes_total": 913, "training_iteration": 185, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-39-45", "timestamp": 1691131185, "time_this_iter_s": 12.994774103164673, "time_total_s": 2052.056024312973, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 322.2252974510193, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.744444444444444, "ram_util_percent": 63.57222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -587.8954711914063, "policy_loss": -806915051.25, "vf_loss": 130400204.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 513.0, "diff_num_grad_updates_vs_sampler_policy": 512.0}}, "num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080}, "sampler_results": {"episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8671.20732545192, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.546605227795168, "mean_inference_ms": 0.3705656073621542, "mean_action_processing_ms": 0.09095843105988266, "mean_env_wait_ms": 1.1181964534307307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518342971801758, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.0663766860961914}}, "episode_reward_max": -3523.9588552746022, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8671.20732545192, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3527.9539504393138, -3523.9588552746022, -3541.1574515941907, -3572.2023026600787, -4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.546605227795168, "mean_inference_ms": 0.3705656073621542, "mean_action_processing_ms": 0.09095843105988266, "mean_env_wait_ms": 1.1181964534307307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518342971801758, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.0663766860961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080, "num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.57101148402616, "num_env_steps_trained_throughput_per_sec": 110.57101148402616, "timesteps_total": 157080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 157080, "timers": {"training_iteration_time_ms": 3252.456, "sample_time_ms": 3241.955, "load_time_ms": 0.296, "load_throughput": 1214566.795, "learn_time_ms": 9.454, "learn_throughput": 38079.456, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080}, "done": false, "episodes_total": 917, "training_iteration": 186, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-39-58", "timestamp": 1691131198, "time_this_iter_s": 13.02598786354065, "time_total_s": 2065.0820121765137, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 335.25128531455994, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 21.122222222222224, "ram_util_percent": 63.72222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -590.643359375, "policy_loss": -202784717.4875, "vf_loss": 131719509.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 532.0}}, "num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520}, "sampler_results": {"episode_reward_max": -4833.644808310766, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8886.285340854894, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5482400688298545, "mean_inference_ms": 0.3704612681898989, "mean_action_processing_ms": 0.09094113037113782, "mean_env_wait_ms": 1.078610216155136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513336181640625, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.06635499000549316}}, "episode_reward_max": -4833.644808310766, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8886.285340854894, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4833.644808310766, -8895.323201184472, -8939.661805354148, -8914.817345997293, -8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5482400688298545, "mean_inference_ms": 0.3704612681898989, "mean_action_processing_ms": 0.09094113037113782, "mean_env_wait_ms": 1.078610216155136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513336181640625, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.06635499000549316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520, "num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.83351097110985, "num_env_steps_trained_throughput_per_sec": 112.83351097110985, "timesteps_total": 158520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 158520, "timers": {"training_iteration_time_ms": 3220.849, "sample_time_ms": 3210.259, "load_time_ms": 0.297, "load_throughput": 1212421.262, "learn_time_ms": 9.531, "learn_throughput": 37769.887, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520}, "done": false, "episodes_total": 921, "training_iteration": 187, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-40-11", "timestamp": 1691131211, "time_this_iter_s": 12.764997005462646, "time_total_s": 2077.8470091819763, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 348.0162823200226, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.705263157894738, "ram_util_percent": 63.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -592.8652465820312, "policy_loss": -436334522.9, "vf_loss": 130115790.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 553.0, "diff_num_grad_updates_vs_sampler_policy": 552.0}}, "num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960}, "sampler_results": {"episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8927.044574758482, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.548439108992283, "mean_inference_ms": 0.3703967104135256, "mean_action_processing_ms": 0.0909314272535193, "mean_env_wait_ms": 1.0542185011188066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034821033477783203, "StateBufferConnector_ms": 0.0026340484619140625, "ViewRequirementAgentConnector_ms": 0.06567001342773438}}, "episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8927.044574758482, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8927.646983599416, -8877.117438815214, -8866.119716897752, -8923.94954738725, -8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.548439108992283, "mean_inference_ms": 0.3703967104135256, "mean_action_processing_ms": 0.0909314272535193, "mean_env_wait_ms": 1.0542185011188066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034821033477783203, "StateBufferConnector_ms": 0.0026340484619140625, "ViewRequirementAgentConnector_ms": 0.06567001342773438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960, "num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.48509468207152, "num_env_steps_trained_throughput_per_sec": 111.48509468207152, "timesteps_total": 159960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 159960, "timers": {"training_iteration_time_ms": 3228.785, "sample_time_ms": 3218.195, "load_time_ms": 0.296, "load_throughput": 1214957.708, "learn_time_ms": 9.539, "learn_throughput": 37738.924, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960}, "done": false, "episodes_total": 925, "training_iteration": 188, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-40-24", "timestamp": 1691131224, "time_this_iter_s": 12.919475078582764, "time_total_s": 2090.766484260559, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 360.93575739860535, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.633333333333336, "ram_util_percent": 63.78888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -594.5523071289062, "policy_loss": -710518139.95, "vf_loss": 132257097.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 573.0, "diff_num_grad_updates_vs_sampler_policy": 572.0}}, "num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400}, "sampler_results": {"episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8928.23965716787, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698, -8862.54689234, -9017.176643914716, -8884.737800825282, -8949.88059055859], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.548842770818924, "mean_inference_ms": 0.37036866926287354, "mean_action_processing_ms": 0.09092778388961169, "mean_env_wait_ms": 1.037224559635232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034875869750976562, "StateBufferConnector_ms": 0.002629995346069336, "ViewRequirementAgentConnector_ms": 0.06566166877746582}}, "episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8928.23965716787, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8888.837986461942, -8867.071270196604, -8980.927652500355, -8958.266863493272, -8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698, -8862.54689234, -9017.176643914716, -8884.737800825282, -8949.88059055859], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.548842770818924, "mean_inference_ms": 0.37036866926287354, "mean_action_processing_ms": 0.09092778388961169, "mean_env_wait_ms": 1.037224559635232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034875869750976562, "StateBufferConnector_ms": 0.002629995346069336, "ViewRequirementAgentConnector_ms": 0.06566166877746582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400, "num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.27134666428095, "num_env_steps_trained_throughput_per_sec": 109.27134666428095, "timesteps_total": 161400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 161400, "timers": {"training_iteration_time_ms": 3247.856, "sample_time_ms": 3237.226, "load_time_ms": 0.299, "load_throughput": 1202093.337, "learn_time_ms": 9.572, "learn_throughput": 37607.801, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400}, "done": false, "episodes_total": 929, "training_iteration": 189, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-40-37", "timestamp": 1691131237, "time_this_iter_s": 13.181122064590454, "time_total_s": 2103.9476063251495, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 374.1168794631958, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 31.284210526315793, "ram_util_percent": 64.20526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -596.5939819335938, "policy_loss": -773754695.9375, "vf_loss": 130209944.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840}, "sampler_results": {"episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8926.785122311368, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698, -8862.54689234, -9017.176643914716, -8884.737800825282, -8949.88059055859, -8885.695069956375, -8857.467808105339, -8929.150598877286, -8877.336810063001], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.549104364912316, "mean_inference_ms": 0.37036415207165163, "mean_action_processing_ms": 0.0909281027757723, "mean_env_wait_ms": 1.0241815150913043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.002638578414916992, "ViewRequirementAgentConnector_ms": 0.06580972671508789}}, "episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8926.785122311368, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8928.660664400857, -8870.263444748227, -8883.956155055708, -8975.074063456846, -8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698, -8862.54689234, -9017.176643914716, -8884.737800825282, -8949.88059055859, -8885.695069956375, -8857.467808105339, -8929.150598877286, -8877.336810063001], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.549104364912316, "mean_inference_ms": 0.37036415207165163, "mean_action_processing_ms": 0.0909281027757723, "mean_env_wait_ms": 1.0241815150913043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.002638578414916992, "ViewRequirementAgentConnector_ms": 0.06580972671508789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840, "num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.89359543842266, "num_env_steps_trained_throughput_per_sec": 112.89359543842266, "timesteps_total": 162840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 162840, "timers": {"training_iteration_time_ms": 3227.821, "sample_time_ms": 3217.16, "load_time_ms": 0.3, "load_throughput": 1200755.022, "learn_time_ms": 9.6, "learn_throughput": 37498.993, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840}, "done": false, "episodes_total": 933, "training_iteration": 190, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-40-50", "timestamp": 1691131250, "time_this_iter_s": 12.758037090301514, "time_total_s": 2116.705643415451, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 386.8749165534973, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 21.227777777777778, "ram_util_percent": 63.51111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -598.95517578125, "policy_loss": -1115645673.15, "vf_loss": 129786332.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 613.0, "diff_num_grad_updates_vs_sampler_policy": 612.0}}, "num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280}, "sampler_results": {"episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8925.938193121232, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698, -8862.54689234, -9017.176643914716, -8884.737800825282, -8949.88059055859, -8885.695069956375, -8857.467808105339, -8929.150598877286, -8877.336810063001, -8875.301068587354, -8911.621627751132, -8918.066945834387, -8868.27176647521], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.550029484417135, "mean_inference_ms": 0.37037243408158355, "mean_action_processing_ms": 0.09092921863679126, "mean_env_wait_ms": 1.0136922249062157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034973621368408203, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.06575274467468262}}, "episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8925.938193121232, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8908.28153439196, -8924.600965857842, -8948.537981895455, -8861.843107351457, -8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698, -8862.54689234, -9017.176643914716, -8884.737800825282, -8949.88059055859, -8885.695069956375, -8857.467808105339, -8929.150598877286, -8877.336810063001, -8875.301068587354, -8911.621627751132, -8918.066945834387, -8868.27176647521], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.550029484417135, "mean_inference_ms": 0.37037243408158355, "mean_action_processing_ms": 0.09092921863679126, "mean_env_wait_ms": 1.0136922249062157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034973621368408203, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.06575274467468262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280, "num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.58184623233204, "num_env_steps_trained_throughput_per_sec": 110.58184623233204, "timesteps_total": 164280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 164280, "timers": {"training_iteration_time_ms": 3231.894, "sample_time_ms": 3221.119, "load_time_ms": 0.303, "load_throughput": 1188001.133, "learn_time_ms": 9.717, "learn_throughput": 37050.064, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280}, "done": false, "episodes_total": 937, "training_iteration": 191, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-41-03", "timestamp": 1691131263, "time_this_iter_s": 13.024808168411255, "time_total_s": 2129.7304515838623, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 399.89972472190857, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 22.733333333333334, "ram_util_percent": 63.483333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.7111111111111113e-06, "entropy_coeff": 0.05, "policy_entropy": -600.6328369140625, "policy_loss": -305871504.225, "vf_loss": 130115313.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 633.0, "diff_num_grad_updates_vs_sampler_policy": 632.0}}, "num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720}, "sampler_results": {"episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8926.098180489083, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698, -8862.54689234, -9017.176643914716, -8884.737800825282, -8949.88059055859, -8885.695069956375, -8857.467808105339, -8929.150598877286, -8877.336810063001, -8875.301068587354, -8911.621627751132, -8918.066945834387, -8868.27176647521, -8954.881598251124, -8874.31755682895, -8949.786621961692, -8880.276549239925], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.551119270157001, "mean_inference_ms": 0.3703868025651282, "mean_action_processing_ms": 0.09093098544123965, "mean_env_wait_ms": 1.0048169979150354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493785858154297, "StateBufferConnector_ms": 0.0026259422302246094, "ViewRequirementAgentConnector_ms": 0.0657644271850586}}, "episode_reward_max": -8836.703131153257, "episode_reward_min": -9039.3130220577, "episode_reward_mean": -8926.098180489083, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8963.93190207115, -8953.243511807617, -8982.731430811054, -8866.023637882687, -8927.57907595488, -8953.434828117457, -8878.86383282108, -8988.253782750087, -8969.503481561263, -8890.79231686152, -8949.422470790756, -8868.431235191447, -8873.957245096524, -8969.503651393798, -8997.004572147625, -8910.201991677206, -8965.25658224142, -8974.038832619763, -8947.577845139514, -8984.020565039682, -8899.711164559956, -8900.87516813745, -8966.142114929386, -8939.835780098496, -8927.905909329804, -8915.315170949856, -8915.756474921487, -8961.240424769117, -9039.3130220577, -8965.814836058236, -8983.737091264667, -8920.74190343952, -8924.367083826566, -8882.196084854231, -8998.33829961231, -8886.11537178794, -8944.603545816408, -8970.149411329177, -8919.37894203668, -8903.944317506463, -8908.11776335061, -8972.802979409451, -9012.700861134288, -8904.25888871769, -8914.352369842227, -8911.543507259743, -8896.60283977853, -8836.703131153257, -8877.464821091586, -8879.071526247832, -8966.548589178381, -8987.426756994515, -8885.238753033276, -9010.442861854048, -8876.392719977994, -8881.43775481227, -8958.762431672494, -8983.179237991757, -8920.771118830859, -8969.45280811206, -8910.260749296978, -8914.844330479964, -8899.711164559956, -8855.426288671368, -8955.858148531835, -8884.225022364548, -8909.40592864125, -8963.59564339226, -8981.217978891686, -8947.98960134829, -8971.41010669915, -8875.535797870947, -8881.025374228737, -8860.706907506423, -8945.081416326822, -8892.036359351912, -8902.859497840627, -8838.447930775686, -8999.93894380505, -8931.827727844215, -8995.585449176786, -8889.845946107363, -8889.142712276427, -8884.796443644698, -8862.54689234, -9017.176643914716, -8884.737800825282, -8949.88059055859, -8885.695069956375, -8857.467808105339, -8929.150598877286, -8877.336810063001, -8875.301068587354, -8911.621627751132, -8918.066945834387, -8868.27176647521, -8954.881598251124, -8874.31755682895, -8949.786621961692, -8880.276549239925], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.551119270157001, "mean_inference_ms": 0.3703868025651282, "mean_action_processing_ms": 0.09093098544123965, "mean_env_wait_ms": 1.0048169979150354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493785858154297, "StateBufferConnector_ms": 0.0026259422302246094, "ViewRequirementAgentConnector_ms": 0.0657644271850586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720, "num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.58775643783737, "num_env_steps_trained_throughput_per_sec": 110.58775643783737, "timesteps_total": 165720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 165720, "timers": {"training_iteration_time_ms": 3242.874, "sample_time_ms": 3232.129, "load_time_ms": 0.305, "load_throughput": 1178911.181, "learn_time_ms": 9.682, "learn_throughput": 37181.44, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720}, "done": false, "episodes_total": 941, "training_iteration": 192, "trial_id": "ef4b4_00000", "date": "2023-08-04_09-41-16", "timestamp": 1691131276, "time_this_iter_s": 13.02431607246399, "time_total_s": 2142.7547676563263, "pid": 37648, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17dcf69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 412.92404079437256, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.357894736842105, "ram_util_percent": 63.43684210526317}}
