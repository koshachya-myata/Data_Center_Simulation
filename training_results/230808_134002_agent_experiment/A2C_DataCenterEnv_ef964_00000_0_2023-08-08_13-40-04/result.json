{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.91396484375, "policy_loss": -4844555.115625, "vf_loss": 15470640.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 51422400, "num_env_steps_trained": 51422400, "num_agent_steps_sampled": 51422400, "num_agent_steps_trained": 51422400}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3046.1926791210158, "episode_reward_mean": -3032.436400886651, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158], "episode_lengths": [360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.658152843480632, "mean_inference_ms": 0.4141949086182657, "mean_action_processing_ms": 0.09800061769525155, "mean_env_wait_ms": 4.808460624472609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035762786865234375, "StateBufferConnector_ms": 0.0032782554626464844, "ViewRequirementAgentConnector_ms": 0.07354021072387695}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3046.1926791210158, "episode_reward_mean": -3032.436400886651, "episode_len_mean": 360.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158], "episode_lengths": [360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.658152843480632, "mean_inference_ms": 0.4141949086182657, "mean_action_processing_ms": 0.09800061769525155, "mean_env_wait_ms": 4.808460624472609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035762786865234375, "StateBufferConnector_ms": 0.0032782554626464844, "ViewRequirementAgentConnector_ms": 0.07354021072387695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51422400, "num_agent_steps_trained": 51422400, "num_env_steps_sampled": 51422400, "num_env_steps_trained": 51422400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 70.92580890834033, "num_env_steps_trained_throughput_per_sec": 70.92580890834033, "timesteps_total": 51422400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 51422400, "timers": {"training_iteration_time_ms": 5075.707, "sample_time_ms": 5050.23, "load_time_ms": 0.446, "load_throughput": 807891.621, "learn_time_ms": 24.17, "learn_throughput": 14894.766, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 51422400, "num_env_steps_trained": 51422400, "num_agent_steps_sampled": 51422400, "num_agent_steps_trained": 51422400}, "done": false, "episodes_total": 12297, "training_iteration": 3856, "trial_id": "ef964_00000", "date": "2023-08-08_13-40-21", "timestamp": 1691491221, "time_this_iter_s": 10.154002904891968, "time_total_s": 93031.83345341682, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.154002904891968, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.53999999999999, "ram_util_percent": 65.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -380.5467529296875, "policy_loss": -4266283.24375, "vf_loss": 15379420.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 51423840, "num_env_steps_trained": 51423840, "num_agent_steps_sampled": 51423840, "num_agent_steps_trained": 51423840}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3085.8091895862103, "episode_reward_mean": -3046.324111510406, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954], "episode_lengths": [360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.226366598767994, "mean_inference_ms": 0.39775263361318186, "mean_action_processing_ms": 0.09537018657353624, "mean_env_wait_ms": 3.0594264362741304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.002984205881754557, "ViewRequirementAgentConnector_ms": 0.06830692291259766}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3085.8091895862103, "episode_reward_mean": -3046.324111510406, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954], "episode_lengths": [360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.226366598767994, "mean_inference_ms": 0.39775263361318186, "mean_action_processing_ms": 0.09537018657353624, "mean_env_wait_ms": 3.0594264362741304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.002984205881754557, "ViewRequirementAgentConnector_ms": 0.06830692291259766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51423840, "num_agent_steps_trained": 51423840, "num_env_steps_sampled": 51423840, "num_env_steps_trained": 51423840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.06083688907948, "num_env_steps_trained_throughput_per_sec": 110.06083688907948, "timesteps_total": 51423840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51423840, "timers": {"training_iteration_time_ms": 3872.506, "sample_time_ms": 3856.571, "load_time_ms": 0.363, "load_throughput": 990997.226, "learn_time_ms": 14.767, "learn_throughput": 24379.189, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 51423840, "num_env_steps_trained": 51423840, "num_agent_steps_sampled": 51423840, "num_agent_steps_trained": 51423840}, "done": false, "episodes_total": 12301, "training_iteration": 3857, "trial_id": "ef964_00000", "date": "2023-08-08_13-40-34", "timestamp": 1691491234, "time_this_iter_s": 13.086137056350708, "time_total_s": 93044.91959047318, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.240139961242676, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.605263157894733, "ram_util_percent": 66.04736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.2010070800781, "policy_loss": -18194629.323828124, "vf_loss": 15823375.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 51425280, "num_env_steps_trained": 51425280, "num_agent_steps_sampled": 51425280, "num_agent_steps_trained": 51425280}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3065.6619735255676, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.089736577482963, "mean_inference_ms": 0.39243729738709787, "mean_action_processing_ms": 0.09447375364744906, "mean_env_wait_ms": 2.50588048029221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037288665771484375, "StateBufferConnector_ms": 0.0028705596923828125, "ViewRequirementAgentConnector_ms": 0.06732702255249023}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3065.6619735255676, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.089736577482963, "mean_inference_ms": 0.39243729738709787, "mean_action_processing_ms": 0.09447375364744906, "mean_env_wait_ms": 2.50588048029221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037288665771484375, "StateBufferConnector_ms": 0.0028705596923828125, "ViewRequirementAgentConnector_ms": 0.06732702255249023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51425280, "num_agent_steps_trained": 51425280, "num_env_steps_sampled": 51425280, "num_env_steps_trained": 51425280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.47509014823333, "num_env_steps_trained_throughput_per_sec": 109.47509014823333, "timesteps_total": 51425280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51425280, "timers": {"training_iteration_time_ms": 3638.867, "sample_time_ms": 3625.007, "load_time_ms": 0.333, "load_throughput": 1081315.841, "learn_time_ms": 12.73, "learn_throughput": 28279.914, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 51425280, "num_env_steps_trained": 51425280, "num_agent_steps_sampled": 51425280, "num_agent_steps_trained": 51425280}, "done": false, "episodes_total": 12305, "training_iteration": 3858, "trial_id": "ef964_00000", "date": "2023-08-08_13-40-47", "timestamp": 1691491247, "time_this_iter_s": 13.156225204467773, "time_total_s": 93058.07581567764, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 36.39636516571045, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.866666666666667, "ram_util_percent": 65.95555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.15, "policy_entropy": -370.310400390625, "policy_loss": -2354327.4125, "vf_loss": 15483451.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 51426720, "num_env_steps_trained": 51426720, "num_agent_steps_sampled": 51426720, "num_agent_steps_trained": 51426720}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3060.8651945231095, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.008069253956887, "mean_inference_ms": 0.38951667235690796, "mean_action_processing_ms": 0.09399211215321943, "mean_env_wait_ms": 2.202775758809424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003562654767717634, "StateBufferConnector_ms": 0.0028508050101143973, "ViewRequirementAgentConnector_ms": 0.06700413567679268}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3060.8651945231095, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.008069253956887, "mean_inference_ms": 0.38951667235690796, "mean_action_processing_ms": 0.09399211215321943, "mean_env_wait_ms": 2.202775758809424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003562654767717634, "StateBufferConnector_ms": 0.0028508050101143973, "ViewRequirementAgentConnector_ms": 0.06700413567679268}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51426720, "num_agent_steps_trained": 51426720, "num_env_steps_sampled": 51426720, "num_env_steps_trained": 51426720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.1483659538947, "num_env_steps_trained_throughput_per_sec": 111.1483659538947, "timesteps_total": 51426720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51426720, "timers": {"training_iteration_time_ms": 3265.81, "sample_time_ms": 3254.996, "load_time_ms": 0.293, "load_throughput": 1228700.008, "learn_time_ms": 9.746, "learn_throughput": 36937.135, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51426720, "num_env_steps_trained": 51426720, "num_agent_steps_sampled": 51426720, "num_agent_steps_trained": 51426720}, "done": false, "episodes_total": 12309, "training_iteration": 3859, "trial_id": "ef964_00000", "date": "2023-08-08_13-41-00", "timestamp": 1691491260, "time_this_iter_s": 12.958138942718506, "time_total_s": 93071.03395462036, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 49.354504108428955, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.86315789473684, "ram_util_percent": 65.8842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.15, "policy_entropy": -382.5380432128906, "policy_loss": 325878.49375, "vf_loss": 15368255.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 51428160, "num_env_steps_trained": 51428160, "num_agent_steps_sampled": 51428160, "num_agent_steps_trained": 51428160}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3060.891941385007, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.958301507265206, "mean_inference_ms": 0.3876581657116628, "mean_action_processing_ms": 0.09369821176961277, "mean_env_wait_ms": 2.0064595444806557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034583939446343314, "StateBufferConnector_ms": 0.0028689702351888022, "ViewRequirementAgentConnector_ms": 0.06675190395779079}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3060.891941385007, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.958301507265206, "mean_inference_ms": 0.3876581657116628, "mean_action_processing_ms": 0.09369821176961277, "mean_env_wait_ms": 2.0064595444806557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034583939446343314, "StateBufferConnector_ms": 0.0028689702351888022, "ViewRequirementAgentConnector_ms": 0.06675190395779079}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51428160, "num_agent_steps_trained": 51428160, "num_env_steps_sampled": 51428160, "num_env_steps_trained": 51428160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.61650344059431, "num_env_steps_trained_throughput_per_sec": 109.61650344059431, "timesteps_total": 51428160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51428160, "timers": {"training_iteration_time_ms": 3269.331, "sample_time_ms": 3258.578, "load_time_ms": 0.292, "load_throughput": 1233014.405, "learn_time_ms": 9.687, "learn_throughput": 37164.235, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51428160, "num_env_steps_trained": 51428160, "num_agent_steps_sampled": 51428160, "num_agent_steps_trained": 51428160}, "done": false, "episodes_total": 12313, "training_iteration": 3860, "trial_id": "ef964_00000", "date": "2023-08-08_13-41-14", "timestamp": 1691491274, "time_this_iter_s": 13.139232158660889, "time_total_s": 93084.17318677902, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 62.493736267089844, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.40526315789474, "ram_util_percent": 65.94736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.15, "policy_entropy": -364.0836547851562, "policy_loss": -13809208.0046875, "vf_loss": 15777150.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 51429240, "num_env_steps_trained": 51429240, "num_agent_steps_sampled": 51429240, "num_agent_steps_trained": 51429240}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3060.768453160867, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.936865581319593, "mean_inference_ms": 0.38685654741529035, "mean_action_processing_ms": 0.09357687038007895, "mean_env_wait_ms": 1.8994200105979624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034230095999581473, "StateBufferConnector_ms": 0.002883729480561756, "ViewRequirementAgentConnector_ms": 0.06700583866664342}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3060.768453160867, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.936865581319593, "mean_inference_ms": 0.38685654741529035, "mean_action_processing_ms": 0.09357687038007895, "mean_env_wait_ms": 1.8994200105979624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034230095999581473, "StateBufferConnector_ms": 0.002883729480561756, "ViewRequirementAgentConnector_ms": 0.06700583866664342}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51429240, "num_agent_steps_trained": 51429240, "num_env_steps_sampled": 51429240, "num_env_steps_trained": 51429240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.64373945680687, "num_env_steps_trained_throughput_per_sec": 106.64373945680687, "timesteps_total": 51429240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51429240, "timers": {"training_iteration_time_ms": 3298.968, "sample_time_ms": 3288.129, "load_time_ms": 0.295, "load_throughput": 1221345.499, "learn_time_ms": 9.767, "learn_throughput": 36860.13, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 51429240, "num_env_steps_trained": 51429240, "num_agent_steps_sampled": 51429240, "num_agent_steps_trained": 51429240}, "done": false, "episodes_total": 12316, "training_iteration": 3861, "trial_id": "ef964_00000", "date": "2023-08-08_13-41-24", "timestamp": 1691491284, "time_this_iter_s": 10.129805088043213, "time_total_s": 93094.30299186707, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 72.62354135513306, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.514285714285712, "ram_util_percent": 65.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.15, "policy_entropy": -367.8551513671875, "policy_loss": -7647300.1875, "vf_loss": 15900850.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118.0, "diff_num_grad_updates_vs_sampler_policy": 117.0}}, "num_env_steps_sampled": 51430320, "num_env_steps_trained": 51430320, "num_agent_steps_sampled": 51430320, "num_agent_steps_trained": 51430320}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3065.0360762234445, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.924466665383992, "mean_inference_ms": 0.3863264294399566, "mean_action_processing_ms": 0.0934952382890714, "mean_env_wait_ms": 1.8135804545533236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0028987725575764975, "ViewRequirementAgentConnector_ms": 0.06711483001708984}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3065.0360762234445, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.924466665383992, "mean_inference_ms": 0.3863264294399566, "mean_action_processing_ms": 0.0934952382890714, "mean_env_wait_ms": 1.8135804545533236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0028987725575764975, "ViewRequirementAgentConnector_ms": 0.06711483001708984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51430320, "num_agent_steps_trained": 51430320, "num_env_steps_sampled": 51430320, "num_env_steps_trained": 51430320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.447279739212, "num_env_steps_trained_throughput_per_sec": 105.447279739212, "timesteps_total": 51430320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51430320, "timers": {"training_iteration_time_ms": 3350.585, "sample_time_ms": 3339.745, "load_time_ms": 0.295, "load_throughput": 1220555.687, "learn_time_ms": 9.764, "learn_throughput": 36868.771, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 51430320, "num_env_steps_trained": 51430320, "num_agent_steps_sampled": 51430320, "num_agent_steps_trained": 51430320}, "done": false, "episodes_total": 12319, "training_iteration": 3862, "trial_id": "ef964_00000", "date": "2023-08-08_13-41-34", "timestamp": 1691491294, "time_this_iter_s": 10.244638919830322, "time_total_s": 93104.5476307869, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 82.86818027496338, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.06666666666667, "ram_util_percent": 61.193333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.15, "policy_entropy": -364.5820251464844, "policy_loss": -5294477.16875, "vf_loss": 15595346.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138.0, "diff_num_grad_updates_vs_sampler_policy": 137.0}}, "num_env_steps_sampled": 51431760, "num_env_steps_trained": 51431760, "num_agent_steps_sampled": 51431760, "num_agent_steps_trained": 51431760}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3065.328315133578, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.907850718839109, "mean_inference_ms": 0.385682820931416, "mean_action_processing_ms": 0.0933920910505149, "mean_env_wait_ms": 1.721062275191058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035933085850306918, "StateBufferConnector_ms": 0.0028754983629499164, "ViewRequirementAgentConnector_ms": 0.06715655326843262}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3065.328315133578, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.907850718839109, "mean_inference_ms": 0.385682820931416, "mean_action_processing_ms": 0.0933920910505149, "mean_env_wait_ms": 1.721062275191058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035933085850306918, "StateBufferConnector_ms": 0.0028754983629499164, "ViewRequirementAgentConnector_ms": 0.06715655326843262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51431760, "num_agent_steps_trained": 51431760, "num_env_steps_sampled": 51431760, "num_env_steps_trained": 51431760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.57209445845915, "num_env_steps_trained_throughput_per_sec": 110.57209445845915, "timesteps_total": 51431760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51431760, "timers": {"training_iteration_time_ms": 3339.232, "sample_time_ms": 3328.421, "load_time_ms": 0.297, "load_throughput": 1213590.612, "learn_time_ms": 9.726, "learn_throughput": 37015.278, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 51431760, "num_env_steps_trained": 51431760, "num_agent_steps_sampled": 51431760, "num_agent_steps_trained": 51431760}, "done": false, "episodes_total": 12323, "training_iteration": 3863, "trial_id": "ef964_00000", "date": "2023-08-08_13-41-47", "timestamp": 1691491307, "time_this_iter_s": 13.02572512626648, "time_total_s": 93117.57335591316, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 95.89390540122986, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.333333333333336, "ram_util_percent": 65.15555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.75e-07, "entropy_coeff": 0.15, "policy_entropy": -367.4320922851563, "policy_loss": -368046.390625, "vf_loss": 15256822.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 157.0}}, "num_env_steps_sampled": 51433200, "num_env_steps_trained": 51433200, "num_agent_steps_sampled": 51433200, "num_agent_steps_trained": 51433200}, "sampler_results": {"episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3062.8144053729993, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.893469466300457, "mean_inference_ms": 0.3851706028615395, "mean_action_processing_ms": 0.0933064803072388, "mean_env_wait_ms": 1.6468223975754794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551691770553589, "StateBufferConnector_ms": 0.00287666916847229, "ViewRequirementAgentConnector_ms": 0.06704628467559814}}, "episode_reward_max": -3018.680122652286, "episode_reward_min": -3154.9291313476338, "episode_reward_mean": -3062.8144053729993, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.893469466300457, "mean_inference_ms": 0.3851706028615395, "mean_action_processing_ms": 0.0933064803072388, "mean_env_wait_ms": 1.6468223975754794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551691770553589, "StateBufferConnector_ms": 0.00287666916847229, "ViewRequirementAgentConnector_ms": 0.06704628467559814}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51433200, "num_agent_steps_trained": 51433200, "num_env_steps_sampled": 51433200, "num_env_steps_trained": 51433200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.23554840225378, "num_env_steps_trained_throughput_per_sec": 110.23554840225378, "timesteps_total": 51433200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51433200, "timers": {"training_iteration_time_ms": 3291.13, "sample_time_ms": 3280.32, "load_time_ms": 0.295, "load_throughput": 1219274.419, "learn_time_ms": 9.749, "learn_throughput": 36926.476, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51433200, "num_env_steps_trained": 51433200, "num_agent_steps_sampled": 51433200, "num_agent_steps_trained": 51433200}, "done": false, "episodes_total": 12327, "training_iteration": 3864, "trial_id": "ef964_00000", "date": "2023-08-08_13-42-00", "timestamp": 1691491320, "time_this_iter_s": 13.065537691116333, "time_total_s": 93130.63889360428, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 108.95944309234619, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.542105263157897, "ram_util_percent": 65.3157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.75e-07, "entropy_coeff": 0.15, "policy_entropy": -362.87626953125, "policy_loss": -19918153.2, "vf_loss": 16789211.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 178.0, "diff_num_grad_updates_vs_sampler_policy": 177.0}}, "num_env_steps_sampled": 51434640, "num_env_steps_trained": 51434640, "num_agent_steps_sampled": 51434640, "num_agent_steps_trained": 51434640}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3065.378371563699, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.880808819383862, "mean_inference_ms": 0.3847455510672839, "mean_action_processing_ms": 0.09323463978421499, "mean_env_wait_ms": 1.5863138099276692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035093890296088327, "StateBufferConnector_ms": 0.002870957056681315, "ViewRequirementAgentConnector_ms": 0.06692740652296278}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3065.378371563699, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.880808819383862, "mean_inference_ms": 0.3847455510672839, "mean_action_processing_ms": 0.09323463978421499, "mean_env_wait_ms": 1.5863138099276692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035093890296088327, "StateBufferConnector_ms": 0.002870957056681315, "ViewRequirementAgentConnector_ms": 0.06692740652296278}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51434640, "num_agent_steps_trained": 51434640, "num_env_steps_sampled": 51434640, "num_env_steps_trained": 51434640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.81302324975907, "num_env_steps_trained_throughput_per_sec": 109.81302324975907, "timesteps_total": 51434640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51434640, "timers": {"training_iteration_time_ms": 3268.701, "sample_time_ms": 3257.89, "load_time_ms": 0.297, "load_throughput": 1212323.918, "learn_time_ms": 9.74, "learn_throughput": 36961.728, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51434640, "num_env_steps_trained": 51434640, "num_agent_steps_sampled": 51434640, "num_agent_steps_trained": 51434640}, "done": false, "episodes_total": 12331, "training_iteration": 3865, "trial_id": "ef964_00000", "date": "2023-08-08_13-42-13", "timestamp": 1691491333, "time_this_iter_s": 13.115747928619385, "time_total_s": 93143.7546415329, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 122.07519102096558, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.266666666666666, "ram_util_percent": 65.57222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.75e-07, "entropy_coeff": 0.15, "policy_entropy": -364.5562683105469, "policy_loss": -9138247.178125, "vf_loss": 15719531.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 198.0, "diff_num_grad_updates_vs_sampler_policy": 197.0}}, "num_env_steps_sampled": 51436080, "num_env_steps_trained": 51436080, "num_agent_steps_sampled": 51436080, "num_agent_steps_trained": 51436080}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3064.9902131566173, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.869929592952357, "mean_inference_ms": 0.38435317293352755, "mean_action_processing_ms": 0.09316736779982634, "mean_env_wait_ms": 1.5355886828748935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034755468368530273, "StateBufferConnector_ms": 0.0028634071350097656, "ViewRequirementAgentConnector_ms": 0.0668799877166748}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3064.9902131566173, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.869929592952357, "mean_inference_ms": 0.38435317293352755, "mean_action_processing_ms": 0.09316736779982634, "mean_env_wait_ms": 1.5355886828748935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034755468368530273, "StateBufferConnector_ms": 0.0028634071350097656, "ViewRequirementAgentConnector_ms": 0.0668799877166748}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51436080, "num_agent_steps_trained": 51436080, "num_env_steps_sampled": 51436080, "num_env_steps_trained": 51436080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.8691296609196, "num_env_steps_trained_throughput_per_sec": 109.8691296609196, "timesteps_total": 51436080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51436080, "timers": {"training_iteration_time_ms": 3274.05, "sample_time_ms": 3263.197, "load_time_ms": 0.3, "load_throughput": 1201615.025, "learn_time_ms": 9.793, "learn_throughput": 36761.058, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51436080, "num_env_steps_trained": 51436080, "num_agent_steps_sampled": 51436080, "num_agent_steps_trained": 51436080}, "done": false, "episodes_total": 12335, "training_iteration": 3866, "trial_id": "ef964_00000", "date": "2023-08-08_13-42-26", "timestamp": 1691491346, "time_this_iter_s": 13.109205961227417, "time_total_s": 93156.86384749413, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.184396982193, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.357894736842102, "ram_util_percent": 65.30526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.15, "policy_entropy": -363.63860473632815, "policy_loss": -10349509.703125, "vf_loss": 15844036.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 217.0}}, "num_env_steps_sampled": 51437520, "num_env_steps_trained": 51437520, "num_agent_steps_sampled": 51437520, "num_agent_steps_trained": 51437520}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3064.790244467704, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.860087156819219, "mean_inference_ms": 0.3840082747565765, "mean_action_processing_ms": 0.09310465630852241, "mean_env_wait_ms": 1.492476498809613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003606622869318182, "StateBufferConnector_ms": 0.002853978763927113, "ViewRequirementAgentConnector_ms": 0.06687153469432484}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3064.790244467704, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.860087156819219, "mean_inference_ms": 0.3840082747565765, "mean_action_processing_ms": 0.09310465630852241, "mean_env_wait_ms": 1.492476498809613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003606622869318182, "StateBufferConnector_ms": 0.002853978763927113, "ViewRequirementAgentConnector_ms": 0.06687153469432484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51437520, "num_agent_steps_trained": 51437520, "num_env_steps_sampled": 51437520, "num_env_steps_trained": 51437520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.24660325960473, "num_env_steps_trained_throughput_per_sec": 110.24660325960473, "timesteps_total": 51437520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51437520, "timers": {"training_iteration_time_ms": 3278.229, "sample_time_ms": 3267.365, "load_time_ms": 0.299, "load_throughput": 1203051.103, "learn_time_ms": 9.801, "learn_throughput": 36729.225, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 51437520, "num_env_steps_trained": 51437520, "num_agent_steps_sampled": 51437520, "num_agent_steps_trained": 51437520}, "done": false, "episodes_total": 12339, "training_iteration": 3867, "trial_id": "ef964_00000", "date": "2023-08-08_13-42-40", "timestamp": 1691491360, "time_this_iter_s": 13.064375877380371, "time_total_s": 93169.9282233715, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 148.24877285957336, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.3, "ram_util_percent": 65.5421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.15, "policy_entropy": -368.2115173339844, "policy_loss": -3903265.44375, "vf_loss": 15196609.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 238.0, "diff_num_grad_updates_vs_sampler_policy": 237.0}}, "num_env_steps_sampled": 51438960, "num_env_steps_trained": 51438960, "num_agent_steps_sampled": 51438960, "num_agent_steps_trained": 51438960}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3065.6558168583506, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.851787801581929, "mean_inference_ms": 0.3837154937018276, "mean_action_processing_ms": 0.09304806616363141, "mean_env_wait_ms": 1.4553339540696804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003641843795776367, "StateBufferConnector_ms": 0.002858539422353109, "ViewRequirementAgentConnector_ms": 0.06690075000127156}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3065.6558168583506, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.851787801581929, "mean_inference_ms": 0.3837154937018276, "mean_action_processing_ms": 0.09304806616363141, "mean_env_wait_ms": 1.4553339540696804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003641843795776367, "StateBufferConnector_ms": 0.002858539422353109, "ViewRequirementAgentConnector_ms": 0.06690075000127156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51438960, "num_agent_steps_trained": 51438960, "num_env_steps_sampled": 51438960, "num_env_steps_trained": 51438960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.12572300470755, "num_env_steps_trained_throughput_per_sec": 109.12572300470755, "timesteps_total": 51438960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51438960, "timers": {"training_iteration_time_ms": 3285.91, "sample_time_ms": 3275.022, "load_time_ms": 0.299, "load_throughput": 1204778.936, "learn_time_ms": 9.827, "learn_throughput": 36635.031, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 51438960, "num_env_steps_trained": 51438960, "num_agent_steps_sampled": 51438960, "num_agent_steps_trained": 51438960}, "done": false, "episodes_total": 12343, "training_iteration": 3868, "trial_id": "ef964_00000", "date": "2023-08-08_13-42-53", "timestamp": 1691491373, "time_this_iter_s": 13.198565006256104, "time_total_s": 93183.12678837776, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 161.44733786582947, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.116666666666664, "ram_util_percent": 65.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.15, "policy_entropy": -365.11943969726565, "policy_loss": -22542486.665625, "vf_loss": 16405773.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 258.0, "diff_num_grad_updates_vs_sampler_policy": 257.0}}, "num_env_steps_sampled": 51440400, "num_env_steps_trained": 51440400, "num_agent_steps_sampled": 51440400, "num_agent_steps_trained": 51440400}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3070.0617232798513, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.844791689547543, "mean_inference_ms": 0.3834548703938862, "mean_action_processing_ms": 0.09299605909604985, "mean_env_wait_ms": 1.423325008146642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036014960362361027, "StateBufferConnector_ms": 0.002850019014798678, "ViewRequirementAgentConnector_ms": 0.06681772378774789}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3070.0617232798513, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.844791689547543, "mean_inference_ms": 0.3834548703938862, "mean_action_processing_ms": 0.09299605909604985, "mean_env_wait_ms": 1.423325008146642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036014960362361027, "StateBufferConnector_ms": 0.002850019014798678, "ViewRequirementAgentConnector_ms": 0.06681772378774789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51440400, "num_agent_steps_trained": 51440400, "num_env_steps_sampled": 51440400, "num_env_steps_trained": 51440400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.2024437336962, "num_env_steps_trained_throughput_per_sec": 108.2024437336962, "timesteps_total": 51440400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51440400, "timers": {"training_iteration_time_ms": 3310.828, "sample_time_ms": 3299.999, "load_time_ms": 0.299, "load_throughput": 1202572.029, "learn_time_ms": 9.769, "learn_throughput": 36851.314, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 51440400, "num_env_steps_trained": 51440400, "num_agent_steps_sampled": 51440400, "num_agent_steps_trained": 51440400}, "done": false, "episodes_total": 12347, "training_iteration": 3869, "trial_id": "ef964_00000", "date": "2023-08-08_13-43-06", "timestamp": 1691491386, "time_this_iter_s": 13.311049938201904, "time_total_s": 93196.43783831596, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 174.75838780403137, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.510526315789473, "ram_util_percent": 65.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.15, "policy_entropy": -363.0072021484375, "policy_loss": -6376905.85625, "vf_loss": 15219375.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 278.0, "diff_num_grad_updates_vs_sampler_policy": 277.0}}, "num_env_steps_sampled": 51441840, "num_env_steps_trained": 51441840, "num_agent_steps_sampled": 51441840, "num_agent_steps_trained": 51441840}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3069.5174602518296, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.838288381508554, "mean_inference_ms": 0.3832242107889091, "mean_action_processing_ms": 0.09294877601441377, "mean_env_wait_ms": 1.3950965592278446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003573298454284668, "StateBufferConnector_ms": 0.002839735576084682, "ViewRequirementAgentConnector_ms": 0.06674017224993024}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3069.5174602518296, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.838288381508554, "mean_inference_ms": 0.3832242107889091, "mean_action_processing_ms": 0.09294877601441377, "mean_env_wait_ms": 1.3950965592278446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003573298454284668, "StateBufferConnector_ms": 0.002839735576084682, "ViewRequirementAgentConnector_ms": 0.06674017224993024}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51441840, "num_agent_steps_trained": 51441840, "num_env_steps_sampled": 51441840, "num_env_steps_trained": 51441840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.19238044529138, "num_env_steps_trained_throughput_per_sec": 110.19238044529138, "timesteps_total": 51441840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51441840, "timers": {"training_iteration_time_ms": 3292.183, "sample_time_ms": 3281.328, "load_time_ms": 0.301, "load_throughput": 1195431.431, "learn_time_ms": 9.785, "learn_throughput": 36789.81, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51441840, "num_env_steps_trained": 51441840, "num_agent_steps_sampled": 51441840, "num_agent_steps_trained": 51441840}, "done": false, "episodes_total": 12351, "training_iteration": 3870, "trial_id": "ef964_00000", "date": "2023-08-08_13-43-19", "timestamp": 1691491399, "time_this_iter_s": 13.070810079574585, "time_total_s": 93209.50864839554, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 187.82919788360596, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.778947368421054, "ram_util_percent": 65.32105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.15, "policy_entropy": -369.1820129394531, "policy_loss": -9155714.4234375, "vf_loss": 15491735.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 298.0, "diff_num_grad_updates_vs_sampler_policy": 297.0}}, "num_env_steps_sampled": 51443280, "num_env_steps_trained": 51443280, "num_agent_steps_sampled": 51443280, "num_agent_steps_trained": 51443280}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3069.1415895864466, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.8322991474971975, "mean_inference_ms": 0.38301415880198725, "mean_action_processing_ms": 0.09290509004507982, "mean_env_wait_ms": 1.3699728519854701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541707992553711, "StateBufferConnector_ms": 0.0028514862060546875, "ViewRequirementAgentConnector_ms": 0.0667126973470052}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3069.1415895864466, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.8322991474971975, "mean_inference_ms": 0.38301415880198725, "mean_action_processing_ms": 0.09290509004507982, "mean_env_wait_ms": 1.3699728519854701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541707992553711, "StateBufferConnector_ms": 0.0028514862060546875, "ViewRequirementAgentConnector_ms": 0.0667126973470052}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51443280, "num_agent_steps_trained": 51443280, "num_env_steps_sampled": 51443280, "num_env_steps_trained": 51443280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.09883998602938, "num_env_steps_trained_throughput_per_sec": 110.09883998602938, "timesteps_total": 51443280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51443280, "timers": {"training_iteration_time_ms": 3280.275, "sample_time_ms": 3269.374, "load_time_ms": 0.3, "load_throughput": 1201328.22, "learn_time_ms": 9.828, "learn_throughput": 36631.032, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 51443280, "num_env_steps_trained": 51443280, "num_agent_steps_sampled": 51443280, "num_agent_steps_trained": 51443280}, "done": false, "episodes_total": 12355, "training_iteration": 3871, "trial_id": "ef964_00000", "date": "2023-08-08_13-43-32", "timestamp": 1691491412, "time_this_iter_s": 13.081995964050293, "time_total_s": 93222.59064435959, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 200.91119384765625, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.210526315789473, "ram_util_percent": 65.47368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.15, "policy_entropy": -365.1141418457031, "policy_loss": -3085059.134375, "vf_loss": 15922896.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 318.0, "diff_num_grad_updates_vs_sampler_policy": 317.0}}, "num_env_steps_sampled": 51444720, "num_env_steps_trained": 51444720, "num_agent_steps_sampled": 51444720, "num_agent_steps_trained": 51444720}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3068.085137119714, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.827155074323333, "mean_inference_ms": 0.3828208353546506, "mean_action_processing_ms": 0.09286346694010729, "mean_env_wait_ms": 1.347390859422152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003563240170478821, "StateBufferConnector_ms": 0.002843514084815979, "ViewRequirementAgentConnector_ms": 0.06671994924545288}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3068.085137119714, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.827155074323333, "mean_inference_ms": 0.3828208353546506, "mean_action_processing_ms": 0.09286346694010729, "mean_env_wait_ms": 1.347390859422152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003563240170478821, "StateBufferConnector_ms": 0.002843514084815979, "ViewRequirementAgentConnector_ms": 0.06671994924545288}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51444720, "num_agent_steps_trained": 51444720, "num_env_steps_sampled": 51444720, "num_env_steps_trained": 51444720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.09387620215678, "num_env_steps_trained_throughput_per_sec": 109.09387620215678, "timesteps_total": 51444720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51444720, "timers": {"training_iteration_time_ms": 3279.265, "sample_time_ms": 3268.275, "load_time_ms": 0.299, "load_throughput": 1205837.278, "learn_time_ms": 9.907, "learn_throughput": 36336.342, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 51444720, "num_env_steps_trained": 51444720, "num_agent_steps_sampled": 51444720, "num_agent_steps_trained": 51444720}, "done": false, "episodes_total": 12359, "training_iteration": 3872, "trial_id": "ef964_00000", "date": "2023-08-08_13-43-46", "timestamp": 1691491426, "time_this_iter_s": 13.202384948730469, "time_total_s": 93235.79302930832, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 214.11357879638672, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.294444444444444, "ram_util_percent": 65.43888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.15, "policy_entropy": -371.846875, "policy_loss": -2916790.91875, "vf_loss": 15493793.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 337.0}}, "num_env_steps_sampled": 51446160, "num_env_steps_trained": 51446160, "num_agent_steps_sampled": 51446160, "num_agent_steps_trained": 51446160}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3068.866572170422, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.822498664201581, "mean_inference_ms": 0.38265204270211906, "mean_action_processing_ms": 0.09282737104712692, "mean_env_wait_ms": 1.327054928866941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.002855062484741211, "ViewRequirementAgentConnector_ms": 0.06679822416866527}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3068.866572170422, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.822498664201581, "mean_inference_ms": 0.38265204270211906, "mean_action_processing_ms": 0.09282737104712692, "mean_env_wait_ms": 1.327054928866941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.002855062484741211, "ViewRequirementAgentConnector_ms": 0.06679822416866527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51446160, "num_agent_steps_trained": 51446160, "num_env_steps_sampled": 51446160, "num_env_steps_trained": 51446160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.44168664708731, "num_env_steps_trained_throughput_per_sec": 109.44168664708731, "timesteps_total": 51446160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51446160, "timers": {"training_iteration_time_ms": 3285.869, "sample_time_ms": 3274.973, "load_time_ms": 0.298, "load_throughput": 1207090.447, "learn_time_ms": 9.822, "learn_throughput": 36653.084, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51446160, "num_env_steps_trained": 51446160, "num_agent_steps_sampled": 51446160, "num_agent_steps_trained": 51446160}, "done": false, "episodes_total": 12363, "training_iteration": 3873, "trial_id": "ef964_00000", "date": "2023-08-08_13-43-59", "timestamp": 1691491439, "time_this_iter_s": 13.16056489944458, "time_total_s": 93248.95359420776, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 227.2741436958313, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.61578947368421, "ram_util_percent": 65.40526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.35e-07, "entropy_coeff": 0.15, "policy_entropy": -368.98271484375, "policy_loss": -12189324.565625, "vf_loss": 16599309.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 358.0, "diff_num_grad_updates_vs_sampler_policy": 357.0}}, "num_env_steps_sampled": 51447600, "num_env_steps_trained": 51447600, "num_agent_steps_sampled": 51447600, "num_agent_steps_trained": 51447600}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3070.239897531613, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.81832273180138, "mean_inference_ms": 0.38249792073293026, "mean_action_processing_ms": 0.09279470258207839, "mean_env_wait_ms": 1.3086782508629604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035822391510009766, "StateBufferConnector_ms": 0.0028567181693183053, "ViewRequirementAgentConnector_ms": 0.06681283315022786}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.6745671192125, "episode_reward_mean": -3070.239897531613, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.81832273180138, "mean_inference_ms": 0.38249792073293026, "mean_action_processing_ms": 0.09279470258207839, "mean_env_wait_ms": 1.3086782508629604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035822391510009766, "StateBufferConnector_ms": 0.0028567181693183053, "ViewRequirementAgentConnector_ms": 0.06681283315022786}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51447600, "num_agent_steps_trained": 51447600, "num_env_steps_sampled": 51447600, "num_env_steps_trained": 51447600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.05369066296537, "num_env_steps_trained_throughput_per_sec": 109.05369066296537, "timesteps_total": 51447600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51447600, "timers": {"training_iteration_time_ms": 3298.811, "sample_time_ms": 3287.941, "load_time_ms": 0.296, "load_throughput": 1214176.134, "learn_time_ms": 9.806, "learn_throughput": 36711.543, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 51447600, "num_env_steps_trained": 51447600, "num_agent_steps_sampled": 51447600, "num_agent_steps_trained": 51447600}, "done": false, "episodes_total": 12367, "training_iteration": 3874, "trial_id": "ef964_00000", "date": "2023-08-08_13-44-12", "timestamp": 1691491452, "time_this_iter_s": 13.20714020729065, "time_total_s": 93262.16073441505, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 240.48128390312195, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.947368421052634, "ram_util_percent": 65.47368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.75e-07, "entropy_coeff": 0.15, "policy_entropy": -362.93255004882815, "policy_loss": -15930019.025, "vf_loss": 17027881.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 378.0, "diff_num_grad_updates_vs_sampler_policy": 377.0}}, "num_env_steps_sampled": 51449040, "num_env_steps_trained": 51449040, "num_agent_steps_sampled": 51449040, "num_agent_steps_trained": 51449040}, "sampler_results": {"episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3071.7185894958466, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.814004275485771, "mean_inference_ms": 0.3823650232276159, "mean_action_processing_ms": 0.09276610352997522, "mean_env_wait_ms": 1.2919716128742877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035568287498072572, "StateBufferConnector_ms": 0.0028522391068307976, "ViewRequirementAgentConnector_ms": 0.06679798427381013}}, "episode_reward_max": -3002.230092148154, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3071.7185894958466, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.814004275485771, "mean_inference_ms": 0.3823650232276159, "mean_action_processing_ms": 0.09276610352997522, "mean_env_wait_ms": 1.2919716128742877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035568287498072572, "StateBufferConnector_ms": 0.0028522391068307976, "ViewRequirementAgentConnector_ms": 0.06679798427381013}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51449040, "num_agent_steps_trained": 51449040, "num_env_steps_sampled": 51449040, "num_env_steps_trained": 51449040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.46922072119051, "num_env_steps_trained_throughput_per_sec": 111.46922072119051, "timesteps_total": 51449040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51449040, "timers": {"training_iteration_time_ms": 3272.476, "sample_time_ms": 3261.661, "load_time_ms": 0.295, "load_throughput": 1220555.687, "learn_time_ms": 9.764, "learn_throughput": 36871.201, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 51449040, "num_env_steps_trained": 51449040, "num_agent_steps_sampled": 51449040, "num_agent_steps_trained": 51449040}, "done": false, "episodes_total": 12371, "training_iteration": 3875, "trial_id": "ef964_00000", "date": "2023-08-08_13-44-25", "timestamp": 1691491465, "time_this_iter_s": 12.921328067779541, "time_total_s": 93275.08206248283, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 253.4026119709015, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.038888888888888, "ram_util_percent": 65.42777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1499999999999998e-07, "entropy_coeff": 0.15, "policy_entropy": -365.4497497558594, "policy_loss": -7359724.028125, "vf_loss": 16146203.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 398.0, "diff_num_grad_updates_vs_sampler_policy": 397.0}}, "num_env_steps_sampled": 51450480, "num_env_steps_trained": 51450480, "num_agent_steps_sampled": 51450480, "num_agent_steps_trained": 51450480}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.137424539732, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.8102174023978055, "mean_inference_ms": 0.382239385563986, "mean_action_processing_ms": 0.09273919579203306, "mean_env_wait_ms": 1.2767284057502273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035312771797180176, "StateBufferConnector_ms": 0.002849400043487549, "ViewRequirementAgentConnector_ms": 0.06678968667984009}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.137424539732, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.8102174023978055, "mean_inference_ms": 0.382239385563986, "mean_action_processing_ms": 0.09273919579203306, "mean_env_wait_ms": 1.2767284057502273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035312771797180176, "StateBufferConnector_ms": 0.002849400043487549, "ViewRequirementAgentConnector_ms": 0.06678968667984009}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51450480, "num_agent_steps_trained": 51450480, "num_env_steps_sampled": 51450480, "num_env_steps_trained": 51450480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.54579776033047, "num_env_steps_trained_throughput_per_sec": 108.54579776033047, "timesteps_total": 51450480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51450480, "timers": {"training_iteration_time_ms": 3281.195, "sample_time_ms": 3270.333, "load_time_ms": 0.297, "load_throughput": 1213980.897, "learn_time_ms": 9.787, "learn_throughput": 36782.819, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 51450480, "num_env_steps_trained": 51450480, "num_agent_steps_sampled": 51450480, "num_agent_steps_trained": 51450480}, "done": false, "episodes_total": 12375, "training_iteration": 3876, "trial_id": "ef964_00000", "date": "2023-08-08_13-44-38", "timestamp": 1691491478, "time_this_iter_s": 13.269071817398071, "time_total_s": 93288.35113430023, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 266.67168378829956, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.08421052631579, "ram_util_percent": 65.69473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -372.33289794921876, "policy_loss": -349622.075, "vf_loss": 15232474.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 418.0, "diff_num_grad_updates_vs_sampler_policy": 417.0}}, "num_env_steps_sampled": 51451920, "num_env_steps_trained": 51451920, "num_agent_steps_sampled": 51451920, "num_agent_steps_trained": 51451920}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.1280518478984, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.806640593068591, "mean_inference_ms": 0.3821168473670579, "mean_action_processing_ms": 0.09271310340249717, "mean_env_wait_ms": 1.2626777513013185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035501661754789807, "StateBufferConnector_ms": 0.0028459798722040085, "ViewRequirementAgentConnector_ms": 0.0667870044708252}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.1280518478984, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.806640593068591, "mean_inference_ms": 0.3821168473670579, "mean_action_processing_ms": 0.09271310340249717, "mean_env_wait_ms": 1.2626777513013185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035501661754789807, "StateBufferConnector_ms": 0.0028459798722040085, "ViewRequirementAgentConnector_ms": 0.0667870044708252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51451920, "num_agent_steps_trained": 51451920, "num_env_steps_sampled": 51451920, "num_env_steps_trained": 51451920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.24524090130984, "num_env_steps_trained_throughput_per_sec": 110.24524090130984, "timesteps_total": 51451920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51451920, "timers": {"training_iteration_time_ms": 3274.982, "sample_time_ms": 3264.139, "load_time_ms": 0.298, "load_throughput": 1207476.561, "learn_time_ms": 9.761, "learn_throughput": 36882.459, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 51451920, "num_env_steps_trained": 51451920, "num_agent_steps_sampled": 51451920, "num_agent_steps_trained": 51451920}, "done": false, "episodes_total": 12379, "training_iteration": 3877, "trial_id": "ef964_00000", "date": "2023-08-08_13-44-51", "timestamp": 1691491491, "time_this_iter_s": 13.064519882202148, "time_total_s": 93301.41565418243, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 279.7362036705017, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.91578947368421, "ram_util_percent": 65.67894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -368.59699096679685, "policy_loss": -9737691.825, "vf_loss": 15927916.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 438.0, "diff_num_grad_updates_vs_sampler_policy": 437.0}}, "num_env_steps_sampled": 51453360, "num_env_steps_trained": 51453360, "num_agent_steps_sampled": 51453360, "num_agent_steps_trained": 51453360}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.3817869663208, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.803315440794046, "mean_inference_ms": 0.38200353738022136, "mean_action_processing_ms": 0.09268883315297236, "mean_env_wait_ms": 1.2497487944964716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035730275240811434, "StateBufferConnector_ms": 0.0028472055088390002, "ViewRequirementAgentConnector_ms": 0.06680488586425781}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.3817869663208, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.803315440794046, "mean_inference_ms": 0.38200353738022136, "mean_action_processing_ms": 0.09268883315297236, "mean_env_wait_ms": 1.2497487944964716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035730275240811434, "StateBufferConnector_ms": 0.0028472055088390002, "ViewRequirementAgentConnector_ms": 0.06680488586425781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51453360, "num_agent_steps_trained": 51453360, "num_env_steps_sampled": 51453360, "num_env_steps_trained": 51453360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.46996493073871, "num_env_steps_trained_throughput_per_sec": 109.46996493073871, "timesteps_total": 51453360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51453360, "timers": {"training_iteration_time_ms": 3283.404, "sample_time_ms": 3272.599, "load_time_ms": 0.299, "load_throughput": 1204586.709, "learn_time_ms": 9.732, "learn_throughput": 36993.06, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51453360, "num_env_steps_trained": 51453360, "num_agent_steps_sampled": 51453360, "num_agent_steps_trained": 51453360}, "done": false, "episodes_total": 12383, "training_iteration": 3878, "trial_id": "ef964_00000", "date": "2023-08-08_13-45-04", "timestamp": 1691491504, "time_this_iter_s": 13.157063961029053, "time_total_s": 93314.57271814346, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 292.89326763153076, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.089473684210525, "ram_util_percent": 65.7421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -363.4522338867188, "policy_loss": -4157875.7109375, "vf_loss": 15551980.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 458.0, "diff_num_grad_updates_vs_sampler_policy": 457.0}}, "num_env_steps_sampled": 51454800, "num_env_steps_trained": 51454800, "num_agent_steps_sampled": 51454800, "num_agent_steps_trained": 51454800}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.3170264435903, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.800289374163126, "mean_inference_ms": 0.3818955785017854, "mean_action_processing_ms": 0.09266618685014519, "mean_env_wait_ms": 1.2377698616429116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035612479500148606, "StateBufferConnector_ms": 0.002847028815228006, "ViewRequirementAgentConnector_ms": 0.06679555644159732}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.3170264435903, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.800289374163126, "mean_inference_ms": 0.3818955785017854, "mean_action_processing_ms": 0.09266618685014519, "mean_env_wait_ms": 1.2377698616429116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035612479500148606, "StateBufferConnector_ms": 0.002847028815228006, "ViewRequirementAgentConnector_ms": 0.06679555644159732}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51454800, "num_agent_steps_trained": 51454800, "num_env_steps_sampled": 51454800, "num_env_steps_trained": 51454800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.2526046765443, "num_env_steps_trained_throughput_per_sec": 109.2526046765443, "timesteps_total": 51454800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51454800, "timers": {"training_iteration_time_ms": 3279.609, "sample_time_ms": 3268.741, "load_time_ms": 0.299, "load_throughput": 1204106.411, "learn_time_ms": 9.798, "learn_throughput": 36743.257, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51454800, "num_env_steps_trained": 51454800, "num_agent_steps_sampled": 51454800, "num_agent_steps_trained": 51454800}, "done": false, "episodes_total": 12387, "training_iteration": 3879, "trial_id": "ef964_00000", "date": "2023-08-08_13-45-18", "timestamp": 1691491518, "time_this_iter_s": 13.183362245559692, "time_total_s": 93327.75608038902, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 306.07662987709045, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.21111111111111, "ram_util_percent": 65.60555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -361.6263793945312, "policy_loss": -7142551.775, "vf_loss": 15531808.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 478.0, "diff_num_grad_updates_vs_sampler_policy": 477.0}}, "num_env_steps_sampled": 51456240, "num_env_steps_trained": 51456240, "num_agent_steps_sampled": 51456240, "num_agent_steps_trained": 51456240}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.7219486861272, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.797519946515659, "mean_inference_ms": 0.3817933931766471, "mean_action_processing_ms": 0.09264484168758517, "mean_env_wait_ms": 1.2266271187470088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003540515899658203, "StateBufferConnector_ms": 0.0028483569622039795, "ViewRequirementAgentConnector_ms": 0.06675596038500468}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.7219486861272, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.797519946515659, "mean_inference_ms": 0.3817933931766471, "mean_action_processing_ms": 0.09264484168758517, "mean_env_wait_ms": 1.2266271187470088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003540515899658203, "StateBufferConnector_ms": 0.0028483569622039795, "ViewRequirementAgentConnector_ms": 0.06675596038500468}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51456240, "num_agent_steps_trained": 51456240, "num_env_steps_sampled": 51456240, "num_env_steps_trained": 51456240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.34623048925911, "num_env_steps_trained_throughput_per_sec": 109.34623048925911, "timesteps_total": 51456240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51456240, "timers": {"training_iteration_time_ms": 3292.625, "sample_time_ms": 3281.693, "load_time_ms": 0.298, "load_throughput": 1208829.91, "learn_time_ms": 9.872, "learn_throughput": 36467.1, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 51456240, "num_env_steps_trained": 51456240, "num_agent_steps_sampled": 51456240, "num_agent_steps_trained": 51456240}, "done": false, "episodes_total": 12391, "training_iteration": 3880, "trial_id": "ef964_00000", "date": "2023-08-08_13-45-31", "timestamp": 1691491531, "time_this_iter_s": 13.172290802001953, "time_total_s": 93340.92837119102, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 319.2489206790924, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.23157894736842, "ram_util_percent": 65.56842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -378.8879150390625, "policy_loss": 226997.4375, "vf_loss": 15188816.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 498.0, "diff_num_grad_updates_vs_sampler_policy": 497.0}}, "num_env_steps_sampled": 51457680, "num_env_steps_trained": 51457680, "num_agent_steps_sampled": 51457680, "num_agent_steps_trained": 51457680}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.9174383282057, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.795004112335732, "mean_inference_ms": 0.3816965549075181, "mean_action_processing_ms": 0.09262512282985608, "mean_env_wait_ms": 1.2162392457057287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035316944122314453, "StateBufferConnector_ms": 0.002861499786376953, "ViewRequirementAgentConnector_ms": 0.06677436828613281}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.9174383282057, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3018.680122652286, -3046.1926791210158, -3085.8091895862103, -3041.523703637113, -3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.795004112335732, "mean_inference_ms": 0.3816965549075181, "mean_action_processing_ms": 0.09262512282985608, "mean_env_wait_ms": 1.2162392457057287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035316944122314453, "StateBufferConnector_ms": 0.002861499786376953, "ViewRequirementAgentConnector_ms": 0.06677436828613281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51457680, "num_agent_steps_trained": 51457680, "num_env_steps_sampled": 51457680, "num_env_steps_trained": 51457680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.0840265187091, "num_env_steps_trained_throughput_per_sec": 109.0840265187091, "timesteps_total": 51457680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51457680, "timers": {"training_iteration_time_ms": 3293.614, "sample_time_ms": 3282.754, "load_time_ms": 0.298, "load_throughput": 1206801.023, "learn_time_ms": 9.795, "learn_throughput": 36754.168, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51457680, "num_env_steps_trained": 51457680, "num_agent_steps_sampled": 51457680, "num_agent_steps_trained": 51457680}, "done": false, "episodes_total": 12395, "training_iteration": 3881, "trial_id": "ef964_00000", "date": "2023-08-08_13-45-44", "timestamp": 1691491544, "time_this_iter_s": 13.203732967376709, "time_total_s": 93354.1321041584, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 332.4526536464691, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.73684210526316, "ram_util_percent": 65.82631578947367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -370.20849609375, "policy_loss": -5401851.0625, "vf_loss": 15477904.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 517.0}}, "num_env_steps_sampled": 51459120, "num_env_steps_trained": 51459120, "num_agent_steps_sampled": 51459120, "num_agent_steps_trained": 51459120}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.08576801599, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.771067159165384, "mean_inference_ms": 0.3807961741914527, "mean_action_processing_ms": 0.09246958594881899, "mean_env_wait_ms": 1.1148896149695735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035278797149658203, "StateBufferConnector_ms": 0.0028502941131591797, "ViewRequirementAgentConnector_ms": 0.06661438941955566}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.08576801599, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3043.8388840150146, -3041.9000900507954, -3111.973011095845, -3022.890200151452, -3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.771067159165384, "mean_inference_ms": 0.3807961741914527, "mean_action_processing_ms": 0.09246958594881899, "mean_env_wait_ms": 1.1148896149695735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035278797149658203, "StateBufferConnector_ms": 0.0028502941131591797, "ViewRequirementAgentConnector_ms": 0.06661438941955566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51459120, "num_agent_steps_trained": 51459120, "num_env_steps_sampled": 51459120, "num_env_steps_trained": 51459120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.17101898254771, "num_env_steps_trained_throughput_per_sec": 109.17101898254771, "timesteps_total": 51459120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51459120, "timers": {"training_iteration_time_ms": 3297.666, "sample_time_ms": 3286.828, "load_time_ms": 0.297, "load_throughput": 1211837.432, "learn_time_ms": 9.769, "learn_throughput": 36849.696, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51459120, "num_env_steps_trained": 51459120, "num_agent_steps_sampled": 51459120, "num_agent_steps_trained": 51459120}, "done": false, "episodes_total": 12399, "training_iteration": 3882, "trial_id": "ef964_00000", "date": "2023-08-08_13-45-57", "timestamp": 1691491557, "time_this_iter_s": 13.193140029907227, "time_total_s": 93367.32524418831, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 345.64579367637634, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.926315789473684, "ram_util_percent": 65.88947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -362.40296630859376, "policy_loss": -15143150.6875, "vf_loss": 16112694.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 538.0, "diff_num_grad_updates_vs_sampler_policy": 537.0}}, "num_env_steps_sampled": 51460560, "num_env_steps_trained": 51460560, "num_agent_steps_sampled": 51460560, "num_agent_steps_trained": 51460560}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.7179211910966, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.762607815637027, "mean_inference_ms": 0.38048843482872235, "mean_action_processing_ms": 0.09241094458265213, "mean_env_wait_ms": 1.076067250454322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035293102264404297, "StateBufferConnector_ms": 0.0028502941131591797, "ViewRequirementAgentConnector_ms": 0.06666803359985352}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.7179211910966, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3154.9291313476338, -3088.8827235983117, -3019.95165261306, -3066.67117565995, -3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.762607815637027, "mean_inference_ms": 0.38048843482872235, "mean_action_processing_ms": 0.09241094458265213, "mean_env_wait_ms": 1.076067250454322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035293102264404297, "StateBufferConnector_ms": 0.0028502941131591797, "ViewRequirementAgentConnector_ms": 0.06666803359985352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51460560, "num_agent_steps_trained": 51460560, "num_env_steps_sampled": 51460560, "num_env_steps_trained": 51460560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.34355210802056, "num_env_steps_trained_throughput_per_sec": 109.34355210802056, "timesteps_total": 51460560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51460560, "timers": {"training_iteration_time_ms": 3295.19, "sample_time_ms": 3284.533, "load_time_ms": 0.297, "load_throughput": 1211254.163, "learn_time_ms": 9.597, "learn_throughput": 37512.128, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 51460560, "num_env_steps_trained": 51460560, "num_agent_steps_sampled": 51460560, "num_agent_steps_trained": 51460560}, "done": false, "episodes_total": 12403, "training_iteration": 3883, "trial_id": "ef964_00000", "date": "2023-08-08_13-46-10", "timestamp": 1691491570, "time_this_iter_s": 13.17226505279541, "time_total_s": 93380.4975092411, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 358.81805872917175, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.86111111111111, "ram_util_percent": 65.97777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -368.84161376953125, "policy_loss": -4528509.9875, "vf_loss": 15760235.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 558.0, "diff_num_grad_updates_vs_sampler_policy": 557.0}}, "num_env_steps_sampled": 51462000, "num_env_steps_trained": 51462000, "num_agent_steps_sampled": 51462000, "num_agent_steps_trained": 51462000}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.3602411432535, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.758083312716946, "mean_inference_ms": 0.3803277294595971, "mean_action_processing_ms": 0.09237820836037024, "mean_env_wait_ms": 1.0519061877270266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531217575073242, "StateBufferConnector_ms": 0.002852201461791992, "ViewRequirementAgentConnector_ms": 0.06670856475830078}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.3602411432535, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3064.9796996389314, -3043.890460155912, -3041.638489668259, -3092.078714223009, -3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.758083312716946, "mean_inference_ms": 0.3803277294595971, "mean_action_processing_ms": 0.09237820836037024, "mean_env_wait_ms": 1.0519061877270266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531217575073242, "StateBufferConnector_ms": 0.002852201461791992, "ViewRequirementAgentConnector_ms": 0.06670856475830078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51462000, "num_agent_steps_trained": 51462000, "num_env_steps_sampled": 51462000, "num_env_steps_trained": 51462000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.17821878025347, "num_env_steps_trained_throughput_per_sec": 111.17821878025347, "timesteps_total": 51462000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51462000, "timers": {"training_iteration_time_ms": 3273.99, "sample_time_ms": 3263.196, "load_time_ms": 0.314, "load_throughput": 1146071.681, "learn_time_ms": 9.719, "learn_throughput": 37039.703, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51462000, "num_env_steps_trained": 51462000, "num_agent_steps_sampled": 51462000, "num_agent_steps_trained": 51462000}, "done": false, "episodes_total": 12407, "training_iteration": 3884, "trial_id": "ef964_00000", "date": "2023-08-08_13-46-23", "timestamp": 1691491583, "time_this_iter_s": 12.955145835876465, "time_total_s": 93393.45265507698, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 371.7732045650482, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 23.294736842105266, "ram_util_percent": 65.96315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -375.7466552734375, "policy_loss": -317157.6875, "vf_loss": 15270534.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 578.0, "diff_num_grad_updates_vs_sampler_policy": 577.0}}, "num_env_steps_sampled": 51463440, "num_env_steps_trained": 51463440, "num_agent_steps_sampled": 51463440, "num_agent_steps_trained": 51463440}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.7030178304053, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.755677676097283, "mean_inference_ms": 0.38023231161353765, "mean_action_processing_ms": 0.09235469638422872, "mean_env_wait_ms": 1.03475449918475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0028553009033203125, "ViewRequirementAgentConnector_ms": 0.06679344177246094}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.7030178304053, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3063.855777370599, -3046.369240344731, -3021.71015838192, -3064.997061127687, -3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.755677676097283, "mean_inference_ms": 0.38023231161353765, "mean_action_processing_ms": 0.09235469638422872, "mean_env_wait_ms": 1.03475449918475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0028553009033203125, "ViewRequirementAgentConnector_ms": 0.06679344177246094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51463440, "num_agent_steps_trained": 51463440, "num_env_steps_sampled": 51463440, "num_env_steps_trained": 51463440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.57752051873749, "num_env_steps_trained_throughput_per_sec": 108.57752051873749, "timesteps_total": 51463440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51463440, "timers": {"training_iteration_time_ms": 3277.221, "sample_time_ms": 3266.325, "load_time_ms": 0.315, "load_throughput": 1143987.757, "learn_time_ms": 9.81, "learn_throughput": 36698.516, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51463440, "num_env_steps_trained": 51463440, "num_agent_steps_sampled": 51463440, "num_agent_steps_trained": 51463440}, "done": false, "episodes_total": 12411, "training_iteration": 3885, "trial_id": "ef964_00000", "date": "2023-08-08_13-46-37", "timestamp": 1691491597, "time_this_iter_s": 13.265275239944458, "time_total_s": 93406.71793031693, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 385.0384798049927, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 19.268421052631577, "ram_util_percent": 65.88947368421051}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.15, "policy_entropy": -363.49208984375, "policy_loss": -10287144.95625, "vf_loss": 16059501.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 598.0, "diff_num_grad_updates_vs_sampler_policy": 597.0}}, "num_env_steps_sampled": 51464880, "num_env_steps_trained": 51464880, "num_agent_steps_sampled": 51464880, "num_agent_steps_trained": 51464880}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.8920465362116, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.753169327661467, "mean_inference_ms": 0.38014139695444255, "mean_action_processing_ms": 0.09232956196915026, "mean_env_wait_ms": 1.0212511791021712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035240650177001953, "StateBufferConnector_ms": 0.0028548240661621094, "ViewRequirementAgentConnector_ms": 0.06678152084350586}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3072.8920465362116, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3093.3753519384686, -3114.368246242426, -3082.685935427786, -3087.674131314259, -3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.753169327661467, "mean_inference_ms": 0.38014139695444255, "mean_action_processing_ms": 0.09232956196915026, "mean_env_wait_ms": 1.0212511791021712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035240650177001953, "StateBufferConnector_ms": 0.0028548240661621094, "ViewRequirementAgentConnector_ms": 0.06678152084350586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51464880, "num_agent_steps_trained": 51464880, "num_env_steps_sampled": 51464880, "num_env_steps_trained": 51464880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.5838387165082, "num_env_steps_trained_throughput_per_sec": 109.5838387165082, "timesteps_total": 51464880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51464880, "timers": {"training_iteration_time_ms": 3294.846, "sample_time_ms": 3283.841, "load_time_ms": 0.314, "load_throughput": 1146593.849, "learn_time_ms": 9.918, "learn_throughput": 36296.6, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51464880, "num_env_steps_trained": 51464880, "num_agent_steps_sampled": 51464880, "num_agent_steps_trained": 51464880}, "done": false, "episodes_total": 12415, "training_iteration": 3886, "trial_id": "ef964_00000", "date": "2023-08-08_13-46-50", "timestamp": 1691491610, "time_this_iter_s": 13.143370866775513, "time_total_s": 93419.8613011837, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 398.1818506717682, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.577777777777776, "ram_util_percent": 65.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-08, "entropy_coeff": 0.15, "policy_entropy": -361.35206298828126, "policy_loss": -18478071.721875, "vf_loss": 15683858.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 618.0, "diff_num_grad_updates_vs_sampler_policy": 617.0}}, "num_env_steps_sampled": 51466320, "num_env_steps_trained": 51466320, "num_agent_steps_sampled": 51466320, "num_agent_steps_trained": 51466320}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.3842309054758, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.749295714299328, "mean_inference_ms": 0.380015751468638, "mean_action_processing_ms": 0.09229857322145105, "mean_env_wait_ms": 1.0102841782891412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035228729248046875, "StateBufferConnector_ms": 0.002845287322998047, "ViewRequirementAgentConnector_ms": 0.06678915023803711}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.3842309054758, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3042.3993469316274, -3114.207964811014, -3043.0426416183086, -3068.677041016577, -3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.749295714299328, "mean_inference_ms": 0.380015751468638, "mean_action_processing_ms": 0.09229857322145105, "mean_env_wait_ms": 1.0102841782891412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035228729248046875, "StateBufferConnector_ms": 0.002845287322998047, "ViewRequirementAgentConnector_ms": 0.06678915023803711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51466320, "num_agent_steps_trained": 51466320, "num_env_steps_sampled": 51466320, "num_env_steps_trained": 51466320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.90779584319284, "num_env_steps_trained_throughput_per_sec": 108.90779584319284, "timesteps_total": 51466320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51466320, "timers": {"training_iteration_time_ms": 3298.168, "sample_time_ms": 3287.274, "load_time_ms": 0.306, "load_throughput": 1178083.358, "learn_time_ms": 9.823, "learn_throughput": 36647.657, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51466320, "num_env_steps_trained": 51466320, "num_agent_steps_sampled": 51466320, "num_agent_steps_trained": 51466320}, "done": false, "episodes_total": 12419, "training_iteration": 3887, "trial_id": "ef964_00000", "date": "2023-08-08_13-47-03", "timestamp": 1691491623, "time_this_iter_s": 13.225104093551636, "time_total_s": 93433.08640527725, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 411.4069547653198, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.789473684210527, "ram_util_percent": 65.9578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.5e-08, "entropy_coeff": 0.15, "policy_entropy": -361.1739562988281, "policy_loss": -14197316.415625, "vf_loss": 15339888.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 638.0, "diff_num_grad_updates_vs_sampler_policy": 637.0}}, "num_env_steps_sampled": 51467760, "num_env_steps_trained": 51467760, "num_agent_steps_sampled": 51467760, "num_agent_steps_trained": 51467760}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.738835029151, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.746376879836318, "mean_inference_ms": 0.3799160170227789, "mean_action_processing_ms": 0.09227293958142754, "mean_env_wait_ms": 1.0015524868309713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.00284576416015625, "ViewRequirementAgentConnector_ms": 0.06675004959106445}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3073.738835029151, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3021.103959578176, -3067.6855904172994, -3066.0401449399524, -3026.038453260342, -3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.746376879836318, "mean_inference_ms": 0.3799160170227789, "mean_action_processing_ms": 0.09227293958142754, "mean_env_wait_ms": 1.0015524868309713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.00284576416015625, "ViewRequirementAgentConnector_ms": 0.06675004959106445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51467760, "num_agent_steps_trained": 51467760, "num_env_steps_sampled": 51467760, "num_env_steps_trained": 51467760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.64283911519964, "num_env_steps_trained_throughput_per_sec": 108.64283911519964, "timesteps_total": 51467760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51467760, "timers": {"training_iteration_time_ms": 3302.861, "sample_time_ms": 3291.967, "load_time_ms": 0.306, "load_throughput": 1176247.908, "learn_time_ms": 9.809, "learn_throughput": 36699.408, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 51467760, "num_env_steps_trained": 51467760, "num_agent_steps_sampled": 51467760, "num_agent_steps_trained": 51467760}, "done": false, "episodes_total": 12423, "training_iteration": 3888, "trial_id": "ef964_00000", "date": "2023-08-08_13-47-16", "timestamp": 1691491636, "time_this_iter_s": 13.257155179977417, "time_total_s": 93446.34356045723, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 424.66410994529724, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.294736842105266, "ram_util_percent": 65.89473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.15, "policy_entropy": -365.42567749023436, "policy_loss": -15255268.221875, "vf_loss": 15924904.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 658.0, "diff_num_grad_updates_vs_sampler_policy": 657.0}}, "num_env_steps_sampled": 51469200, "num_env_steps_trained": 51469200, "num_agent_steps_sampled": 51469200, "num_agent_steps_trained": 51469200}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3075.4513597415853, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7438161319295435, "mean_inference_ms": 0.3798259500307307, "mean_action_processing_ms": 0.09224991014720613, "mean_env_wait_ms": 0.9942955624044036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512144088745117, "StateBufferConnector_ms": 0.0028412342071533203, "ViewRequirementAgentConnector_ms": 0.06677770614624023}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3075.4513597415853, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3002.230092148154, -3089.355591821855, -3067.3001532679837, -3184.6745671192125, -3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7438161319295435, "mean_inference_ms": 0.3798259500307307, "mean_action_processing_ms": 0.09224991014720613, "mean_env_wait_ms": 0.9942955624044036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512144088745117, "StateBufferConnector_ms": 0.0028412342071533203, "ViewRequirementAgentConnector_ms": 0.06677770614624023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51469200, "num_agent_steps_trained": 51469200, "num_env_steps_sampled": 51469200, "num_env_steps_trained": 51469200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.87812522511827, "num_env_steps_trained_throughput_per_sec": 111.87812522511827, "timesteps_total": 51469200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51469200, "timers": {"training_iteration_time_ms": 3275.031, "sample_time_ms": 3264.071, "load_time_ms": 0.306, "load_throughput": 1175515.329, "learn_time_ms": 9.857, "learn_throughput": 36523.112, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 51469200, "num_env_steps_trained": 51469200, "num_agent_steps_sampled": 51469200, "num_agent_steps_trained": 51469200}, "done": false, "episodes_total": 12427, "training_iteration": 3889, "trial_id": "ef964_00000", "date": "2023-08-08_13-47-29", "timestamp": 1691491649, "time_this_iter_s": 12.874128818511963, "time_total_s": 93459.21768927574, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 437.5382387638092, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 26.727777777777774, "ram_util_percent": 65.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.15, "policy_entropy": -370.94321899414064, "policy_loss": -2322001.809375, "vf_loss": 15243026.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 678.0, "diff_num_grad_updates_vs_sampler_policy": 677.0}}, "num_env_steps_sampled": 51470640, "num_env_steps_trained": 51470640, "num_agent_steps_sampled": 51470640, "num_agent_steps_trained": 51470640}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3074.8438722861783, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.741769624490679, "mean_inference_ms": 0.37974402501018817, "mean_action_processing_ms": 0.09222829323711533, "mean_env_wait_ms": 0.9879718920793971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035157203674316406, "StateBufferConnector_ms": 0.002837657928466797, "ViewRequirementAgentConnector_ms": 0.06679892539978027}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3074.8438722861783, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3021.343038725731, -3047.225036758139, -3090.408142997252, -3087.010931490392, -3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.741769624490679, "mean_inference_ms": 0.37974402501018817, "mean_action_processing_ms": 0.09222829323711533, "mean_env_wait_ms": 0.9879718920793971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035157203674316406, "StateBufferConnector_ms": 0.002837657928466797, "ViewRequirementAgentConnector_ms": 0.06679892539978027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51470640, "num_agent_steps_trained": 51470640, "num_env_steps_sampled": 51470640, "num_env_steps_trained": 51470640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.46566353130076, "num_env_steps_trained_throughput_per_sec": 109.46566353130076, "timesteps_total": 51470640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51470640, "timers": {"training_iteration_time_ms": 3264.389, "sample_time_ms": 3253.436, "load_time_ms": 0.307, "load_throughput": 1173596.642, "learn_time_ms": 9.851, "learn_throughput": 36543.265, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 51470640, "num_env_steps_trained": 51470640, "num_agent_steps_sampled": 51470640, "num_agent_steps_trained": 51470640}, "done": false, "episodes_total": 12431, "training_iteration": 3890, "trial_id": "ef964_00000", "date": "2023-08-08_13-47-43", "timestamp": 1691491663, "time_this_iter_s": 13.157829999923706, "time_total_s": 93472.37551927567, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 450.6960687637329, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.178947368421053, "ram_util_percent": 65.84736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.15, "policy_entropy": -363.3890380859375, "policy_loss": -3187443.275, "vf_loss": 15318084.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 697.0}}, "num_env_steps_sampled": 51472080, "num_env_steps_trained": 51472080, "num_agent_steps_sampled": 51472080, "num_agent_steps_trained": 51472080}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3075.7274782930645, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.739996312218254, "mean_inference_ms": 0.3796805702571966, "mean_action_processing_ms": 0.0922102256456983, "mean_env_wait_ms": 0.9825169342696077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035102367401123047, "StateBufferConnector_ms": 0.0028340816497802734, "ViewRequirementAgentConnector_ms": 0.06681632995605469}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3075.7274782930645, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3090.3907762747267, -3003.5379246324096, -3066.1962176564243, -3091.0373117507124, -3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.739996312218254, "mean_inference_ms": 0.3796805702571966, "mean_action_processing_ms": 0.0922102256456983, "mean_env_wait_ms": 0.9825169342696077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035102367401123047, "StateBufferConnector_ms": 0.0028340816497802734, "ViewRequirementAgentConnector_ms": 0.06681632995605469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51472080, "num_agent_steps_trained": 51472080, "num_env_steps_sampled": 51472080, "num_env_steps_trained": 51472080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.59028300823788, "num_env_steps_trained_throughput_per_sec": 109.59028300823788, "timesteps_total": 51472080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51472080, "timers": {"training_iteration_time_ms": 3288.245, "sample_time_ms": 3277.374, "load_time_ms": 0.306, "load_throughput": 1177348.491, "learn_time_ms": 9.79, "learn_throughput": 36771.353, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51472080, "num_env_steps_trained": 51472080, "num_agent_steps_sampled": 51472080, "num_agent_steps_trained": 51472080}, "done": false, "episodes_total": 12435, "training_iteration": 3891, "trial_id": "ef964_00000", "date": "2023-08-08_13-47-56", "timestamp": 1691491676, "time_this_iter_s": 13.142833948135376, "time_total_s": 93485.5183532238, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 463.8389027118683, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 20.573684210526313, "ram_util_percent": 65.79473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.15, "policy_entropy": -368.950146484375, "policy_loss": -874994.20625, "vf_loss": 15512137.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 718.0, "diff_num_grad_updates_vs_sampler_policy": 717.0}}, "num_env_steps_sampled": 51473520, "num_env_steps_trained": 51473520, "num_agent_steps_sampled": 51473520, "num_agent_steps_trained": 51473520}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3075.5823383704683, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.738665289066821, "mean_inference_ms": 0.37962585330444926, "mean_action_processing_ms": 0.09219540733671636, "mean_env_wait_ms": 0.9776967223320858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506898880004883, "StateBufferConnector_ms": 0.002831697463989258, "ViewRequirementAgentConnector_ms": 0.06671428680419922}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3184.681084227915, "episode_reward_mean": -3075.5823383704683, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3093.5127372905504, -3138.3967326803227, -3046.259037960655, -3022.5399446903184, -3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.738665289066821, "mean_inference_ms": 0.37962585330444926, "mean_action_processing_ms": 0.09219540733671636, "mean_env_wait_ms": 0.9776967223320858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506898880004883, "StateBufferConnector_ms": 0.002831697463989258, "ViewRequirementAgentConnector_ms": 0.06671428680419922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51473520, "num_agent_steps_trained": 51473520, "num_env_steps_sampled": 51473520, "num_env_steps_trained": 51473520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.19987817658664, "num_env_steps_trained_throughput_per_sec": 109.19987817658664, "timesteps_total": 51473520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51473520, "timers": {"training_iteration_time_ms": 3291.568, "sample_time_ms": 3280.713, "load_time_ms": 0.301, "load_throughput": 1194580.253, "learn_time_ms": 9.779, "learn_throughput": 36812.951, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 51473520, "num_env_steps_trained": 51473520, "num_agent_steps_sampled": 51473520, "num_agent_steps_trained": 51473520}, "done": false, "episodes_total": 12439, "training_iteration": 3892, "trial_id": "ef964_00000", "date": "2023-08-08_13-48-09", "timestamp": 1691491689, "time_this_iter_s": 13.189647912979126, "time_total_s": 93498.70800113678, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 477.0285506248474, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.63888888888889, "ram_util_percent": 65.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.15, "policy_entropy": -378.4573913574219, "policy_loss": -908038.60625, "vf_loss": 15282914.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 738.0, "diff_num_grad_updates_vs_sampler_policy": 737.0}}, "num_env_steps_sampled": 51474960, "num_env_steps_trained": 51474960, "num_agent_steps_sampled": 51474960, "num_agent_steps_trained": 51474960}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.440467319574, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737349213511441, "mean_inference_ms": 0.3795739704155405, "mean_action_processing_ms": 0.09218236661209225, "mean_env_wait_ms": 0.9734386498642743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500223159790039, "StateBufferConnector_ms": 0.002824068069458008, "ViewRequirementAgentConnector_ms": 0.06664085388183594}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.440467319574, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3067.6925357637924, -3116.228766281719, -3163.56797928118, -3144.2411200247725, -3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737349213511441, "mean_inference_ms": 0.3795739704155405, "mean_action_processing_ms": 0.09218236661209225, "mean_env_wait_ms": 0.9734386498642743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500223159790039, "StateBufferConnector_ms": 0.002824068069458008, "ViewRequirementAgentConnector_ms": 0.06664085388183594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51474960, "num_agent_steps_trained": 51474960, "num_env_steps_sampled": 51474960, "num_env_steps_trained": 51474960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.27746756693568, "num_env_steps_trained_throughput_per_sec": 109.27746756693568, "timesteps_total": 51474960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51474960, "timers": {"training_iteration_time_ms": 3295.36, "sample_time_ms": 3284.411, "load_time_ms": 0.3, "load_throughput": 1198277.47, "learn_time_ms": 9.871, "learn_throughput": 36469.214, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51474960, "num_env_steps_trained": 51474960, "num_agent_steps_sampled": 51474960, "num_agent_steps_trained": 51474960}, "done": false, "episodes_total": 12443, "training_iteration": 3893, "trial_id": "ef964_00000", "date": "2023-08-08_13-48-22", "timestamp": 1691491702, "time_this_iter_s": 13.180464267730713, "time_total_s": 93511.88846540451, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 490.2090148925781, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.631578947368425, "ram_util_percent": 65.77368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.15, "policy_entropy": -361.673291015625, "policy_loss": -5485771.8125, "vf_loss": 15409351.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 758.0, "diff_num_grad_updates_vs_sampler_policy": 757.0}}, "num_env_steps_sampled": 51476400, "num_env_steps_trained": 51476400, "num_agent_steps_sampled": 51476400, "num_agent_steps_trained": 51476400}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3073.866389030416, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736056288249888, "mean_inference_ms": 0.3795271404840198, "mean_action_processing_ms": 0.09217130368950434, "mean_env_wait_ms": 0.969415489349121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500699996948242, "StateBufferConnector_ms": 0.0028252601623535156, "ViewRequirementAgentConnector_ms": 0.06665873527526855}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3073.866389030416, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3090.454594535714, -3021.4314803408097, -3092.4820062015897, -3045.4000824720542, -3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736056288249888, "mean_inference_ms": 0.3795271404840198, "mean_action_processing_ms": 0.09217130368950434, "mean_env_wait_ms": 0.969415489349121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500699996948242, "StateBufferConnector_ms": 0.0028252601623535156, "ViewRequirementAgentConnector_ms": 0.06665873527526855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51476400, "num_agent_steps_trained": 51476400, "num_env_steps_sampled": 51476400, "num_env_steps_trained": 51476400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.08576816164567, "num_env_steps_trained_throughput_per_sec": 109.08576816164567, "timesteps_total": 51476400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51476400, "timers": {"training_iteration_time_ms": 3296.511, "sample_time_ms": 3285.666, "load_time_ms": 0.3, "load_throughput": 1200946.027, "learn_time_ms": 9.776, "learn_throughput": 36824.802, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51476400, "num_env_steps_trained": 51476400, "num_agent_steps_sampled": 51476400, "num_agent_steps_trained": 51476400}, "done": false, "episodes_total": 12447, "training_iteration": 3894, "trial_id": "ef964_00000", "date": "2023-08-08_13-48-35", "timestamp": 1691491715, "time_this_iter_s": 13.203337907791138, "time_total_s": 93525.0918033123, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 503.41235280036926, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.852631578947367, "ram_util_percent": 65.60526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.15, "policy_entropy": -362.0780334472656, "policy_loss": -6817970.890625, "vf_loss": 15684533.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 778.0, "diff_num_grad_updates_vs_sampler_policy": 777.0}}, "num_env_steps_sampled": 51477840, "num_env_steps_trained": 51477840, "num_agent_steps_sampled": 51477840, "num_agent_steps_trained": 51477840}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.107084020313, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734985226460465, "mean_inference_ms": 0.3794843360086041, "mean_action_processing_ms": 0.09216178772307358, "mean_env_wait_ms": 0.9658215450762347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035033226013183594, "StateBufferConnector_ms": 0.0028328895568847656, "ViewRequirementAgentConnector_ms": 0.06667256355285645}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.107084020313, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3092.184649362124, -3093.129816762643, -3024.085299406539, -3046.1178355530533, -3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734985226460465, "mean_inference_ms": 0.3794843360086041, "mean_action_processing_ms": 0.09216178772307358, "mean_env_wait_ms": 0.9658215450762347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035033226013183594, "StateBufferConnector_ms": 0.0028328895568847656, "ViewRequirementAgentConnector_ms": 0.06667256355285645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51477840, "num_agent_steps_trained": 51477840, "num_env_steps_sampled": 51477840, "num_env_steps_trained": 51477840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.61194981579132, "num_env_steps_trained_throughput_per_sec": 109.61194981579132, "timesteps_total": 51477840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51477840, "timers": {"training_iteration_time_ms": 3292.526, "sample_time_ms": 3281.599, "load_time_ms": 0.3, "load_throughput": 1198087.313, "learn_time_ms": 9.852, "learn_throughput": 36540.612, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51477840, "num_env_steps_trained": 51477840, "num_agent_steps_sampled": 51477840, "num_agent_steps_trained": 51477840}, "done": false, "episodes_total": 12451, "training_iteration": 3895, "trial_id": "ef964_00000", "date": "2023-08-08_13-48-49", "timestamp": 1691491729, "time_this_iter_s": 13.14010214805603, "time_total_s": 93538.23190546036, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 516.5524549484253, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 20.83888888888889, "ram_util_percent": 65.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.15, "policy_entropy": -371.38372192382815, "policy_loss": -6620789.165625, "vf_loss": 15212127.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 798.0, "diff_num_grad_updates_vs_sampler_policy": 797.0}}, "num_env_steps_sampled": 51479280, "num_env_steps_trained": 51479280, "num_agent_steps_sampled": 51479280, "num_agent_steps_trained": 51479280}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.864951814906, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7341476224906955, "mean_inference_ms": 0.3794511003026349, "mean_action_processing_ms": 0.0921547720765557, "mean_env_wait_ms": 0.962580603698117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500223159790039, "StateBufferConnector_ms": 0.002825498580932617, "ViewRequirementAgentConnector_ms": 0.06667971611022949}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.864951814906, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3020.7376027466166, -3047.844369182304, -3046.8901941330673, -3093.481234412892, -3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7341476224906955, "mean_inference_ms": 0.3794511003026349, "mean_action_processing_ms": 0.0921547720765557, "mean_env_wait_ms": 0.962580603698117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500223159790039, "StateBufferConnector_ms": 0.002825498580932617, "ViewRequirementAgentConnector_ms": 0.06667971611022949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51479280, "num_agent_steps_trained": 51479280, "num_env_steps_sampled": 51479280, "num_env_steps_trained": 51479280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.94306715233813, "num_env_steps_trained_throughput_per_sec": 108.94306715233813, "timesteps_total": 51479280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51479280, "timers": {"training_iteration_time_ms": 3294.033, "sample_time_ms": 3283.166, "load_time_ms": 0.301, "load_throughput": 1195904.831, "learn_time_ms": 9.806, "learn_throughput": 36712.257, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51479280, "num_env_steps_trained": 51479280, "num_agent_steps_sampled": 51479280, "num_agent_steps_trained": 51479280}, "done": false, "episodes_total": 12455, "training_iteration": 3896, "trial_id": "ef964_00000", "date": "2023-08-08_13-49-02", "timestamp": 1691491742, "time_this_iter_s": 13.220729112625122, "time_total_s": 93551.45263457298, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 529.7731840610504, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.189473684210526, "ram_util_percent": 65.72105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.25e-08, "entropy_coeff": 0.15, "policy_entropy": -370.24986572265624, "policy_loss": -1304909.071875, "vf_loss": 15517598.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 818.0, "diff_num_grad_updates_vs_sampler_policy": 817.0}}, "num_env_steps_sampled": 51480720, "num_env_steps_trained": 51480720, "num_agent_steps_sampled": 51480720, "num_agent_steps_trained": 51480720}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.8644047246053, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733283906614079, "mean_inference_ms": 0.3794219120228995, "mean_action_processing_ms": 0.09214969820578205, "mean_env_wait_ms": 0.9596479603057317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505706787109375, "StateBufferConnector_ms": 0.002832651138305664, "ViewRequirementAgentConnector_ms": 0.0666959285736084}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.8644047246053, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3068.2161137071303, -3119.822830006397, -3091.289992012995, -3046.1491962004943, -3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733283906614079, "mean_inference_ms": 0.3794219120228995, "mean_action_processing_ms": 0.09214969820578205, "mean_env_wait_ms": 0.9596479603057317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505706787109375, "StateBufferConnector_ms": 0.002832651138305664, "ViewRequirementAgentConnector_ms": 0.0666959285736084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51480720, "num_agent_steps_trained": 51480720, "num_env_steps_sampled": 51480720, "num_env_steps_trained": 51480720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.26184638876421, "num_env_steps_trained_throughput_per_sec": 109.26184638876421, "timesteps_total": 51480720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51480720, "timers": {"training_iteration_time_ms": 3294.962, "sample_time_ms": 3284.034, "load_time_ms": 0.301, "load_throughput": 1196852.758, "learn_time_ms": 9.867, "learn_throughput": 36485.516, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51480720, "num_env_steps_trained": 51480720, "num_agent_steps_sampled": 51480720, "num_agent_steps_trained": 51480720}, "done": false, "episodes_total": 12459, "training_iteration": 3897, "trial_id": "ef964_00000", "date": "2023-08-08_13-49-15", "timestamp": 1691491755, "time_this_iter_s": 13.18215799331665, "time_total_s": 93564.6347925663, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 542.9553420543671, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 19.0, "ram_util_percent": 65.60526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.25e-08, "entropy_coeff": 0.15, "policy_entropy": -366.2244140625, "policy_loss": -6129313.0, "vf_loss": 15524765.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 838.0, "diff_num_grad_updates_vs_sampler_policy": 837.0}}, "num_env_steps_sampled": 51482160, "num_env_steps_trained": 51482160, "num_agent_steps_sampled": 51482160, "num_agent_steps_trained": 51482160}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3075.9934206239573, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7325054743767545, "mean_inference_ms": 0.3793912908218536, "mean_action_processing_ms": 0.0921441254314927, "mean_env_wait_ms": 0.9569345679661352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003503084182739258, "StateBufferConnector_ms": 0.002828359603881836, "ViewRequirementAgentConnector_ms": 0.06668949127197266}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3075.9934206239573, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3095.0812261749566, -3046.8778350770394, -3093.1716021868438, -3139.215051248616, -3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7325054743767545, "mean_inference_ms": 0.3793912908218536, "mean_action_processing_ms": 0.0921441254314927, "mean_env_wait_ms": 0.9569345679661352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003503084182739258, "StateBufferConnector_ms": 0.002828359603881836, "ViewRequirementAgentConnector_ms": 0.06668949127197266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51482160, "num_agent_steps_trained": 51482160, "num_env_steps_sampled": 51482160, "num_env_steps_trained": 51482160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.4517002015374, "num_env_steps_trained_throughput_per_sec": 109.4517002015374, "timesteps_total": 51482160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51482160, "timers": {"training_iteration_time_ms": 3298.313, "sample_time_ms": 3287.328, "load_time_ms": 0.302, "load_throughput": 1192598.878, "learn_time_ms": 9.921, "learn_throughput": 36284.999, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 51482160, "num_env_steps_trained": 51482160, "num_agent_steps_sampled": 51482160, "num_agent_steps_trained": 51482160}, "done": false, "episodes_total": 12463, "training_iteration": 3898, "trial_id": "ef964_00000", "date": "2023-08-08_13-49-28", "timestamp": 1691491768, "time_this_iter_s": 13.159357070922852, "time_total_s": 93577.79414963722, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 556.1146991252899, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 19.788888888888888, "ram_util_percent": 65.65555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.15, "policy_entropy": -370.1583190917969, "policy_loss": -4968869.884375, "vf_loss": 15787750.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 858.0, "diff_num_grad_updates_vs_sampler_policy": 857.0}}, "num_env_steps_sampled": 51483600, "num_env_steps_trained": 51483600, "num_agent_steps_sampled": 51483600, "num_agent_steps_trained": 51483600}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3074.4103293077305, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731767188897773, "mean_inference_ms": 0.3793629118803119, "mean_action_processing_ms": 0.09213891253071774, "mean_env_wait_ms": 0.9543830628911323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034928321838378906, "StateBufferConnector_ms": 0.0028171539306640625, "ViewRequirementAgentConnector_ms": 0.06668400764465332}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3074.4103293077305, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3091.7889259945555, -3044.840595942354, -3072.0295732433387, -3184.681084227915, -3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731767188897773, "mean_inference_ms": 0.3793629118803119, "mean_action_processing_ms": 0.09213891253071774, "mean_env_wait_ms": 0.9543830628911323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034928321838378906, "StateBufferConnector_ms": 0.0028171539306640625, "ViewRequirementAgentConnector_ms": 0.06668400764465332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51483600, "num_agent_steps_trained": 51483600, "num_env_steps_sampled": 51483600, "num_env_steps_trained": 51483600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.30660858937289, "num_env_steps_trained_throughput_per_sec": 109.30660858937289, "timesteps_total": 51483600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51483600, "timers": {"training_iteration_time_ms": 3287.88, "sample_time_ms": 3276.87, "load_time_ms": 0.302, "load_throughput": 1190624.066, "learn_time_ms": 9.94, "learn_throughput": 36216.941, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 51483600, "num_env_steps_trained": 51483600, "num_agent_steps_sampled": 51483600, "num_agent_steps_trained": 51483600}, "done": false, "episodes_total": 12467, "training_iteration": 3899, "trial_id": "ef964_00000", "date": "2023-08-08_13-49-41", "timestamp": 1691491781, "time_this_iter_s": 13.17674708366394, "time_total_s": 93590.97089672089, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 569.2914462089539, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 19.652631578947368, "ram_util_percent": 65.57368421052634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.15, "policy_entropy": -371.6042236328125, "policy_loss": -12295764.559375, "vf_loss": 15868908.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 877.0}}, "num_env_steps_sampled": 51485040, "num_env_steps_trained": 51485040, "num_agent_steps_sampled": 51485040, "num_agent_steps_trained": 51485040}, "sampler_results": {"episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3074.0027818596577, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7315281586671185, "mean_inference_ms": 0.3793303896392029, "mean_action_processing_ms": 0.09213335268113813, "mean_env_wait_ms": 0.9519993667656115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034971237182617188, "StateBufferConnector_ms": 0.0028192996978759766, "ViewRequirementAgentConnector_ms": 0.0666513442993164}}, "episode_reward_max": -2999.5274745886936, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3074.0027818596577, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3120.5982375708413, -3164.48599198956, -2999.5274745886936, -3115.7694573451777, -3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7315281586671185, "mean_inference_ms": 0.3793303896392029, "mean_action_processing_ms": 0.09213335268113813, "mean_env_wait_ms": 0.9519993667656115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034971237182617188, "StateBufferConnector_ms": 0.0028192996978759766, "ViewRequirementAgentConnector_ms": 0.0666513442993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51485040, "num_agent_steps_trained": 51485040, "num_env_steps_sampled": 51485040, "num_env_steps_trained": 51485040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.48580607886443, "num_env_steps_trained_throughput_per_sec": 108.48580607886443, "timesteps_total": 51485040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51485040, "timers": {"training_iteration_time_ms": 3305.478, "sample_time_ms": 3294.389, "load_time_ms": 0.302, "load_throughput": 1190154.836, "learn_time_ms": 10.007, "learn_throughput": 35975.846, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 51485040, "num_env_steps_trained": 51485040, "num_agent_steps_sampled": 51485040, "num_agent_steps_trained": 51485040}, "done": false, "episodes_total": 12471, "training_iteration": 3900, "trial_id": "ef964_00000", "date": "2023-08-08_13-49-55", "timestamp": 1691491795, "time_this_iter_s": 13.276535034179688, "time_total_s": 93604.24743175507, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 582.5679812431335, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 20.11052631578947, "ram_util_percent": 65.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.15, "policy_entropy": -363.6596984863281, "policy_loss": -10580884.88125, "vf_loss": 15576622.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 898.0, "diff_num_grad_updates_vs_sampler_policy": 897.0}}, "num_env_steps_sampled": 51486480, "num_env_steps_trained": 51486480, "num_agent_steps_sampled": 51486480, "num_agent_steps_trained": 51486480}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3073.7884829147497, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731240283390129, "mean_inference_ms": 0.379301845307864, "mean_action_processing_ms": 0.09212843957406153, "mean_env_wait_ms": 0.9497590672785629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035026073455810547, "StateBufferConnector_ms": 0.002816915512084961, "ViewRequirementAgentConnector_ms": 0.06659507751464844}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3073.7884829147497, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3068.524684066464, -3068.545766508827, -3047.217431381202, -3023.4745100883842, -3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731240283390129, "mean_inference_ms": 0.379301845307864, "mean_action_processing_ms": 0.09212843957406153, "mean_env_wait_ms": 0.9497590672785629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035026073455810547, "StateBufferConnector_ms": 0.002816915512084961, "ViewRequirementAgentConnector_ms": 0.06659507751464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51486480, "num_agent_steps_trained": 51486480, "num_env_steps_sampled": 51486480, "num_env_steps_trained": 51486480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.69799841410789, "num_env_steps_trained_throughput_per_sec": 108.69799841410789, "timesteps_total": 51486480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51486480, "timers": {"training_iteration_time_ms": 3317.28, "sample_time_ms": 3306.352, "load_time_ms": 0.301, "load_throughput": 1196473.407, "learn_time_ms": 9.838, "learn_throughput": 36591.529, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 51486480, "num_env_steps_trained": 51486480, "num_agent_steps_sampled": 51486480, "num_agent_steps_trained": 51486480}, "done": false, "episodes_total": 12475, "training_iteration": 3901, "trial_id": "ef964_00000", "date": "2023-08-08_13-50-08", "timestamp": 1691491808, "time_this_iter_s": 13.250606060028076, "time_total_s": 93617.4980378151, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 595.8185873031616, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 20.342105263157894, "ram_util_percent": 65.67894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.15, "policy_entropy": -378.3988464355469, "policy_loss": -8778714.45, "vf_loss": 16074941.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 918.0, "diff_num_grad_updates_vs_sampler_policy": 917.0}}, "num_env_steps_sampled": 51487920, "num_env_steps_trained": 51487920, "num_agent_steps_sampled": 51487920, "num_agent_steps_trained": 51487920}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3074.8216484115374, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7310780313869865, "mean_inference_ms": 0.3792806661096266, "mean_action_processing_ms": 0.09212471009598587, "mean_env_wait_ms": 0.9476923901022073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003502368927001953, "StateBufferConnector_ms": 0.0028197765350341797, "ViewRequirementAgentConnector_ms": 0.06657242774963379}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3074.8216484115374, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3068.818303487771, -3097.743956930079, -3140.5955542329007, -3091.683083162007, -3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7310780313869865, "mean_inference_ms": 0.3792806661096266, "mean_action_processing_ms": 0.09212471009598587, "mean_env_wait_ms": 0.9476923901022073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003502368927001953, "StateBufferConnector_ms": 0.0028197765350341797, "ViewRequirementAgentConnector_ms": 0.06657242774963379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51487920, "num_agent_steps_trained": 51487920, "num_env_steps_sampled": 51487920, "num_env_steps_trained": 51487920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.40942329992261, "num_env_steps_trained_throughput_per_sec": 109.40942329992261, "timesteps_total": 51487920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51487920, "timers": {"training_iteration_time_ms": 3309.293, "sample_time_ms": 3298.364, "load_time_ms": 0.301, "load_throughput": 1197137.43, "learn_time_ms": 9.837, "learn_throughput": 36594.721, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 51487920, "num_env_steps_trained": 51487920, "num_agent_steps_sampled": 51487920, "num_agent_steps_trained": 51487920}, "done": false, "episodes_total": 12479, "training_iteration": 3902, "trial_id": "ef964_00000", "date": "2023-08-08_13-50-21", "timestamp": 1691491821, "time_this_iter_s": 13.164363145828247, "time_total_s": 93630.66240096092, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 608.9829504489899, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 20.15, "ram_util_percent": 65.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.15, "policy_entropy": -369.09882202148435, "policy_loss": -120080.95625, "vf_loss": 15352175.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 938.0, "diff_num_grad_updates_vs_sampler_policy": 937.0}}, "num_env_steps_sampled": 51489360, "num_env_steps_trained": 51489360, "num_agent_steps_sampled": 51489360, "num_agent_steps_trained": 51489360}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3072.951405638962, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73102333680507, "mean_inference_ms": 0.3792594883431144, "mean_action_processing_ms": 0.09212108275081865, "mean_env_wait_ms": 0.9457073199990225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.0028128623962402344, "ViewRequirementAgentConnector_ms": 0.06663155555725098}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3072.951405638962, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.5445780356745, -3070.4527081176498, -3072.5538906486895, -3073.0180029720837, -3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73102333680507, "mean_inference_ms": 0.3792594883431144, "mean_action_processing_ms": 0.09212108275081865, "mean_env_wait_ms": 0.9457073199990225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.0028128623962402344, "ViewRequirementAgentConnector_ms": 0.06663155555725098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51489360, "num_agent_steps_trained": 51489360, "num_env_steps_sampled": 51489360, "num_env_steps_trained": 51489360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.99458798485719, "num_env_steps_trained_throughput_per_sec": 108.99458798485719, "timesteps_total": 51489360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51489360, "timers": {"training_iteration_time_ms": 3294.521, "sample_time_ms": 3283.638, "load_time_ms": 0.304, "load_throughput": 1183531.463, "learn_time_ms": 9.809, "learn_throughput": 36700.3, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 51489360, "num_env_steps_trained": 51489360, "num_agent_steps_sampled": 51489360, "num_agent_steps_trained": 51489360}, "done": false, "episodes_total": 12483, "training_iteration": 3903, "trial_id": "ef964_00000", "date": "2023-08-08_13-50-34", "timestamp": 1691491834, "time_this_iter_s": 13.21444296836853, "time_total_s": 93643.87684392929, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 622.1973934173584, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 19.63157894736842, "ram_util_percent": 65.5421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.275e-08, "entropy_coeff": 0.15, "policy_entropy": -367.91826782226565, "policy_loss": -4148887.15, "vf_loss": 16130258.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 958.0, "diff_num_grad_updates_vs_sampler_policy": 957.0}}, "num_env_steps_sampled": 51490800, "num_env_steps_trained": 51490800, "num_agent_steps_sampled": 51490800, "num_agent_steps_trained": 51490800}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3073.4074517165204, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730919919484824, "mean_inference_ms": 0.3792430938392921, "mean_action_processing_ms": 0.09211801657839251, "mean_env_wait_ms": 0.9438598576533735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034956932067871094, "StateBufferConnector_ms": 0.002808094024658203, "ViewRequirementAgentConnector_ms": 0.06663250923156738}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3073.4074517165204, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3046.9809614008664, -3044.300822985261, -3070.3641420824893, -3074.494714589327, -3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730919919484824, "mean_inference_ms": 0.3792430938392921, "mean_action_processing_ms": 0.09211801657839251, "mean_env_wait_ms": 0.9438598576533735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034956932067871094, "StateBufferConnector_ms": 0.002808094024658203, "ViewRequirementAgentConnector_ms": 0.06663250923156738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51490800, "num_agent_steps_trained": 51490800, "num_env_steps_sampled": 51490800, "num_env_steps_trained": 51490800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.68813601726185, "num_env_steps_trained_throughput_per_sec": 109.68813601726185, "timesteps_total": 51490800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51490800, "timers": {"training_iteration_time_ms": 3287.511, "sample_time_ms": 3276.582, "load_time_ms": 0.305, "load_throughput": 1179463.709, "learn_time_ms": 9.851, "learn_throughput": 36545.742, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51490800, "num_env_steps_trained": 51490800, "num_agent_steps_sampled": 51490800, "num_agent_steps_trained": 51490800}, "done": false, "episodes_total": 12487, "training_iteration": 3904, "trial_id": "ef964_00000", "date": "2023-08-08_13-50-48", "timestamp": 1691491848, "time_this_iter_s": 13.131062030792236, "time_total_s": 93657.00790596008, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 635.3284554481506, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.263157894736842, "ram_util_percent": 65.49473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3749999999999997e-08, "entropy_coeff": 0.15, "policy_entropy": -373.7622436523437, "policy_loss": -4327939.09375, "vf_loss": 16270437.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 978.0, "diff_num_grad_updates_vs_sampler_policy": 977.0}}, "num_env_steps_sampled": 51492240, "num_env_steps_trained": 51492240, "num_agent_steps_sampled": 51492240, "num_agent_steps_trained": 51492240}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3075.408645561724, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730857801716163, "mean_inference_ms": 0.3792303338589938, "mean_action_processing_ms": 0.09211550356660762, "mean_env_wait_ms": 0.9421765062110259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035016536712646484, "StateBufferConnector_ms": 0.002796173095703125, "ViewRequirementAgentConnector_ms": 0.0666353702545166}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3075.408645561724, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.5573739079887, -3092.9074756228442, -3119.9787933739767, -3026.9931160475176, -3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730857801716163, "mean_inference_ms": 0.3792303338589938, "mean_action_processing_ms": 0.09211550356660762, "mean_env_wait_ms": 0.9421765062110259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035016536712646484, "StateBufferConnector_ms": 0.002796173095703125, "ViewRequirementAgentConnector_ms": 0.0666353702545166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51492240, "num_agent_steps_trained": 51492240, "num_env_steps_sampled": 51492240, "num_env_steps_trained": 51492240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.03844114985729, "num_env_steps_trained_throughput_per_sec": 108.03844114985729, "timesteps_total": 51492240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51492240, "timers": {"training_iteration_time_ms": 3302.998, "sample_time_ms": 3292.127, "load_time_ms": 0.303, "load_throughput": 1186693.996, "learn_time_ms": 9.796, "learn_throughput": 36748.443, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51492240, "num_env_steps_trained": 51492240, "num_agent_steps_sampled": 51492240, "num_agent_steps_trained": 51492240}, "done": false, "episodes_total": 12491, "training_iteration": 3905, "trial_id": "ef964_00000", "date": "2023-08-08_13-51-01", "timestamp": 1691491861, "time_this_iter_s": 13.33151888847351, "time_total_s": 93670.33942484856, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 648.6599743366241, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 20.13157894736842, "ram_util_percent": 65.50526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.7499999999999995e-09, "entropy_coeff": 0.15, "policy_entropy": -369.9143371582031, "policy_loss": -6817479.20625, "vf_loss": 15217493.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 998.0, "diff_num_grad_updates_vs_sampler_policy": 997.0}}, "num_env_steps_sampled": 51493680, "num_env_steps_trained": 51493680, "num_agent_steps_sampled": 51493680, "num_agent_steps_trained": 51493680}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3073.728416827469, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730795742270271, "mean_inference_ms": 0.37921840610253127, "mean_action_processing_ms": 0.09211286967565321, "mean_env_wait_ms": 0.9405628001003024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034952163696289062, "StateBufferConnector_ms": 0.002783060073852539, "ViewRequirementAgentConnector_ms": 0.06658339500427246}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3073.728416827469, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.942480736314, -3047.2372750824707, -3046.6177638335894, -3044.2411441226513, -3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730795742270271, "mean_inference_ms": 0.37921840610253127, "mean_action_processing_ms": 0.09211286967565321, "mean_env_wait_ms": 0.9405628001003024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034952163696289062, "StateBufferConnector_ms": 0.002783060073852539, "ViewRequirementAgentConnector_ms": 0.06658339500427246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51493680, "num_agent_steps_trained": 51493680, "num_env_steps_sampled": 51493680, "num_env_steps_trained": 51493680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.3525023342743, "num_env_steps_trained_throughput_per_sec": 109.3525023342743, "timesteps_total": 51493680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51493680, "timers": {"training_iteration_time_ms": 3308.658, "sample_time_ms": 3297.698, "load_time_ms": 0.303, "load_throughput": 1187160.5, "learn_time_ms": 9.876, "learn_throughput": 36453.454, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 51493680, "num_env_steps_trained": 51493680, "num_agent_steps_sampled": 51493680, "num_agent_steps_trained": 51493680}, "done": false, "episodes_total": 12495, "training_iteration": 3906, "trial_id": "ef964_00000", "date": "2023-08-08_13-51-14", "timestamp": 1691491874, "time_this_iter_s": 13.171210050582886, "time_total_s": 93683.51063489914, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 661.831184387207, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 19.72222222222222, "ram_util_percent": 65.60555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.05e-09, "entropy_coeff": 0.15, "policy_entropy": -368.97312622070314, "policy_loss": -14194885.85, "vf_loss": 16670232.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1018.0, "diff_num_grad_updates_vs_sampler_policy": 1017.0}}, "num_env_steps_sampled": 51495120, "num_env_steps_trained": 51495120, "num_agent_steps_sampled": 51495120, "num_agent_steps_trained": 51495120}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3074.737659726883, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730652996118177, "mean_inference_ms": 0.3792084892269405, "mean_action_processing_ms": 0.0921109793167272, "mean_env_wait_ms": 0.9390812251768454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495931625366211, "StateBufferConnector_ms": 0.0027871131896972656, "ViewRequirementAgentConnector_ms": 0.06665563583374023}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3074.737659726883, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3074.5530293571537, -3044.6238258242925, -3048.0668467887235, -3116.5738008535936, -3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730652996118177, "mean_inference_ms": 0.3792084892269405, "mean_action_processing_ms": 0.0921109793167272, "mean_env_wait_ms": 0.9390812251768454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495931625366211, "StateBufferConnector_ms": 0.0027871131896972656, "ViewRequirementAgentConnector_ms": 0.06665563583374023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51495120, "num_agent_steps_trained": 51495120, "num_env_steps_sampled": 51495120, "num_env_steps_trained": 51495120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.67086978612176, "num_env_steps_trained_throughput_per_sec": 109.67086978612176, "timesteps_total": 51495120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51495120, "timers": {"training_iteration_time_ms": 3298.992, "sample_time_ms": 3288.049, "load_time_ms": 0.301, "load_throughput": 1196189.052, "learn_time_ms": 9.865, "learn_throughput": 36492.482, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 51495120, "num_env_steps_trained": 51495120, "num_agent_steps_sampled": 51495120, "num_agent_steps_trained": 51495120}, "done": false, "episodes_total": 12499, "training_iteration": 3907, "trial_id": "ef964_00000", "date": "2023-08-08_13-51-27", "timestamp": 1691491887, "time_this_iter_s": 13.132925987243652, "time_total_s": 93696.64356088638, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 674.9641103744507, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 19.647368421052633, "ram_util_percent": 65.56315789473683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4500000000000002e-09, "entropy_coeff": 0.15, "policy_entropy": -363.24095458984374, "policy_loss": -22227116.890625, "vf_loss": 16210746.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1038.0, "diff_num_grad_updates_vs_sampler_policy": 1037.0}}, "num_env_steps_sampled": 51496560, "num_env_steps_trained": 51496560, "num_agent_steps_sampled": 51496560, "num_agent_steps_trained": 51496560}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.6489419975574, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730508570596387, "mean_inference_ms": 0.37919968680522254, "mean_action_processing_ms": 0.09210930152740104, "mean_env_wait_ms": 0.9377189296814933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499269485473633, "StateBufferConnector_ms": 0.0027883052825927734, "ViewRequirementAgentConnector_ms": 0.06665849685668945}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.6489419975574, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.785506925219, -3030.070277673677, -3048.328579416939, -3068.4823144188454, -3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730508570596387, "mean_inference_ms": 0.37919968680522254, "mean_action_processing_ms": 0.09210930152740104, "mean_env_wait_ms": 0.9377189296814933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499269485473633, "StateBufferConnector_ms": 0.0027883052825927734, "ViewRequirementAgentConnector_ms": 0.06665849685668945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51496560, "num_agent_steps_trained": 51496560, "num_env_steps_sampled": 51496560, "num_env_steps_trained": 51496560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.89764987396659, "num_env_steps_trained_throughput_per_sec": 108.89764987396659, "timesteps_total": 51496560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51496560, "timers": {"training_iteration_time_ms": 3291.945, "sample_time_ms": 3281.016, "load_time_ms": 0.301, "load_throughput": 1195904.831, "learn_time_ms": 9.86, "learn_throughput": 36510.571, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 51496560, "num_env_steps_trained": 51496560, "num_agent_steps_sampled": 51496560, "num_agent_steps_trained": 51496560}, "done": false, "episodes_total": 12503, "training_iteration": 3908, "trial_id": "ef964_00000", "date": "2023-08-08_13-51-40", "timestamp": 1691491900, "time_this_iter_s": 13.226251125335693, "time_total_s": 93709.86981201172, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 688.1903614997864, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 22.5, "ram_util_percent": 65.78421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.15, "policy_entropy": -364.25584106445314, "policy_loss": -17908626.715625, "vf_loss": 15861626.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 1057.0}}, "num_env_steps_sampled": 51498000, "num_env_steps_trained": 51498000, "num_agent_steps_sampled": 51498000, "num_agent_steps_trained": 51498000}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.559148702947, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730566679314527, "mean_inference_ms": 0.3791894570212185, "mean_action_processing_ms": 0.09210703409304384, "mean_env_wait_ms": 0.9364386903305478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493785858154297, "StateBufferConnector_ms": 0.0027866363525390625, "ViewRequirementAgentConnector_ms": 0.06655406951904297}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.559148702947, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.17864989482, -3113.1291143645167, -3093.0606288915887, -3025.4966392503247, -3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730566679314527, "mean_inference_ms": 0.3791894570212185, "mean_action_processing_ms": 0.09210703409304384, "mean_env_wait_ms": 0.9364386903305478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493785858154297, "StateBufferConnector_ms": 0.0027866363525390625, "ViewRequirementAgentConnector_ms": 0.06655406951904297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51498000, "num_agent_steps_trained": 51498000, "num_env_steps_sampled": 51498000, "num_env_steps_trained": 51498000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.61526801612662, "num_env_steps_trained_throughput_per_sec": 109.61526801612662, "timesteps_total": 51498000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51498000, "timers": {"training_iteration_time_ms": 3299.567, "sample_time_ms": 3288.699, "load_time_ms": 0.303, "load_throughput": 1188468.666, "learn_time_ms": 9.798, "learn_throughput": 36742.452, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 51498000, "num_env_steps_trained": 51498000, "num_agent_steps_sampled": 51498000, "num_agent_steps_trained": 51498000}, "done": false, "episodes_total": 12507, "training_iteration": 3909, "trial_id": "ef964_00000", "date": "2023-08-08_13-51-54", "timestamp": 1691491914, "time_this_iter_s": 13.139719247817993, "time_total_s": 93723.00953125954, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 701.3300807476044, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 20.166666666666668, "ram_util_percent": 65.79444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.15, "policy_entropy": -365.218310546875, "policy_loss": -5617121.515625, "vf_loss": 15205667.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1078.0, "diff_num_grad_updates_vs_sampler_policy": 1077.0}}, "num_env_steps_sampled": 51499440, "num_env_steps_trained": 51499440, "num_agent_steps_sampled": 51499440, "num_agent_steps_trained": 51499440}, "sampler_results": {"episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.916709746138, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730503021584699, "mean_inference_ms": 0.3791808926043265, "mean_action_processing_ms": 0.09210491853886424, "mean_env_wait_ms": 0.9352544796200014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.002783536911010742, "ViewRequirementAgentConnector_ms": 0.0664818286895752}}, "episode_reward_max": -2999.792266558114, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.916709746138, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.952163229327, -3097.067696502, -2999.792266558114, -3094.022981516112, -3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730503021584699, "mean_inference_ms": 0.3791808926043265, "mean_action_processing_ms": 0.09210491853886424, "mean_env_wait_ms": 0.9352544796200014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.002783536911010742, "ViewRequirementAgentConnector_ms": 0.0664818286895752}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51499440, "num_agent_steps_trained": 51499440, "num_env_steps_sampled": 51499440, "num_env_steps_trained": 51499440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.40546554028157, "num_env_steps_trained_throughput_per_sec": 109.40546554028157, "timesteps_total": 51499440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51499440, "timers": {"training_iteration_time_ms": 3299.756, "sample_time_ms": 3288.921, "load_time_ms": 0.302, "load_throughput": 1192222.219, "learn_time_ms": 9.77, "learn_throughput": 36848.796, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 51499440, "num_env_steps_trained": 51499440, "num_agent_steps_sampled": 51499440, "num_agent_steps_trained": 51499440}, "done": false, "episodes_total": 12511, "training_iteration": 3910, "trial_id": "ef964_00000", "date": "2023-08-08_13-52-07", "timestamp": 1691491927, "time_this_iter_s": 13.165034055709839, "time_total_s": 93736.17456531525, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 714.4951148033142, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 19.063157894736843, "ram_util_percent": 65.84210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.15, "policy_entropy": -362.3180236816406, "policy_loss": -16143503.55625, "vf_loss": 16252521.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1098.0, "diff_num_grad_updates_vs_sampler_policy": 1097.0}}, "num_env_steps_sampled": 51500880, "num_env_steps_trained": 51500880, "num_agent_steps_sampled": 51500880, "num_agent_steps_trained": 51500880}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3078.333444274259, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730472341247696, "mean_inference_ms": 0.37917095336569084, "mean_action_processing_ms": 0.09210311721940581, "mean_env_wait_ms": 0.9341560885044004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035071372985839844, "StateBufferConnector_ms": 0.002784252166748047, "ViewRequirementAgentConnector_ms": 0.06655240058898926}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3078.333444274259, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3121.3408260803794, -3118.300123035804, -3093.283593810051, -3094.39755892318, -3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730472341247696, "mean_inference_ms": 0.37917095336569084, "mean_action_processing_ms": 0.09210311721940581, "mean_env_wait_ms": 0.9341560885044004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035071372985839844, "StateBufferConnector_ms": 0.002784252166748047, "ViewRequirementAgentConnector_ms": 0.06655240058898926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51500880, "num_agent_steps_trained": 51500880, "num_env_steps_sampled": 51500880, "num_env_steps_trained": 51500880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.95285208702298, "num_env_steps_trained_throughput_per_sec": 108.95285208702298, "timesteps_total": 51500880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51500880, "timers": {"training_iteration_time_ms": 3289.721, "sample_time_ms": 3278.907, "load_time_ms": 0.3, "load_throughput": 1198943.497, "learn_time_ms": 9.738, "learn_throughput": 36967.52, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 51500880, "num_env_steps_trained": 51500880, "num_agent_steps_sampled": 51500880, "num_agent_steps_trained": 51500880}, "done": false, "episodes_total": 12515, "training_iteration": 3911, "trial_id": "ef964_00000", "date": "2023-08-08_13-52-20", "timestamp": 1691491940, "time_this_iter_s": 13.219611167907715, "time_total_s": 93749.39417648315, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 727.7147259712219, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 20.07894736842105, "ram_util_percent": 65.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.15, "policy_entropy": -365.10345458984375, "policy_loss": -9750606.8625, "vf_loss": 15794734.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1118.0, "diff_num_grad_updates_vs_sampler_policy": 1117.0}}, "num_env_steps_sampled": 51502320, "num_env_steps_trained": 51502320, "num_agent_steps_sampled": 51502320, "num_agent_steps_trained": 51502320}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.8609076233156, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7304356320053556, "mean_inference_ms": 0.37916063874223904, "mean_action_processing_ms": 0.09210135658689719, "mean_env_wait_ms": 0.9330684113736654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499269485473633, "StateBufferConnector_ms": 0.002783060073852539, "ViewRequirementAgentConnector_ms": 0.06644153594970703}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.8609076233156, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3067.4669189186384, -3071.150866679704, -3094.0054035072994, -3071.1642176392747, -3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7304356320053556, "mean_inference_ms": 0.37916063874223904, "mean_action_processing_ms": 0.09210135658689719, "mean_env_wait_ms": 0.9330684113736654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499269485473633, "StateBufferConnector_ms": 0.002783060073852539, "ViewRequirementAgentConnector_ms": 0.06644153594970703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51502320, "num_agent_steps_trained": 51502320, "num_env_steps_sampled": 51502320, "num_env_steps_trained": 51502320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.47754677181503, "num_env_steps_trained_throughput_per_sec": 109.47754677181503, "timesteps_total": 51502320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51502320, "timers": {"training_iteration_time_ms": 3296.399, "sample_time_ms": 3285.628, "load_time_ms": 0.313, "load_throughput": 1148599.909, "learn_time_ms": 9.686, "learn_throughput": 37166.98, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51502320, "num_env_steps_trained": 51502320, "num_agent_steps_sampled": 51502320, "num_agent_steps_trained": 51502320}, "done": false, "episodes_total": 12519, "training_iteration": 3912, "trial_id": "ef964_00000", "date": "2023-08-08_13-52-33", "timestamp": 1691491953, "time_this_iter_s": 13.15631103515625, "time_total_s": 93762.55048751831, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 740.8710370063782, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.294444444444444, "ram_util_percent": 65.55555555555553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.15, "policy_entropy": -372.4179626464844, "policy_loss": -5594444.115625, "vf_loss": 16043597.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1138.0, "diff_num_grad_updates_vs_sampler_policy": 1137.0}}, "num_env_steps_sampled": 51503760, "num_env_steps_trained": 51503760, "num_agent_steps_sampled": 51503760, "num_agent_steps_trained": 51503760}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.986673727761, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730315238272543, "mean_inference_ms": 0.37915050360856806, "mean_action_processing_ms": 0.09209918603547418, "mean_env_wait_ms": 0.9320486683299275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035102367401123047, "StateBufferConnector_ms": 0.0027832984924316406, "ViewRequirementAgentConnector_ms": 0.06651782989501953}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.986673727761, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3068.5626123399757, -3047.362619791031, -3143.384433170459, -3092.810954137899, -3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730315238272543, "mean_inference_ms": 0.37915050360856806, "mean_action_processing_ms": 0.09209918603547418, "mean_env_wait_ms": 0.9320486683299275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035102367401123047, "StateBufferConnector_ms": 0.0027832984924316406, "ViewRequirementAgentConnector_ms": 0.06651782989501953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51503760, "num_agent_steps_trained": 51503760, "num_env_steps_sampled": 51503760, "num_env_steps_trained": 51503760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.32914098756228, "num_env_steps_trained_throughput_per_sec": 109.32914098756228, "timesteps_total": 51503760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51503760, "timers": {"training_iteration_time_ms": 3289.516, "sample_time_ms": 3278.628, "load_time_ms": 0.317, "load_throughput": 1135300.331, "learn_time_ms": 9.786, "learn_throughput": 36785.418, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 51503760, "num_env_steps_trained": 51503760, "num_agent_steps_sampled": 51503760, "num_agent_steps_trained": 51503760}, "done": false, "episodes_total": 12523, "training_iteration": 3913, "trial_id": "ef964_00000", "date": "2023-08-08_13-52-46", "timestamp": 1691491966, "time_this_iter_s": 13.174057006835938, "time_total_s": 93775.72454452515, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 754.0450940132141, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 18.310526315789474, "ram_util_percent": 65.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.935302734375, "policy_loss": -24277192.634375, "vf_loss": 15911488.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1158.0, "diff_num_grad_updates_vs_sampler_policy": 1157.0}}, "num_env_steps_sampled": 51505200, "num_env_steps_trained": 51505200, "num_agent_steps_sampled": 51505200, "num_agent_steps_trained": 51505200}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3075.833660301035, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730463383568388, "mean_inference_ms": 0.37914142431671793, "mean_action_processing_ms": 0.09209718724392257, "mean_env_wait_ms": 0.9310603484723271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511190414428711, "StateBufferConnector_ms": 0.00278472900390625, "ViewRequirementAgentConnector_ms": 0.06649661064147949}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3075.833660301035, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3116.285585407291, -3048.5991036257033, -3093.1478866805787, -3024.779083102929, -3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730463383568388, "mean_inference_ms": 0.37914142431671793, "mean_action_processing_ms": 0.09209718724392257, "mean_env_wait_ms": 0.9310603484723271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511190414428711, "StateBufferConnector_ms": 0.00278472900390625, "ViewRequirementAgentConnector_ms": 0.06649661064147949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51505200, "num_agent_steps_trained": 51505200, "num_env_steps_sampled": 51505200, "num_env_steps_trained": 51505200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.43594787586953, "num_env_steps_trained_throughput_per_sec": 109.43594787586953, "timesteps_total": 51505200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51505200, "timers": {"training_iteration_time_ms": 3291.914, "sample_time_ms": 3280.955, "load_time_ms": 0.317, "load_throughput": 1135727.296, "learn_time_ms": 9.856, "learn_throughput": 36525.144, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 51505200, "num_env_steps_trained": 51505200, "num_agent_steps_sampled": 51505200, "num_agent_steps_trained": 51505200}, "done": false, "episodes_total": 12527, "training_iteration": 3914, "trial_id": "ef964_00000", "date": "2023-08-08_13-53-00", "timestamp": 1691491980, "time_this_iter_s": 13.161206722259521, "time_total_s": 93788.8857512474, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 767.2063007354736, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 21.557894736842105, "ram_util_percent": 65.5421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.500000000000001e-10, "entropy_coeff": 0.15, "policy_entropy": -367.5945678710938, "policy_loss": -11723240.41875, "vf_loss": 16421110.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 51506640, "num_env_steps_trained": 51506640, "num_agent_steps_sampled": 51506640, "num_agent_steps_trained": 51506640}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3075.8593506058073, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730626711048253, "mean_inference_ms": 0.37913367019555183, "mean_action_processing_ms": 0.0920955399229524, "mean_env_wait_ms": 0.9301124748987479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035092830657958984, "StateBufferConnector_ms": 0.002797842025756836, "ViewRequirementAgentConnector_ms": 0.06654024124145508}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3075.8593506058073, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.8493296100924, -3094.8602484240164, -3120.7883385315436, -3047.8498340944916, -3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730626711048253, "mean_inference_ms": 0.37913367019555183, "mean_action_processing_ms": 0.0920955399229524, "mean_env_wait_ms": 0.9301124748987479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035092830657958984, "StateBufferConnector_ms": 0.002797842025756836, "ViewRequirementAgentConnector_ms": 0.06654024124145508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51506640, "num_agent_steps_trained": 51506640, "num_env_steps_sampled": 51506640, "num_env_steps_trained": 51506640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.316957539148, "num_env_steps_trained_throughput_per_sec": 109.316957539148, "timesteps_total": 51506640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51506640, "timers": {"training_iteration_time_ms": 3291.885, "sample_time_ms": 3280.983, "load_time_ms": 0.303, "load_throughput": 1190061.034, "learn_time_ms": 9.819, "learn_throughput": 36661.805, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 51506640, "num_env_steps_trained": 51506640, "num_agent_steps_sampled": 51506640, "num_agent_steps_trained": 51506640}, "done": false, "episodes_total": 12531, "training_iteration": 3915, "trial_id": "ef964_00000", "date": "2023-08-08_13-53-13", "timestamp": 1691491993, "time_this_iter_s": 13.175650835037231, "time_total_s": 93802.06140208244, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 780.3819515705109, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 19.505263157894742, "ram_util_percent": 65.61052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.1445251464844, "policy_loss": -11455061.5375, "vf_loss": 16219970.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1198.0, "diff_num_grad_updates_vs_sampler_policy": 1197.0}}, "num_env_steps_sampled": 51508080, "num_env_steps_trained": 51508080, "num_agent_steps_sampled": 51508080, "num_agent_steps_trained": 51508080}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.4096272285733, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73081233080852, "mean_inference_ms": 0.3791282203937574, "mean_action_processing_ms": 0.0920941467308311, "mean_env_wait_ms": 0.9292170710109204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.0027980804443359375, "ViewRequirementAgentConnector_ms": 0.06656789779663086}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3076.4096272285733, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.360709188676, -3046.338041590753, -3094.7039757805014, -3047.2455114946083, -3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73081233080852, "mean_inference_ms": 0.3791282203937574, "mean_action_processing_ms": 0.0920941467308311, "mean_env_wait_ms": 0.9292170710109204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.0027980804443359375, "ViewRequirementAgentConnector_ms": 0.06656789779663086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51508080, "num_agent_steps_trained": 51508080, "num_env_steps_sampled": 51508080, "num_env_steps_trained": 51508080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.1002984679493, "num_env_steps_trained_throughput_per_sec": 109.1002984679493, "timesteps_total": 51508080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51508080, "timers": {"training_iteration_time_ms": 3297.461, "sample_time_ms": 3286.607, "load_time_ms": 0.301, "load_throughput": 1197327.286, "learn_time_ms": 9.778, "learn_throughput": 36817.439, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 51508080, "num_env_steps_trained": 51508080, "num_agent_steps_sampled": 51508080, "num_agent_steps_trained": 51508080}, "done": false, "episodes_total": 12535, "training_iteration": 3916, "trial_id": "ef964_00000", "date": "2023-08-08_13-53-26", "timestamp": 1691492006, "time_this_iter_s": 13.201818943023682, "time_total_s": 93815.26322102547, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 793.5837705135345, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 19.81111111111111, "ram_util_percent": 65.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.5933044433594, "policy_loss": -782805.89375, "vf_loss": 15840120.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1218.0, "diff_num_grad_updates_vs_sampler_policy": 1217.0}}, "num_env_steps_sampled": 51509520, "num_env_steps_trained": 51509520, "num_agent_steps_sampled": 51509520, "num_agent_steps_trained": 51509520}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3077.3402507181804, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7309769332957625, "mean_inference_ms": 0.37912437636646956, "mean_action_processing_ms": 0.09209266032941262, "mean_env_wait_ms": 0.9283755181189072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003552675247192383, "StateBufferConnector_ms": 0.002801656723022461, "ViewRequirementAgentConnector_ms": 0.06665349006652832}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3192.0795977457656, "episode_reward_mean": -3077.3402507181804, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.3751437136243, -3092.6271288918633, -3192.0795977457656, -3030.439477181199, -3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7309769332957625, "mean_inference_ms": 0.37912437636646956, "mean_action_processing_ms": 0.09209266032941262, "mean_env_wait_ms": 0.9283755181189072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003552675247192383, "StateBufferConnector_ms": 0.002801656723022461, "ViewRequirementAgentConnector_ms": 0.06665349006652832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51509520, "num_agent_steps_trained": 51509520, "num_env_steps_sampled": 51509520, "num_env_steps_trained": 51509520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.13612647088894, "num_env_steps_trained_throughput_per_sec": 109.13612647088894, "timesteps_total": 51509520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51509520, "timers": {"training_iteration_time_ms": 3300.719, "sample_time_ms": 3289.796, "load_time_ms": 0.302, "load_throughput": 1190436.329, "learn_time_ms": 9.843, "learn_throughput": 36575.84, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51509520, "num_env_steps_trained": 51509520, "num_agent_steps_sampled": 51509520, "num_agent_steps_trained": 51509520}, "done": false, "episodes_total": 12539, "training_iteration": 3917, "trial_id": "ef964_00000", "date": "2023-08-08_13-53-39", "timestamp": 1691492019, "time_this_iter_s": 13.197398900985718, "time_total_s": 93828.46061992645, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 806.7811694145203, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 19.926315789473687, "ram_util_percent": 65.72631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.5915283203125, "policy_loss": -19419787.9875, "vf_loss": 16906816.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1238.0, "diff_num_grad_updates_vs_sampler_policy": 1237.0}}, "num_env_steps_sampled": 51510960, "num_env_steps_trained": 51510960, "num_agent_steps_sampled": 51510960, "num_agent_steps_trained": 51510960}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3076.745783646358, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7311147781684895, "mean_inference_ms": 0.3791203211503668, "mean_action_processing_ms": 0.09209162448393908, "mean_env_wait_ms": 0.9275340984447541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035581588745117188, "StateBufferConnector_ms": 0.0028095245361328125, "ViewRequirementAgentConnector_ms": 0.06677079200744629}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3076.745783646358, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3046.9157466981096, -3046.628879940764, -3022.839773308558, -3117.9381724882805, -3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7311147781684895, "mean_inference_ms": 0.3791203211503668, "mean_action_processing_ms": 0.09209162448393908, "mean_env_wait_ms": 0.9275340984447541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035581588745117188, "StateBufferConnector_ms": 0.0028095245361328125, "ViewRequirementAgentConnector_ms": 0.06677079200744629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51510960, "num_agent_steps_trained": 51510960, "num_env_steps_sampled": 51510960, "num_env_steps_trained": 51510960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.38912023961821, "num_env_steps_trained_throughput_per_sec": 110.38912023961821, "timesteps_total": 51510960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51510960, "timers": {"training_iteration_time_ms": 3291.036, "sample_time_ms": 3280.091, "load_time_ms": 0.303, "load_throughput": 1189217.484, "learn_time_ms": 9.871, "learn_throughput": 36471.063, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51510960, "num_env_steps_trained": 51510960, "num_agent_steps_sampled": 51510960, "num_agent_steps_trained": 51510960}, "done": false, "episodes_total": 12543, "training_iteration": 3918, "trial_id": "ef964_00000", "date": "2023-08-08_13-53-52", "timestamp": 1691492032, "time_this_iter_s": 13.04764175415039, "time_total_s": 93841.5082616806, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 819.8288111686707, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 20.38888888888889, "ram_util_percent": 65.87222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.3909057617187, "policy_loss": -9268096.3375, "vf_loss": 15852756.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1258.0, "diff_num_grad_updates_vs_sampler_policy": 1257.0}}, "num_env_steps_sampled": 51512400, "num_env_steps_trained": 51512400, "num_agent_steps_sampled": 51512400, "num_agent_steps_trained": 51512400}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3077.3116128276592, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731215603319681, "mean_inference_ms": 0.379117730638275, "mean_action_processing_ms": 0.09209062446674135, "mean_env_wait_ms": 0.9267472971589291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035562515258789062, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.06673502922058105}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3077.3116128276592, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3122.5619175283477, -3113.133073955865, -3142.9218837492763, -3095.2207873063403, -3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731215603319681, "mean_inference_ms": 0.379117730638275, "mean_action_processing_ms": 0.09209062446674135, "mean_env_wait_ms": 0.9267472971589291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035562515258789062, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.06673502922058105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51512400, "num_agent_steps_trained": 51512400, "num_env_steps_sampled": 51512400, "num_env_steps_trained": 51512400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.1626903337376, "num_env_steps_trained_throughput_per_sec": 109.1626903337376, "timesteps_total": 51512400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51512400, "timers": {"training_iteration_time_ms": 3290.344, "sample_time_ms": 3279.489, "load_time_ms": 0.302, "load_throughput": 1191563.636, "learn_time_ms": 9.789, "learn_throughput": 36777.265, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51512400, "num_env_steps_trained": 51512400, "num_agent_steps_sampled": 51512400, "num_agent_steps_trained": 51512400}, "done": false, "episodes_total": 12547, "training_iteration": 3919, "trial_id": "ef964_00000", "date": "2023-08-08_13-54-06", "timestamp": 1691492046, "time_this_iter_s": 13.1944100856781, "time_total_s": 93854.70267176628, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 833.0232212543488, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 19.078947368421055, "ram_util_percent": 65.78421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.18079833984376, "policy_loss": -1196521.5, "vf_loss": 15710778.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1278.0, "diff_num_grad_updates_vs_sampler_policy": 1277.0}}, "num_env_steps_sampled": 51513840, "num_env_steps_trained": 51513840, "num_agent_steps_sampled": 51513840, "num_agent_steps_trained": 51513840}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.707717560332, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7313742058210035, "mean_inference_ms": 0.37911480268298203, "mean_action_processing_ms": 0.09208942089259697, "mean_env_wait_ms": 0.9259440185631368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003556966781616211, "StateBufferConnector_ms": 0.002805948257446289, "ViewRequirementAgentConnector_ms": 0.0667879581451416}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.707717560332, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3141.3807946564893, -3047.5529270197194, -3120.2063931186008, -3022.1642657489524, -3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7313742058210035, "mean_inference_ms": 0.37911480268298203, "mean_action_processing_ms": 0.09208942089259697, "mean_env_wait_ms": 0.9259440185631368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003556966781616211, "StateBufferConnector_ms": 0.002805948257446289, "ViewRequirementAgentConnector_ms": 0.0667879581451416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51513840, "num_agent_steps_trained": 51513840, "num_env_steps_sampled": 51513840, "num_env_steps_trained": 51513840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.61218057142526, "num_env_steps_trained_throughput_per_sec": 109.61218057142526, "timesteps_total": 51513840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51513840, "timers": {"training_iteration_time_ms": 3279.056, "sample_time_ms": 3268.183, "load_time_ms": 0.302, "load_throughput": 1192975.776, "learn_time_ms": 9.79, "learn_throughput": 36770.548, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 51513840, "num_env_steps_trained": 51513840, "num_agent_steps_sampled": 51513840, "num_agent_steps_trained": 51513840}, "done": false, "episodes_total": 12551, "training_iteration": 3920, "trial_id": "ef964_00000", "date": "2023-08-08_13-54-19", "timestamp": 1691492059, "time_this_iter_s": 13.140305757522583, "time_total_s": 93867.8429775238, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 846.1635270118713, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 19.942105263157895, "ram_util_percent": 65.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.2214050292969, "policy_loss": -16355127.075, "vf_loss": 16401314.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1298.0, "diff_num_grad_updates_vs_sampler_policy": 1297.0}}, "num_env_steps_sampled": 51515280, "num_env_steps_trained": 51515280, "num_agent_steps_sampled": 51515280, "num_agent_steps_trained": 51515280}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3073.6453764962876, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731517785121432, "mean_inference_ms": 0.3791093996215911, "mean_action_processing_ms": 0.09208743820419851, "mean_env_wait_ms": 0.9251544532084139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035653114318847656, "StateBufferConnector_ms": 0.002803802490234375, "ViewRequirementAgentConnector_ms": 0.06677794456481934}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3073.6453764962876, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3003.5276308994003, -3069.5050145513324, -3070.6804899441, -3065.1855560498407, -3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731517785121432, "mean_inference_ms": 0.3791093996215911, "mean_action_processing_ms": 0.09208743820419851, "mean_env_wait_ms": 0.9251544532084139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035653114318847656, "StateBufferConnector_ms": 0.002803802490234375, "ViewRequirementAgentConnector_ms": 0.06677794456481934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51515280, "num_agent_steps_trained": 51515280, "num_env_steps_sampled": 51515280, "num_env_steps_trained": 51515280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.34760239388021, "num_env_steps_trained_throughput_per_sec": 109.34760239388021, "timesteps_total": 51515280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51515280, "timers": {"training_iteration_time_ms": 3292.88, "sample_time_ms": 3282.052, "load_time_ms": 0.306, "load_throughput": 1174966.493, "learn_time_ms": 9.751, "learn_throughput": 36918.531, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51515280, "num_env_steps_trained": 51515280, "num_agent_steps_sampled": 51515280, "num_agent_steps_trained": 51515280}, "done": false, "episodes_total": 12555, "training_iteration": 3921, "trial_id": "ef964_00000", "date": "2023-08-08_13-54-32", "timestamp": 1691492072, "time_this_iter_s": 13.171873092651367, "time_total_s": 93881.01485061646, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 859.3354001045227, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 19.989473684210527, "ram_util_percent": 65.74736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.3523376464844, "policy_loss": -7366401.775, "vf_loss": 15479933.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1318.0, "diff_num_grad_updates_vs_sampler_policy": 1317.0}}, "num_env_steps_sampled": 51516720, "num_env_steps_trained": 51516720, "num_agent_steps_sampled": 51516720, "num_agent_steps_trained": 51516720}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.8489804324827, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731618664895788, "mean_inference_ms": 0.37910648910089306, "mean_action_processing_ms": 0.09208569768727451, "mean_env_wait_ms": 0.9244283112381149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003561735153198242, "StateBufferConnector_ms": 0.0028040409088134766, "ViewRequirementAgentConnector_ms": 0.06672978401184082}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.8489804324827, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3025.2358126919403, -3096.9293349620525, -3068.3521791266044, -3047.8623950816905, -3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731618664895788, "mean_inference_ms": 0.37910648910089306, "mean_action_processing_ms": 0.09208569768727451, "mean_env_wait_ms": 0.9244283112381149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003561735153198242, "StateBufferConnector_ms": 0.0028040409088134766, "ViewRequirementAgentConnector_ms": 0.06672978401184082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51516720, "num_agent_steps_trained": 51516720, "num_env_steps_sampled": 51516720, "num_env_steps_trained": 51516720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.30280068488098, "num_env_steps_trained_throughput_per_sec": 109.30280068488098, "timesteps_total": 51516720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51516720, "timers": {"training_iteration_time_ms": 3286.966, "sample_time_ms": 3276.115, "load_time_ms": 0.306, "load_throughput": 1175423.821, "learn_time_ms": 9.77, "learn_throughput": 36847.987, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 51516720, "num_env_steps_trained": 51516720, "num_agent_steps_sampled": 51516720, "num_agent_steps_trained": 51516720}, "done": false, "episodes_total": 12559, "training_iteration": 3922, "trial_id": "ef964_00000", "date": "2023-08-08_13-54-45", "timestamp": 1691492085, "time_this_iter_s": 13.177285194396973, "time_total_s": 93894.19213581085, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 872.5126852989197, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.70555555555556, "ram_util_percent": 65.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -380.86565551757815, "policy_loss": -1308234.54375, "vf_loss": 15379627.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1338.0, "diff_num_grad_updates_vs_sampler_policy": 1337.0}}, "num_env_steps_sampled": 51518160, "num_env_steps_trained": 51518160, "num_agent_steps_sampled": 51518160, "num_agent_steps_trained": 51518160}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.540159669118, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731724291705673, "mean_inference_ms": 0.37910396999530815, "mean_action_processing_ms": 0.09208393334709196, "mean_env_wait_ms": 0.9237301286014578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003561735153198242, "StateBufferConnector_ms": 0.002796173095703125, "ViewRequirementAgentConnector_ms": 0.06667685508728027}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.540159669118, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3025.9089927503237, -3047.9949377223415, -3069.376160346594, -3072.75649224545, -3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731724291705673, "mean_inference_ms": 0.37910396999530815, "mean_action_processing_ms": 0.09208393334709196, "mean_env_wait_ms": 0.9237301286014578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003561735153198242, "StateBufferConnector_ms": 0.002796173095703125, "ViewRequirementAgentConnector_ms": 0.06667685508728027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51518160, "num_agent_steps_trained": 51518160, "num_env_steps_sampled": 51518160, "num_env_steps_trained": 51518160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.39191976333896, "num_env_steps_trained_throughput_per_sec": 109.39191976333896, "timesteps_total": 51518160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51518160, "timers": {"training_iteration_time_ms": 3289.726, "sample_time_ms": 3278.849, "load_time_ms": 0.307, "load_throughput": 1172867.361, "learn_time_ms": 9.811, "learn_throughput": 36694.235, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51518160, "num_env_steps_trained": 51518160, "num_agent_steps_sampled": 51518160, "num_agent_steps_trained": 51518160}, "done": false, "episodes_total": 12563, "training_iteration": 3923, "trial_id": "ef964_00000", "date": "2023-08-08_13-54-58", "timestamp": 1691492098, "time_this_iter_s": 13.166469812393188, "time_total_s": 93907.35860562325, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 885.6791551113129, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 19.473684210526315, "ram_util_percent": 65.68947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.2875915527344, "policy_loss": -6425575.35, "vf_loss": 16128060.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1358.0, "diff_num_grad_updates_vs_sampler_policy": 1357.0}}, "num_env_steps_sampled": 51519600, "num_env_steps_trained": 51519600, "num_agent_steps_sampled": 51519600, "num_agent_steps_trained": 51519600}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3075.4217046843182, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731829707466514, "mean_inference_ms": 0.3791016632259908, "mean_action_processing_ms": 0.09208222530807372, "mean_env_wait_ms": 0.9230693405193813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.0028052330017089844, "ViewRequirementAgentConnector_ms": 0.06665706634521484}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3075.4217046843182, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3091.7857424183453, -3165.767534563884, -3022.836670427605, -3072.195487191151, -3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731829707466514, "mean_inference_ms": 0.3791016632259908, "mean_action_processing_ms": 0.09208222530807372, "mean_env_wait_ms": 0.9230693405193813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.0028052330017089844, "ViewRequirementAgentConnector_ms": 0.06665706634521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51519600, "num_agent_steps_trained": 51519600, "num_env_steps_sampled": 51519600, "num_env_steps_trained": 51519600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.03997593529914, "num_env_steps_trained_throughput_per_sec": 109.03997593529914, "timesteps_total": 51519600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51519600, "timers": {"training_iteration_time_ms": 3294.99, "sample_time_ms": 3284.139, "load_time_ms": 0.303, "load_throughput": 1189685.975, "learn_time_ms": 9.781, "learn_throughput": 36805.413, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51519600, "num_env_steps_trained": 51519600, "num_agent_steps_sampled": 51519600, "num_agent_steps_trained": 51519600}, "done": false, "episodes_total": 12567, "training_iteration": 3924, "trial_id": "ef964_00000", "date": "2023-08-08_13-55-12", "timestamp": 1691492112, "time_this_iter_s": 13.209074974060059, "time_total_s": 93920.5676805973, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 898.8882300853729, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 19.542105263157897, "ram_util_percent": 65.63157894736844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.9026184082031, "policy_loss": -5817015.371875, "vf_loss": 15219624.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1378.0, "diff_num_grad_updates_vs_sampler_policy": 1377.0}}, "num_env_steps_sampled": 51521040, "num_env_steps_trained": 51521040, "num_agent_steps_sampled": 51521040, "num_agent_steps_trained": 51521040}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.4992166931515, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731877307887007, "mean_inference_ms": 0.37909884891728185, "mean_action_processing_ms": 0.09208045002344795, "mean_env_wait_ms": 0.9224257428432763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035598278045654297, "StateBufferConnector_ms": 0.002809762954711914, "ViewRequirementAgentConnector_ms": 0.0668025016784668}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.4992166931515, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3092.904860069582, -3141.772725763662, -3072.7096799956507, -3071.564001174508, -3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731877307887007, "mean_inference_ms": 0.37909884891728185, "mean_action_processing_ms": 0.09208045002344795, "mean_env_wait_ms": 0.9224257428432763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035598278045654297, "StateBufferConnector_ms": 0.002809762954711914, "ViewRequirementAgentConnector_ms": 0.0668025016784668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51521040, "num_agent_steps_trained": 51521040, "num_env_steps_sampled": 51521040, "num_env_steps_trained": 51521040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.31885502619949, "num_env_steps_trained_throughput_per_sec": 109.31885502619949, "timesteps_total": 51521040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51521040, "timers": {"training_iteration_time_ms": 3302.865, "sample_time_ms": 3291.987, "load_time_ms": 0.304, "load_throughput": 1185668.975, "learn_time_ms": 9.803, "learn_throughput": 36722.614, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51521040, "num_env_steps_trained": 51521040, "num_agent_steps_sampled": 51521040, "num_agent_steps_trained": 51521040}, "done": false, "episodes_total": 12571, "training_iteration": 3925, "trial_id": "ef964_00000", "date": "2023-08-08_13-55-25", "timestamp": 1691492125, "time_this_iter_s": 13.17536997795105, "time_total_s": 93933.74305057526, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 912.063600063324, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.833333333333332, "ram_util_percent": 65.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.5072509765625, "policy_loss": -4772151.55625, "vf_loss": 15367520.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1398.0, "diff_num_grad_updates_vs_sampler_policy": 1397.0}}, "num_env_steps_sampled": 51522480, "num_env_steps_trained": 51522480, "num_agent_steps_sampled": 51522480, "num_agent_steps_trained": 51522480}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3073.7734626071574, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7319275383598605, "mean_inference_ms": 0.37909568025346685, "mean_action_processing_ms": 0.09207893091464125, "mean_env_wait_ms": 0.9217741235321975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035626888275146484, "StateBufferConnector_ms": 0.0028123855590820312, "ViewRequirementAgentConnector_ms": 0.06681632995605469}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3073.7734626071574, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3069.7212512242277, -3094.9246306948417, -3046.561337493072, -3099.8717223115077, -3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7319275383598605, "mean_inference_ms": 0.37909568025346685, "mean_action_processing_ms": 0.09207893091464125, "mean_env_wait_ms": 0.9217741235321975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035626888275146484, "StateBufferConnector_ms": 0.0028123855590820312, "ViewRequirementAgentConnector_ms": 0.06681632995605469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51522480, "num_agent_steps_trained": 51522480, "num_env_steps_sampled": 51522480, "num_env_steps_trained": 51522480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.93413470178426, "num_env_steps_trained_throughput_per_sec": 108.93413470178426, "timesteps_total": 51522480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51522480, "timers": {"training_iteration_time_ms": 3299.792, "sample_time_ms": 3288.929, "load_time_ms": 0.304, "load_throughput": 1183531.463, "learn_time_ms": 9.79, "learn_throughput": 36771.801, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51522480, "num_env_steps_trained": 51522480, "num_agent_steps_sampled": 51522480, "num_agent_steps_trained": 51522480}, "done": false, "episodes_total": 12575, "training_iteration": 3926, "trial_id": "ef964_00000", "date": "2023-08-08_13-55-38", "timestamp": 1691492138, "time_this_iter_s": 13.22198486328125, "time_total_s": 93946.96503543854, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 925.2855849266052, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 21.40526315789474, "ram_util_percent": 65.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -366.62473754882814, "policy_loss": -7440975.86875, "vf_loss": 16242541.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 1417.0}}, "num_env_steps_sampled": 51523920, "num_env_steps_trained": 51523920, "num_agent_steps_sampled": 51523920, "num_agent_steps_trained": 51523920}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.710928731864, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7319518906871, "mean_inference_ms": 0.3790910077045377, "mean_action_processing_ms": 0.09207740581832409, "mean_env_wait_ms": 0.9211691253657314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035626888275146484, "StateBufferConnector_ms": 0.002810955047607422, "ViewRequirementAgentConnector_ms": 0.06679558753967285}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3074.710928731864, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.5908622025318, -3096.5012109117415, -3047.0868661206823, -3045.6376813203233, -3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7319518906871, "mean_inference_ms": 0.3790910077045377, "mean_action_processing_ms": 0.09207740581832409, "mean_env_wait_ms": 0.9211691253657314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035626888275146484, "StateBufferConnector_ms": 0.002810955047607422, "ViewRequirementAgentConnector_ms": 0.06679558753967285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51523920, "num_agent_steps_trained": 51523920, "num_env_steps_sampled": 51523920, "num_env_steps_trained": 51523920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.51706434538806, "num_env_steps_trained_throughput_per_sec": 109.51706434538806, "timesteps_total": 51523920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51523920, "timers": {"training_iteration_time_ms": 3298.068, "sample_time_ms": 3287.279, "load_time_ms": 0.309, "load_throughput": 1165624.085, "learn_time_ms": 9.708, "learn_throughput": 37083.368, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51523920, "num_env_steps_trained": 51523920, "num_agent_steps_sampled": 51523920, "num_agent_steps_trained": 51523920}, "done": false, "episodes_total": 12579, "training_iteration": 3927, "trial_id": "ef964_00000", "date": "2023-08-08_13-55-51", "timestamp": 1691492151, "time_this_iter_s": 13.151824951171875, "time_total_s": 93960.11686038971, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 938.4374098777771, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 19.94736842105263, "ram_util_percent": 65.92105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.9299377441406, "policy_loss": -5093546.425, "vf_loss": 15448104.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1438.0, "diff_num_grad_updates_vs_sampler_policy": 1437.0}}, "num_env_steps_sampled": 51525360, "num_env_steps_trained": 51525360, "num_agent_steps_sampled": 51525360, "num_agent_steps_trained": 51525360}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3075.715201461646, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731941547628496, "mean_inference_ms": 0.3790871106832567, "mean_action_processing_ms": 0.09207618512904019, "mean_env_wait_ms": 0.9206117994207568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003559589385986328, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.06670808792114258}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3075.715201461646, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.13380180948, -3067.5980662012453, -3142.1374742166972, -3100.3044453025436, -3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731941547628496, "mean_inference_ms": 0.3790871106832567, "mean_action_processing_ms": 0.09207618512904019, "mean_env_wait_ms": 0.9206117994207568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003559589385986328, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.06670808792114258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51525360, "num_agent_steps_trained": 51525360, "num_env_steps_sampled": 51525360, "num_env_steps_trained": 51525360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.97938775314671, "num_env_steps_trained_throughput_per_sec": 108.97938775314671, "timesteps_total": 51525360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51525360, "timers": {"training_iteration_time_ms": 3296.5, "sample_time_ms": 3285.571, "load_time_ms": 0.308, "load_throughput": 1168781.98, "learn_time_ms": 9.849, "learn_throughput": 36552.731, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 51525360, "num_env_steps_trained": 51525360, "num_agent_steps_sampled": 51525360, "num_agent_steps_trained": 51525360}, "done": false, "episodes_total": 12583, "training_iteration": 3928, "trial_id": "ef964_00000", "date": "2023-08-08_13-56-04", "timestamp": 1691492164, "time_this_iter_s": 13.216310024261475, "time_total_s": 93973.33317041397, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 951.6537199020386, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 19.12777777777778, "ram_util_percent": 65.85555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.7208251953125, "policy_loss": -8059245.153125, "vf_loss": 16089670.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1458.0, "diff_num_grad_updates_vs_sampler_policy": 1457.0}}, "num_env_steps_sampled": 51526800, "num_env_steps_trained": 51526800, "num_agent_steps_sampled": 51526800, "num_agent_steps_trained": 51526800}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3075.7200189281443, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731961483498634, "mean_inference_ms": 0.3790816693912188, "mean_action_processing_ms": 0.09207485253955466, "mean_env_wait_ms": 0.9200707707928495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003561735153198242, "StateBufferConnector_ms": 0.0028183460235595703, "ViewRequirementAgentConnector_ms": 0.06674981117248535}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3075.7200189281443, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3027.662341248634, -3117.4854094755583, -3173.7714906628644, -3117.340784191125, -3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731961483498634, "mean_inference_ms": 0.3790816693912188, "mean_action_processing_ms": 0.09207485253955466, "mean_env_wait_ms": 0.9200707707928495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003561735153198242, "StateBufferConnector_ms": 0.0028183460235595703, "ViewRequirementAgentConnector_ms": 0.06674981117248535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51526800, "num_agent_steps_trained": 51526800, "num_env_steps_sampled": 51526800, "num_env_steps_trained": 51526800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.3343361534451, "num_env_steps_trained_throughput_per_sec": 109.3343361534451, "timesteps_total": 51526800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51526800, "timers": {"training_iteration_time_ms": 3297.133, "sample_time_ms": 3286.267, "load_time_ms": 0.31, "load_throughput": 1160785.24, "learn_time_ms": 9.778, "learn_throughput": 36816.451, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 51526800, "num_env_steps_trained": 51526800, "num_agent_steps_sampled": 51526800, "num_agent_steps_trained": 51526800}, "done": false, "episodes_total": 12587, "training_iteration": 3929, "trial_id": "ef964_00000", "date": "2023-08-08_13-56-18", "timestamp": 1691492178, "time_this_iter_s": 13.173643112182617, "time_total_s": 93986.50681352615, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 964.8273630142212, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 19.763157894736842, "ram_util_percent": 65.7421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.710302734375, "policy_loss": 124653.11875, "vf_loss": 14944867.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1478.0, "diff_num_grad_updates_vs_sampler_policy": 1477.0}}, "num_env_steps_sampled": 51528240, "num_env_steps_trained": 51528240, "num_agent_steps_sampled": 51528240, "num_agent_steps_trained": 51528240}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3073.28537056325, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731920010531241, "mean_inference_ms": 0.3790742819786931, "mean_action_processing_ms": 0.09207336717054916, "mean_env_wait_ms": 0.9194938859510827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035572052001953125, "StateBufferConnector_ms": 0.0028209686279296875, "ViewRequirementAgentConnector_ms": 0.06674313545227051}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3073.28537056325, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.3123990688364, -3001.5152913892866, -3094.0403298688834, -3023.5458651997437, -3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731920010531241, "mean_inference_ms": 0.3790742819786931, "mean_action_processing_ms": 0.09207336717054916, "mean_env_wait_ms": 0.9194938859510827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035572052001953125, "StateBufferConnector_ms": 0.0028209686279296875, "ViewRequirementAgentConnector_ms": 0.06674313545227051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51528240, "num_agent_steps_trained": 51528240, "num_env_steps_sampled": 51528240, "num_env_steps_trained": 51528240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.98392796933224, "num_env_steps_trained_throughput_per_sec": 109.98392796933224, "timesteps_total": 51528240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51528240, "timers": {"training_iteration_time_ms": 3286.858, "sample_time_ms": 3276.084, "load_time_ms": 0.302, "load_throughput": 1191657.675, "learn_time_ms": 9.701, "learn_throughput": 37110.436, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51528240, "num_env_steps_trained": 51528240, "num_agent_steps_sampled": 51528240, "num_agent_steps_trained": 51528240}, "done": false, "episodes_total": 12591, "training_iteration": 3930, "trial_id": "ef964_00000", "date": "2023-08-08_13-56-31", "timestamp": 1691492191, "time_this_iter_s": 13.095629215240479, "time_total_s": 93999.6024427414, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 977.9229922294617, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 21.710526315789473, "ram_util_percent": 65.84736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -373.032861328125, "policy_loss": -6131488.69375, "vf_loss": 15251218.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1498.0, "diff_num_grad_updates_vs_sampler_policy": 1497.0}}, "num_env_steps_sampled": 51529680, "num_env_steps_trained": 51529680, "num_agent_steps_sampled": 51529680, "num_agent_steps_trained": 51529680}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3073.811961685138, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7318751410053315, "mean_inference_ms": 0.3790683751668445, "mean_action_processing_ms": 0.09207193191444635, "mean_env_wait_ms": 0.9189642456766757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003558635711669922, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.06678080558776855}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3073.811961685138, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3096.853115045959, -3046.3492698294867, -3022.5872446860426, -3144.173324155108, -3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7318751410053315, "mean_inference_ms": 0.3790683751668445, "mean_action_processing_ms": 0.09207193191444635, "mean_env_wait_ms": 0.9189642456766757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003558635711669922, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.06678080558776855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51529680, "num_agent_steps_trained": 51529680, "num_env_steps_sampled": 51529680, "num_env_steps_trained": 51529680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.80295181483726, "num_env_steps_trained_throughput_per_sec": 108.80295181483726, "timesteps_total": 51529680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51529680, "timers": {"training_iteration_time_ms": 3289.923, "sample_time_ms": 3279.102, "load_time_ms": 0.304, "load_throughput": 1182604.511, "learn_time_ms": 9.741, "learn_throughput": 36957.567, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51529680, "num_env_steps_trained": 51529680, "num_agent_steps_sampled": 51529680, "num_agent_steps_trained": 51529680}, "done": false, "episodes_total": 12595, "training_iteration": 3931, "trial_id": "ef964_00000", "date": "2023-08-08_13-56-44", "timestamp": 1691492204, "time_this_iter_s": 13.238015174865723, "time_total_s": 94012.84045791626, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 991.1610074043274, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 19.61111111111111, "ram_util_percent": 65.78333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.58746948242185, "policy_loss": -9426313.178125, "vf_loss": 15902109.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1518.0, "diff_num_grad_updates_vs_sampler_policy": 1517.0}}, "num_env_steps_sampled": 51531120, "num_env_steps_trained": 51531120, "num_agent_steps_sampled": 51531120, "num_agent_steps_trained": 51531120}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3072.7983177829556, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73187669902546, "mean_inference_ms": 0.37906107275920453, "mean_action_processing_ms": 0.09207041283782633, "mean_env_wait_ms": 0.9184304911566223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560781478881836, "StateBufferConnector_ms": 0.0028226375579833984, "ViewRequirementAgentConnector_ms": 0.0667424201965332}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3072.7983177829556, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3118.116732093543, -3119.5631461704916, -3119.760751693408, -3117.5050999336577, -3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73187669902546, "mean_inference_ms": 0.37906107275920453, "mean_action_processing_ms": 0.09207041283782633, "mean_env_wait_ms": 0.9184304911566223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560781478881836, "StateBufferConnector_ms": 0.0028226375579833984, "ViewRequirementAgentConnector_ms": 0.0667424201965332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51531120, "num_agent_steps_trained": 51531120, "num_env_steps_sampled": 51531120, "num_env_steps_trained": 51531120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.32257302548949, "num_env_steps_trained_throughput_per_sec": 109.32257302548949, "timesteps_total": 51531120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51531120, "timers": {"training_iteration_time_ms": 3296.334, "sample_time_ms": 3285.364, "load_time_ms": 0.306, "load_throughput": 1176706.234, "learn_time_ms": 9.89, "learn_throughput": 36398.971, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 51531120, "num_env_steps_trained": 51531120, "num_agent_steps_sampled": 51531120, "num_agent_steps_trained": 51531120}, "done": false, "episodes_total": 12599, "training_iteration": 3932, "trial_id": "ef964_00000", "date": "2023-08-08_13-56-57", "timestamp": 1691492217, "time_this_iter_s": 13.174921035766602, "time_total_s": 94026.01537895203, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1004.335928440094, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 20.310526315789474, "ram_util_percent": 65.91052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.6983337402344, "policy_loss": -7859729.2375, "vf_loss": 15846272.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1538.0, "diff_num_grad_updates_vs_sampler_policy": 1537.0}}, "num_env_steps_sampled": 51532560, "num_env_steps_trained": 51532560, "num_agent_steps_sampled": 51532560, "num_agent_steps_trained": 51532560}, "sampler_results": {"episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3070.87617409184, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731803047676783, "mean_inference_ms": 0.3790535800847373, "mean_action_processing_ms": 0.09206918632687261, "mean_env_wait_ms": 0.9178935451388568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035660266876220703, "StateBufferConnector_ms": 0.002826213836669922, "ViewRequirementAgentConnector_ms": 0.06679391860961914}}, "episode_reward_max": -3000.061056377933, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3070.87617409184, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.566031080451, -3022.7552897370824, -3000.061056377933, -3092.3049717781705, -3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731803047676783, "mean_inference_ms": 0.3790535800847373, "mean_action_processing_ms": 0.09206918632687261, "mean_env_wait_ms": 0.9178935451388568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035660266876220703, "StateBufferConnector_ms": 0.002826213836669922, "ViewRequirementAgentConnector_ms": 0.06679391860961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51532560, "num_agent_steps_trained": 51532560, "num_env_steps_sampled": 51532560, "num_env_steps_trained": 51532560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.91325376779338, "num_env_steps_trained_throughput_per_sec": 110.91325376779338, "timesteps_total": 51532560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51532560, "timers": {"training_iteration_time_ms": 3279.429, "sample_time_ms": 3268.493, "load_time_ms": 0.306, "load_throughput": 1177073.152, "learn_time_ms": 9.863, "learn_throughput": 36499.804, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51532560, "num_env_steps_trained": 51532560, "num_agent_steps_sampled": 51532560, "num_agent_steps_trained": 51532560}, "done": false, "episodes_total": 12603, "training_iteration": 3933, "trial_id": "ef964_00000", "date": "2023-08-08_13-57-10", "timestamp": 1691492230, "time_this_iter_s": 12.985965013504028, "time_total_s": 94039.00134396553, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1017.321893453598, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 22.694444444444443, "ram_util_percent": 65.75555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.773876953125, "policy_loss": -9459221.4625, "vf_loss": 15933839.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1558.0, "diff_num_grad_updates_vs_sampler_policy": 1557.0}}, "num_env_steps_sampled": 51534000, "num_env_steps_trained": 51534000, "num_agent_steps_sampled": 51534000, "num_agent_steps_trained": 51534000}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3071.106934690752, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731698920692682, "mean_inference_ms": 0.3790470270155902, "mean_action_processing_ms": 0.09206787922824443, "mean_env_wait_ms": 0.9173903389356703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003597736358642578, "StateBufferConnector_ms": 0.002827882766723633, "ViewRequirementAgentConnector_ms": 0.06685757637023926}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3071.106934690752, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3069.2616004558427, -3097.005217520051, -3122.505850162923, -3023.8484685815556, -3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731698920692682, "mean_inference_ms": 0.3790470270155902, "mean_action_processing_ms": 0.09206787922824443, "mean_env_wait_ms": 0.9173903389356703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003597736358642578, "StateBufferConnector_ms": 0.002827882766723633, "ViewRequirementAgentConnector_ms": 0.06685757637023926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51534000, "num_agent_steps_trained": 51534000, "num_env_steps_sampled": 51534000, "num_env_steps_trained": 51534000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.07730127493102, "num_env_steps_trained_throughput_per_sec": 110.07730127493102, "timesteps_total": 51534000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51534000, "timers": {"training_iteration_time_ms": 3267.717, "sample_time_ms": 3256.804, "load_time_ms": 0.302, "load_throughput": 1192693.081, "learn_time_ms": 9.845, "learn_throughput": 36566.274, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51534000, "num_env_steps_trained": 51534000, "num_agent_steps_sampled": 51534000, "num_agent_steps_trained": 51534000}, "done": false, "episodes_total": 12607, "training_iteration": 3934, "trial_id": "ef964_00000", "date": "2023-08-08_13-57-23", "timestamp": 1691492243, "time_this_iter_s": 13.084500789642334, "time_total_s": 94052.08584475517, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1030.4063942432404, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 19.98421052631579, "ram_util_percent": 65.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -374.1685546875, "policy_loss": 200701.9125, "vf_loss": 15341559.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1578.0, "diff_num_grad_updates_vs_sampler_policy": 1577.0}}, "num_env_steps_sampled": 51535440, "num_env_steps_trained": 51535440, "num_agent_steps_sampled": 51535440, "num_agent_steps_trained": 51535440}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3072.566971072589, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731621665575159, "mean_inference_ms": 0.37903993025020066, "mean_action_processing_ms": 0.09206642601745887, "mean_env_wait_ms": 0.9169139231776575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035979747772216797, "StateBufferConnector_ms": 0.002821207046508789, "ViewRequirementAgentConnector_ms": 0.06682705879211426}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3184.3846135537037, "episode_reward_mean": -3072.566971072589, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3096.741910949274, -3096.955622854792, -3023.024415477044, -3140.786611336533, -3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731621665575159, "mean_inference_ms": 0.37903993025020066, "mean_action_processing_ms": 0.09206642601745887, "mean_env_wait_ms": 0.9169139231776575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035979747772216797, "StateBufferConnector_ms": 0.002821207046508789, "ViewRequirementAgentConnector_ms": 0.06682705879211426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51535440, "num_agent_steps_trained": 51535440, "num_env_steps_sampled": 51535440, "num_env_steps_trained": 51535440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.58924294042907, "num_env_steps_trained_throughput_per_sec": 108.58924294042907, "timesteps_total": 51535440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51535440, "timers": {"training_iteration_time_ms": 3271.849, "sample_time_ms": 3260.894, "load_time_ms": 0.301, "load_throughput": 1195715.426, "learn_time_ms": 9.884, "learn_throughput": 36422.853, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51535440, "num_env_steps_trained": 51535440, "num_agent_steps_sampled": 51535440, "num_agent_steps_trained": 51535440}, "done": false, "episodes_total": 12611, "training_iteration": 3935, "trial_id": "ef964_00000", "date": "2023-08-08_13-57-37", "timestamp": 1691492257, "time_this_iter_s": 13.263790845870972, "time_total_s": 94065.34963560104, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1043.6701850891113, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 18.83157894736842, "ram_util_percent": 65.85263157894735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.1232116699219, "policy_loss": -3570485.9671875, "vf_loss": 15279101.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1598.0, "diff_num_grad_updates_vs_sampler_policy": 1597.0}}, "num_env_steps_sampled": 51536880, "num_env_steps_trained": 51536880, "num_agent_steps_sampled": 51536880, "num_agent_steps_trained": 51536880}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3073.486096664038, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731530706242081, "mean_inference_ms": 0.3790322850865992, "mean_action_processing_ms": 0.09206505744934151, "mean_env_wait_ms": 0.9164577973506806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003598451614379883, "StateBufferConnector_ms": 0.0028188228607177734, "ViewRequirementAgentConnector_ms": 0.06682205200195312}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3073.486096664038, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3068.745536344398, -3046.3909256705833, -3089.8027488304147, -3075.129225909758, -3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731530706242081, "mean_inference_ms": 0.3790322850865992, "mean_action_processing_ms": 0.09206505744934151, "mean_env_wait_ms": 0.9164577973506806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003598451614379883, "StateBufferConnector_ms": 0.0028188228607177734, "ViewRequirementAgentConnector_ms": 0.06682205200195312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51536880, "num_agent_steps_trained": 51536880, "num_env_steps_sampled": 51536880, "num_env_steps_trained": 51536880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.01684433427438, "num_env_steps_trained_throughput_per_sec": 109.01684433427438, "timesteps_total": 51536880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51536880, "timers": {"training_iteration_time_ms": 3301.392, "sample_time_ms": 3290.425, "load_time_ms": 0.301, "load_throughput": 1195904.831, "learn_time_ms": 9.902, "learn_throughput": 36357.165, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 51536880, "num_env_steps_trained": 51536880, "num_agent_steps_sampled": 51536880, "num_agent_steps_trained": 51536880}, "done": false, "episodes_total": 12615, "training_iteration": 3936, "trial_id": "ef964_00000", "date": "2023-08-08_13-57-50", "timestamp": 1691492270, "time_this_iter_s": 13.211776971817017, "time_total_s": 94078.56141257286, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1056.8819620609283, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 20.38421052631579, "ram_util_percent": 65.90526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.58942260742185, "policy_loss": -8050512.53125, "vf_loss": 16036288.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1618.0, "diff_num_grad_updates_vs_sampler_policy": 1617.0}}, "num_env_steps_sampled": 51538320, "num_env_steps_trained": 51538320, "num_agent_steps_sampled": 51538320, "num_agent_steps_trained": 51538320}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.8152703680385, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731472056096683, "mean_inference_ms": 0.3790245321980859, "mean_action_processing_ms": 0.09206363272008648, "mean_env_wait_ms": 0.9160372284388757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036034584045410156, "StateBufferConnector_ms": 0.0028226375579833984, "ViewRequirementAgentConnector_ms": 0.0669095516204834}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.8152703680385, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3098.891572905464, -3026.13755565511, -3094.161012598712, -3097.17387603013, -3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731472056096683, "mean_inference_ms": 0.3790245321980859, "mean_action_processing_ms": 0.09206363272008648, "mean_env_wait_ms": 0.9160372284388757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036034584045410156, "StateBufferConnector_ms": 0.0028226375579833984, "ViewRequirementAgentConnector_ms": 0.0669095516204834}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51538320, "num_agent_steps_trained": 51538320, "num_env_steps_sampled": 51538320, "num_env_steps_trained": 51538320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.2931571691314, "num_env_steps_trained_throughput_per_sec": 108.2931571691314, "timesteps_total": 51538320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51538320, "timers": {"training_iteration_time_ms": 3311.501, "sample_time_ms": 3300.736, "load_time_ms": 0.301, "load_throughput": 1195431.431, "learn_time_ms": 9.711, "learn_throughput": 37072.988, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 51538320, "num_env_steps_trained": 51538320, "num_agent_steps_sampled": 51538320, "num_agent_steps_trained": 51538320}, "done": false, "episodes_total": 12619, "training_iteration": 3937, "trial_id": "ef964_00000", "date": "2023-08-08_13-58-03", "timestamp": 1691492283, "time_this_iter_s": 13.30007815361023, "time_total_s": 94091.86149072647, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1070.1820402145386, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 19.544444444444444, "ram_util_percent": 65.88333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.02314453125, "policy_loss": -3027668.45703125, "vf_loss": 15481099.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1638.0, "diff_num_grad_updates_vs_sampler_policy": 1637.0}}, "num_env_steps_sampled": 51539760, "num_env_steps_trained": 51539760, "num_agent_steps_sampled": 51539760, "num_agent_steps_trained": 51539760}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3073.305747067994, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73146088842414, "mean_inference_ms": 0.37901575380139435, "mean_action_processing_ms": 0.09206249176270558, "mean_env_wait_ms": 0.915601061549458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035982131958007812, "StateBufferConnector_ms": 0.0028200149536132812, "ViewRequirementAgentConnector_ms": 0.0668487548828125}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3073.305747067994, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.5574855396903, -3069.946353040231, -3025.572887929859, -3118.742550256981, -3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73146088842414, "mean_inference_ms": 0.37901575380139435, "mean_action_processing_ms": 0.09206249176270558, "mean_env_wait_ms": 0.915601061549458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035982131958007812, "StateBufferConnector_ms": 0.0028200149536132812, "ViewRequirementAgentConnector_ms": 0.0668487548828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51539760, "num_agent_steps_trained": 51539760, "num_env_steps_sampled": 51539760, "num_env_steps_trained": 51539760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.92160305290786, "num_env_steps_trained_throughput_per_sec": 108.92160305290786, "timesteps_total": 51539760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51539760, "timers": {"training_iteration_time_ms": 3309.145, "sample_time_ms": 3298.392, "load_time_ms": 0.304, "load_throughput": 1183160.508, "learn_time_ms": 9.692, "learn_throughput": 37144.854, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 51539760, "num_env_steps_trained": 51539760, "num_agent_steps_sampled": 51539760, "num_agent_steps_trained": 51539760}, "done": false, "episodes_total": 12623, "training_iteration": 3938, "trial_id": "ef964_00000", "date": "2023-08-08_13-58-16", "timestamp": 1691492296, "time_this_iter_s": 13.22344708442688, "time_total_s": 94105.0849378109, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1083.4054872989655, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 19.494736842105265, "ram_util_percent": 65.87368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -366.866845703125, "policy_loss": -7957974.00625, "vf_loss": 15461534.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1658.0, "diff_num_grad_updates_vs_sampler_policy": 1657.0}}, "num_env_steps_sampled": 51541200, "num_env_steps_trained": 51541200, "num_agent_steps_sampled": 51541200, "num_agent_steps_trained": 51541200}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.8176237208113, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731442505039372, "mean_inference_ms": 0.37900441540534585, "mean_action_processing_ms": 0.09206097430223494, "mean_env_wait_ms": 0.9151898198643851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035953521728515625, "StateBufferConnector_ms": 0.0028214454650878906, "ViewRequirementAgentConnector_ms": 0.06682968139648438}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.8176237208113, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.2021121985904, -3046.3618930844223, -3049.4057336572746, -3118.410950353445, -3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731442505039372, "mean_inference_ms": 0.37900441540534585, "mean_action_processing_ms": 0.09206097430223494, "mean_env_wait_ms": 0.9151898198643851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035953521728515625, "StateBufferConnector_ms": 0.0028214454650878906, "ViewRequirementAgentConnector_ms": 0.06682968139648438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51541200, "num_agent_steps_trained": 51541200, "num_env_steps_sampled": 51541200, "num_env_steps_trained": 51541200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.44774136603726, "num_env_steps_trained_throughput_per_sec": 109.44774136603726, "timesteps_total": 51541200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51541200, "timers": {"training_iteration_time_ms": 3300.35, "sample_time_ms": 3289.495, "load_time_ms": 0.303, "load_throughput": 1188749.362, "learn_time_ms": 9.794, "learn_throughput": 36755.689, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 51541200, "num_env_steps_trained": 51541200, "num_agent_steps_sampled": 51541200, "num_agent_steps_trained": 51541200}, "done": false, "episodes_total": 12627, "training_iteration": 3939, "trial_id": "ef964_00000", "date": "2023-08-08_13-58-30", "timestamp": 1691492310, "time_this_iter_s": 13.159895896911621, "time_total_s": 94118.24483370781, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1096.565383195877, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 19.46315789473684, "ram_util_percent": 65.77368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.869921875, "policy_loss": -3168521.4625, "vf_loss": 15606117.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1678.0, "diff_num_grad_updates_vs_sampler_policy": 1677.0}}, "num_env_steps_sampled": 51542640, "num_env_steps_trained": 51542640, "num_agent_steps_sampled": 51542640, "num_agent_steps_trained": 51542640}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3073.6787358576908, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7314050367602025, "mean_inference_ms": 0.3789926863065054, "mean_action_processing_ms": 0.09205951768749926, "mean_env_wait_ms": 0.9147969485277625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035982131958007812, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.06682753562927246}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3073.6787358576908, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3097.3307951721645, -3024.2820783196503, -3149.7873929356147, -3117.975146509338, -3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7314050367602025, "mean_inference_ms": 0.3789926863065054, "mean_action_processing_ms": 0.09205951768749926, "mean_env_wait_ms": 0.9147969485277625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035982131958007812, "StateBufferConnector_ms": 0.0028085708618164062, "ViewRequirementAgentConnector_ms": 0.06682753562927246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51542640, "num_agent_steps_trained": 51542640, "num_env_steps_sampled": 51542640, "num_env_steps_trained": 51542640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.65187902865007, "num_env_steps_trained_throughput_per_sec": 109.65187902865007, "timesteps_total": 51542640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51542640, "timers": {"training_iteration_time_ms": 3286.451, "sample_time_ms": 3275.5, "load_time_ms": 0.304, "load_throughput": 1185203.642, "learn_time_ms": 9.879, "learn_throughput": 36441.577, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 51542640, "num_env_steps_trained": 51542640, "num_agent_steps_sampled": 51542640, "num_agent_steps_trained": 51542640}, "done": false, "episodes_total": 12631, "training_iteration": 3940, "trial_id": "ef964_00000", "date": "2023-08-08_13-58-43", "timestamp": 1691492323, "time_this_iter_s": 13.135472774505615, "time_total_s": 94131.38030648232, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1109.7008559703827, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 19.605555555555558, "ram_util_percent": 65.79444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.384716796875, "policy_loss": -9680639.85625, "vf_loss": 15619830.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1698.0, "diff_num_grad_updates_vs_sampler_policy": 1697.0}}, "num_env_steps_sampled": 51544080, "num_env_steps_trained": 51544080, "num_agent_steps_sampled": 51544080, "num_agent_steps_trained": 51544080}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.6539068865613, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73138927773638, "mean_inference_ms": 0.378980249543726, "mean_action_processing_ms": 0.09205815225208505, "mean_env_wait_ms": 0.9143968598658091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035948753356933594, "StateBufferConnector_ms": 0.0028138160705566406, "ViewRequirementAgentConnector_ms": 0.06678962707519531}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.6539068865613, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.5517095440446, -3116.4642208088353, -3097.6803719255176, -3092.0142847368097, -3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73138927773638, "mean_inference_ms": 0.378980249543726, "mean_action_processing_ms": 0.09205815225208505, "mean_env_wait_ms": 0.9143968598658091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035948753356933594, "StateBufferConnector_ms": 0.0028138160705566406, "ViewRequirementAgentConnector_ms": 0.06678962707519531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51544080, "num_agent_steps_trained": 51544080, "num_env_steps_sampled": 51544080, "num_env_steps_trained": 51544080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.95855013022425, "num_env_steps_trained_throughput_per_sec": 108.95855013022425, "timesteps_total": 51544080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51544080, "timers": {"training_iteration_time_ms": 3294.767, "sample_time_ms": 3283.822, "load_time_ms": 0.303, "load_throughput": 1186600.739, "learn_time_ms": 9.864, "learn_throughput": 36494.864, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51544080, "num_env_steps_trained": 51544080, "num_agent_steps_sampled": 51544080, "num_agent_steps_trained": 51544080}, "done": false, "episodes_total": 12635, "training_iteration": 3941, "trial_id": "ef964_00000", "date": "2023-08-08_13-58-56", "timestamp": 1691492336, "time_this_iter_s": 13.218863010406494, "time_total_s": 94144.59916949272, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1122.9197189807892, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 19.868421052631575, "ram_util_percent": 65.69473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.1781433105469, "policy_loss": -10556866.171875, "vf_loss": 15782526.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1718.0, "diff_num_grad_updates_vs_sampler_policy": 1717.0}}, "num_env_steps_sampled": 51545520, "num_env_steps_trained": 51545520, "num_agent_steps_sampled": 51545520, "num_agent_steps_trained": 51545520}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.875291238313, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731300481195566, "mean_inference_ms": 0.3789678827705659, "mean_action_processing_ms": 0.09205698720142738, "mean_env_wait_ms": 0.9140013664818207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.002808094024658203, "ViewRequirementAgentConnector_ms": 0.06672334671020508}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.875291238313, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3072.496503076021, -3025.1795762569436, -3045.013947463601, -3184.3846135537037, -3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731300481195566, "mean_inference_ms": 0.3789678827705659, "mean_action_processing_ms": 0.09205698720142738, "mean_env_wait_ms": 0.9140013664818207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.002808094024658203, "ViewRequirementAgentConnector_ms": 0.06672334671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51545520, "num_agent_steps_trained": 51545520, "num_env_steps_sampled": 51545520, "num_env_steps_trained": 51545520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.14570696373254, "num_env_steps_trained_throughput_per_sec": 111.14570696373254, "timesteps_total": 51545520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51545520, "timers": {"training_iteration_time_ms": 3278.434, "sample_time_ms": 3267.612, "load_time_ms": 0.305, "load_throughput": 1181401.643, "learn_time_ms": 9.742, "learn_throughput": 36955.215, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51545520, "num_env_steps_trained": 51545520, "num_agent_steps_sampled": 51545520, "num_agent_steps_trained": 51545520}, "done": false, "episodes_total": 12639, "training_iteration": 3942, "trial_id": "ef964_00000", "date": "2023-08-08_13-59-09", "timestamp": 1691492349, "time_this_iter_s": 12.958897352218628, "time_total_s": 94157.55806684494, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1135.8786163330078, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 24.16842105263158, "ram_util_percent": 65.62631578947371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.49559326171874, "policy_loss": -7031417.984375, "vf_loss": 15884275.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1738.0, "diff_num_grad_updates_vs_sampler_policy": 1737.0}}, "num_env_steps_sampled": 51546960, "num_env_steps_trained": 51546960, "num_agent_steps_sampled": 51546960, "num_agent_steps_trained": 51546960}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.516796633807, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7312631443197715, "mean_inference_ms": 0.3789539203867209, "mean_action_processing_ms": 0.09205549472342628, "mean_env_wait_ms": 0.9136119968398084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035576820373535156, "StateBufferConnector_ms": 0.0028009414672851562, "ViewRequirementAgentConnector_ms": 0.06658673286437988}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.516796633807, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3026.435988775333, -3097.5907365930607, -3091.8801570254886, -3074.998608171943, -3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7312631443197715, "mean_inference_ms": 0.3789539203867209, "mean_action_processing_ms": 0.09205549472342628, "mean_env_wait_ms": 0.9136119968398084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035576820373535156, "StateBufferConnector_ms": 0.0028009414672851562, "ViewRequirementAgentConnector_ms": 0.06658673286437988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51546960, "num_agent_steps_trained": 51546960, "num_env_steps_sampled": 51546960, "num_env_steps_trained": 51546960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.67969840704879, "num_env_steps_trained_throughput_per_sec": 109.67969840704879, "timesteps_total": 51546960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51546960, "timers": {"training_iteration_time_ms": 3271.297, "sample_time_ms": 3260.484, "load_time_ms": 0.304, "load_throughput": 1184459.868, "learn_time_ms": 9.737, "learn_throughput": 36972.046, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51546960, "num_env_steps_trained": 51546960, "num_agent_steps_sampled": 51546960, "num_agent_steps_trained": 51546960}, "done": false, "episodes_total": 12643, "training_iteration": 3943, "trial_id": "ef964_00000", "date": "2023-08-08_13-59-22", "timestamp": 1691492362, "time_this_iter_s": 13.131959199905396, "time_total_s": 94170.69002604485, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1149.0105755329132, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 19.950000000000003, "ram_util_percent": 65.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -366.88397827148435, "policy_loss": -9141420.76875, "vf_loss": 16632546.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1758.0, "diff_num_grad_updates_vs_sampler_policy": 1757.0}}, "num_env_steps_sampled": 51548400, "num_env_steps_trained": 51548400, "num_agent_steps_sampled": 51548400, "num_agent_steps_trained": 51548400}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.0968560792267, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7312387875795165, "mean_inference_ms": 0.37893947885726265, "mean_action_processing_ms": 0.09205411035541068, "mean_env_wait_ms": 0.9132356070059251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003565073013305664, "StateBufferConnector_ms": 0.0028023719787597656, "ViewRequirementAgentConnector_ms": 0.06667089462280273}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.0968560792267, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.230302528323, -3047.238739759392, -3048.747524754758, -3069.2315687646783, -3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7312387875795165, "mean_inference_ms": 0.37893947885726265, "mean_action_processing_ms": 0.09205411035541068, "mean_env_wait_ms": 0.9132356070059251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003565073013305664, "StateBufferConnector_ms": 0.0028023719787597656, "ViewRequirementAgentConnector_ms": 0.06667089462280273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51548400, "num_agent_steps_trained": 51548400, "num_env_steps_sampled": 51548400, "num_env_steps_trained": 51548400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.7179732721593, "num_env_steps_trained_throughput_per_sec": 108.7179732721593, "timesteps_total": 51548400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51548400, "timers": {"training_iteration_time_ms": 3299.641, "sample_time_ms": 3288.758, "load_time_ms": 0.302, "load_throughput": 1192881.529, "learn_time_ms": 9.807, "learn_throughput": 36707.527, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51548400, "num_env_steps_trained": 51548400, "num_agent_steps_sampled": 51548400, "num_agent_steps_trained": 51548400}, "done": false, "episodes_total": 12647, "training_iteration": 3944, "trial_id": "ef964_00000", "date": "2023-08-08_13-59-35", "timestamp": 1691492375, "time_this_iter_s": 13.248183012008667, "time_total_s": 94183.93820905685, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1162.2587585449219, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 20.2, "ram_util_percent": 65.69473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.2065734863281, "policy_loss": -9182356.803125, "vf_loss": 15660432.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1778.0, "diff_num_grad_updates_vs_sampler_policy": 1777.0}}, "num_env_steps_sampled": 51549840, "num_env_steps_trained": 51549840, "num_agent_steps_sampled": 51549840, "num_agent_steps_trained": 51549840}, "sampler_results": {"episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.503892078919, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731195972467563, "mean_inference_ms": 0.3789249987280962, "mean_action_processing_ms": 0.09205279558565277, "mean_env_wait_ms": 0.912887285575631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.06665873527526855}}, "episode_reward_max": -3002.9313328782523, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.503892078919, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3046.2257870006197, -3045.467072031824, -3002.9313328782523, -3130.446082228561, -3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731195972467563, "mean_inference_ms": 0.3789249987280962, "mean_action_processing_ms": 0.09205279558565277, "mean_env_wait_ms": 0.912887285575631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.06665873527526855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51549840, "num_agent_steps_trained": 51549840, "num_env_steps_sampled": 51549840, "num_env_steps_trained": 51549840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.74129331755623, "num_env_steps_trained_throughput_per_sec": 109.74129331755623, "timesteps_total": 51549840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51549840, "timers": {"training_iteration_time_ms": 3288.02, "sample_time_ms": 3277.055, "load_time_ms": 0.303, "load_throughput": 1188842.957, "learn_time_ms": 9.882, "learn_throughput": 36429.707, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 51549840, "num_env_steps_trained": 51549840, "num_agent_steps_sampled": 51549840, "num_agent_steps_trained": 51549840}, "done": false, "episodes_total": 12651, "training_iteration": 3945, "trial_id": "ef964_00000", "date": "2023-08-08_13-59-49", "timestamp": 1691492389, "time_this_iter_s": 13.124610900878906, "time_total_s": 94197.06281995773, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1175.3833694458008, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 19.652631578947368, "ram_util_percent": 65.84736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -371.29046630859375, "policy_loss": -4222170.2375, "vf_loss": 16365674.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1798.0, "diff_num_grad_updates_vs_sampler_policy": 1797.0}}, "num_env_steps_sampled": 51551280, "num_env_steps_trained": 51551280, "num_agent_steps_sampled": 51551280, "num_agent_steps_trained": 51551280}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.897054241245, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731141597555966, "mean_inference_ms": 0.37890965926258857, "mean_action_processing_ms": 0.09205156212893588, "mean_env_wait_ms": 0.9125475635140091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035545825958251953, "StateBufferConnector_ms": 0.0028030872344970703, "ViewRequirementAgentConnector_ms": 0.06662225723266602}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.897054241245, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.356246723666, -3138.695796782952, -3095.4825549252428, -3046.7244866322903, -3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731141597555966, "mean_inference_ms": 0.37890965926258857, "mean_action_processing_ms": 0.09205156212893588, "mean_env_wait_ms": 0.9125475635140091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035545825958251953, "StateBufferConnector_ms": 0.0028030872344970703, "ViewRequirementAgentConnector_ms": 0.06662225723266602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51551280, "num_agent_steps_trained": 51551280, "num_env_steps_sampled": 51551280, "num_env_steps_trained": 51551280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.73390218337624, "num_env_steps_trained_throughput_per_sec": 109.73390218337624, "timesteps_total": 51551280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51551280, "timers": {"training_iteration_time_ms": 3285.077, "sample_time_ms": 3274.206, "load_time_ms": 0.304, "load_throughput": 1183809.831, "learn_time_ms": 9.796, "learn_throughput": 36749.248, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51551280, "num_env_steps_trained": 51551280, "num_agent_steps_sampled": 51551280, "num_agent_steps_trained": 51551280}, "done": false, "episodes_total": 12655, "training_iteration": 3946, "trial_id": "ef964_00000", "date": "2023-08-08_14-00-02", "timestamp": 1691492402, "time_this_iter_s": 13.12533974647522, "time_total_s": 94210.18815970421, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1188.508709192276, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 19.87222222222222, "ram_util_percent": 65.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.1128845214844, "policy_loss": -14337811.96875, "vf_loss": 16449126.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1818.0, "diff_num_grad_updates_vs_sampler_policy": 1817.0}}, "num_env_steps_sampled": 51552720, "num_env_steps_trained": 51552720, "num_agent_steps_sampled": 51552720, "num_agent_steps_trained": 51552720}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.7370388552054, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731146233535586, "mean_inference_ms": 0.3788929548255352, "mean_action_processing_ms": 0.09205025255705677, "mean_env_wait_ms": 0.9122098326699464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035533905029296875, "StateBufferConnector_ms": 0.002799510955810547, "ViewRequirementAgentConnector_ms": 0.06664299964904785}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.7370388552054, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.0895732899044, -3044.8802252498813, -3093.813456963026, -3045.714390023044, -3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731146233535586, "mean_inference_ms": 0.3788929548255352, "mean_action_processing_ms": 0.09205025255705677, "mean_env_wait_ms": 0.9122098326699464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035533905029296875, "StateBufferConnector_ms": 0.002799510955810547, "ViewRequirementAgentConnector_ms": 0.06664299964904785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51552720, "num_agent_steps_trained": 51552720, "num_env_steps_sampled": 51552720, "num_env_steps_trained": 51552720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.94724891692577, "num_env_steps_trained_throughput_per_sec": 107.94724891692577, "timesteps_total": 51552720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51552720, "timers": {"training_iteration_time_ms": 3297.132, "sample_time_ms": 3286.303, "load_time_ms": 0.304, "load_throughput": 1182419.295, "learn_time_ms": 9.745, "learn_throughput": 36942.647, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 51552720, "num_env_steps_trained": 51552720, "num_agent_steps_sampled": 51552720, "num_agent_steps_trained": 51552720}, "done": false, "episodes_total": 12659, "training_iteration": 3947, "trial_id": "ef964_00000", "date": "2023-08-08_14-00-15", "timestamp": 1691492415, "time_this_iter_s": 13.342682123184204, "time_total_s": 94223.53084182739, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1201.8513913154602, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 19.347368421052632, "ram_util_percent": 65.86315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.22443237304685, "policy_loss": 112676.83125, "vf_loss": 14989794.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1838.0, "diff_num_grad_updates_vs_sampler_policy": 1837.0}}, "num_env_steps_sampled": 51554160, "num_env_steps_trained": 51554160, "num_agent_steps_sampled": 51554160, "num_agent_steps_trained": 51554160}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.1465394138754, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731127694030427, "mean_inference_ms": 0.3788760148600727, "mean_action_processing_ms": 0.09204926957332908, "mean_env_wait_ms": 0.9118777118167763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035545825958251953, "StateBufferConnector_ms": 0.0028023719787597656, "ViewRequirementAgentConnector_ms": 0.06668710708618164}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.1465394138754, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.131602736723, -3093.8607420510725, -3068.916529091768, -3117.282210705147, -3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731127694030427, "mean_inference_ms": 0.3788760148600727, "mean_action_processing_ms": 0.09204926957332908, "mean_env_wait_ms": 0.9118777118167763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035545825958251953, "StateBufferConnector_ms": 0.0028023719787597656, "ViewRequirementAgentConnector_ms": 0.06668710708618164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51554160, "num_agent_steps_trained": 51554160, "num_env_steps_sampled": 51554160, "num_env_steps_trained": 51554160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.13457582910043, "num_env_steps_trained_throughput_per_sec": 110.13457582910043, "timesteps_total": 51554160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51554160, "timers": {"training_iteration_time_ms": 3297.598, "sample_time_ms": 3286.646, "load_time_ms": 0.305, "load_throughput": 1181032.022, "learn_time_ms": 9.869, "learn_throughput": 36479.698, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 51554160, "num_env_steps_trained": 51554160, "num_agent_steps_sampled": 51554160, "num_agent_steps_trained": 51554160}, "done": false, "episodes_total": 12663, "training_iteration": 3948, "trial_id": "ef964_00000", "date": "2023-08-08_14-00-28", "timestamp": 1691492428, "time_this_iter_s": 13.077808856964111, "time_total_s": 94236.60865068436, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1214.9292001724243, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 20.742105263157896, "ram_util_percent": 65.72105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.07362060546876, "policy_loss": -3948796.6375, "vf_loss": 15465861.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1858.0, "diff_num_grad_updates_vs_sampler_policy": 1857.0}}, "num_env_steps_sampled": 51555600, "num_env_steps_trained": 51555600, "num_agent_steps_sampled": 51555600, "num_agent_steps_trained": 51555600}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.4066008433856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731107883052188, "mean_inference_ms": 0.37885952453618926, "mean_action_processing_ms": 0.09204826398531395, "mean_env_wait_ms": 0.9115595256105226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548860549926758, "StateBufferConnector_ms": 0.002801656723022461, "ViewRequirementAgentConnector_ms": 0.06667494773864746}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.4066008433856, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3046.9673622539017, -3068.1182621327766, -3120.92456766421, -3024.326443433358, -3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731107883052188, "mean_inference_ms": 0.37885952453618926, "mean_action_processing_ms": 0.09204826398531395, "mean_env_wait_ms": 0.9115595256105226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548860549926758, "StateBufferConnector_ms": 0.002801656723022461, "ViewRequirementAgentConnector_ms": 0.06667494773864746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51555600, "num_agent_steps_trained": 51555600, "num_env_steps_sampled": 51555600, "num_env_steps_trained": 51555600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.8140917093533, "num_env_steps_trained_throughput_per_sec": 108.8140917093533, "timesteps_total": 51555600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51555600, "timers": {"training_iteration_time_ms": 3296.199, "sample_time_ms": 3285.252, "load_time_ms": 0.306, "load_throughput": 1178267.218, "learn_time_ms": 9.871, "learn_throughput": 36470.975, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51555600, "num_env_steps_trained": 51555600, "num_agent_steps_sampled": 51555600, "num_agent_steps_trained": 51555600}, "done": false, "episodes_total": 12667, "training_iteration": 3949, "trial_id": "ef964_00000", "date": "2023-08-08_14-00-41", "timestamp": 1691492441, "time_this_iter_s": 13.236457109451294, "time_total_s": 94249.84510779381, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1228.1656572818756, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 19.1, "ram_util_percent": 65.74999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -371.7661560058594, "policy_loss": -9316810.99375, "vf_loss": 15836209.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1878.0, "diff_num_grad_updates_vs_sampler_policy": 1877.0}}, "num_env_steps_sampled": 51557040, "num_env_steps_trained": 51557040, "num_agent_steps_sampled": 51557040, "num_agent_steps_trained": 51557040}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.860360061308, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731090980581768, "mean_inference_ms": 0.37884336221952675, "mean_action_processing_ms": 0.09204718182502734, "mean_env_wait_ms": 0.9112471586264754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550291061401367, "StateBufferConnector_ms": 0.0027937889099121094, "ViewRequirementAgentConnector_ms": 0.06661605834960938}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.860360061308, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3072.0873438998115, -3048.1725834371864, -3139.79608062766, -3046.3198504393745, -3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731090980581768, "mean_inference_ms": 0.37884336221952675, "mean_action_processing_ms": 0.09204718182502734, "mean_env_wait_ms": 0.9112471586264754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550291061401367, "StateBufferConnector_ms": 0.0027937889099121094, "ViewRequirementAgentConnector_ms": 0.06661605834960938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51557040, "num_agent_steps_trained": 51557040, "num_env_steps_sampled": 51557040, "num_env_steps_trained": 51557040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.30790234821687, "num_env_steps_trained_throughput_per_sec": 109.30790234821687, "timesteps_total": 51557040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51557040, "timers": {"training_iteration_time_ms": 3294.721, "sample_time_ms": 3283.825, "load_time_ms": 0.306, "load_throughput": 1177073.152, "learn_time_ms": 9.813, "learn_throughput": 36686.39, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51557040, "num_env_steps_trained": 51557040, "num_agent_steps_sampled": 51557040, "num_agent_steps_trained": 51557040}, "done": false, "episodes_total": 12671, "training_iteration": 3950, "trial_id": "ef964_00000", "date": "2023-08-08_14-00-55", "timestamp": 1691492455, "time_this_iter_s": 13.176677942276001, "time_total_s": 94263.02178573608, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1241.3423352241516, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 19.742105263157896, "ram_util_percent": 65.71052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -371.5350341796875, "policy_loss": 190848.090625, "vf_loss": 14954347.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1898.0, "diff_num_grad_updates_vs_sampler_policy": 1897.0}}, "num_env_steps_sampled": 51558480, "num_env_steps_trained": 51558480, "num_agent_steps_sampled": 51558480, "num_agent_steps_trained": 51558480}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.2400249068096, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731048764830718, "mean_inference_ms": 0.3788270649172631, "mean_action_processing_ms": 0.09204603364872192, "mean_env_wait_ms": 0.9109403643093394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545045852661133, "StateBufferConnector_ms": 0.002795696258544922, "ViewRequirementAgentConnector_ms": 0.06662559509277344}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.2400249068096, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3117.519207413797, -3023.028465612205, -3140.6430355191223, -3123.6348456492437, -3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731048764830718, "mean_inference_ms": 0.3788270649172631, "mean_action_processing_ms": 0.09204603364872192, "mean_env_wait_ms": 0.9109403643093394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545045852661133, "StateBufferConnector_ms": 0.002795696258544922, "ViewRequirementAgentConnector_ms": 0.06662559509277344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51558480, "num_agent_steps_trained": 51558480, "num_env_steps_sampled": 51558480, "num_env_steps_trained": 51558480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.57729180597116, "num_env_steps_trained_throughput_per_sec": 109.57729180597116, "timesteps_total": 51558480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51558480, "timers": {"training_iteration_time_ms": 3294.966, "sample_time_ms": 3284.071, "load_time_ms": 0.304, "load_throughput": 1183253.225, "learn_time_ms": 9.802, "learn_throughput": 36728.51, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 51558480, "num_env_steps_trained": 51558480, "num_agent_steps_sampled": 51558480, "num_agent_steps_trained": 51558480}, "done": false, "episodes_total": 12675, "training_iteration": 3951, "trial_id": "ef964_00000", "date": "2023-08-08_14-01-08", "timestamp": 1691492468, "time_this_iter_s": 13.144329071044922, "time_total_s": 94276.16611480713, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1254.4866642951965, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 18.442105263157895, "ram_util_percent": 65.67368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.0587463378906, "policy_loss": 319762.375, "vf_loss": 14941308.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1918.0, "diff_num_grad_updates_vs_sampler_policy": 1917.0}}, "num_env_steps_sampled": 51559920, "num_env_steps_trained": 51559920, "num_agent_steps_sampled": 51559920, "num_agent_steps_trained": 51559920}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3073.089809672927, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7310000526079605, "mean_inference_ms": 0.3788119164147537, "mean_action_processing_ms": 0.0920452699611645, "mean_env_wait_ms": 0.9106271781774435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035400390625, "StateBufferConnector_ms": 0.002820253372192383, "ViewRequirementAgentConnector_ms": 0.06668663024902344}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3073.089809672927, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3098.8164081784694, -3026.0899203343533, -3139.0584425915577, -3048.2791224290077, -3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7310000526079605, "mean_inference_ms": 0.3788119164147537, "mean_action_processing_ms": 0.0920452699611645, "mean_env_wait_ms": 0.9106271781774435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035400390625, "StateBufferConnector_ms": 0.002820253372192383, "ViewRequirementAgentConnector_ms": 0.06668663024902344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51559920, "num_agent_steps_trained": 51559920, "num_env_steps_sampled": 51559920, "num_env_steps_trained": 51559920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.15136562813248, "num_env_steps_trained_throughput_per_sec": 110.15136562813248, "timesteps_total": 51559920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51559920, "timers": {"training_iteration_time_ms": 3287.195, "sample_time_ms": 3276.289, "load_time_ms": 0.304, "load_throughput": 1184459.868, "learn_time_ms": 9.818, "learn_throughput": 36666.702, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 51559920, "num_env_steps_trained": 51559920, "num_agent_steps_sampled": 51559920, "num_agent_steps_trained": 51559920}, "done": false, "episodes_total": 12679, "training_iteration": 3952, "trial_id": "ef964_00000", "date": "2023-08-08_14-01-21", "timestamp": 1691492481, "time_this_iter_s": 13.075811862945557, "time_total_s": 94289.24192667007, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1267.562476158142, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 19.955555555555556, "ram_util_percent": 65.6888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.16025390625, "policy_loss": -5262790.6375, "vf_loss": 15533295.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1938.0, "diff_num_grad_updates_vs_sampler_policy": 1937.0}}, "num_env_steps_sampled": 51561360, "num_env_steps_trained": 51561360, "num_agent_steps_sampled": 51561360, "num_agent_steps_trained": 51561360}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3071.7071081542344, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730955520793668, "mean_inference_ms": 0.3787974331603687, "mean_action_processing_ms": 0.09204455586646193, "mean_env_wait_ms": 0.9103017068368083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035483837127685547, "StateBufferConnector_ms": 0.002811908721923828, "ViewRequirementAgentConnector_ms": 0.06665635108947754}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3071.7071081542344, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.7691304827586, -3094.3379046955706, -3074.0212425949435, -3094.5272564065663, -3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730955520793668, "mean_inference_ms": 0.3787974331603687, "mean_action_processing_ms": 0.09204455586646193, "mean_env_wait_ms": 0.9103017068368083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035483837127685547, "StateBufferConnector_ms": 0.002811908721923828, "ViewRequirementAgentConnector_ms": 0.06665635108947754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51561360, "num_agent_steps_trained": 51561360, "num_env_steps_sampled": 51561360, "num_env_steps_trained": 51561360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.31438940819588, "num_env_steps_trained_throughput_per_sec": 109.31438940819588, "timesteps_total": 51561360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51561360, "timers": {"training_iteration_time_ms": 3280.113, "sample_time_ms": 3269.157, "load_time_ms": 0.304, "load_throughput": 1183438.702, "learn_time_ms": 9.875, "learn_throughput": 36454.95, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51561360, "num_env_steps_trained": 51561360, "num_agent_steps_sampled": 51561360, "num_agent_steps_trained": 51561360}, "done": false, "episodes_total": 12683, "training_iteration": 3953, "trial_id": "ef964_00000", "date": "2023-08-08_14-01-34", "timestamp": 1691492494, "time_this_iter_s": 13.175839900970459, "time_total_s": 94302.41776657104, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1280.7383160591125, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 19.85263157894737, "ram_util_percent": 65.83684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -381.121484375, "policy_loss": -2662356.74375, "vf_loss": 15263106.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1958.0, "diff_num_grad_updates_vs_sampler_policy": 1957.0}}, "num_env_steps_sampled": 51562800, "num_env_steps_trained": 51562800, "num_agent_steps_sampled": 51562800, "num_agent_steps_trained": 51562800}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3070.1240504428947, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730932309506463, "mean_inference_ms": 0.3787828150738041, "mean_action_processing_ms": 0.09204381335294869, "mean_env_wait_ms": 0.9099673897994199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035505294799804688, "StateBufferConnector_ms": 0.002810239791870117, "ViewRequirementAgentConnector_ms": 0.06660962104797363}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3070.1240504428947, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3119.0955682352005, -3047.1179397175133, -3023.0162184099127, -3003.565462726196, -3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730932309506463, "mean_inference_ms": 0.3787828150738041, "mean_action_processing_ms": 0.09204381335294869, "mean_env_wait_ms": 0.9099673897994199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035505294799804688, "StateBufferConnector_ms": 0.002810239791870117, "ViewRequirementAgentConnector_ms": 0.06660962104797363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51562800, "num_agent_steps_trained": 51562800, "num_env_steps_sampled": 51562800, "num_env_steps_trained": 51562800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.20867259447323, "num_env_steps_trained_throughput_per_sec": 109.20867259447323, "timesteps_total": 51562800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51562800, "timers": {"training_iteration_time_ms": 3292.217, "sample_time_ms": 3281.264, "load_time_ms": 0.308, "load_throughput": 1169959.275, "learn_time_ms": 9.862, "learn_throughput": 36505.01, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 51562800, "num_env_steps_trained": 51562800, "num_agent_steps_sampled": 51562800, "num_agent_steps_trained": 51562800}, "done": false, "episodes_total": 12687, "training_iteration": 3954, "trial_id": "ef964_00000", "date": "2023-08-08_14-01-47", "timestamp": 1691492507, "time_this_iter_s": 13.188794136047363, "time_total_s": 94315.60656070709, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1293.92711019516, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 19.452631578947365, "ram_util_percent": 65.97894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -360.82354125976565, "policy_loss": -3995908.246875, "vf_loss": 15695531.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1978.0, "diff_num_grad_updates_vs_sampler_policy": 1977.0}}, "num_env_steps_sampled": 51564240, "num_env_steps_trained": 51564240, "num_agent_steps_sampled": 51564240, "num_agent_steps_trained": 51564240}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.250409830457, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730926376473656, "mean_inference_ms": 0.37876909945156817, "mean_action_processing_ms": 0.09204325403430884, "mean_env_wait_ms": 0.909663100822348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553628921508789, "StateBufferConnector_ms": 0.002810239791870117, "ViewRequirementAgentConnector_ms": 0.0666666030883789}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3072.250409830457, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.9465129127734, -3051.3510367043064, -3095.9277447619043, -3024.847703336487, -3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730926376473656, "mean_inference_ms": 0.37876909945156817, "mean_action_processing_ms": 0.09204325403430884, "mean_env_wait_ms": 0.909663100822348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553628921508789, "StateBufferConnector_ms": 0.002810239791870117, "ViewRequirementAgentConnector_ms": 0.0666666030883789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51564240, "num_agent_steps_trained": 51564240, "num_env_steps_sampled": 51564240, "num_env_steps_trained": 51564240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.98292537649539, "num_env_steps_trained_throughput_per_sec": 108.98292537649539, "timesteps_total": 51564240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51564240, "timers": {"training_iteration_time_ms": 3301.29, "sample_time_ms": 3290.473, "load_time_ms": 0.307, "load_throughput": 1173049.596, "learn_time_ms": 9.743, "learn_throughput": 36950.332, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 51564240, "num_env_steps_trained": 51564240, "num_agent_steps_sampled": 51564240, "num_agent_steps_trained": 51564240}, "done": false, "episodes_total": 12691, "training_iteration": 3955, "trial_id": "ef964_00000", "date": "2023-08-08_14-02-01", "timestamp": 1691492521, "time_this_iter_s": 13.215993881225586, "time_total_s": 94328.82255458832, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1307.1431040763855, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 19.611111111111114, "ram_util_percent": 65.85555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.51875, "policy_loss": -17605881.6, "vf_loss": 15913257.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1998.0, "diff_num_grad_updates_vs_sampler_policy": 1997.0}}, "num_env_steps_sampled": 51565680, "num_env_steps_trained": 51565680, "num_agent_steps_sampled": 51565680, "num_agent_steps_trained": 51565680}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.1325991002477, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730916538246827, "mean_inference_ms": 0.37875469552257146, "mean_action_processing_ms": 0.09204280322954743, "mean_env_wait_ms": 0.9093743605292351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553628921508789, "StateBufferConnector_ms": 0.002813577651977539, "ViewRequirementAgentConnector_ms": 0.0666208267211914}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.1325991002477, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.6570223517515, -3046.384303603471, -3046.1062288633766, -3093.45100867975, -3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730916538246827, "mean_inference_ms": 0.37875469552257146, "mean_action_processing_ms": 0.09204280322954743, "mean_env_wait_ms": 0.9093743605292351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553628921508789, "StateBufferConnector_ms": 0.002813577651977539, "ViewRequirementAgentConnector_ms": 0.0666208267211914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51565680, "num_agent_steps_trained": 51565680, "num_env_steps_sampled": 51565680, "num_env_steps_trained": 51565680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.50915927019038, "num_env_steps_trained_throughput_per_sec": 108.50915927019038, "timesteps_total": 51565680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51565680, "timers": {"training_iteration_time_ms": 3307.087, "sample_time_ms": 3296.199, "load_time_ms": 0.302, "load_throughput": 1190624.066, "learn_time_ms": 9.806, "learn_throughput": 36710.918, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 51565680, "num_env_steps_trained": 51565680, "num_agent_steps_sampled": 51565680, "num_agent_steps_trained": 51565680}, "done": false, "episodes_total": 12695, "training_iteration": 3956, "trial_id": "ef964_00000", "date": "2023-08-08_14-02-14", "timestamp": 1691492534, "time_this_iter_s": 13.273782014846802, "time_total_s": 94342.09633660316, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1320.4168860912323, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 18.278947368421054, "ram_util_percent": 65.9578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.6616577148437, "policy_loss": -12827280.26875, "vf_loss": 15907228.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2018.0, "diff_num_grad_updates_vs_sampler_policy": 2017.0}}, "num_env_steps_sampled": 51567120, "num_env_steps_trained": 51567120, "num_agent_steps_sampled": 51567120, "num_agent_steps_trained": 51567120}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.4516667329626, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730910918142834, "mean_inference_ms": 0.37874041701505207, "mean_action_processing_ms": 0.09204223596137937, "mean_env_wait_ms": 0.909104448626727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035462379455566406, "StateBufferConnector_ms": 0.0028007030487060547, "ViewRequirementAgentConnector_ms": 0.06656265258789062}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.4516667329626, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3068.599956502389, -3070.4309675267973, -3073.188576116691, -3070.5118606337396, -3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730910918142834, "mean_inference_ms": 0.37874041701505207, "mean_action_processing_ms": 0.09204223596137937, "mean_env_wait_ms": 0.909104448626727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035462379455566406, "StateBufferConnector_ms": 0.0028007030487060547, "ViewRequirementAgentConnector_ms": 0.06656265258789062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51567120, "num_agent_steps_trained": 51567120, "num_env_steps_sampled": 51567120, "num_env_steps_trained": 51567120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.83385627590003, "num_env_steps_trained_throughput_per_sec": 108.83385627590003, "timesteps_total": 51567120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51567120, "timers": {"training_iteration_time_ms": 3313.968, "sample_time_ms": 3302.981, "load_time_ms": 0.304, "load_throughput": 1185762.086, "learn_time_ms": 9.906, "learn_throughput": 36342.027, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 51567120, "num_env_steps_trained": 51567120, "num_agent_steps_sampled": 51567120, "num_agent_steps_trained": 51567120}, "done": false, "episodes_total": 12699, "training_iteration": 3957, "trial_id": "ef964_00000", "date": "2023-08-08_14-02-27", "timestamp": 1691492547, "time_this_iter_s": 13.234095096588135, "time_total_s": 94355.33043169975, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1333.6509811878204, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 19.731578947368423, "ram_util_percent": 65.67894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.17401733398435, "policy_loss": -5300862.575, "vf_loss": 16118013.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2038.0, "diff_num_grad_updates_vs_sampler_policy": 2037.0}}, "num_env_steps_sampled": 51568560, "num_env_steps_trained": 51568560, "num_agent_steps_sampled": 51568560, "num_agent_steps_trained": 51568560}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.1001179977984, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730964245058862, "mean_inference_ms": 0.37872705538764334, "mean_action_processing_ms": 0.09204150860980238, "mean_env_wait_ms": 0.9088488627759679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544330596923828, "StateBufferConnector_ms": 0.0027933120727539062, "ViewRequirementAgentConnector_ms": 0.0665445327758789}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.1001179977984, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.8902640007154, -3022.580777240466, -3024.529055542651, -3115.763312080908, -3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730964245058862, "mean_inference_ms": 0.37872705538764334, "mean_action_processing_ms": 0.09204150860980238, "mean_env_wait_ms": 0.9088488627759679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544330596923828, "StateBufferConnector_ms": 0.0027933120727539062, "ViewRequirementAgentConnector_ms": 0.0665445327758789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51568560, "num_agent_steps_trained": 51568560, "num_env_steps_sampled": 51568560, "num_env_steps_trained": 51568560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.33727535166915, "num_env_steps_trained_throughput_per_sec": 109.33727535166915, "timesteps_total": 51568560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51568560, "timers": {"training_iteration_time_ms": 3299.62, "sample_time_ms": 3288.615, "load_time_ms": 0.304, "load_throughput": 1182697.141, "learn_time_ms": 9.921, "learn_throughput": 36288.226, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 51568560, "num_env_steps_trained": 51568560, "num_agent_steps_sampled": 51568560, "num_agent_steps_trained": 51568560}, "done": false, "episodes_total": 12703, "training_iteration": 3958, "trial_id": "ef964_00000", "date": "2023-08-08_14-02-40", "timestamp": 1691492560, "time_this_iter_s": 13.173247337341309, "time_total_s": 94368.5036790371, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1346.8242285251617, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 18.105263157894736, "ram_util_percent": 65.67368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -372.4961791992188, "policy_loss": -882747.728125, "vf_loss": 15588304.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2058.0, "diff_num_grad_updates_vs_sampler_policy": 2057.0}}, "num_env_steps_sampled": 51570000, "num_env_steps_trained": 51570000, "num_agent_steps_sampled": 51570000, "num_agent_steps_trained": 51570000}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.7932019231525, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7310186191568, "mean_inference_ms": 0.3787127393651594, "mean_action_processing_ms": 0.09204069758720658, "mean_env_wait_ms": 0.9086025052482504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003514528274536133, "StateBufferConnector_ms": 0.0027976036071777344, "ViewRequirementAgentConnector_ms": 0.06662940979003906}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3075.7932019231525, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3169.0753500059423, -3141.0459812240483, -3099.575539966088, -3048.9279037079923, -3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7310186191568, "mean_inference_ms": 0.3787127393651594, "mean_action_processing_ms": 0.09204069758720658, "mean_env_wait_ms": 0.9086025052482504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003514528274536133, "StateBufferConnector_ms": 0.0027976036071777344, "ViewRequirementAgentConnector_ms": 0.06662940979003906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51570000, "num_agent_steps_trained": 51570000, "num_env_steps_sampled": 51570000, "num_env_steps_trained": 51570000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.19626868048941, "num_env_steps_trained_throughput_per_sec": 110.19626868048941, "timesteps_total": 51570000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51570000, "timers": {"training_iteration_time_ms": 3286.292, "sample_time_ms": 3275.491, "load_time_ms": 0.302, "load_throughput": 1193164.315, "learn_time_ms": 9.732, "learn_throughput": 36991.973, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51570000, "num_env_steps_trained": 51570000, "num_agent_steps_sampled": 51570000, "num_agent_steps_trained": 51570000}, "done": false, "episodes_total": 12707, "training_iteration": 3959, "trial_id": "ef964_00000", "date": "2023-08-08_14-02-53", "timestamp": 1691492573, "time_this_iter_s": 13.07030701637268, "time_total_s": 94381.57398605347, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1359.8945355415344, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 23.144444444444446, "ram_util_percent": 65.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.3094787597656, "policy_loss": -12775528.39375, "vf_loss": 16091188.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2078.0, "diff_num_grad_updates_vs_sampler_policy": 2077.0}}, "num_env_steps_sampled": 51571440, "num_env_steps_trained": 51571440, "num_agent_steps_sampled": 51571440, "num_agent_steps_trained": 51571440}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.6665882842185, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73106410431416, "mean_inference_ms": 0.37869863946913723, "mean_action_processing_ms": 0.09203997786361111, "mean_env_wait_ms": 0.9083486638172501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003507852554321289, "StateBufferConnector_ms": 0.002794504165649414, "ViewRequirementAgentConnector_ms": 0.06667423248291016}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3186.834095038791, "episode_reward_mean": -3074.6665882842185, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3186.834095038791, -3069.785534863563, -3145.659306183123, -3047.14218367719, -3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73106410431416, "mean_inference_ms": 0.37869863946913723, "mean_action_processing_ms": 0.09203997786361111, "mean_env_wait_ms": 0.9083486638172501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003507852554321289, "StateBufferConnector_ms": 0.002794504165649414, "ViewRequirementAgentConnector_ms": 0.06667423248291016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51571440, "num_agent_steps_trained": 51571440, "num_env_steps_sampled": 51571440, "num_env_steps_trained": 51571440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.01156124366285, "num_env_steps_trained_throughput_per_sec": 109.01156124366285, "timesteps_total": 51571440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51571440, "timers": {"training_iteration_time_ms": 3286.758, "sample_time_ms": 3275.911, "load_time_ms": 0.302, "load_throughput": 1191563.636, "learn_time_ms": 9.769, "learn_throughput": 36850.055, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 51571440, "num_env_steps_trained": 51571440, "num_agent_steps_sampled": 51571440, "num_agent_steps_trained": 51571440}, "done": false, "episodes_total": 12711, "training_iteration": 3960, "trial_id": "ef964_00000", "date": "2023-08-08_14-03-07", "timestamp": 1691492587, "time_this_iter_s": 13.212398767471313, "time_total_s": 94394.78638482094, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1373.1069343090057, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 19.394736842105264, "ram_util_percent": 65.60000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.491943359375, "policy_loss": -13730569.25, "vf_loss": 16472508.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2098.0, "diff_num_grad_updates_vs_sampler_policy": 2097.0}}, "num_env_steps_sampled": 51572880, "num_env_steps_trained": 51572880, "num_agent_steps_sampled": 51572880, "num_agent_steps_trained": 51572880}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.319159082653, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731117635017423, "mean_inference_ms": 0.37868576717375535, "mean_action_processing_ms": 0.09203935894309248, "mean_env_wait_ms": 0.9080985339186205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035016536712646484, "StateBufferConnector_ms": 0.0027904510498046875, "ViewRequirementAgentConnector_ms": 0.06662654876708984}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.319159082653, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3122.5164814033046, -3072.361092908938, -3096.5281708285875, -3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731117635017423, "mean_inference_ms": 0.37868576717375535, "mean_action_processing_ms": 0.09203935894309248, "mean_env_wait_ms": 0.9080985339186205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035016536712646484, "StateBufferConnector_ms": 0.0027904510498046875, "ViewRequirementAgentConnector_ms": 0.06662654876708984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51572880, "num_agent_steps_trained": 51572880, "num_env_steps_sampled": 51572880, "num_env_steps_trained": 51572880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.66206450622818, "num_env_steps_trained_throughput_per_sec": 108.66206450622818, "timesteps_total": 51572880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51572880, "timers": {"training_iteration_time_ms": 3308.707, "sample_time_ms": 3297.764, "load_time_ms": 0.302, "load_throughput": 1192316.361, "learn_time_ms": 9.865, "learn_throughput": 36491.689, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51572880, "num_env_steps_trained": 51572880, "num_agent_steps_sampled": 51572880, "num_agent_steps_trained": 51572880}, "done": false, "episodes_total": 12715, "training_iteration": 3961, "trial_id": "ef964_00000", "date": "2023-08-08_14-03-20", "timestamp": 1691492600, "time_this_iter_s": 13.254869937896729, "time_total_s": 94408.04125475883, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1386.3618042469025, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 19.573684210526313, "ram_util_percent": 65.71052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.5969299316406, "policy_loss": -4205514.21875, "vf_loss": 15754260.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2113.0, "diff_num_grad_updates_vs_sampler_policy": 2112.0}}, "num_env_steps_sampled": 51573960, "num_env_steps_trained": 51573960, "num_agent_steps_sampled": 51573960, "num_agent_steps_trained": 51573960}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.9098952578906, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731163355504954, "mean_inference_ms": 0.37867627419771116, "mean_action_processing_ms": 0.09203892164166802, "mean_env_wait_ms": 0.9079117769250428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035047531127929688, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06662178039550781}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.9098952578906, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3121.580062014248, -3023.424838395594, -3045.8731521856876, -3046.459478077192, -3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731163355504954, "mean_inference_ms": 0.37867627419771116, "mean_action_processing_ms": 0.09203892164166802, "mean_env_wait_ms": 0.9079117769250428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035047531127929688, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06662178039550781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51573960, "num_agent_steps_trained": 51573960, "num_env_steps_sampled": 51573960, "num_env_steps_trained": 51573960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.45311761939301, "num_env_steps_trained_throughput_per_sec": 107.45311761939301, "timesteps_total": 51573960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51573960, "timers": {"training_iteration_time_ms": 3319.047, "sample_time_ms": 3308.11, "load_time_ms": 0.301, "load_throughput": 1196947.634, "learn_time_ms": 9.86, "learn_throughput": 36511.278, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51573960, "num_env_steps_trained": 51573960, "num_agent_steps_sampled": 51573960, "num_agent_steps_trained": 51573960}, "done": false, "episodes_total": 12718, "training_iteration": 3962, "trial_id": "ef964_00000", "date": "2023-08-08_14-03-30", "timestamp": 1691492610, "time_this_iter_s": 10.05374813079834, "time_total_s": 94418.09500288963, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1396.4155523777008, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 18.357142857142858, "ram_util_percent": 65.67857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.4211059570313, "policy_loss": -3666831.1625, "vf_loss": 15462745.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2133.0, "diff_num_grad_updates_vs_sampler_policy": 2132.0}}, "num_env_steps_sampled": 51575400, "num_env_steps_trained": 51575400, "num_agent_steps_sampled": 51575400, "num_agent_steps_trained": 51575400}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.62464430749, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731194584414896, "mean_inference_ms": 0.3786642925906658, "mean_action_processing_ms": 0.09203836064468003, "mean_env_wait_ms": 0.9076689270022805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.0027952194213867188, "ViewRequirementAgentConnector_ms": 0.06664872169494629}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.62464430749, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3049.6542185265134, -3022.219150355801, -3047.757675668126, -3070.9867506769956, -3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731194584414896, "mean_inference_ms": 0.3786642925906658, "mean_action_processing_ms": 0.09203836064468003, "mean_env_wait_ms": 0.9076689270022805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.0027952194213867188, "ViewRequirementAgentConnector_ms": 0.06664872169494629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51575400, "num_agent_steps_trained": 51575400, "num_env_steps_sampled": 51575400, "num_env_steps_trained": 51575400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.71669528569903, "num_env_steps_trained_throughput_per_sec": 109.71669528569903, "timesteps_total": 51575400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51575400, "timers": {"training_iteration_time_ms": 3312.415, "sample_time_ms": 3301.583, "load_time_ms": 0.302, "load_throughput": 1194013.475, "learn_time_ms": 9.759, "learn_throughput": 36888.046, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51575400, "num_env_steps_trained": 51575400, "num_agent_steps_sampled": 51575400, "num_agent_steps_trained": 51575400}, "done": false, "episodes_total": 12722, "training_iteration": 3963, "trial_id": "ef964_00000", "date": "2023-08-08_14-03-43", "timestamp": 1691492623, "time_this_iter_s": 13.127612113952637, "time_total_s": 94431.22261500359, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1409.5431644916534, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 20.000000000000004, "ram_util_percent": 65.92105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.716357421875, "policy_loss": -3569754.48125, "vf_loss": 15664446.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2153.0, "diff_num_grad_updates_vs_sampler_policy": 2152.0}}, "num_env_steps_sampled": 51576840, "num_env_steps_trained": 51576840, "num_agent_steps_sampled": 51576840, "num_agent_steps_trained": 51576840}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3074.360040061186, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73121663681141, "mean_inference_ms": 0.3786538612355523, "mean_action_processing_ms": 0.09203806904384024, "mean_env_wait_ms": 0.907438721223231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350189208984375, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.06664705276489258}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3074.360040061186, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.0433653476043, -3095.2197335226347, -3090.781967374373, -3115.2989428626424, -3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73121663681141, "mean_inference_ms": 0.3786538612355523, "mean_action_processing_ms": 0.09203806904384024, "mean_env_wait_ms": 0.907438721223231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350189208984375, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.06664705276489258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51576840, "num_agent_steps_trained": 51576840, "num_env_steps_sampled": 51576840, "num_env_steps_trained": 51576840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.30458294896737, "num_env_steps_trained_throughput_per_sec": 109.30458294896737, "timesteps_total": 51576840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51576840, "timers": {"training_iteration_time_ms": 3299.087, "sample_time_ms": 3288.263, "load_time_ms": 0.302, "load_throughput": 1190811.861, "learn_time_ms": 9.753, "learn_throughput": 36910.408, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51576840, "num_env_steps_trained": 51576840, "num_agent_steps_sampled": 51576840, "num_agent_steps_trained": 51576840}, "done": false, "episodes_total": 12726, "training_iteration": 3964, "trial_id": "ef964_00000", "date": "2023-08-08_14-03-56", "timestamp": 1691492636, "time_this_iter_s": 13.177072048187256, "time_total_s": 94444.39968705177, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1422.7202365398407, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 18.89444444444445, "ram_util_percent": 65.99444444444447}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -373.3996643066406, "policy_loss": -5802747.90625, "vf_loss": 16254136.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2173.0, "diff_num_grad_updates_vs_sampler_policy": 2172.0}}, "num_env_steps_sampled": 51578280, "num_env_steps_trained": 51578280, "num_agent_steps_sampled": 51578280, "num_agent_steps_trained": 51578280}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.49321047369, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731275808980419, "mean_inference_ms": 0.3786427844434654, "mean_action_processing_ms": 0.09203777739724263, "mean_env_wait_ms": 0.9072044349477312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034983158111572266, "StateBufferConnector_ms": 0.002802610397338867, "ViewRequirementAgentConnector_ms": 0.06662154197692871}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.49321047369, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.1912592219746, -3045.158146964832, -3142.803593121787, -3025.770323557994, -3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731275808980419, "mean_inference_ms": 0.3786427844434654, "mean_action_processing_ms": 0.09203777739724263, "mean_env_wait_ms": 0.9072044349477312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034983158111572266, "StateBufferConnector_ms": 0.002802610397338867, "ViewRequirementAgentConnector_ms": 0.06662154197692871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51578280, "num_agent_steps_trained": 51578280, "num_env_steps_sampled": 51578280, "num_env_steps_trained": 51578280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.79011524411113, "num_env_steps_trained_throughput_per_sec": 108.79011524411113, "timesteps_total": 51578280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51578280, "timers": {"training_iteration_time_ms": 3295.435, "sample_time_ms": 3284.557, "load_time_ms": 0.301, "load_throughput": 1195810.121, "learn_time_ms": 9.796, "learn_throughput": 36751.216, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 51578280, "num_env_steps_trained": 51578280, "num_agent_steps_sampled": 51578280, "num_agent_steps_trained": 51578280}, "done": false, "episodes_total": 12730, "training_iteration": 3965, "trial_id": "ef964_00000", "date": "2023-08-08_14-04-10", "timestamp": 1691492650, "time_this_iter_s": 13.23951005935669, "time_total_s": 94457.63919711113, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1435.9597465991974, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 19.55263157894737, "ram_util_percent": 65.92105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.09275512695314, "policy_loss": -502646.625, "vf_loss": 15245267.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2193.0, "diff_num_grad_updates_vs_sampler_policy": 2192.0}}, "num_env_steps_sampled": 51579720, "num_env_steps_trained": 51579720, "num_agent_steps_sampled": 51579720, "num_agent_steps_trained": 51579720}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.5240187183317, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731305037335514, "mean_inference_ms": 0.37863199692565586, "mean_action_processing_ms": 0.09203739679172383, "mean_env_wait_ms": 0.9069745614756834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035102367401123047, "StateBufferConnector_ms": 0.0028030872344970703, "ViewRequirementAgentConnector_ms": 0.06657981872558594}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3073.5240187183317, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3073.160452179253, -3092.493305230201, -3092.832256549843, -3067.5458204029424, -3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731305037335514, "mean_inference_ms": 0.37863199692565586, "mean_action_processing_ms": 0.09203739679172383, "mean_env_wait_ms": 0.9069745614756834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035102367401123047, "StateBufferConnector_ms": 0.0028030872344970703, "ViewRequirementAgentConnector_ms": 0.06657981872558594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51579720, "num_agent_steps_trained": 51579720, "num_env_steps_sampled": 51579720, "num_env_steps_trained": 51579720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.06222477827824, "num_env_steps_trained_throughput_per_sec": 110.06222477827824, "timesteps_total": 51579720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51579720, "timers": {"training_iteration_time_ms": 3295.256, "sample_time_ms": 3284.46, "load_time_ms": 0.301, "load_throughput": 1194202.341, "learn_time_ms": 9.722, "learn_throughput": 37028.349, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51579720, "num_env_steps_trained": 51579720, "num_agent_steps_sampled": 51579720, "num_agent_steps_trained": 51579720}, "done": false, "episodes_total": 12734, "training_iteration": 3966, "trial_id": "ef964_00000", "date": "2023-08-08_14-04-23", "timestamp": 1691492663, "time_this_iter_s": 13.086305856704712, "time_total_s": 94470.72550296783, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1449.046052455902, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 19.484210526315792, "ram_util_percent": 65.77368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.3976623535156, "policy_loss": -12532560.4375, "vf_loss": 15863203.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2213.0, "diff_num_grad_updates_vs_sampler_policy": 2212.0}}, "num_env_steps_sampled": 51581160, "num_env_steps_trained": 51581160, "num_agent_steps_sampled": 51581160, "num_agent_steps_trained": 51581160}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3072.8965086853623, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731376634070241, "mean_inference_ms": 0.3786215275965181, "mean_action_processing_ms": 0.09203707673722385, "mean_env_wait_ms": 0.9067507146734716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515958786010742, "StateBufferConnector_ms": 0.0028069019317626953, "ViewRequirementAgentConnector_ms": 0.0666501522064209}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3072.8965086853623, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3098.977640007311, -3071.0405070335705, -3046.0047288128435, -3092.0123431086035, -3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731376634070241, "mean_inference_ms": 0.3786215275965181, "mean_action_processing_ms": 0.09203707673722385, "mean_env_wait_ms": 0.9067507146734716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515958786010742, "StateBufferConnector_ms": 0.0028069019317626953, "ViewRequirementAgentConnector_ms": 0.0666501522064209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51581160, "num_agent_steps_trained": 51581160, "num_env_steps_sampled": 51581160, "num_env_steps_trained": 51581160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.46970699596837, "num_env_steps_trained_throughput_per_sec": 109.46970699596837, "timesteps_total": 51581160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51581160, "timers": {"training_iteration_time_ms": 3285.91, "sample_time_ms": 3275.134, "load_time_ms": 0.301, "load_throughput": 1194202.341, "learn_time_ms": 9.712, "learn_throughput": 37068.802, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 51581160, "num_env_steps_trained": 51581160, "num_agent_steps_sampled": 51581160, "num_agent_steps_trained": 51581160}, "done": false, "episodes_total": 12738, "training_iteration": 3967, "trial_id": "ef964_00000", "date": "2023-08-08_14-04-36", "timestamp": 1691492676, "time_this_iter_s": 13.157218933105469, "time_total_s": 94483.88272190094, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1462.2032713890076, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 17.68888888888889, "ram_util_percent": 65.70555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -360.88603515625, "policy_loss": -9420761.4125, "vf_loss": 15745628.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2233.0, "diff_num_grad_updates_vs_sampler_policy": 2232.0}}, "num_env_steps_sampled": 51582600, "num_env_steps_trained": 51582600, "num_agent_steps_sampled": 51582600, "num_agent_steps_trained": 51582600}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3072.934760249623, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731469905851846, "mean_inference_ms": 0.3786127676060677, "mean_action_processing_ms": 0.09203710300576183, "mean_env_wait_ms": 0.9065372407132003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003520965576171875, "StateBufferConnector_ms": 0.002814769744873047, "ViewRequirementAgentConnector_ms": 0.06673026084899902}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3072.934760249623, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3082.1676009447838, -3072.6235512804237, -3072.0026271080765, -3164.885818976427, -3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731469905851846, "mean_inference_ms": 0.3786127676060677, "mean_action_processing_ms": 0.09203710300576183, "mean_env_wait_ms": 0.9065372407132003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003520965576171875, "StateBufferConnector_ms": 0.002814769744873047, "ViewRequirementAgentConnector_ms": 0.06673026084899902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51582600, "num_agent_steps_trained": 51582600, "num_env_steps_sampled": 51582600, "num_env_steps_trained": 51582600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.22759309427737, "num_env_steps_trained_throughput_per_sec": 109.22759309427737, "timesteps_total": 51582600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51582600, "timers": {"training_iteration_time_ms": 3280.793, "sample_time_ms": 3270.029, "load_time_ms": 0.301, "load_throughput": 1196378.607, "learn_time_ms": 9.707, "learn_throughput": 37087.284, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 51582600, "num_env_steps_trained": 51582600, "num_agent_steps_sampled": 51582600, "num_agent_steps_trained": 51582600}, "done": false, "episodes_total": 12742, "training_iteration": 3968, "trial_id": "ef964_00000", "date": "2023-08-08_14-04-49", "timestamp": 1691492689, "time_this_iter_s": 13.186329126358032, "time_total_s": 94497.0690510273, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1475.3896005153656, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 19.99473684210526, "ram_util_percent": 65.77368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.0083068847656, "policy_loss": -3035428.44375, "vf_loss": 14998739.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2253.0, "diff_num_grad_updates_vs_sampler_policy": 2252.0}}, "num_env_steps_sampled": 51584040, "num_env_steps_trained": 51584040, "num_agent_steps_sampled": 51584040, "num_agent_steps_trained": 51584040}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3071.188545580486, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731554188512434, "mean_inference_ms": 0.37860403380346375, "mean_action_processing_ms": 0.09203712417517462, "mean_env_wait_ms": 0.9063167126229714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035185813903808594, "StateBufferConnector_ms": 0.002817869186401367, "ViewRequirementAgentConnector_ms": 0.06670522689819336}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3166.9443294866996, "episode_reward_mean": -3071.188545580486, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3139.399437742857, -3166.9443294866996, -3024.7105617392035, -3093.0890060401407, -3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731554188512434, "mean_inference_ms": 0.37860403380346375, "mean_action_processing_ms": 0.09203712417517462, "mean_env_wait_ms": 0.9063167126229714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035185813903808594, "StateBufferConnector_ms": 0.002817869186401367, "ViewRequirementAgentConnector_ms": 0.06670522689819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51584040, "num_agent_steps_trained": 51584040, "num_env_steps_sampled": 51584040, "num_env_steps_trained": 51584040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.51578945994179, "num_env_steps_trained_throughput_per_sec": 109.51578945994179, "timesteps_total": 51584040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51584040, "timers": {"training_iteration_time_ms": 3291.279, "sample_time_ms": 3280.45, "load_time_ms": 0.303, "load_throughput": 1188842.957, "learn_time_ms": 9.756, "learn_throughput": 36899.043, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51584040, "num_env_steps_trained": 51584040, "num_agent_steps_sampled": 51584040, "num_agent_steps_trained": 51584040}, "done": false, "episodes_total": 12746, "training_iteration": 3969, "trial_id": "ef964_00000", "date": "2023-08-08_14-05-02", "timestamp": 1691492702, "time_this_iter_s": 13.151687145233154, "time_total_s": 94510.22073817253, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1488.5412876605988, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 19.4, "ram_util_percent": 65.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.432275390625, "policy_loss": -2623781.71875, "vf_loss": 15384825.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2273.0, "diff_num_grad_updates_vs_sampler_policy": 2272.0}}, "num_env_steps_sampled": 51585480, "num_env_steps_trained": 51585480, "num_agent_steps_sampled": 51585480, "num_agent_steps_trained": 51585480}, "sampler_results": {"episode_reward_max": -3000.067392093376, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3070.0399938723376, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731662167464024, "mean_inference_ms": 0.3785956378492837, "mean_action_processing_ms": 0.0920373278528896, "mean_env_wait_ms": 0.9060952212535376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035085678100585938, "StateBufferConnector_ms": 0.0028183460235595703, "ViewRequirementAgentConnector_ms": 0.06667852401733398}}, "episode_reward_max": -3000.067392093376, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3070.0399938723376, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3069.407838510315, -3000.067392093376, -3095.1199042463563, -3048.8502925337466, -3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731662167464024, "mean_inference_ms": 0.3785956378492837, "mean_action_processing_ms": 0.0920373278528896, "mean_env_wait_ms": 0.9060952212535376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035085678100585938, "StateBufferConnector_ms": 0.0028183460235595703, "ViewRequirementAgentConnector_ms": 0.06667852401733398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51585480, "num_agent_steps_trained": 51585480, "num_env_steps_sampled": 51585480, "num_env_steps_trained": 51585480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.86956637728443, "num_env_steps_trained_throughput_per_sec": 108.86956637728443, "timesteps_total": 51585480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51585480, "timers": {"training_iteration_time_ms": 3290.891, "sample_time_ms": 3280.146, "load_time_ms": 0.302, "load_throughput": 1190154.836, "learn_time_ms": 9.66, "learn_throughput": 37266.048, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 51585480, "num_env_steps_trained": 51585480, "num_agent_steps_sampled": 51585480, "num_agent_steps_trained": 51585480}, "done": false, "episodes_total": 12750, "training_iteration": 3970, "trial_id": "ef964_00000", "date": "2023-08-08_14-05-16", "timestamp": 1691492716, "time_this_iter_s": 13.229703903198242, "time_total_s": 94523.45044207573, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1501.770991563797, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 19.384210526315794, "ram_util_percent": 65.9157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.66013793945314, "policy_loss": -9792131.21875, "vf_loss": 16060766.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2293.0, "diff_num_grad_updates_vs_sampler_policy": 2292.0}}, "num_env_steps_sampled": 51586920, "num_env_steps_trained": 51586920, "num_agent_steps_sampled": 51586920, "num_agent_steps_trained": 51586920}, "sampler_results": {"episode_reward_max": -3000.0675493697754, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3072.1997507227784, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731789639187254, "mean_inference_ms": 0.3785862150696805, "mean_action_processing_ms": 0.0920372124710768, "mean_env_wait_ms": 0.905891049034509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.002819061279296875, "ViewRequirementAgentConnector_ms": 0.06667423248291016}}, "episode_reward_max": -3000.0675493697754, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3072.1997507227784, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3120.3489014983866, -3069.0369897642486, -3098.5176069531176, -3000.0675493697754, -3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731789639187254, "mean_inference_ms": 0.3785862150696805, "mean_action_processing_ms": 0.0920372124710768, "mean_env_wait_ms": 0.905891049034509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.002819061279296875, "ViewRequirementAgentConnector_ms": 0.06667423248291016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51586920, "num_agent_steps_trained": 51586920, "num_env_steps_sampled": 51586920, "num_env_steps_trained": 51586920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.74739227084798, "num_env_steps_trained_throughput_per_sec": 108.74739227084798, "timesteps_total": 51586920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51586920, "timers": {"training_iteration_time_ms": 3304.676, "sample_time_ms": 3293.952, "load_time_ms": 0.302, "load_throughput": 1191187.63, "learn_time_ms": 9.662, "learn_throughput": 37259.059, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 51586920, "num_env_steps_trained": 51586920, "num_agent_steps_sampled": 51586920, "num_agent_steps_trained": 51586920}, "done": false, "episodes_total": 12754, "training_iteration": 3971, "trial_id": "ef964_00000", "date": "2023-08-08_14-05-29", "timestamp": 1691492729, "time_this_iter_s": 13.24454402923584, "time_total_s": 94536.69498610497, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1515.0155355930328, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 19.811111111111114, "ram_util_percent": 65.79444444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.66810302734376, "policy_loss": -17574015.925, "vf_loss": 16461676.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2313.0, "diff_num_grad_updates_vs_sampler_policy": 2312.0}}, "num_env_steps_sampled": 51588360, "num_env_steps_trained": 51588360, "num_agent_steps_sampled": 51588360, "num_agent_steps_trained": 51588360}, "sampler_results": {"episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3072.0077405877023, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731863723431794, "mean_inference_ms": 0.37857682411561105, "mean_action_processing_ms": 0.09203711239610957, "mean_env_wait_ms": 0.9056942427550851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.002824544906616211, "ViewRequirementAgentConnector_ms": 0.06673121452331543}}, "episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3072.0077405877023, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3145.6354003730157, -3048.7350907668765, -3024.134425604536, -3070.173091660585, -3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731863723431794, "mean_inference_ms": 0.37857682411561105, "mean_action_processing_ms": 0.09203711239610957, "mean_env_wait_ms": 0.9056942427550851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.002824544906616211, "ViewRequirementAgentConnector_ms": 0.06673121452331543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51588360, "num_agent_steps_trained": 51588360, "num_env_steps_sampled": 51588360, "num_env_steps_trained": 51588360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.82732457134087, "num_env_steps_trained_throughput_per_sec": 109.82732457134087, "timesteps_total": 51588360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51588360, "timers": {"training_iteration_time_ms": 3291.761, "sample_time_ms": 3280.97, "load_time_ms": 0.302, "load_throughput": 1191187.63, "learn_time_ms": 9.735, "learn_throughput": 36981.191, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 51588360, "num_env_steps_trained": 51588360, "num_agent_steps_sampled": 51588360, "num_agent_steps_trained": 51588360}, "done": false, "episodes_total": 12758, "training_iteration": 3972, "trial_id": "ef964_00000", "date": "2023-08-08_14-05-42", "timestamp": 1691492742, "time_this_iter_s": 13.114287853240967, "time_total_s": 94549.8092739582, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1528.1298234462738, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 19.942105263157895, "ram_util_percent": 65.78421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.5189636230469, "policy_loss": -13941563.90625, "vf_loss": 16170283.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2333.0, "diff_num_grad_updates_vs_sampler_policy": 2332.0}}, "num_env_steps_sampled": 51589800, "num_env_steps_trained": 51589800, "num_agent_steps_sampled": 51589800, "num_agent_steps_trained": 51589800}, "sampler_results": {"episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3072.689464331008, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731938160194044, "mean_inference_ms": 0.3785682878449921, "mean_action_processing_ms": 0.09203702178551502, "mean_env_wait_ms": 0.9055201386816247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.0028162002563476562, "ViewRequirementAgentConnector_ms": 0.06677699089050293}}, "episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3072.689464331008, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3005.405093360853, -3025.02271240478, -3140.948127542894, -3116.3247968103647, -3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731938160194044, "mean_inference_ms": 0.3785682878449921, "mean_action_processing_ms": 0.09203702178551502, "mean_env_wait_ms": 0.9055201386816247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.0028162002563476562, "ViewRequirementAgentConnector_ms": 0.06677699089050293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51589800, "num_agent_steps_trained": 51589800, "num_env_steps_sampled": 51589800, "num_env_steps_trained": 51589800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.9304430762475, "num_env_steps_trained_throughput_per_sec": 108.9304430762475, "timesteps_total": 51589800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51589800, "timers": {"training_iteration_time_ms": 3297.561, "sample_time_ms": 3286.735, "load_time_ms": 0.305, "load_throughput": 1182049.037, "learn_time_ms": 9.748, "learn_throughput": 36929.004, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51589800, "num_env_steps_trained": 51589800, "num_agent_steps_sampled": 51589800, "num_agent_steps_trained": 51589800}, "done": false, "episodes_total": 12762, "training_iteration": 3973, "trial_id": "ef964_00000", "date": "2023-08-08_14-05-55", "timestamp": 1691492755, "time_this_iter_s": 13.222373247146606, "time_total_s": 94563.03164720535, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1541.3521966934204, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 19.30526315789474, "ram_util_percent": 66.03157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.42933349609376, "policy_loss": -6775700.11875, "vf_loss": 15181508.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2353.0, "diff_num_grad_updates_vs_sampler_policy": 2352.0}}, "num_env_steps_sampled": 51591240, "num_env_steps_trained": 51591240, "num_agent_steps_sampled": 51591240, "num_agent_steps_trained": 51591240}, "sampler_results": {"episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3072.3835330580837, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732025857467768, "mean_inference_ms": 0.3785598045765224, "mean_action_processing_ms": 0.09203693720882, "mean_env_wait_ms": 0.905348001804747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003536701202392578, "StateBufferConnector_ms": 0.002826690673828125, "ViewRequirementAgentConnector_ms": 0.0668637752532959}}, "episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3072.3835330580837, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.901590777759, -3068.6008183475574, -3024.8274085340913, -3141.363755244771, -3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732025857467768, "mean_inference_ms": 0.3785598045765224, "mean_action_processing_ms": 0.09203693720882, "mean_env_wait_ms": 0.905348001804747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003536701202392578, "StateBufferConnector_ms": 0.002826690673828125, "ViewRequirementAgentConnector_ms": 0.0668637752532959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51591240, "num_agent_steps_trained": 51591240, "num_env_steps_sampled": 51591240, "num_env_steps_trained": 51591240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.67359596794503, "num_env_steps_trained_throughput_per_sec": 108.67359596794503, "timesteps_total": 51591240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51591240, "timers": {"training_iteration_time_ms": 3305.112, "sample_time_ms": 3294.324, "load_time_ms": 0.304, "load_throughput": 1186041.505, "learn_time_ms": 9.7, "learn_throughput": 37112.352, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 51591240, "num_env_steps_trained": 51591240, "num_agent_steps_sampled": 51591240, "num_agent_steps_trained": 51591240}, "done": false, "episodes_total": 12766, "training_iteration": 3974, "trial_id": "ef964_00000", "date": "2023-08-08_14-06-09", "timestamp": 1691492769, "time_this_iter_s": 13.253544807434082, "time_total_s": 94576.28519201279, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1554.6057415008545, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 20.115789473684213, "ram_util_percent": 65.96315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.8713073730469, "policy_loss": -11349930.4375, "vf_loss": 16304628.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2373.0, "diff_num_grad_updates_vs_sampler_policy": 2372.0}}, "num_env_steps_sampled": 51592680, "num_env_steps_trained": 51592680, "num_agent_steps_sampled": 51592680, "num_agent_steps_trained": 51592680}, "sampler_results": {"episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.595701189011, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732113303884883, "mean_inference_ms": 0.37855238038361605, "mean_action_processing_ms": 0.09203704845998686, "mean_env_wait_ms": 0.9051886149362207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035371780395507812, "StateBufferConnector_ms": 0.0028285980224609375, "ViewRequirementAgentConnector_ms": 0.06683659553527832}}, "episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.595701189011, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.9205751500326, -3022.6444294471316, -3024.601860135939, -3094.894335922405, -3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732113303884883, "mean_inference_ms": 0.37855238038361605, "mean_action_processing_ms": 0.09203704845998686, "mean_env_wait_ms": 0.9051886149362207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035371780395507812, "StateBufferConnector_ms": 0.0028285980224609375, "ViewRequirementAgentConnector_ms": 0.06683659553527832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51592680, "num_agent_steps_trained": 51592680, "num_env_steps_sampled": 51592680, "num_env_steps_trained": 51592680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.76306449763044, "num_env_steps_trained_throughput_per_sec": 108.76306449763044, "timesteps_total": 51592680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51592680, "timers": {"training_iteration_time_ms": 3312.564, "sample_time_ms": 3301.882, "load_time_ms": 0.301, "load_throughput": 1196473.407, "learn_time_ms": 9.611, "learn_throughput": 37455.553, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51592680, "num_env_steps_trained": 51592680, "num_agent_steps_sampled": 51592680, "num_agent_steps_trained": 51592680}, "done": false, "episodes_total": 12770, "training_iteration": 3975, "trial_id": "ef964_00000", "date": "2023-08-08_14-06-22", "timestamp": 1691492782, "time_this_iter_s": 13.242724657058716, "time_total_s": 94589.52791666985, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1567.8484661579132, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 18.5, "ram_util_percent": 65.74444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.0583190917969, "policy_loss": 322258.559375, "vf_loss": 15126087.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2393.0, "diff_num_grad_updates_vs_sampler_policy": 2392.0}}, "num_env_steps_sampled": 51594120, "num_env_steps_trained": 51594120, "num_agent_steps_sampled": 51594120, "num_agent_steps_trained": 51594120}, "sampler_results": {"episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.6193450974797, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732220193777119, "mean_inference_ms": 0.3785458500180388, "mean_action_processing_ms": 0.0920372020724533, "mean_env_wait_ms": 0.9050399983864872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003540515899658203, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.06678962707519531}}, "episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.6193450974797, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3002.201717448749, -3074.1216223235833, -3095.35559507669, -3120.258539187269, -3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732220193777119, "mean_inference_ms": 0.3785458500180388, "mean_action_processing_ms": 0.0920372020724533, "mean_env_wait_ms": 0.9050399983864872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003540515899658203, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.06678962707519531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51594120, "num_agent_steps_trained": 51594120, "num_env_steps_sampled": 51594120, "num_env_steps_trained": 51594120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.54487896058976, "num_env_steps_trained_throughput_per_sec": 108.54487896058976, "timesteps_total": 51594120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51594120, "timers": {"training_iteration_time_ms": 3314.567, "sample_time_ms": 3303.825, "load_time_ms": 0.302, "load_throughput": 1192787.298, "learn_time_ms": 9.655, "learn_throughput": 37287.214, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 51594120, "num_env_steps_trained": 51594120, "num_agent_steps_sampled": 51594120, "num_agent_steps_trained": 51594120}, "done": false, "episodes_total": 12774, "training_iteration": 3976, "trial_id": "ef964_00000", "date": "2023-08-08_14-06-35", "timestamp": 1691492795, "time_this_iter_s": 13.269231796264648, "time_total_s": 94602.79714846611, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1581.1176979541779, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 19.02631578947369, "ram_util_percent": 65.67894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.66517944335936, "policy_loss": -13827996.0875, "vf_loss": 16007750.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2413.0, "diff_num_grad_updates_vs_sampler_policy": 2412.0}}, "num_env_steps_sampled": 51595560, "num_env_steps_trained": 51595560, "num_agent_steps_sampled": 51595560, "num_agent_steps_trained": 51595560}, "sampler_results": {"episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.3059355546193, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732360846653867, "mean_inference_ms": 0.3785389311377898, "mean_action_processing_ms": 0.09203733194665671, "mean_env_wait_ms": 0.9048900395360446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035407543182373047, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.0667266845703125}}, "episode_reward_max": -3000.068274218507, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.3059355546193, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.068274218507, -3025.114825691411, -3073.227603988928, -3000.0683861468137, -3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732360846653867, "mean_inference_ms": 0.3785389311377898, "mean_action_processing_ms": 0.09203733194665671, "mean_env_wait_ms": 0.9048900395360446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035407543182373047, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.0667266845703125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51595560, "num_agent_steps_trained": 51595560, "num_env_steps_sampled": 51595560, "num_env_steps_trained": 51595560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.10709400505088, "num_env_steps_trained_throughput_per_sec": 109.10709400505088, "timesteps_total": 51595560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51595560, "timers": {"training_iteration_time_ms": 3305.664, "sample_time_ms": 3294.816, "load_time_ms": 0.302, "load_throughput": 1191187.63, "learn_time_ms": 9.756, "learn_throughput": 36901.568, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 51595560, "num_env_steps_trained": 51595560, "num_agent_steps_sampled": 51595560, "num_agent_steps_trained": 51595560}, "done": false, "episodes_total": 12778, "training_iteration": 3977, "trial_id": "ef964_00000", "date": "2023-08-08_14-06-48", "timestamp": 1691492808, "time_this_iter_s": 13.200923919677734, "time_total_s": 94615.99807238579, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1594.3186218738556, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 19.426315789473684, "ram_util_percent": 65.64210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.5338195800781, "policy_loss": -8853211.1484375, "vf_loss": 15622786.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2433.0, "diff_num_grad_updates_vs_sampler_policy": 2432.0}}, "num_env_steps_sampled": 51597000, "num_env_steps_trained": 51597000, "num_agent_steps_sampled": 51597000, "num_agent_steps_trained": 51597000}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3074.1841021260257, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732500720113577, "mean_inference_ms": 0.37853246245935496, "mean_action_processing_ms": 0.0920374268021786, "mean_env_wait_ms": 0.9047441219287035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035381317138671875, "StateBufferConnector_ms": 0.002814054489135742, "ViewRequirementAgentConnector_ms": 0.06684517860412598}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3074.1841021260257, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3075.562925836983, -3002.2161933627913, -3048.2003631560374, -3096.115182337075, -3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732500720113577, "mean_inference_ms": 0.37853246245935496, "mean_action_processing_ms": 0.0920374268021786, "mean_env_wait_ms": 0.9047441219287035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035381317138671875, "StateBufferConnector_ms": 0.002814054489135742, "ViewRequirementAgentConnector_ms": 0.06684517860412598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51597000, "num_agent_steps_trained": 51597000, "num_env_steps_sampled": 51597000, "num_env_steps_trained": 51597000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.50517848110579, "num_env_steps_trained_throughput_per_sec": 109.50517848110579, "timesteps_total": 51597000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51597000, "timers": {"training_iteration_time_ms": 3297.904, "sample_time_ms": 3287.041, "load_time_ms": 0.303, "load_throughput": 1189779.718, "learn_time_ms": 9.775, "learn_throughput": 36829.383, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 51597000, "num_env_steps_trained": 51597000, "num_agent_steps_sampled": 51597000, "num_agent_steps_trained": 51597000}, "done": false, "episodes_total": 12782, "training_iteration": 3978, "trial_id": "ef964_00000", "date": "2023-08-08_14-07-02", "timestamp": 1691492822, "time_this_iter_s": 13.152899980545044, "time_total_s": 94629.15097236633, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1607.4715218544006, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 19.87777777777778, "ram_util_percent": 65.75555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.46564331054685, "policy_loss": -8650787.703125, "vf_loss": 15593684.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2453.0, "diff_num_grad_updates_vs_sampler_policy": 2452.0}}, "num_env_steps_sampled": 51598440, "num_env_steps_trained": 51598440, "num_agent_steps_sampled": 51598440, "num_agent_steps_trained": 51598440}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3074.3399688533977, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732637970686844, "mean_inference_ms": 0.37852652853813057, "mean_action_processing_ms": 0.09203746168167819, "mean_env_wait_ms": 0.9046077546310366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531217575073242, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.0668020248413086}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3074.3399688533977, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3028.8180241900327, -3071.992437552325, -3119.2482641563497, -3118.654634207274, -3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732637970686844, "mean_inference_ms": 0.37852652853813057, "mean_action_processing_ms": 0.09203746168167819, "mean_env_wait_ms": 0.9046077546310366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531217575073242, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.0668020248413086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51598440, "num_agent_steps_trained": 51598440, "num_env_steps_sampled": 51598440, "num_env_steps_trained": 51598440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.01576209523904, "num_env_steps_trained_throughput_per_sec": 109.01576209523904, "timesteps_total": 51598440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51598440, "timers": {"training_iteration_time_ms": 3290.513, "sample_time_ms": 3279.637, "load_time_ms": 0.303, "load_throughput": 1188749.362, "learn_time_ms": 9.797, "learn_throughput": 36745.939, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51598440, "num_env_steps_trained": 51598440, "num_agent_steps_sampled": 51598440, "num_agent_steps_trained": 51598440}, "done": false, "episodes_total": 12786, "training_iteration": 3979, "trial_id": "ef964_00000", "date": "2023-08-08_14-07-15", "timestamp": 1691492835, "time_this_iter_s": 13.212294816970825, "time_total_s": 94642.3632671833, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1620.6838166713715, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 18.978947368421046, "ram_util_percent": 65.6842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.7917724609375, "policy_loss": -5512913.315625, "vf_loss": 15541813.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2473.0, "diff_num_grad_updates_vs_sampler_policy": 2472.0}}, "num_env_steps_sampled": 51599880, "num_env_steps_trained": 51599880, "num_agent_steps_sampled": 51599880, "num_agent_steps_trained": 51599880}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.117906746514, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732777545488677, "mean_inference_ms": 0.3785209200962674, "mean_action_processing_ms": 0.09203746885047132, "mean_env_wait_ms": 0.904461665313653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035293102264404297, "StateBufferConnector_ms": 0.0028154850006103516, "ViewRequirementAgentConnector_ms": 0.06681990623474121}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.117906746514, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3095.5357919291264, -3123.5241900159895, -3093.0282600116248, -3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732777545488677, "mean_inference_ms": 0.3785209200962674, "mean_action_processing_ms": 0.09203746885047132, "mean_env_wait_ms": 0.904461665313653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035293102264404297, "StateBufferConnector_ms": 0.0028154850006103516, "ViewRequirementAgentConnector_ms": 0.06681990623474121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51599880, "num_agent_steps_trained": 51599880, "num_env_steps_sampled": 51599880, "num_env_steps_trained": 51599880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.29503140455405, "num_env_steps_trained_throughput_per_sec": 109.29503140455405, "timesteps_total": 51599880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51599880, "timers": {"training_iteration_time_ms": 3290.626, "sample_time_ms": 3279.828, "load_time_ms": 0.303, "load_throughput": 1187720.79, "learn_time_ms": 9.728, "learn_throughput": 37004.846, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 51599880, "num_env_steps_trained": 51599880, "num_agent_steps_sampled": 51599880, "num_agent_steps_trained": 51599880}, "done": false, "episodes_total": 12790, "training_iteration": 3980, "trial_id": "ef964_00000", "date": "2023-08-08_14-07-28", "timestamp": 1691492848, "time_this_iter_s": 13.179800033569336, "time_total_s": 94655.54306721687, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1633.8636167049408, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 20.189473684210526, "ram_util_percent": 65.61052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.5495666503906, "policy_loss": -9589316.4625, "vf_loss": 15772607.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2488.0, "diff_num_grad_updates_vs_sampler_policy": 2487.0}}, "num_env_steps_sampled": 51600960, "num_env_steps_trained": 51600960, "num_agent_steps_sampled": 51600960, "num_agent_steps_trained": 51600960}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.2340346785804, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732885311222048, "mean_inference_ms": 0.378516980504833, "mean_action_processing_ms": 0.09203747674504693, "mean_env_wait_ms": 0.9043559239475019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0028276443481445312, "ViewRequirementAgentConnector_ms": 0.06682395935058594}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3162.870950123696, "episode_reward_mean": -3073.2340346785804, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.008894514227, -3095.7305801525945, -3022.7936149138063, -3069.655869288573, -3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732885311222048, "mean_inference_ms": 0.378516980504833, "mean_action_processing_ms": 0.09203747674504693, "mean_env_wait_ms": 0.9043559239475019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0028276443481445312, "ViewRequirementAgentConnector_ms": 0.06682395935058594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51600960, "num_agent_steps_trained": 51600960, "num_env_steps_sampled": 51600960, "num_env_steps_trained": 51600960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.96130765970372, "num_env_steps_trained_throughput_per_sec": 107.96130765970372, "timesteps_total": 51600960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51600960, "timers": {"training_iteration_time_ms": 3311.412, "sample_time_ms": 3300.676, "load_time_ms": 0.303, "load_throughput": 1189592.248, "learn_time_ms": 9.674, "learn_throughput": 37214.797, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51600960, "num_env_steps_trained": 51600960, "num_agent_steps_sampled": 51600960, "num_agent_steps_trained": 51600960}, "done": false, "episodes_total": 12793, "training_iteration": 3981, "trial_id": "ef964_00000", "date": "2023-08-08_14-07-38", "timestamp": 1691492858, "time_this_iter_s": 10.00633692741394, "time_total_s": 94665.54940414429, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1643.8699536323547, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 20.764285714285716, "ram_util_percent": 65.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.2264892578125, "policy_loss": -9163547.134375, "vf_loss": 15756141.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2508.0, "diff_num_grad_updates_vs_sampler_policy": 2507.0}}, "num_env_steps_sampled": 51602400, "num_env_steps_trained": 51602400, "num_agent_steps_sampled": 51602400, "num_agent_steps_trained": 51602400}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3074.435905485918, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73300655038041, "mean_inference_ms": 0.378511997214318, "mean_action_processing_ms": 0.09203746588012664, "mean_env_wait_ms": 0.9042256879048938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518342971801758, "StateBufferConnector_ms": 0.002826690673828125, "ViewRequirementAgentConnector_ms": 0.0667729377746582}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3074.435905485918, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3053.861976060204, -3094.1938665072594, -3121.082411875727, -3054.0327919120446, -3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73300655038041, "mean_inference_ms": 0.378511997214318, "mean_action_processing_ms": 0.09203746588012664, "mean_env_wait_ms": 0.9042256879048938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518342971801758, "StateBufferConnector_ms": 0.002826690673828125, "ViewRequirementAgentConnector_ms": 0.0667729377746582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51602400, "num_agent_steps_trained": 51602400, "num_env_steps_sampled": 51602400, "num_env_steps_trained": 51602400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.11511059484847, "num_env_steps_trained_throughput_per_sec": 109.11511059484847, "timesteps_total": 51602400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51602400, "timers": {"training_iteration_time_ms": 3314.643, "sample_time_ms": 3303.822, "load_time_ms": 0.302, "load_throughput": 1191845.797, "learn_time_ms": 9.757, "learn_throughput": 36897.961, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51602400, "num_env_steps_trained": 51602400, "num_agent_steps_sampled": 51602400, "num_agent_steps_trained": 51602400}, "done": false, "episodes_total": 12797, "training_iteration": 3982, "trial_id": "ef964_00000", "date": "2023-08-08_14-07-51", "timestamp": 1691492871, "time_this_iter_s": 13.19988489151001, "time_total_s": 94678.7492890358, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1657.0698385238647, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 19.515789473684208, "ram_util_percent": 66.05263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.4088073730469, "policy_loss": -13366052.384375, "vf_loss": 16037473.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2528.0, "diff_num_grad_updates_vs_sampler_policy": 2527.0}}, "num_env_steps_sampled": 51603840, "num_env_steps_trained": 51603840, "num_agent_steps_sampled": 51603840, "num_agent_steps_trained": 51603840}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3074.25782367363, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733103768308268, "mean_inference_ms": 0.3785065078893694, "mean_action_processing_ms": 0.09203746732395648, "mean_env_wait_ms": 0.9040907023886503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528118133544922, "StateBufferConnector_ms": 0.0028302669525146484, "ViewRequirementAgentConnector_ms": 0.0667734146118164}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3074.25782367363, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3072.2330486363835, -3100.228234839049, -3076.9174378420216, -3022.8279004286055, -3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733103768308268, "mean_inference_ms": 0.3785065078893694, "mean_action_processing_ms": 0.09203746732395648, "mean_env_wait_ms": 0.9040907023886503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528118133544922, "StateBufferConnector_ms": 0.0028302669525146484, "ViewRequirementAgentConnector_ms": 0.0667734146118164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51603840, "num_agent_steps_trained": 51603840, "num_env_steps_sampled": 51603840, "num_env_steps_trained": 51603840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.20810194255036, "num_env_steps_trained_throughput_per_sec": 110.20810194255036, "timesteps_total": 51603840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51603840, "timers": {"training_iteration_time_ms": 3291.232, "sample_time_ms": 3280.458, "load_time_ms": 0.304, "load_throughput": 1182882.444, "learn_time_ms": 9.706, "learn_throughput": 37091.293, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 51603840, "num_env_steps_trained": 51603840, "num_agent_steps_sampled": 51603840, "num_agent_steps_trained": 51603840}, "done": false, "episodes_total": 12801, "training_iteration": 3983, "trial_id": "ef964_00000", "date": "2023-08-08_14-08-04", "timestamp": 1691492884, "time_this_iter_s": 13.069375038146973, "time_total_s": 94691.81866407394, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1670.1392135620117, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 21.505555555555553, "ram_util_percent": 65.96111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.2543884277344, "policy_loss": -2680427.9375, "vf_loss": 15200041.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2548.0, "diff_num_grad_updates_vs_sampler_policy": 2547.0}}, "num_env_steps_sampled": 51605280, "num_env_steps_trained": 51605280, "num_agent_steps_sampled": 51605280, "num_agent_steps_trained": 51605280}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3073.8859967585, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73321590768806, "mean_inference_ms": 0.3785008104859812, "mean_action_processing_ms": 0.092037636712068, "mean_env_wait_ms": 0.903950723889094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530263900756836, "StateBufferConnector_ms": 0.0028383731842041016, "ViewRequirementAgentConnector_ms": 0.06687617301940918}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3073.8859967585, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3121.9491613735286, -3056.3773017559956, -3072.7209855921255, -3105.143364209025, -3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73321590768806, "mean_inference_ms": 0.3785008104859812, "mean_action_processing_ms": 0.092037636712068, "mean_env_wait_ms": 0.903950723889094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530263900756836, "StateBufferConnector_ms": 0.0028383731842041016, "ViewRequirementAgentConnector_ms": 0.06687617301940918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51605280, "num_agent_steps_trained": 51605280, "num_env_steps_sampled": 51605280, "num_env_steps_trained": 51605280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.56085938570108, "num_env_steps_trained_throughput_per_sec": 109.56085938570108, "timesteps_total": 51605280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51605280, "timers": {"training_iteration_time_ms": 3279.32, "sample_time_ms": 3268.502, "load_time_ms": 0.304, "load_throughput": 1183345.956, "learn_time_ms": 9.744, "learn_throughput": 36947.258, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51605280, "num_env_steps_trained": 51605280, "num_agent_steps_sampled": 51605280, "num_agent_steps_trained": 51605280}, "done": false, "episodes_total": 12805, "training_iteration": 3984, "trial_id": "ef964_00000", "date": "2023-08-08_14-08-18", "timestamp": 1691492898, "time_this_iter_s": 13.146384000778198, "time_total_s": 94704.96504807472, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1683.28559756279, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 19.97894736842105, "ram_util_percent": 65.82105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.52427978515624, "policy_loss": -11886780.875, "vf_loss": 16084841.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2568.0, "diff_num_grad_updates_vs_sampler_policy": 2567.0}}, "num_env_steps_sampled": 51606720, "num_env_steps_trained": 51606720, "num_agent_steps_sampled": 51606720, "num_agent_steps_trained": 51606720}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3073.1251513857064, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733307612834119, "mean_inference_ms": 0.37849480712923056, "mean_action_processing_ms": 0.09203789377310446, "mean_env_wait_ms": 0.9038067635771532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035429000854492188, "StateBufferConnector_ms": 0.0028357505798339844, "ViewRequirementAgentConnector_ms": 0.06677913665771484}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3073.1251513857064, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.339893068105, -3122.759168141391, -3068.9707774162925, -3031.558441006059, -3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733307612834119, "mean_inference_ms": 0.37849480712923056, "mean_action_processing_ms": 0.09203789377310446, "mean_env_wait_ms": 0.9038067635771532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035429000854492188, "StateBufferConnector_ms": 0.0028357505798339844, "ViewRequirementAgentConnector_ms": 0.06677913665771484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51606720, "num_agent_steps_trained": 51606720, "num_env_steps_sampled": 51606720, "num_env_steps_trained": 51606720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.70456134928011, "num_env_steps_trained_throughput_per_sec": 110.70456134928011, "timesteps_total": 51606720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51606720, "timers": {"training_iteration_time_ms": 3259.464, "sample_time_ms": 3248.709, "load_time_ms": 0.302, "load_throughput": 1190905.781, "learn_time_ms": 9.683, "learn_throughput": 37179.792, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51606720, "num_env_steps_trained": 51606720, "num_agent_steps_sampled": 51606720, "num_agent_steps_trained": 51606720}, "done": false, "episodes_total": 12809, "training_iteration": 3985, "trial_id": "ef964_00000", "date": "2023-08-08_14-08-31", "timestamp": 1691492911, "time_this_iter_s": 13.010803937911987, "time_total_s": 94717.97585201263, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1696.296401500702, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 23.142105263157895, "ram_util_percent": 65.65263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -372.27960815429685, "policy_loss": -10120684.3, "vf_loss": 16327628.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2588.0, "diff_num_grad_updates_vs_sampler_policy": 2587.0}}, "num_env_steps_sampled": 51608160, "num_env_steps_trained": 51608160, "num_agent_steps_sampled": 51608160, "num_agent_steps_trained": 51608160}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3073.3061249246553, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73341893384037, "mean_inference_ms": 0.3784876937685829, "mean_action_processing_ms": 0.09203799076923229, "mean_env_wait_ms": 0.9036548304233762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035452842712402344, "StateBufferConnector_ms": 0.0028421878814697266, "ViewRequirementAgentConnector_ms": 0.06675839424133301}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3073.3061249246553, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3072.405508406307, -3141.743472777535, -3162.870950123696, -3094.2553894330968, -3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73341893384037, "mean_inference_ms": 0.3784876937685829, "mean_action_processing_ms": 0.09203799076923229, "mean_env_wait_ms": 0.9036548304233762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035452842712402344, "StateBufferConnector_ms": 0.0028421878814697266, "ViewRequirementAgentConnector_ms": 0.06675839424133301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51608160, "num_agent_steps_trained": 51608160, "num_env_steps_sampled": 51608160, "num_env_steps_trained": 51608160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.4038921818272, "num_env_steps_trained_throughput_per_sec": 108.4038921818272, "timesteps_total": 51608160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51608160, "timers": {"training_iteration_time_ms": 3283.577, "sample_time_ms": 3272.825, "load_time_ms": 0.301, "load_throughput": 1194107.9, "learn_time_ms": 9.675, "learn_throughput": 37208.652, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51608160, "num_env_steps_trained": 51608160, "num_agent_steps_sampled": 51608160, "num_agent_steps_trained": 51608160}, "done": false, "episodes_total": 12813, "training_iteration": 3986, "trial_id": "ef964_00000", "date": "2023-08-08_14-08-44", "timestamp": 1691492924, "time_this_iter_s": 13.286648035049438, "time_total_s": 94731.26250004768, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1709.5830495357513, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 18.688888888888886, "ram_util_percent": 65.58888888888887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.8978759765625, "policy_loss": -834600.93125, "vf_loss": 15479025.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2608.0, "diff_num_grad_updates_vs_sampler_policy": 2607.0}}, "num_env_steps_sampled": 51609600, "num_env_steps_trained": 51609600, "num_agent_steps_sampled": 51609600, "num_agent_steps_trained": 51609600}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3071.1981309150033, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7335251644357985, "mean_inference_ms": 0.37848062202600674, "mean_action_processing_ms": 0.09203813402119501, "mean_env_wait_ms": 0.9034906168190563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486221313476562, "StateBufferConnector_ms": 0.0028421878814697266, "ViewRequirementAgentConnector_ms": 0.06676244735717773}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3071.1981309150033, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3093.35302310767, -3070.0507025934876, -3047.3718027085088, -3045.219950458175, -3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7335251644357985, "mean_inference_ms": 0.37848062202600674, "mean_action_processing_ms": 0.09203813402119501, "mean_env_wait_ms": 0.9034906168190563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486221313476562, "StateBufferConnector_ms": 0.0028421878814697266, "ViewRequirementAgentConnector_ms": 0.06676244735717773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51609600, "num_agent_steps_trained": 51609600, "num_env_steps_sampled": 51609600, "num_env_steps_trained": 51609600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.7407373959909, "num_env_steps_trained_throughput_per_sec": 108.7407373959909, "timesteps_total": 51609600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51609600, "timers": {"training_iteration_time_ms": 3291.625, "sample_time_ms": 3280.885, "load_time_ms": 0.303, "load_throughput": 1189030.191, "learn_time_ms": 9.668, "learn_throughput": 37236.547, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51609600, "num_env_steps_trained": 51609600, "num_agent_steps_sampled": 51609600, "num_agent_steps_trained": 51609600}, "done": false, "episodes_total": 12817, "training_iteration": 3987, "trial_id": "ef964_00000", "date": "2023-08-08_14-08-57", "timestamp": 1691492937, "time_this_iter_s": 13.245383977890015, "time_total_s": 94744.50788402557, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1722.8284335136414, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 19.189473684210526, "ram_util_percent": 65.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.087255859375, "policy_loss": -4879967.89375, "vf_loss": 15118342.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2628.0, "diff_num_grad_updates_vs_sampler_policy": 2627.0}}, "num_env_steps_sampled": 51611040, "num_env_steps_trained": 51611040, "num_agent_steps_sampled": 51611040, "num_agent_steps_trained": 51611040}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3070.5689310594194, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733640920358069, "mean_inference_ms": 0.37847382816695274, "mean_action_processing_ms": 0.09203832429185241, "mean_env_wait_ms": 0.903324858915123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542184829711914, "StateBufferConnector_ms": 0.0028333663940429688, "ViewRequirementAgentConnector_ms": 0.06670522689819336}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3164.9138266515374, "episode_reward_mean": -3070.5689310594194, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3046.1699798726477, -3073.78678121825, -3023.639636239846, -3091.653739669405, -3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733640920358069, "mean_inference_ms": 0.37847382816695274, "mean_action_processing_ms": 0.09203832429185241, "mean_env_wait_ms": 0.903324858915123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542184829711914, "StateBufferConnector_ms": 0.0028333663940429688, "ViewRequirementAgentConnector_ms": 0.06670522689819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51611040, "num_agent_steps_trained": 51611040, "num_env_steps_sampled": 51611040, "num_env_steps_trained": 51611040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.58919998938524, "num_env_steps_trained_throughput_per_sec": 108.58919998938524, "timesteps_total": 51611040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51611040, "timers": {"training_iteration_time_ms": 3317.487, "sample_time_ms": 3306.659, "load_time_ms": 0.303, "load_throughput": 1189123.831, "learn_time_ms": 9.747, "learn_throughput": 36934.334, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 51611040, "num_env_steps_trained": 51611040, "num_agent_steps_sampled": 51611040, "num_agent_steps_trained": 51611040}, "done": false, "episodes_total": 12821, "training_iteration": 3988, "trial_id": "ef964_00000", "date": "2023-08-08_14-09-10", "timestamp": 1691492950, "time_this_iter_s": 13.2637197971344, "time_total_s": 94757.77160382271, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1736.0921533107758, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 18.41578947368421, "ram_util_percent": 65.66315789473683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -377.40362548828125, "policy_loss": -1968880.953125, "vf_loss": 15228138.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2648.0, "diff_num_grad_updates_vs_sampler_policy": 2647.0}}, "num_env_steps_sampled": 51612480, "num_env_steps_trained": 51612480, "num_agent_steps_sampled": 51612480, "num_agent_steps_trained": 51612480}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3071.7694559084907, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733757884604374, "mean_inference_ms": 0.3784666002881337, "mean_action_processing_ms": 0.09203830462045051, "mean_env_wait_ms": 0.9031672873606807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.06667089462280273}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3071.7694559084907, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3075.077213469452, -3068.2151082642495, -3045.291565566761, -3027.3483199354832, -3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733757884604374, "mean_inference_ms": 0.3784666002881337, "mean_action_processing_ms": 0.09203830462045051, "mean_env_wait_ms": 0.9031672873606807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.06667089462280273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51612480, "num_agent_steps_trained": 51612480, "num_env_steps_sampled": 51612480, "num_env_steps_trained": 51612480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.14970167791299, "num_env_steps_trained_throughput_per_sec": 109.14970167791299, "timesteps_total": 51612480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51612480, "timers": {"training_iteration_time_ms": 3309.142, "sample_time_ms": 3298.251, "load_time_ms": 0.312, "load_throughput": 1155544.073, "learn_time_ms": 9.812, "learn_throughput": 36690.669, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 51612480, "num_env_steps_trained": 51612480, "num_agent_steps_sampled": 51612480, "num_agent_steps_trained": 51612480}, "done": false, "episodes_total": 12825, "training_iteration": 3989, "trial_id": "ef964_00000", "date": "2023-08-08_14-09-24", "timestamp": 1691492964, "time_this_iter_s": 13.195749998092651, "time_total_s": 94770.9673538208, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1749.2879033088684, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 19.38421052631579, "ram_util_percent": 65.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.9893310546875, "policy_loss": -6131124.2375, "vf_loss": 15759738.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2668.0, "diff_num_grad_updates_vs_sampler_policy": 2667.0}}, "num_env_steps_sampled": 51613920, "num_env_steps_trained": 51613920, "num_agent_steps_sampled": 51613920, "num_agent_steps_trained": 51613920}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.9733950537084, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733860312648065, "mean_inference_ms": 0.37845975977579954, "mean_action_processing_ms": 0.09203833432690155, "mean_env_wait_ms": 0.9030181529812754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550291061401367, "StateBufferConnector_ms": 0.0028231143951416016, "ViewRequirementAgentConnector_ms": 0.06666278839111328}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.9733950537084, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3120.8060565911615, -3144.8263831094105, -3069.8473100878073, -3046.7041392816027, -3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733860312648065, "mean_inference_ms": 0.37845975977579954, "mean_action_processing_ms": 0.09203833432690155, "mean_env_wait_ms": 0.9030181529812754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550291061401367, "StateBufferConnector_ms": 0.0028231143951416016, "ViewRequirementAgentConnector_ms": 0.06666278839111328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51613920, "num_agent_steps_trained": 51613920, "num_env_steps_sampled": 51613920, "num_env_steps_trained": 51613920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.12180348680408, "num_env_steps_trained_throughput_per_sec": 109.12180348680408, "timesteps_total": 51613920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51613920, "timers": {"training_iteration_time_ms": 3302.793, "sample_time_ms": 3291.815, "load_time_ms": 0.312, "load_throughput": 1152545.18, "learn_time_ms": 9.899, "learn_throughput": 36368.112, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51613920, "num_env_steps_trained": 51613920, "num_agent_steps_sampled": 51613920, "num_agent_steps_trained": 51613920}, "done": false, "episodes_total": 12829, "training_iteration": 3990, "trial_id": "ef964_00000", "date": "2023-08-08_14-09-37", "timestamp": 1691492977, "time_this_iter_s": 13.199023008346558, "time_total_s": 94784.16637682915, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1762.486926317215, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 20.37777777777778, "ram_util_percent": 65.6388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.5180236816406, "policy_loss": -3746490.390625, "vf_loss": 15778837.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2688.0, "diff_num_grad_updates_vs_sampler_policy": 2687.0}}, "num_env_steps_sampled": 51615360, "num_env_steps_trained": 51615360, "num_agent_steps_sampled": 51615360, "num_agent_steps_trained": 51615360}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3071.293485277228, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733997862864133, "mean_inference_ms": 0.3784529062334318, "mean_action_processing_ms": 0.09203843775791222, "mean_env_wait_ms": 0.9028646605330201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548145294189453, "StateBufferConnector_ms": 0.0028121471405029297, "ViewRequirementAgentConnector_ms": 0.0666811466217041}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3071.293485277228, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3025.626314851977, -3070.5343290257306, -3050.5624702081523, -3047.689537400112, -3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733997862864133, "mean_inference_ms": 0.3784529062334318, "mean_action_processing_ms": 0.09203843775791222, "mean_env_wait_ms": 0.9028646605330201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548145294189453, "StateBufferConnector_ms": 0.0028121471405029297, "ViewRequirementAgentConnector_ms": 0.0666811466217041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51615360, "num_agent_steps_trained": 51615360, "num_env_steps_sampled": 51615360, "num_env_steps_trained": 51615360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.66754252520123, "num_env_steps_trained_throughput_per_sec": 108.66754252520123, "timesteps_total": 51615360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51615360, "timers": {"training_iteration_time_ms": 3308.072, "sample_time_ms": 3297.213, "load_time_ms": 0.319, "load_throughput": 1129694.329, "learn_time_ms": 9.779, "learn_throughput": 36812.951, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 51615360, "num_env_steps_trained": 51615360, "num_agent_steps_sampled": 51615360, "num_agent_steps_trained": 51615360}, "done": false, "episodes_total": 12833, "training_iteration": 3991, "trial_id": "ef964_00000", "date": "2023-08-08_14-09-50", "timestamp": 1691492990, "time_this_iter_s": 13.254169702529907, "time_total_s": 94797.42054653168, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1775.7410960197449, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 19.71052631578947, "ram_util_percent": 65.94736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -360.7767272949219, "policy_loss": -11668098.15625, "vf_loss": 15806987.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2708.0, "diff_num_grad_updates_vs_sampler_policy": 2707.0}}, "num_env_steps_sampled": 51616800, "num_env_steps_trained": 51616800, "num_agent_steps_sampled": 51616800, "num_agent_steps_trained": 51616800}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.1971310188264, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734156416620979, "mean_inference_ms": 0.37844585035059763, "mean_action_processing_ms": 0.09203867409076634, "mean_env_wait_ms": 0.9027161950408256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035178661346435547, "StateBufferConnector_ms": 0.002824068069458008, "ViewRequirementAgentConnector_ms": 0.06677961349487305}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.1971310188264, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3094.494494431311, -3048.4697160116107, -3117.3776963143173, -3048.9294863839164, -3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734156416620979, "mean_inference_ms": 0.37844585035059763, "mean_action_processing_ms": 0.09203867409076634, "mean_env_wait_ms": 0.9027161950408256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035178661346435547, "StateBufferConnector_ms": 0.002824068069458008, "ViewRequirementAgentConnector_ms": 0.06677961349487305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51616800, "num_agent_steps_trained": 51616800, "num_env_steps_sampled": 51616800, "num_env_steps_trained": 51616800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.69722766356448, "num_env_steps_trained_throughput_per_sec": 108.69722766356448, "timesteps_total": 51616800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51616800, "timers": {"training_iteration_time_ms": 3303.855, "sample_time_ms": 3293.075, "load_time_ms": 0.308, "load_throughput": 1167787.657, "learn_time_ms": 9.722, "learn_throughput": 37030.075, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 51616800, "num_env_steps_trained": 51616800, "num_agent_steps_sampled": 51616800, "num_agent_steps_trained": 51616800}, "done": false, "episodes_total": 12837, "training_iteration": 3992, "trial_id": "ef964_00000", "date": "2023-08-08_14-10-03", "timestamp": 1691493003, "time_this_iter_s": 13.25032091140747, "time_total_s": 94810.67086744308, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1788.9914169311523, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 19.03157894736842, "ram_util_percent": 65.99473684210524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.8273681640625, "policy_loss": -6640422.88125, "vf_loss": 16172348.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2728.0, "diff_num_grad_updates_vs_sampler_policy": 2727.0}}, "num_env_steps_sampled": 51618240, "num_env_steps_trained": 51618240, "num_agent_steps_sampled": 51618240, "num_agent_steps_trained": 51618240}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.4337335442674, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7343220434133935, "mean_inference_ms": 0.37843730734829484, "mean_action_processing_ms": 0.09203859341685326, "mean_env_wait_ms": 0.9025739457327684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.002812623977661133, "ViewRequirementAgentConnector_ms": 0.06670284271240234}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.4337335442674, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3097.08347667853, -3052.923207644528, -3070.0573298969634, -3070.2045332152716, -3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7343220434133935, "mean_inference_ms": 0.37843730734829484, "mean_action_processing_ms": 0.09203859341685326, "mean_env_wait_ms": 0.9025739457327684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.002812623977661133, "ViewRequirementAgentConnector_ms": 0.06670284271240234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51618240, "num_agent_steps_trained": 51618240, "num_env_steps_sampled": 51618240, "num_env_steps_trained": 51618240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.87508888984269, "num_env_steps_trained_throughput_per_sec": 108.87508888984269, "timesteps_total": 51618240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51618240, "timers": {"training_iteration_time_ms": 3310.231, "sample_time_ms": 3299.483, "load_time_ms": 0.304, "load_throughput": 1183160.508, "learn_time_ms": 9.69, "learn_throughput": 37150.52, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 51618240, "num_env_steps_trained": 51618240, "num_agent_steps_sampled": 51618240, "num_agent_steps_trained": 51618240}, "done": false, "episodes_total": 12841, "training_iteration": 3993, "trial_id": "ef964_00000", "date": "2023-08-08_14-10-17", "timestamp": 1691493017, "time_this_iter_s": 13.228981018066406, "time_total_s": 94823.89984846115, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1802.2203979492188, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 18.731578947368416, "ram_util_percent": 65.86315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.67084350585935, "policy_loss": -2803402.16875, "vf_loss": 15832895.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2748.0, "diff_num_grad_updates_vs_sampler_policy": 2747.0}}, "num_env_steps_sampled": 51619680, "num_env_steps_trained": 51619680, "num_agent_steps_sampled": 51619680, "num_agent_steps_trained": 51619680}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3073.0545797302993, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734491950659506, "mean_inference_ms": 0.37842879098342386, "mean_action_processing_ms": 0.0920385161207415, "mean_env_wait_ms": 0.9024403681663604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506898880004883, "StateBufferConnector_ms": 0.002820253372192383, "ViewRequirementAgentConnector_ms": 0.06667923927307129}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3073.0545797302993, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.8730606392737, -3119.4655118445066, -3095.7757809499485, -3048.259696584031, -3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734491950659506, "mean_inference_ms": 0.37842879098342386, "mean_action_processing_ms": 0.0920385161207415, "mean_env_wait_ms": 0.9024403681663604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506898880004883, "StateBufferConnector_ms": 0.002820253372192383, "ViewRequirementAgentConnector_ms": 0.06667923927307129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51619680, "num_agent_steps_trained": 51619680, "num_env_steps_sampled": 51619680, "num_env_steps_trained": 51619680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.9894978245401, "num_env_steps_trained_throughput_per_sec": 108.9894978245401, "timesteps_total": 51619680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51619680, "timers": {"training_iteration_time_ms": 3307.262, "sample_time_ms": 3296.475, "load_time_ms": 0.301, "load_throughput": 1194391.267, "learn_time_ms": 9.73, "learn_throughput": 37000.312, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 51619680, "num_env_steps_trained": 51619680, "num_agent_steps_sampled": 51619680, "num_agent_steps_trained": 51619680}, "done": false, "episodes_total": 12845, "training_iteration": 3994, "trial_id": "ef964_00000", "date": "2023-08-08_14-10-30", "timestamp": 1691493030, "time_this_iter_s": 13.215116024017334, "time_total_s": 94837.11496448517, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1815.435513973236, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 19.799999999999997, "ram_util_percent": 65.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.3879699707031, "policy_loss": -9167549.5609375, "vf_loss": 16415732.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2768.0, "diff_num_grad_updates_vs_sampler_policy": 2767.0}}, "num_env_steps_sampled": 51621120, "num_env_steps_trained": 51621120, "num_agent_steps_sampled": 51621120, "num_agent_steps_trained": 51621120}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3073.49764570755, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734660549966807, "mean_inference_ms": 0.3784201684870002, "mean_action_processing_ms": 0.09203838710421824, "mean_env_wait_ms": 0.9023144783861526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035119056701660156, "StateBufferConnector_ms": 0.0028171539306640625, "ViewRequirementAgentConnector_ms": 0.06673026084899902}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3073.49764570755, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.787174815617, -3145.0608498134884, -3073.244501819345, -3095.4920785573086, -3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734660549966807, "mean_inference_ms": 0.3784201684870002, "mean_action_processing_ms": 0.09203838710421824, "mean_env_wait_ms": 0.9023144783861526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035119056701660156, "StateBufferConnector_ms": 0.0028171539306640625, "ViewRequirementAgentConnector_ms": 0.06673026084899902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51621120, "num_agent_steps_trained": 51621120, "num_env_steps_sampled": 51621120, "num_env_steps_trained": 51621120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.74731590844112, "num_env_steps_trained_throughput_per_sec": 108.74731590844112, "timesteps_total": 51621120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51621120, "timers": {"training_iteration_time_ms": 3309.138, "sample_time_ms": 3298.297, "load_time_ms": 0.303, "load_throughput": 1186787.267, "learn_time_ms": 9.771, "learn_throughput": 36843.671, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51621120, "num_env_steps_trained": 51621120, "num_agent_steps_sampled": 51621120, "num_agent_steps_trained": 51621120}, "done": false, "episodes_total": 12849, "training_iteration": 3995, "trial_id": "ef964_00000", "date": "2023-08-08_14-10-43", "timestamp": 1691493043, "time_this_iter_s": 13.24449372291565, "time_total_s": 94850.35945820808, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1828.6800076961517, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 16.58421052631579, "ram_util_percent": 65.77368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.05796508789064, "policy_loss": 322568.7125, "vf_loss": 15149279.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2788.0, "diff_num_grad_updates_vs_sampler_policy": 2787.0}}, "num_env_steps_sampled": 51622560, "num_env_steps_trained": 51622560, "num_agent_steps_sampled": 51622560, "num_agent_steps_trained": 51622560}, "sampler_results": {"episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.251860634607, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734823270001145, "mean_inference_ms": 0.3784115088468694, "mean_action_processing_ms": 0.09203835158022765, "mean_env_wait_ms": 0.9021796076551061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035178661346435547, "StateBufferConnector_ms": 0.0028231143951416016, "ViewRequirementAgentConnector_ms": 0.06680870056152344}}, "episode_reward_max": -3000.0715550532345, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.251860634607, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3115.623682237666, -3121.161655402094, -3000.0715550532345, -3007.0743917483937, -3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734823270001145, "mean_inference_ms": 0.3784115088468694, "mean_action_processing_ms": 0.09203835158022765, "mean_env_wait_ms": 0.9021796076551061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035178661346435547, "StateBufferConnector_ms": 0.0028231143951416016, "ViewRequirementAgentConnector_ms": 0.06680870056152344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51622560, "num_agent_steps_trained": 51622560, "num_env_steps_sampled": 51622560, "num_env_steps_trained": 51622560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.30901413487081, "num_env_steps_trained_throughput_per_sec": 109.30901413487081, "timesteps_total": 51622560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51622560, "timers": {"training_iteration_time_ms": 3300.706, "sample_time_ms": 3289.887, "load_time_ms": 0.304, "load_throughput": 1185389.732, "learn_time_ms": 9.763, "learn_throughput": 36873.993, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 51622560, "num_env_steps_trained": 51622560, "num_agent_steps_sampled": 51622560, "num_agent_steps_trained": 51622560}, "done": false, "episodes_total": 12853, "training_iteration": 3996, "trial_id": "ef964_00000", "date": "2023-08-08_14-10-56", "timestamp": 1691493056, "time_this_iter_s": 13.17652702331543, "time_total_s": 94863.5359852314, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1841.8565347194672, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 19.278947368421054, "ram_util_percent": 65.61578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -366.1650756835937, "policy_loss": -4324592.546875, "vf_loss": 15870205.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2808.0, "diff_num_grad_updates_vs_sampler_policy": 2807.0}}, "num_env_steps_sampled": 51624000, "num_env_steps_trained": 51624000, "num_agent_steps_sampled": 51624000, "num_agent_steps_trained": 51624000}, "sampler_results": {"episode_reward_max": -3022.0247763306515, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.833679638055, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735015247609876, "mean_inference_ms": 0.37840307349941893, "mean_action_processing_ms": 0.09203834441709889, "mean_env_wait_ms": 0.9020462396750172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035207271575927734, "StateBufferConnector_ms": 0.0028145313262939453, "ViewRequirementAgentConnector_ms": 0.06671738624572754}}, "episode_reward_max": -3022.0247763306515, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.833679638055, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3140.4624318741303, -3091.5288300316893, -3096.9328955133374, -3046.172252333075, -3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735015247609876, "mean_inference_ms": 0.37840307349941893, "mean_action_processing_ms": 0.09203834441709889, "mean_env_wait_ms": 0.9020462396750172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035207271575927734, "StateBufferConnector_ms": 0.0028145313262939453, "ViewRequirementAgentConnector_ms": 0.06671738624572754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51624000, "num_agent_steps_trained": 51624000, "num_env_steps_sampled": 51624000, "num_env_steps_trained": 51624000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.35305643260983, "num_env_steps_trained_throughput_per_sec": 108.35305643260983, "timesteps_total": 51624000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51624000, "timers": {"training_iteration_time_ms": 3311.272, "sample_time_ms": 3300.576, "load_time_ms": 0.303, "load_throughput": 1186973.854, "learn_time_ms": 9.641, "learn_throughput": 37341.434, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 51624000, "num_env_steps_trained": 51624000, "num_agent_steps_sampled": 51624000, "num_agent_steps_trained": 51624000}, "done": false, "episodes_total": 12857, "training_iteration": 3997, "trial_id": "ef964_00000", "date": "2023-08-08_14-11-10", "timestamp": 1691493070, "time_this_iter_s": 13.29275894165039, "time_total_s": 94876.82874417305, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1855.1492936611176, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 17.84736842105263, "ram_util_percent": 65.52105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -366.3238464355469, "policy_loss": -12903056.675, "vf_loss": 16316472.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2828.0, "diff_num_grad_updates_vs_sampler_policy": 2827.0}}, "num_env_steps_sampled": 51625440, "num_env_steps_trained": 51625440, "num_agent_steps_sampled": 51625440, "num_agent_steps_trained": 51625440}, "sampler_results": {"episode_reward_max": -3022.0247763306515, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.4580027788534, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735210887434963, "mean_inference_ms": 0.3783968176878308, "mean_action_processing_ms": 0.09203871339690588, "mean_env_wait_ms": 0.9019201109087405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035386085510253906, "StateBufferConnector_ms": 0.0028154850006103516, "ViewRequirementAgentConnector_ms": 0.06675291061401367}}, "episode_reward_max": -3022.0247763306515, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.4580027788534, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3122.216404857602, -3050.44266810763, -3093.4372789017452, -3090.5803512489324, -3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735210887434963, "mean_inference_ms": 0.3783968176878308, "mean_action_processing_ms": 0.09203871339690588, "mean_env_wait_ms": 0.9019201109087405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035386085510253906, "StateBufferConnector_ms": 0.0028154850006103516, "ViewRequirementAgentConnector_ms": 0.06675291061401367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51625440, "num_agent_steps_trained": 51625440, "num_env_steps_sampled": 51625440, "num_env_steps_trained": 51625440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.59173025428791, "num_env_steps_trained_throughput_per_sec": 108.59173025428791, "timesteps_total": 51625440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51625440, "timers": {"training_iteration_time_ms": 3317.295, "sample_time_ms": 3306.656, "load_time_ms": 0.304, "load_throughput": 1186134.674, "learn_time_ms": 9.582, "learn_throughput": 37569.623, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 51625440, "num_env_steps_trained": 51625440, "num_agent_steps_sampled": 51625440, "num_agent_steps_trained": 51625440}, "done": false, "episodes_total": 12861, "training_iteration": 3998, "trial_id": "ef964_00000", "date": "2023-08-08_14-11-23", "timestamp": 1691493083, "time_this_iter_s": 13.26347017288208, "time_total_s": 94890.09221434593, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1868.4127638339996, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 19.37368421052632, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.7131286621094, "policy_loss": -4992217.9, "vf_loss": 15510445.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2848.0, "diff_num_grad_updates_vs_sampler_policy": 2847.0}}, "num_env_steps_sampled": 51626880, "num_env_steps_trained": 51626880, "num_agent_steps_sampled": 51626880, "num_agent_steps_trained": 51626880}, "sampler_results": {"episode_reward_max": -3022.0247763306515, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3071.0418032716643, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735393613154044, "mean_inference_ms": 0.37838994221888456, "mean_action_processing_ms": 0.0920390398226866, "mean_env_wait_ms": 0.901791174254909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003526926040649414, "StateBufferConnector_ms": 0.002809286117553711, "ViewRequirementAgentConnector_ms": 0.06662988662719727}}, "episode_reward_max": -3022.0247763306515, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3071.0418032716643, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.647304568154, -3117.824482107492, -3096.612245175457, -3070.6737038873543, -3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735393613154044, "mean_inference_ms": 0.37838994221888456, "mean_action_processing_ms": 0.0920390398226866, "mean_env_wait_ms": 0.901791174254909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003526926040649414, "StateBufferConnector_ms": 0.002809286117553711, "ViewRequirementAgentConnector_ms": 0.06662988662719727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51626880, "num_agent_steps_trained": 51626880, "num_env_steps_sampled": 51626880, "num_env_steps_trained": 51626880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.34067789362686, "num_env_steps_trained_throughput_per_sec": 109.34067789362686, "timesteps_total": 51626880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51626880, "timers": {"training_iteration_time_ms": 3305.868, "sample_time_ms": 3295.191, "load_time_ms": 0.302, "load_throughput": 1190154.836, "learn_time_ms": 9.618, "learn_throughput": 37429.092, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 51626880, "num_env_steps_trained": 51626880, "num_agent_steps_sampled": 51626880, "num_agent_steps_trained": 51626880}, "done": false, "episodes_total": 12865, "training_iteration": 3999, "trial_id": "ef964_00000", "date": "2023-08-08_14-11-36", "timestamp": 1691493096, "time_this_iter_s": 13.172695875167847, "time_total_s": 94903.2649102211, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1881.5854597091675, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 19.366666666666667, "ram_util_percent": 65.72777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.72015380859375, "policy_loss": -4632421.3, "vf_loss": 15184601.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2868.0, "diff_num_grad_updates_vs_sampler_policy": 2867.0}}, "num_env_steps_sampled": 51628320, "num_env_steps_trained": 51628320, "num_agent_steps_sampled": 51628320, "num_agent_steps_trained": 51628320}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3069.850715326089, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735575949737458, "mean_inference_ms": 0.37838212858514725, "mean_action_processing_ms": 0.09203917519604747, "mean_env_wait_ms": 0.9016480533123682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003525972366333008, "StateBufferConnector_ms": 0.0028035640716552734, "ViewRequirementAgentConnector_ms": 0.06655097007751465}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3069.850715326089, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3118.7999548264997, -3072.3982639322194, -3048.4395295492245, -3070.6012813476286, -3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735575949737458, "mean_inference_ms": 0.37838212858514725, "mean_action_processing_ms": 0.09203917519604747, "mean_env_wait_ms": 0.9016480533123682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003525972366333008, "StateBufferConnector_ms": 0.0028035640716552734, "ViewRequirementAgentConnector_ms": 0.06655097007751465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51628320, "num_agent_steps_trained": 51628320, "num_env_steps_sampled": 51628320, "num_env_steps_trained": 51628320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.32401755324656, "num_env_steps_trained_throughput_per_sec": 109.32401755324656, "timesteps_total": 51628320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51628320, "timers": {"training_iteration_time_ms": 3292.436, "sample_time_ms": 3281.734, "load_time_ms": 0.3, "load_throughput": 1198182.384, "learn_time_ms": 9.639, "learn_throughput": 37347.53, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 51628320, "num_env_steps_trained": 51628320, "num_agent_steps_sampled": 51628320, "num_agent_steps_trained": 51628320}, "done": false, "episodes_total": 12869, "training_iteration": 4000, "trial_id": "ef964_00000", "date": "2023-08-08_14-11-49", "timestamp": 1691493109, "time_this_iter_s": 13.174646139144897, "time_total_s": 94916.43955636024, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1894.7601058483124, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 19.40526315789474, "ram_util_percent": 65.95263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.7179809570313, "policy_loss": -6834244.44375, "vf_loss": 15707515.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2888.0, "diff_num_grad_updates_vs_sampler_policy": 2887.0}}, "num_env_steps_sampled": 51629760, "num_env_steps_trained": 51629760, "num_agent_steps_sampled": 51629760, "num_agent_steps_trained": 51629760}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3069.362291412938, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735746126948702, "mean_inference_ms": 0.37837428101706094, "mean_action_processing_ms": 0.09203929616698794, "mean_env_wait_ms": 0.9015052378681692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035300254821777344, "StateBufferConnector_ms": 0.002805948257446289, "ViewRequirementAgentConnector_ms": 0.06665635108947754}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3069.362291412938, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.9865166733325, -3047.794084521141, -3069.1528881225254, -3047.278456182602, -3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735746126948702, "mean_inference_ms": 0.37837428101706094, "mean_action_processing_ms": 0.09203929616698794, "mean_env_wait_ms": 0.9015052378681692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035300254821777344, "StateBufferConnector_ms": 0.002805948257446289, "ViewRequirementAgentConnector_ms": 0.06665635108947754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51629760, "num_agent_steps_trained": 51629760, "num_env_steps_sampled": 51629760, "num_env_steps_trained": 51629760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.00532057625173, "num_env_steps_trained_throughput_per_sec": 109.00532057625173, "timesteps_total": 51629760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51629760, "timers": {"training_iteration_time_ms": 3296.425, "sample_time_ms": 3285.715, "load_time_ms": 0.301, "load_throughput": 1194958.405, "learn_time_ms": 9.645, "learn_throughput": 37325.742, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 51629760, "num_env_steps_trained": 51629760, "num_agent_steps_sampled": 51629760, "num_agent_steps_trained": 51629760}, "done": false, "episodes_total": 12873, "training_iteration": 4001, "trial_id": "ef964_00000", "date": "2023-08-08_14-12-03", "timestamp": 1691493123, "time_this_iter_s": 13.213243961334229, "time_total_s": 94929.65280032158, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1907.9733498096466, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 19.536842105263162, "ram_util_percent": 66.03684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -360.74061279296876, "policy_loss": -11255661.9, "vf_loss": 15766767.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2908.0, "diff_num_grad_updates_vs_sampler_policy": 2907.0}}, "num_env_steps_sampled": 51631200, "num_env_steps_trained": 51631200, "num_agent_steps_sampled": 51631200, "num_agent_steps_trained": 51631200}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3070.1514718490657, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735916226855036, "mean_inference_ms": 0.37836710920939026, "mean_action_processing_ms": 0.09203948012221992, "mean_env_wait_ms": 0.9013700838027667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035316944122314453, "StateBufferConnector_ms": 0.002811431884765625, "ViewRequirementAgentConnector_ms": 0.06664299964904785}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3070.1514718490657, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3096.3710909239344, -3022.340624122613, -3047.654986836007, -3046.4464683837905, -3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735916226855036, "mean_inference_ms": 0.37836710920939026, "mean_action_processing_ms": 0.09203948012221992, "mean_env_wait_ms": 0.9013700838027667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035316944122314453, "StateBufferConnector_ms": 0.002811431884765625, "ViewRequirementAgentConnector_ms": 0.06664299964904785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51631200, "num_agent_steps_trained": 51631200, "num_env_steps_sampled": 51631200, "num_env_steps_trained": 51631200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.58355222311144, "num_env_steps_trained_throughput_per_sec": 108.58355222311144, "timesteps_total": 51631200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51631200, "timers": {"training_iteration_time_ms": 3297.392, "sample_time_ms": 3286.71, "load_time_ms": 0.302, "load_throughput": 1193919.064, "learn_time_ms": 9.616, "learn_throughput": 37439.393, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51631200, "num_env_steps_trained": 51631200, "num_agent_steps_sampled": 51631200, "num_agent_steps_trained": 51631200}, "done": false, "episodes_total": 12877, "training_iteration": 4002, "trial_id": "ef964_00000", "date": "2023-08-08_14-12-16", "timestamp": 1691493136, "time_this_iter_s": 13.264539957046509, "time_total_s": 94942.91734027863, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1921.2378897666931, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 19.147368421052633, "ram_util_percent": 65.9736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.704541015625, "policy_loss": -2442511.828125, "vf_loss": 15529300.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2928.0, "diff_num_grad_updates_vs_sampler_policy": 2927.0}}, "num_env_steps_sampled": 51632640, "num_env_steps_trained": 51632640, "num_agent_steps_sampled": 51632640, "num_agent_steps_trained": 51632640}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.746888520454, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736080869370291, "mean_inference_ms": 0.3783594213123294, "mean_action_processing_ms": 0.09203964700859632, "mean_env_wait_ms": 0.9012539756612372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003525257110595703, "StateBufferConnector_ms": 0.002807140350341797, "ViewRequirementAgentConnector_ms": 0.06658029556274414}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3072.746888520454, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3069.853667844024, -3024.9250400663295, -3047.351134754447, -3093.933667290393, -3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736080869370291, "mean_inference_ms": 0.3783594213123294, "mean_action_processing_ms": 0.09203964700859632, "mean_env_wait_ms": 0.9012539756612372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003525257110595703, "StateBufferConnector_ms": 0.002807140350341797, "ViewRequirementAgentConnector_ms": 0.06658029556274414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51632640, "num_agent_steps_trained": 51632640, "num_env_steps_sampled": 51632640, "num_env_steps_trained": 51632640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.8993207754389, "num_env_steps_trained_throughput_per_sec": 108.8993207754389, "timesteps_total": 51632640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51632640, "timers": {"training_iteration_time_ms": 3305.69, "sample_time_ms": 3294.894, "load_time_ms": 0.31, "load_throughput": 1160071.789, "learn_time_ms": 9.725, "learn_throughput": 37016.367, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51632640, "num_env_steps_trained": 51632640, "num_agent_steps_sampled": 51632640, "num_agent_steps_trained": 51632640}, "done": false, "episodes_total": 12881, "training_iteration": 4003, "trial_id": "ef964_00000", "date": "2023-08-08_14-12-29", "timestamp": 1691493149, "time_this_iter_s": 13.226139068603516, "time_total_s": 94956.14347934723, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1934.4640288352966, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 19.11111111111111, "ram_util_percent": 65.79444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.02797241210936, "policy_loss": -11602486.0625, "vf_loss": 15446138.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2948.0, "diff_num_grad_updates_vs_sampler_policy": 2947.0}}, "num_env_steps_sampled": 51634080, "num_env_steps_trained": 51634080, "num_agent_steps_sampled": 51634080, "num_agent_steps_trained": 51634080}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3074.3643774949633, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7362417905353285, "mean_inference_ms": 0.37835153647666075, "mean_action_processing_ms": 0.09203978367364893, "mean_env_wait_ms": 0.9011488780122753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513813018798828, "StateBufferConnector_ms": 0.0028142929077148438, "ViewRequirementAgentConnector_ms": 0.06660223007202148}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.3992080767675, "episode_reward_mean": -3074.3643774949633, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.4714953189077, -3048.879773711292, -3044.9613292415434, -3069.291909862039, -3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7362417905353285, "mean_inference_ms": 0.37835153647666075, "mean_action_processing_ms": 0.09203978367364893, "mean_env_wait_ms": 0.9011488780122753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513813018798828, "StateBufferConnector_ms": 0.0028142929077148438, "ViewRequirementAgentConnector_ms": 0.06660223007202148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51634080, "num_agent_steps_trained": 51634080, "num_env_steps_sampled": 51634080, "num_env_steps_trained": 51634080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.82362211843552, "num_env_steps_trained_throughput_per_sec": 108.82362211843552, "timesteps_total": 51634080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51634080, "timers": {"training_iteration_time_ms": 3311.421, "sample_time_ms": 3300.641, "load_time_ms": 0.312, "load_throughput": 1152809.162, "learn_time_ms": 9.699, "learn_throughput": 37117.005, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 51634080, "num_env_steps_trained": 51634080, "num_agent_steps_sampled": 51634080, "num_agent_steps_trained": 51634080}, "done": false, "episodes_total": 12885, "training_iteration": 4004, "trial_id": "ef964_00000", "date": "2023-08-08_14-12-42", "timestamp": 1691493162, "time_this_iter_s": 13.23534107208252, "time_total_s": 94969.37882041931, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1947.6993699073792, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 18.71578947368421, "ram_util_percent": 65.74736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.4292236328125, "policy_loss": -15637807.7, "vf_loss": 16444970.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2968.0, "diff_num_grad_updates_vs_sampler_policy": 2967.0}}, "num_env_steps_sampled": 51635520, "num_env_steps_trained": 51635520, "num_agent_steps_sampled": 51635520, "num_agent_steps_trained": 51635520}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.78412235716, "episode_reward_mean": -3076.854617353641, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736388826185389, "mean_inference_ms": 0.3783439872119729, "mean_action_processing_ms": 0.09204001518528994, "mean_env_wait_ms": 0.9010665772025132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035161972045898438, "StateBufferConnector_ms": 0.0028095245361328125, "ViewRequirementAgentConnector_ms": 0.06655001640319824}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.78412235716, "episode_reward_mean": -3076.854617353641, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3053.3741366026607, -3095.105004394516, -3134.0210103367062, -3094.5750204321034, -3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736388826185389, "mean_inference_ms": 0.3783439872119729, "mean_action_processing_ms": 0.09204001518528994, "mean_env_wait_ms": 0.9010665772025132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035161972045898438, "StateBufferConnector_ms": 0.0028095245361328125, "ViewRequirementAgentConnector_ms": 0.06655001640319824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51635520, "num_agent_steps_trained": 51635520, "num_env_steps_sampled": 51635520, "num_env_steps_trained": 51635520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.81682263516146, "num_env_steps_trained_throughput_per_sec": 108.81682263516146, "timesteps_total": 51635520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51635520, "timers": {"training_iteration_time_ms": 3310.269, "sample_time_ms": 3299.417, "load_time_ms": 0.306, "load_throughput": 1177256.697, "learn_time_ms": 9.779, "learn_throughput": 36813.579, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51635520, "num_env_steps_trained": 51635520, "num_agent_steps_sampled": 51635520, "num_agent_steps_trained": 51635520}, "done": false, "episodes_total": 12889, "training_iteration": 4005, "trial_id": "ef964_00000", "date": "2023-08-08_14-12-56", "timestamp": 1691493176, "time_this_iter_s": 13.23631501197815, "time_total_s": 94982.61513543129, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1960.9356849193573, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 19.168421052631583, "ram_util_percent": 65.86315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.4535888671875, "policy_loss": -740779.60625, "vf_loss": 15497037.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2988.0, "diff_num_grad_updates_vs_sampler_policy": 2987.0}}, "num_env_steps_sampled": 51636960, "num_env_steps_trained": 51636960, "num_agent_steps_sampled": 51636960, "num_agent_steps_trained": 51636960}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.78412235716, "episode_reward_mean": -3075.5115522718024, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736532908543057, "mean_inference_ms": 0.378336956073624, "mean_action_processing_ms": 0.09204029209210228, "mean_env_wait_ms": 0.9009762323491163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035140514373779297, "StateBufferConnector_ms": 0.0028035640716552734, "ViewRequirementAgentConnector_ms": 0.06652688980102539}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.78412235716, "episode_reward_mean": -3075.5115522718024, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3164.9138266515374, -3022.8463859264507, -3095.872754086731, -3095.7430729382654, -3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736532908543057, "mean_inference_ms": 0.378336956073624, "mean_action_processing_ms": 0.09204029209210228, "mean_env_wait_ms": 0.9009762323491163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035140514373779297, "StateBufferConnector_ms": 0.0028035640716552734, "ViewRequirementAgentConnector_ms": 0.06652688980102539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51636960, "num_agent_steps_trained": 51636960, "num_env_steps_sampled": 51636960, "num_env_steps_trained": 51636960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.81633054867103, "num_env_steps_trained_throughput_per_sec": 108.81633054867103, "timesteps_total": 51636960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51636960, "timers": {"training_iteration_time_ms": 3306.846, "sample_time_ms": 3296.052, "load_time_ms": 0.304, "load_throughput": 1184274.071, "learn_time_ms": 9.719, "learn_throughput": 37042.248, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51636960, "num_env_steps_trained": 51636960, "num_agent_steps_sampled": 51636960, "num_agent_steps_trained": 51636960}, "done": false, "episodes_total": 12893, "training_iteration": 4006, "trial_id": "ef964_00000", "date": "2023-08-08_14-13-09", "timestamp": 1691493189, "time_this_iter_s": 13.23630690574646, "time_total_s": 94995.85144233704, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1974.1719918251038, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 18.705263157894734, "ram_util_percent": 65.77368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.057763671875, "policy_loss": 319762.65, "vf_loss": 14941404.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3008.0, "diff_num_grad_updates_vs_sampler_policy": 3007.0}}, "num_env_steps_sampled": 51638400, "num_env_steps_trained": 51638400, "num_agent_steps_sampled": 51638400, "num_agent_steps_trained": 51638400}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.78412235716, "episode_reward_mean": -3072.914060383542, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736654536199946, "mean_inference_ms": 0.3783300176514166, "mean_action_processing_ms": 0.09204054692281069, "mean_env_wait_ms": 0.9008678671827094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035212039947509766, "StateBufferConnector_ms": 0.002803325653076172, "ViewRequirementAgentConnector_ms": 0.06662750244140625}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3168.78412235716, "episode_reward_mean": -3072.914060383542, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.027255449834, -3069.4847641891524, -3045.786347839787, -3120.064497647631, -3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736654536199946, "mean_inference_ms": 0.3783300176514166, "mean_action_processing_ms": 0.09204054692281069, "mean_env_wait_ms": 0.9008678671827094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035212039947509766, "StateBufferConnector_ms": 0.002803325653076172, "ViewRequirementAgentConnector_ms": 0.06662750244140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51638400, "num_agent_steps_trained": 51638400, "num_env_steps_sampled": 51638400, "num_env_steps_trained": 51638400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.68899203998542, "num_env_steps_trained_throughput_per_sec": 110.68899203998542, "timesteps_total": 51638400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51638400, "timers": {"training_iteration_time_ms": 3289.661, "sample_time_ms": 3278.899, "load_time_ms": 0.305, "load_throughput": 1181401.643, "learn_time_ms": 9.682, "learn_throughput": 37182.63, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51638400, "num_env_steps_trained": 51638400, "num_agent_steps_sampled": 51638400, "num_agent_steps_trained": 51638400}, "done": false, "episodes_total": 12897, "training_iteration": 4007, "trial_id": "ef964_00000", "date": "2023-08-08_14-13-22", "timestamp": 1691493202, "time_this_iter_s": 13.01231598854065, "time_total_s": 95008.86375832558, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1987.1843078136444, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 19.961111111111112, "ram_util_percent": 65.82777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.8295471191406, "policy_loss": -4904352.89375, "vf_loss": 15649012.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3028.0, "diff_num_grad_updates_vs_sampler_policy": 3027.0}}, "num_env_steps_sampled": 51639840, "num_env_steps_trained": 51639840, "num_agent_steps_sampled": 51639840, "num_agent_steps_trained": 51639840}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3189.7689544108785, "episode_reward_mean": -3073.6724907862426, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736783546733604, "mean_inference_ms": 0.3783232888273929, "mean_action_processing_ms": 0.09204079953821466, "mean_env_wait_ms": 0.900774356315964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518819808959961, "StateBufferConnector_ms": 0.0028066635131835938, "ViewRequirementAgentConnector_ms": 0.06665539741516113}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3189.7689544108785, "episode_reward_mean": -3073.6724907862426, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.236485420217, -3094.686547202791, -3047.0761212795132, -3022.0247763306515, -3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736783546733604, "mean_inference_ms": 0.3783232888273929, "mean_action_processing_ms": 0.09204079953821466, "mean_env_wait_ms": 0.900774356315964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518819808959961, "StateBufferConnector_ms": 0.0028066635131835938, "ViewRequirementAgentConnector_ms": 0.06665539741516113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51639840, "num_agent_steps_trained": 51639840, "num_env_steps_sampled": 51639840, "num_env_steps_trained": 51639840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.39822657363207, "num_env_steps_trained_throughput_per_sec": 109.39822657363207, "timesteps_total": 51639840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51639840, "timers": {"training_iteration_time_ms": 3278.311, "sample_time_ms": 3267.539, "load_time_ms": 0.304, "load_throughput": 1184274.071, "learn_time_ms": 9.695, "learn_throughput": 37130.696, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51639840, "num_env_steps_trained": 51639840, "num_agent_steps_sampled": 51639840, "num_agent_steps_trained": 51639840}, "done": false, "episodes_total": 12901, "training_iteration": 4008, "trial_id": "ef964_00000", "date": "2023-08-08_14-13-35", "timestamp": 1691493215, "time_this_iter_s": 13.16577410697937, "time_total_s": 95022.02953243256, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2000.3500819206238, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 20.236842105263158, "ram_util_percent": 65.86315789473683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.94025268554685, "policy_loss": -405895.95625, "vf_loss": 15025505.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3048.0, "diff_num_grad_updates_vs_sampler_policy": 3047.0}}, "num_env_steps_sampled": 51641280, "num_env_steps_trained": 51641280, "num_agent_steps_sampled": 51641280, "num_agent_steps_trained": 51641280}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3189.7689544108785, "episode_reward_mean": -3075.0911297090493, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736895585873233, "mean_inference_ms": 0.3783169358946293, "mean_action_processing_ms": 0.09204109405250759, "mean_env_wait_ms": 0.9006907594053324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.0027980804443359375, "ViewRequirementAgentConnector_ms": 0.0666048526763916}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3189.7689544108785, "episode_reward_mean": -3075.0911297090493, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3069.481612098613, -3048.263744192815, -3045.8698705058046, -3116.491048853934, -3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736895585873233, "mean_inference_ms": 0.3783169358946293, "mean_action_processing_ms": 0.09204109405250759, "mean_env_wait_ms": 0.9006907594053324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.0027980804443359375, "ViewRequirementAgentConnector_ms": 0.0666048526763916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51641280, "num_agent_steps_trained": 51641280, "num_env_steps_sampled": 51641280, "num_env_steps_trained": 51641280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.94983498234481, "num_env_steps_trained_throughput_per_sec": 109.94983498234481, "timesteps_total": 51641280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51641280, "timers": {"training_iteration_time_ms": 3269.951, "sample_time_ms": 3259.131, "load_time_ms": 0.3, "load_throughput": 1199133.926, "learn_time_ms": 9.749, "learn_throughput": 36927.65, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51641280, "num_env_steps_trained": 51641280, "num_agent_steps_sampled": 51641280, "num_agent_steps_trained": 51641280}, "done": false, "episodes_total": 12905, "training_iteration": 4009, "trial_id": "ef964_00000", "date": "2023-08-08_14-13-48", "timestamp": 1691493228, "time_this_iter_s": 13.099635124206543, "time_total_s": 95035.12916755676, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2013.4497170448303, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 21.894736842105267, "ram_util_percent": 65.95789473684209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -360.6727600097656, "policy_loss": -21006312.2375, "vf_loss": 17328051.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3068.0, "diff_num_grad_updates_vs_sampler_policy": 3067.0}}, "num_env_steps_sampled": 51642720, "num_env_steps_trained": 51642720, "num_agent_steps_sampled": 51642720, "num_agent_steps_trained": 51642720}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3077.4927493821115, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7370387317611815, "mean_inference_ms": 0.3783114863408498, "mean_action_processing_ms": 0.09204154118011115, "mean_env_wait_ms": 0.9006247384168019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515958786010742, "StateBufferConnector_ms": 0.0027971267700195312, "ViewRequirementAgentConnector_ms": 0.06665921211242676}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3077.4927493821115, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.7197618548926, -3047.5942303897023, -3072.1919452171305, -3119.219696065037, -3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7370387317611815, "mean_inference_ms": 0.3783114863408498, "mean_action_processing_ms": 0.09204154118011115, "mean_env_wait_ms": 0.9006247384168019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515958786010742, "StateBufferConnector_ms": 0.0027971267700195312, "ViewRequirementAgentConnector_ms": 0.06665921211242676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51642720, "num_agent_steps_trained": 51642720, "num_env_steps_sampled": 51642720, "num_env_steps_trained": 51642720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.7074184948288, "num_env_steps_trained_throughput_per_sec": 108.7074184948288, "timesteps_total": 51642720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51642720, "timers": {"training_iteration_time_ms": 3293.599, "sample_time_ms": 3282.744, "load_time_ms": 0.303, "load_throughput": 1186414.269, "learn_time_ms": 9.784, "learn_throughput": 36794.561, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 51642720, "num_env_steps_trained": 51642720, "num_agent_steps_sampled": 51642720, "num_agent_steps_trained": 51642720}, "done": false, "episodes_total": 12909, "training_iteration": 4010, "trial_id": "ef964_00000", "date": "2023-08-08_14-14-02", "timestamp": 1691493242, "time_this_iter_s": 13.249361038208008, "time_total_s": 95048.37852859497, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2026.6990780830383, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 19.461111111111116, "ram_util_percent": 65.87777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.0502624511719, "policy_loss": -4539102.49375, "vf_loss": 15174502.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3088.0, "diff_num_grad_updates_vs_sampler_policy": 3087.0}}, "num_env_steps_sampled": 51644160, "num_env_steps_trained": 51644160, "num_agent_steps_sampled": 51644160, "num_agent_steps_trained": 51644160}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3076.917361207312, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737151251567391, "mean_inference_ms": 0.3783063172867628, "mean_action_processing_ms": 0.09204211193238969, "mean_env_wait_ms": 0.9005576923448408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512859344482422, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.06662821769714355}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3076.917361207312, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3092.0162163839914, -3070.8775489897503, -3048.071864845518, -3049.5102895562172, -3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737151251567391, "mean_inference_ms": 0.3783063172867628, "mean_action_processing_ms": 0.09204211193238969, "mean_env_wait_ms": 0.9005576923448408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512859344482422, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.06662821769714355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51644160, "num_agent_steps_trained": 51644160, "num_env_steps_sampled": 51644160, "num_env_steps_trained": 51644160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.68205268045581, "num_env_steps_trained_throughput_per_sec": 109.68205268045581, "timesteps_total": 51644160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51644160, "timers": {"training_iteration_time_ms": 3281.487, "sample_time_ms": 3270.664, "load_time_ms": 0.304, "load_throughput": 1183809.831, "learn_time_ms": 9.75, "learn_throughput": 36923.044, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 51644160, "num_env_steps_trained": 51644160, "num_agent_steps_sampled": 51644160, "num_agent_steps_trained": 51644160}, "done": false, "episodes_total": 12913, "training_iteration": 4011, "trial_id": "ef964_00000", "date": "2023-08-08_14-14-15", "timestamp": 1691493255, "time_this_iter_s": 13.131696939468384, "time_total_s": 95061.51022553444, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2039.8307750225067, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 19.19473684210526, "ram_util_percent": 65.90526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.66099243164064, "policy_loss": -7005248.01875, "vf_loss": 16031002.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3108.0, "diff_num_grad_updates_vs_sampler_policy": 3107.0}}, "num_env_steps_sampled": 51645600, "num_env_steps_trained": 51645600, "num_agent_steps_sampled": 51645600, "num_agent_steps_trained": 51645600}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3076.64070870629, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737241533627435, "mean_inference_ms": 0.37830054807838537, "mean_action_processing_ms": 0.09204255034853194, "mean_env_wait_ms": 0.9004925833231155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035092830657958984, "StateBufferConnector_ms": 0.0027997493743896484, "ViewRequirementAgentConnector_ms": 0.06661176681518555}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3076.64070870629, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.7859437841025, -3097.4907017428204, -3049.4464801213853, -3023.3523676612153, -3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737241533627435, "mean_inference_ms": 0.37830054807838537, "mean_action_processing_ms": 0.09204255034853194, "mean_env_wait_ms": 0.9004925833231155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035092830657958984, "StateBufferConnector_ms": 0.0027997493743896484, "ViewRequirementAgentConnector_ms": 0.06661176681518555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51645600, "num_agent_steps_trained": 51645600, "num_env_steps_sampled": 51645600, "num_env_steps_trained": 51645600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.63225804144598, "num_env_steps_trained_throughput_per_sec": 109.63225804144598, "timesteps_total": 51645600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51645600, "timers": {"training_iteration_time_ms": 3287.506, "sample_time_ms": 3276.679, "load_time_ms": 0.305, "load_throughput": 1179003.233, "learn_time_ms": 9.761, "learn_throughput": 36882.549, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51645600, "num_env_steps_trained": 51645600, "num_agent_steps_sampled": 51645600, "num_agent_steps_trained": 51645600}, "done": false, "episodes_total": 12917, "training_iteration": 4012, "trial_id": "ef964_00000", "date": "2023-08-08_14-14-28", "timestamp": 1691493268, "time_this_iter_s": 13.137607336044312, "time_total_s": 95074.64783287048, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2052.968382358551, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 20.094736842105263, "ram_util_percent": 65.63684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -373.98590698242185, "policy_loss": -250015.2875, "vf_loss": 15259827.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3128.0, "diff_num_grad_updates_vs_sampler_policy": 3127.0}}, "num_env_steps_sampled": 51647040, "num_env_steps_trained": 51647040, "num_agent_steps_sampled": 51647040, "num_agent_steps_trained": 51647040}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3076.8800339865625, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737288093984628, "mean_inference_ms": 0.3782946263770246, "mean_action_processing_ms": 0.09204297273531983, "mean_env_wait_ms": 0.900430337592712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511190414428711, "StateBufferConnector_ms": 0.0028066635131835938, "ViewRequirementAgentConnector_ms": 0.0666816234588623}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3076.8800339865625, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3168.3992080767675, -3022.9804311524817, -3141.3887173263665, -3022.5342653516095, -3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737288093984628, "mean_inference_ms": 0.3782946263770246, "mean_action_processing_ms": 0.09204297273531983, "mean_env_wait_ms": 0.900430337592712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511190414428711, "StateBufferConnector_ms": 0.0028066635131835938, "ViewRequirementAgentConnector_ms": 0.0666816234588623}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51647040, "num_agent_steps_trained": 51647040, "num_env_steps_sampled": 51647040, "num_env_steps_trained": 51647040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.41779745864199, "num_env_steps_trained_throughput_per_sec": 110.41779745864199, "timesteps_total": 51647040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51647040, "timers": {"training_iteration_time_ms": 3272.409, "sample_time_ms": 3261.606, "load_time_ms": 0.303, "load_throughput": 1188188.102, "learn_time_ms": 9.735, "learn_throughput": 36981.01, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51647040, "num_env_steps_trained": 51647040, "num_agent_steps_sampled": 51647040, "num_agent_steps_trained": 51647040}, "done": false, "episodes_total": 12921, "training_iteration": 4013, "trial_id": "ef964_00000", "date": "2023-08-08_14-14-41", "timestamp": 1691493281, "time_this_iter_s": 13.04424500465393, "time_total_s": 95087.69207787514, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2066.012627363205, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 20.51111111111111, "ram_util_percent": 65.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.3023193359375, "policy_loss": -8374442.771875, "vf_loss": 15632092.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3148.0, "diff_num_grad_updates_vs_sampler_policy": 3147.0}}, "num_env_steps_sampled": 51648480, "num_env_steps_trained": 51648480, "num_agent_steps_sampled": 51648480, "num_agent_steps_trained": 51648480}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.8005057430464, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73731777040035, "mean_inference_ms": 0.3782886174744157, "mean_action_processing_ms": 0.09204355883440751, "mean_env_wait_ms": 0.900360118060811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003508329391479492, "StateBufferConnector_ms": 0.0028030872344970703, "ViewRequirementAgentConnector_ms": 0.06660318374633789}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.8005057430464, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3122.1126584671492, -3070.3213403590366, -3072.056506611027, -3071.8356163205635, -3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73731777040035, "mean_inference_ms": 0.3782886174744157, "mean_action_processing_ms": 0.09204355883440751, "mean_env_wait_ms": 0.900360118060811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003508329391479492, "StateBufferConnector_ms": 0.0028030872344970703, "ViewRequirementAgentConnector_ms": 0.06660318374633789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51648480, "num_agent_steps_trained": 51648480, "num_env_steps_sampled": 51648480, "num_env_steps_trained": 51648480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.34420102989664, "num_env_steps_trained_throughput_per_sec": 110.34420102989664, "timesteps_total": 51648480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51648480, "timers": {"training_iteration_time_ms": 3272.141, "sample_time_ms": 3261.305, "load_time_ms": 0.303, "load_throughput": 1189030.191, "learn_time_ms": 9.76, "learn_throughput": 36886.964, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 51648480, "num_env_steps_trained": 51648480, "num_agent_steps_sampled": 51648480, "num_agent_steps_trained": 51648480}, "done": false, "episodes_total": 12925, "training_iteration": 4014, "trial_id": "ef964_00000", "date": "2023-08-08_14-14-54", "timestamp": 1691493294, "time_this_iter_s": 13.052917718887329, "time_total_s": 95100.74499559402, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2079.0655450820923, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 20.205263157894734, "ram_util_percent": 65.62105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.5066711425781, "policy_loss": -14230905.5, "vf_loss": 16016355.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3168.0, "diff_num_grad_updates_vs_sampler_policy": 3167.0}}, "num_env_steps_sampled": 51649920, "num_env_steps_trained": 51649920, "num_agent_steps_sampled": 51649920, "num_agent_steps_trained": 51649920}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.2557281882723, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737353699221039, "mean_inference_ms": 0.3782828752471563, "mean_action_processing_ms": 0.09204418738818745, "mean_env_wait_ms": 0.9002879169534214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.0666053295135498}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.2557281882723, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.4175867714757, -3025.8568407198595, -3046.6246308151067, -3071.2938531154277, -3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737353699221039, "mean_inference_ms": 0.3782828752471563, "mean_action_processing_ms": 0.09204418738818745, "mean_env_wait_ms": 0.9002879169534214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.0666053295135498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51649920, "num_agent_steps_trained": 51649920, "num_env_steps_sampled": 51649920, "num_env_steps_trained": 51649920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.92905215079048, "num_env_steps_trained_throughput_per_sec": 108.92905215079048, "timesteps_total": 51649920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51649920, "timers": {"training_iteration_time_ms": 3279.486, "sample_time_ms": 3268.725, "load_time_ms": 0.303, "load_throughput": 1188842.957, "learn_time_ms": 9.699, "learn_throughput": 37117.826, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51649920, "num_env_steps_trained": 51649920, "num_agent_steps_sampled": 51649920, "num_agent_steps_trained": 51649920}, "done": false, "episodes_total": 12929, "training_iteration": 4015, "trial_id": "ef964_00000", "date": "2023-08-08_14-15-07", "timestamp": 1691493307, "time_this_iter_s": 13.222433090209961, "time_total_s": 95113.96742868423, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2092.2879781723022, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 19.43888888888889, "ram_util_percent": 65.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.1445678710937, "policy_loss": -2290367.35625, "vf_loss": 15471618.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3188.0, "diff_num_grad_updates_vs_sampler_policy": 3187.0}}, "num_env_steps_sampled": 51651360, "num_env_steps_trained": 51651360, "num_agent_steps_sampled": 51651360, "num_agent_steps_trained": 51651360}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3075.679422092267, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7373641837288645, "mean_inference_ms": 0.3782778881643881, "mean_action_processing_ms": 0.09204496822056761, "mean_env_wait_ms": 0.9002278790947064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035049915313720703, "StateBufferConnector_ms": 0.002802610397338867, "ViewRequirementAgentConnector_ms": 0.06652212142944336}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3075.679422092267, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.5577671570372, -3072.0163667312654, -3045.8257975476745, -3118.377294209853, -3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7373641837288645, "mean_inference_ms": 0.3782778881643881, "mean_action_processing_ms": 0.09204496822056761, "mean_env_wait_ms": 0.9002278790947064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035049915313720703, "StateBufferConnector_ms": 0.002802610397338867, "ViewRequirementAgentConnector_ms": 0.06652212142944336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51651360, "num_agent_steps_trained": 51651360, "num_env_steps_sampled": 51651360, "num_env_steps_trained": 51651360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.19105161662765, "num_env_steps_trained_throughput_per_sec": 109.19105161662765, "timesteps_total": 51651360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51651360, "timers": {"training_iteration_time_ms": 3298.504, "sample_time_ms": 3287.797, "load_time_ms": 0.302, "load_throughput": 1191657.675, "learn_time_ms": 9.658, "learn_throughput": 37273.591, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 51651360, "num_env_steps_trained": 51651360, "num_agent_steps_sampled": 51651360, "num_agent_steps_trained": 51651360}, "done": false, "episodes_total": 12933, "training_iteration": 4016, "trial_id": "ef964_00000", "date": "2023-08-08_14-15-21", "timestamp": 1691493321, "time_this_iter_s": 13.19100022315979, "time_total_s": 95127.1584289074, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2105.478978395462, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 20.021052631578947, "ram_util_percent": 65.65263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.4827575683594, "policy_loss": -11133181.596875, "vf_loss": 15353859.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3208.0, "diff_num_grad_updates_vs_sampler_policy": 3207.0}}, "num_env_steps_sampled": 51652800, "num_env_steps_trained": 51652800, "num_agent_steps_sampled": 51652800, "num_agent_steps_trained": 51652800}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.2408657940937, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737308704172641, "mean_inference_ms": 0.37827267606994724, "mean_action_processing_ms": 0.09204565625347647, "mean_env_wait_ms": 0.9001538818290464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035142898559570312, "StateBufferConnector_ms": 0.002796173095703125, "ViewRequirementAgentConnector_ms": 0.06636595726013184}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.2408657940937, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3093.8978630940737, -3045.980737424232, -3048.1500612371005, -3144.90298392988, -3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737308704172641, "mean_inference_ms": 0.37827267606994724, "mean_action_processing_ms": 0.09204565625347647, "mean_env_wait_ms": 0.9001538818290464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035142898559570312, "StateBufferConnector_ms": 0.002796173095703125, "ViewRequirementAgentConnector_ms": 0.06636595726013184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51652800, "num_agent_steps_trained": 51652800, "num_env_steps_sampled": 51652800, "num_env_steps_trained": 51652800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.57344447040389, "num_env_steps_trained_throughput_per_sec": 112.57344447040389, "timesteps_total": 51652800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51652800, "timers": {"training_iteration_time_ms": 3257.847, "sample_time_ms": 3247.086, "load_time_ms": 0.302, "load_throughput": 1191281.609, "learn_time_ms": 9.705, "learn_throughput": 37094.391, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 51652800, "num_env_steps_trained": 51652800, "num_agent_steps_sampled": 51652800, "num_agent_steps_trained": 51652800}, "done": false, "episodes_total": 12937, "training_iteration": 4017, "trial_id": "ef964_00000", "date": "2023-08-08_14-15-33", "timestamp": 1691493333, "time_this_iter_s": 12.794511795043945, "time_total_s": 95139.95294070244, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2118.273490190506, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 25.150000000000002, "ram_util_percent": 65.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.0255187988281, "policy_loss": -19855971.04375, "vf_loss": 16572372.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3228.0, "diff_num_grad_updates_vs_sampler_policy": 3227.0}}, "num_env_steps_sampled": 51654240, "num_env_steps_trained": 51654240, "num_agent_steps_sampled": 51654240, "num_agent_steps_trained": 51654240}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.9670850137086, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737261681453486, "mean_inference_ms": 0.3782683344633573, "mean_action_processing_ms": 0.09204655061155279, "mean_env_wait_ms": 0.9000837890525364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523111343383789, "StateBufferConnector_ms": 0.002803325653076172, "ViewRequirementAgentConnector_ms": 0.06641387939453125}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.9670850137086, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3141.543293259037, -3047.634408012205, -3068.3695620462568, -3094.8059027208883, -3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737261681453486, "mean_inference_ms": 0.3782683344633573, "mean_action_processing_ms": 0.09204655061155279, "mean_env_wait_ms": 0.9000837890525364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523111343383789, "StateBufferConnector_ms": 0.002803325653076172, "ViewRequirementAgentConnector_ms": 0.06641387939453125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51654240, "num_agent_steps_trained": 51654240, "num_env_steps_sampled": 51654240, "num_env_steps_trained": 51654240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.22335381929062, "num_env_steps_trained_throughput_per_sec": 108.22335381929062, "timesteps_total": 51654240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51654240, "timers": {"training_iteration_time_ms": 3265.692, "sample_time_ms": 3254.801, "load_time_ms": 0.303, "load_throughput": 1188562.217, "learn_time_ms": 9.807, "learn_throughput": 36709.133, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 51654240, "num_env_steps_trained": 51654240, "num_agent_steps_sampled": 51654240, "num_agent_steps_trained": 51654240}, "done": false, "episodes_total": 12941, "training_iteration": 4018, "trial_id": "ef964_00000", "date": "2023-08-08_14-15-47", "timestamp": 1691493347, "time_this_iter_s": 13.308677196502686, "time_total_s": 95153.26161789894, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2131.5821673870087, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 19.478947368421053, "ram_util_percent": 65.85263157894735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.05287475585936, "policy_loss": -2798553.50625, "vf_loss": 15502487.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3248.0, "diff_num_grad_updates_vs_sampler_policy": 3247.0}}, "num_env_steps_sampled": 51655680, "num_env_steps_trained": 51655680, "num_agent_steps_sampled": 51655680, "num_agent_steps_trained": 51655680}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.7898327316116, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737201362960094, "mean_inference_ms": 0.37826438921214295, "mean_action_processing_ms": 0.09204750518227868, "mean_env_wait_ms": 0.9000155092279906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.002790689468383789, "ViewRequirementAgentConnector_ms": 0.06640481948852539}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.7898327316116, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.9161911194037, -3065.155422828129, -3072.691424681924, -3144.917609113423, -3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737201362960094, "mean_inference_ms": 0.37826438921214295, "mean_action_processing_ms": 0.09204750518227868, "mean_env_wait_ms": 0.9000155092279906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.002790689468383789, "ViewRequirementAgentConnector_ms": 0.06640481948852539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51655680, "num_agent_steps_trained": 51655680, "num_env_steps_sampled": 51655680, "num_env_steps_trained": 51655680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.53011476293236, "num_env_steps_trained_throughput_per_sec": 109.53011476293236, "timesteps_total": 51655680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51655680, "timers": {"training_iteration_time_ms": 3268.475, "sample_time_ms": 3257.485, "load_time_ms": 0.301, "load_throughput": 1197897.215, "learn_time_ms": 9.913, "learn_throughput": 36315.456, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51655680, "num_env_steps_trained": 51655680, "num_agent_steps_sampled": 51655680, "num_agent_steps_trained": 51655680}, "done": false, "episodes_total": 12945, "training_iteration": 4019, "trial_id": "ef964_00000", "date": "2023-08-08_14-16-00", "timestamp": 1691493360, "time_this_iter_s": 13.149906873703003, "time_total_s": 95166.41152477264, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2144.7320742607117, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 19.18421052631579, "ram_util_percent": 65.93157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.8160400390625, "policy_loss": -4676190.15625, "vf_loss": 15512115.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3268.0, "diff_num_grad_updates_vs_sampler_policy": 3267.0}}, "num_env_steps_sampled": 51657120, "num_env_steps_trained": 51657120, "num_agent_steps_sampled": 51657120, "num_agent_steps_trained": 51657120}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.107428630194, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737120627925074, "mean_inference_ms": 0.378260756663458, "mean_action_processing_ms": 0.09204847217168886, "mean_env_wait_ms": 0.8999395887191527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519296646118164, "StateBufferConnector_ms": 0.002788543701171875, "ViewRequirementAgentConnector_ms": 0.06649041175842285}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.107428630194, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3044.7744390823937, -3070.1761542355334, -3095.64973758928, -3024.4057668042465, -3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737120627925074, "mean_inference_ms": 0.378260756663458, "mean_action_processing_ms": 0.09204847217168886, "mean_env_wait_ms": 0.8999395887191527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519296646118164, "StateBufferConnector_ms": 0.002788543701171875, "ViewRequirementAgentConnector_ms": 0.06649041175842285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51657120, "num_agent_steps_trained": 51657120, "num_env_steps_sampled": 51657120, "num_env_steps_trained": 51657120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.08581020574469, "num_env_steps_trained_throughput_per_sec": 110.08581020574469, "timesteps_total": 51657120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51657120, "timers": {"training_iteration_time_ms": 3293.284, "sample_time_ms": 3282.383, "load_time_ms": 0.304, "load_throughput": 1183160.508, "learn_time_ms": 9.836, "learn_throughput": 36601.995, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 51657120, "num_env_steps_trained": 51657120, "num_agent_steps_sampled": 51657120, "num_agent_steps_trained": 51657120}, "done": false, "episodes_total": 12949, "training_iteration": 4020, "trial_id": "ef964_00000", "date": "2023-08-08_14-16-13", "timestamp": 1691493373, "time_this_iter_s": 13.083486080169678, "time_total_s": 95179.49501085281, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2157.8155603408813, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 19.549999999999997, "ram_util_percent": 65.92222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.219384765625, "policy_loss": -4185003.0875, "vf_loss": 15606365.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3288.0, "diff_num_grad_updates_vs_sampler_policy": 3287.0}}, "num_env_steps_sampled": 51658560, "num_env_steps_trained": 51658560, "num_agent_steps_sampled": 51658560, "num_agent_steps_trained": 51658560}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3073.9309314708553, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737045096277605, "mean_inference_ms": 0.37825784132033297, "mean_action_processing_ms": 0.09204946745225605, "mean_env_wait_ms": 0.8998623645448787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035140514373779297, "StateBufferConnector_ms": 0.0027861595153808594, "ViewRequirementAgentConnector_ms": 0.0665276050567627}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3073.9309314708553, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3046.6283296751267, -3140.782302590784, -3022.941056185212, -3091.7614963350975, -3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737045096277605, "mean_inference_ms": 0.37825784132033297, "mean_action_processing_ms": 0.09204946745225605, "mean_env_wait_ms": 0.8998623645448787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035140514373779297, "StateBufferConnector_ms": 0.0027861595153808594, "ViewRequirementAgentConnector_ms": 0.0665276050567627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51658560, "num_agent_steps_trained": 51658560, "num_env_steps_sampled": 51658560, "num_env_steps_trained": 51658560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.16400831055105, "num_env_steps_trained_throughput_per_sec": 109.16400831055105, "timesteps_total": 51658560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51658560, "timers": {"training_iteration_time_ms": 3288.342, "sample_time_ms": 3277.406, "load_time_ms": 0.304, "load_throughput": 1184459.868, "learn_time_ms": 9.868, "learn_throughput": 36483.136, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 51658560, "num_env_steps_trained": 51658560, "num_agent_steps_sampled": 51658560, "num_agent_steps_trained": 51658560}, "done": false, "episodes_total": 12953, "training_iteration": 4021, "trial_id": "ef964_00000", "date": "2023-08-08_14-16-26", "timestamp": 1691493386, "time_this_iter_s": 13.194386959075928, "time_total_s": 95192.68939781189, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2171.0099472999573, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 19.93157894736842, "ram_util_percent": 65.73684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.1826538085937, "policy_loss": -12187322.4125, "vf_loss": 15537786.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 3307.0}}, "num_env_steps_sampled": 51660000, "num_env_steps_trained": 51660000, "num_agent_steps_sampled": 51660000, "num_agent_steps_trained": 51660000}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.5007297989273, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736952279334335, "mean_inference_ms": 0.37825570923874013, "mean_action_processing_ms": 0.09205052104544065, "mean_env_wait_ms": 0.8997879799474106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035042762756347656, "StateBufferConnector_ms": 0.002784252166748047, "ViewRequirementAgentConnector_ms": 0.06657576560974121}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.5007297989273, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3118.503921653844, -3049.6879019226753, -3050.2077143316824, -3119.1291859238654, -3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736952279334335, "mean_inference_ms": 0.37825570923874013, "mean_action_processing_ms": 0.09205052104544065, "mean_env_wait_ms": 0.8997879799474106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035042762756347656, "StateBufferConnector_ms": 0.002784252166748047, "ViewRequirementAgentConnector_ms": 0.06657576560974121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51660000, "num_agent_steps_trained": 51660000, "num_env_steps_sampled": 51660000, "num_env_steps_trained": 51660000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.93692863688825, "num_env_steps_trained_throughput_per_sec": 108.93692863688825, "timesteps_total": 51660000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51660000, "timers": {"training_iteration_time_ms": 3296.02, "sample_time_ms": 3285.227, "load_time_ms": 0.305, "load_throughput": 1180016.755, "learn_time_ms": 9.722, "learn_throughput": 37027.623, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51660000, "num_env_steps_trained": 51660000, "num_agent_steps_sampled": 51660000, "num_agent_steps_trained": 51660000}, "done": false, "episodes_total": 12957, "training_iteration": 4022, "trial_id": "ef964_00000", "date": "2023-08-08_14-16-39", "timestamp": 1691493399, "time_this_iter_s": 13.221683025360107, "time_total_s": 95205.91108083725, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2184.2316303253174, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 19.83684210526316, "ram_util_percent": 65.71052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.0574890136719, "policy_loss": 319762.71875, "vf_loss": 14941429.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3328.0, "diff_num_grad_updates_vs_sampler_policy": 3327.0}}, "num_env_steps_sampled": 51661440, "num_env_steps_trained": 51661440, "num_agent_steps_sampled": 51661440, "num_agent_steps_trained": 51661440}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3073.0846220802487, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736850093426056, "mean_inference_ms": 0.37825072792890774, "mean_action_processing_ms": 0.09205113887662396, "mean_env_wait_ms": 0.8997000777511042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034856796264648438, "StateBufferConnector_ms": 0.002785205841064453, "ViewRequirementAgentConnector_ms": 0.06655645370483398}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3073.0846220802487, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3073.239208780975, -3049.5051585140864, -3046.4170741808084, -3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736850093426056, "mean_inference_ms": 0.37825072792890774, "mean_action_processing_ms": 0.09205113887662396, "mean_env_wait_ms": 0.8997000777511042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034856796264648438, "StateBufferConnector_ms": 0.002785205841064453, "ViewRequirementAgentConnector_ms": 0.06655645370483398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51661440, "num_agent_steps_trained": 51661440, "num_env_steps_sampled": 51661440, "num_env_steps_trained": 51661440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.84796241938999, "num_env_steps_trained_throughput_per_sec": 109.84796241938999, "timesteps_total": 51661440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51661440, "timers": {"training_iteration_time_ms": 3295.98, "sample_time_ms": 3285.101, "load_time_ms": 0.306, "load_throughput": 1178083.358, "learn_time_ms": 9.8, "learn_throughput": 36734.586, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51661440, "num_env_steps_trained": 51661440, "num_agent_steps_sampled": 51661440, "num_agent_steps_trained": 51661440}, "done": false, "episodes_total": 12961, "training_iteration": 4023, "trial_id": "ef964_00000", "date": "2023-08-08_14-16-53", "timestamp": 1691493413, "time_this_iter_s": 13.111937999725342, "time_total_s": 95219.02301883698, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2197.3435683250427, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 19.866666666666667, "ram_util_percent": 65.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.9943481445313, "policy_loss": -8387080.49375, "vf_loss": 15674873.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3343.0, "diff_num_grad_updates_vs_sampler_policy": 3342.0}}, "num_env_steps_sampled": 51662520, "num_env_steps_trained": 51662520, "num_agent_steps_sampled": 51662520, "num_agent_steps_trained": 51662520}, "sampler_results": {"episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3075.2225893809473, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736781473001296, "mean_inference_ms": 0.3782473087404367, "mean_action_processing_ms": 0.09205159852908412, "mean_env_wait_ms": 0.8996435624719631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034787654876708984, "StateBufferConnector_ms": 0.002784252166748047, "ViewRequirementAgentConnector_ms": 0.06651639938354492}}, "episode_reward_max": -3000.0762277319504, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3075.2225893809473, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.895310921135, -3092.7416374310483, -3072.13356750629, -3000.0762277319504, -3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736781473001296, "mean_inference_ms": 0.3782473087404367, "mean_action_processing_ms": 0.09205159852908412, "mean_env_wait_ms": 0.8996435624719631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034787654876708984, "StateBufferConnector_ms": 0.002784252166748047, "ViewRequirementAgentConnector_ms": 0.06651639938354492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51662520, "num_agent_steps_trained": 51662520, "num_env_steps_sampled": 51662520, "num_env_steps_trained": 51662520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.98367232203802, "num_env_steps_trained_throughput_per_sec": 107.98367232203802, "timesteps_total": 51662520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51662520, "timers": {"training_iteration_time_ms": 3307.056, "sample_time_ms": 3296.206, "load_time_ms": 0.305, "load_throughput": 1181124.406, "learn_time_ms": 9.773, "learn_throughput": 36837.649, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51662520, "num_env_steps_trained": 51662520, "num_agent_steps_sampled": 51662520, "num_agent_steps_trained": 51662520}, "done": false, "episodes_total": 12964, "training_iteration": 4024, "trial_id": "ef964_00000", "date": "2023-08-08_14-17-03", "timestamp": 1691493423, "time_this_iter_s": 10.00432825088501, "time_total_s": 95229.02734708786, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2207.3478965759277, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 20.75, "ram_util_percent": 65.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.01930541992186, "policy_loss": -5862728.4625, "vf_loss": 15467221.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3363.0, "diff_num_grad_updates_vs_sampler_policy": 3362.0}}, "num_env_steps_sampled": 51663960, "num_env_steps_trained": 51663960, "num_agent_steps_sampled": 51663960, "num_agent_steps_trained": 51663960}, "sampler_results": {"episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3075.4574100886384, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736690227918903, "mean_inference_ms": 0.3782428984423316, "mean_action_processing_ms": 0.09205218534775068, "mean_env_wait_ms": 0.899572239851849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500223159790039, "StateBufferConnector_ms": 0.002779245376586914, "ViewRequirementAgentConnector_ms": 0.06649565696716309}}, "episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3075.4574100886384, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.6975085117137, -3048.08597749257, -3069.8099080215834, -3048.2871019864015, -3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736690227918903, "mean_inference_ms": 0.3782428984423316, "mean_action_processing_ms": 0.09205218534775068, "mean_env_wait_ms": 0.899572239851849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500223159790039, "StateBufferConnector_ms": 0.002779245376586914, "ViewRequirementAgentConnector_ms": 0.06649565696716309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51663960, "num_agent_steps_trained": 51663960, "num_env_steps_sampled": 51663960, "num_env_steps_trained": 51663960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.11959346025824, "num_env_steps_trained_throughput_per_sec": 109.11959346025824, "timesteps_total": 51663960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51663960, "timers": {"training_iteration_time_ms": 3301.985, "sample_time_ms": 3291.188, "load_time_ms": 0.305, "load_throughput": 1180108.98, "learn_time_ms": 9.731, "learn_throughput": 36996.233, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51663960, "num_env_steps_trained": 51663960, "num_agent_steps_sampled": 51663960, "num_agent_steps_trained": 51663960}, "done": false, "episodes_total": 12968, "training_iteration": 4025, "trial_id": "ef964_00000", "date": "2023-08-08_14-17-16", "timestamp": 1691493436, "time_this_iter_s": 13.199345111846924, "time_total_s": 95242.2266921997, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2220.5472416877747, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 19.021052631578947, "ram_util_percent": 65.6263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.4801025390625, "policy_loss": -8269596.69375, "vf_loss": 15679950.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3383.0, "diff_num_grad_updates_vs_sampler_policy": 3382.0}}, "num_env_steps_sampled": 51665400, "num_env_steps_trained": 51665400, "num_agent_steps_sampled": 51665400, "num_agent_steps_trained": 51665400}, "sampler_results": {"episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3078.034502861859, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736581563156111, "mean_inference_ms": 0.3782382701596042, "mean_action_processing_ms": 0.09205277857934556, "mean_env_wait_ms": 0.8995133022455823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489255905151367, "StateBufferConnector_ms": 0.002778768539428711, "ViewRequirementAgentConnector_ms": 0.06642961502075195}}, "episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3078.034502861859, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3095.213650839878, -3076.572124880412, -3022.975129494242, -3071.1504452683535, -3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736581563156111, "mean_inference_ms": 0.3782382701596042, "mean_action_processing_ms": 0.09205277857934556, "mean_env_wait_ms": 0.8995133022455823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489255905151367, "StateBufferConnector_ms": 0.002778768539428711, "ViewRequirementAgentConnector_ms": 0.06642961502075195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51665400, "num_agent_steps_trained": 51665400, "num_env_steps_sampled": 51665400, "num_env_steps_trained": 51665400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.38537793433612, "num_env_steps_trained_throughput_per_sec": 109.38537793433612, "timesteps_total": 51665400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51665400, "timers": {"training_iteration_time_ms": 3300.636, "sample_time_ms": 3289.806, "load_time_ms": 0.306, "load_throughput": 1175698.388, "learn_time_ms": 9.765, "learn_throughput": 36865.26, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51665400, "num_env_steps_trained": 51665400, "num_agent_steps_sampled": 51665400, "num_agent_steps_trained": 51665400}, "done": false, "episodes_total": 12972, "training_iteration": 4026, "trial_id": "ef964_00000", "date": "2023-08-08_14-17-29", "timestamp": 1691493449, "time_this_iter_s": 13.167239904403687, "time_total_s": 95255.39393210411, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2233.7144815921783, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 19.96842105263158, "ram_util_percent": 65.76842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -379.3075439453125, "policy_loss": -4581499.85, "vf_loss": 15440263.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3403.0, "diff_num_grad_updates_vs_sampler_policy": 3402.0}}, "num_env_steps_sampled": 51666840, "num_env_steps_trained": 51666840, "num_agent_steps_sampled": 51666840, "num_agent_steps_trained": 51666840}, "sampler_results": {"episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3078.13059058849, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736473589409128, "mean_inference_ms": 0.37823357172741545, "mean_action_processing_ms": 0.09205336433799363, "mean_env_wait_ms": 0.8994524444838775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034894943237304688, "StateBufferConnector_ms": 0.0027837753295898438, "ViewRequirementAgentConnector_ms": 0.06645417213439941}}, "episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3078.13059058849, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3096.4322894693128, -3165.9839426730905, -3119.3566164774024, -3140.21455854342, -3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736473589409128, "mean_inference_ms": 0.37823357172741545, "mean_action_processing_ms": 0.09205336433799363, "mean_env_wait_ms": 0.8994524444838775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034894943237304688, "StateBufferConnector_ms": 0.0027837753295898438, "ViewRequirementAgentConnector_ms": 0.06645417213439941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51666840, "num_agent_steps_trained": 51666840, "num_env_steps_sampled": 51666840, "num_env_steps_trained": 51666840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.72773934265508, "num_env_steps_trained_throughput_per_sec": 108.72773934265508, "timesteps_total": 51666840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51666840, "timers": {"training_iteration_time_ms": 3300.615, "sample_time_ms": 3289.683, "load_time_ms": 0.302, "load_throughput": 1191563.636, "learn_time_ms": 9.872, "learn_throughput": 36468.421, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 51666840, "num_env_steps_trained": 51666840, "num_agent_steps_sampled": 51666840, "num_agent_steps_trained": 51666840}, "done": false, "episodes_total": 12976, "training_iteration": 4027, "trial_id": "ef964_00000", "date": "2023-08-08_14-17-42", "timestamp": 1691493462, "time_this_iter_s": 13.246883153915405, "time_total_s": 95268.64081525803, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2246.9613647460938, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 20.3578947368421, "ram_util_percent": 65.88947368421051}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.057421875, "policy_loss": 319762.73125, "vf_loss": 14941436.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3423.0, "diff_num_grad_updates_vs_sampler_policy": 3422.0}}, "num_env_steps_sampled": 51668280, "num_env_steps_trained": 51668280, "num_agent_steps_sampled": 51668280, "num_agent_steps_trained": 51668280}, "sampler_results": {"episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.144076447602, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736350745675684, "mean_inference_ms": 0.37822968482214864, "mean_action_processing_ms": 0.09205402320563864, "mean_env_wait_ms": 0.899374263724678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034940242767333984, "StateBufferConnector_ms": 0.0027785301208496094, "ViewRequirementAgentConnector_ms": 0.06655645370483398}}, "episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.144076447602, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3046.7997197113095, -3069.653200132107, -3162.270531189558, -3094.937112463985, -3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736350745675684, "mean_inference_ms": 0.37822968482214864, "mean_action_processing_ms": 0.09205402320563864, "mean_env_wait_ms": 0.899374263724678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034940242767333984, "StateBufferConnector_ms": 0.0027785301208496094, "ViewRequirementAgentConnector_ms": 0.06655645370483398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51668280, "num_agent_steps_trained": 51668280, "num_env_steps_sampled": 51668280, "num_env_steps_trained": 51668280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.42521438703699, "num_env_steps_trained_throughput_per_sec": 110.42521438703699, "timesteps_total": 51668280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51668280, "timers": {"training_iteration_time_ms": 3288.506, "sample_time_ms": 3277.522, "load_time_ms": 0.303, "load_throughput": 1186693.996, "learn_time_ms": 9.922, "learn_throughput": 36282.209, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 51668280, "num_env_steps_trained": 51668280, "num_agent_steps_sampled": 51668280, "num_agent_steps_trained": 51668280}, "done": false, "episodes_total": 12980, "training_iteration": 4028, "trial_id": "ef964_00000", "date": "2023-08-08_14-17-55", "timestamp": 1691493475, "time_this_iter_s": 13.04331088066101, "time_total_s": 95281.68412613869, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2260.0046756267548, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 18.472222222222218, "ram_util_percent": 65.88333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -377.9217895507812, "policy_loss": -4905555.04375, "vf_loss": 15227431.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3443.0, "diff_num_grad_updates_vs_sampler_policy": 3442.0}}, "num_env_steps_sampled": 51669720, "num_env_steps_trained": 51669720, "num_agent_steps_sampled": 51669720, "num_agent_steps_trained": 51669720}, "sampler_results": {"episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3073.268689465723, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736217624168983, "mean_inference_ms": 0.37822579477483814, "mean_action_processing_ms": 0.09205468762940107, "mean_env_wait_ms": 0.8992910107845595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035071372985839844, "StateBufferConnector_ms": 0.0027709007263183594, "ViewRequirementAgentConnector_ms": 0.06648135185241699}}, "episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3073.268689465723, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.951563620432, -3069.5650920475073, -3168.78412235716, -3124.490963909573, -3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.736217624168983, "mean_inference_ms": 0.37822579477483814, "mean_action_processing_ms": 0.09205468762940107, "mean_env_wait_ms": 0.8992910107845595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035071372985839844, "StateBufferConnector_ms": 0.0027709007263183594, "ViewRequirementAgentConnector_ms": 0.06648135185241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51669720, "num_agent_steps_trained": 51669720, "num_env_steps_sampled": 51669720, "num_env_steps_trained": 51669720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.64968928249685, "num_env_steps_trained_throughput_per_sec": 109.64968928249685, "timesteps_total": 51669720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51669720, "timers": {"training_iteration_time_ms": 3281.681, "sample_time_ms": 3270.724, "load_time_ms": 0.303, "load_throughput": 1186973.854, "learn_time_ms": 9.886, "learn_throughput": 36414.772, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 51669720, "num_env_steps_trained": 51669720, "num_agent_steps_sampled": 51669720, "num_agent_steps_trained": 51669720}, "done": false, "episodes_total": 12984, "training_iteration": 4029, "trial_id": "ef964_00000", "date": "2023-08-08_14-18-09", "timestamp": 1691493489, "time_this_iter_s": 13.135692119598389, "time_total_s": 95294.81981825829, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2273.140367746353, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 19.847368421052632, "ram_util_percent": 65.97368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.3393798828125, "policy_loss": -16744734.36875, "vf_loss": 16298486.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3463.0, "diff_num_grad_updates_vs_sampler_policy": 3462.0}}, "num_env_steps_sampled": 51671160, "num_env_steps_trained": 51671160, "num_agent_steps_sampled": 51671160, "num_agent_steps_trained": 51671160}, "sampler_results": {"episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3072.7597462512927, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73608701121727, "mean_inference_ms": 0.37822738683403834, "mean_action_processing_ms": 0.09205672596061434, "mean_env_wait_ms": 0.899207393948161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511667251586914, "StateBufferConnector_ms": 0.0027785301208496094, "ViewRequirementAgentConnector_ms": 0.0665750503540039}}, "episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3072.7597462512927, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3120.7883156873336, -3073.023531213476, -3097.820687768147, -3024.4575826675236, -3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73608701121727, "mean_inference_ms": 0.37822738683403834, "mean_action_processing_ms": 0.09205672596061434, "mean_env_wait_ms": 0.899207393948161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511667251586914, "StateBufferConnector_ms": 0.0027785301208496094, "ViewRequirementAgentConnector_ms": 0.0665750503540039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51671160, "num_agent_steps_trained": 51671160, "num_env_steps_sampled": 51671160, "num_env_steps_trained": 51671160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.37043323769322, "num_env_steps_trained_throughput_per_sec": 108.37043323769322, "timesteps_total": 51671160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51671160, "timers": {"training_iteration_time_ms": 3300.089, "sample_time_ms": 3289.163, "load_time_ms": 0.311, "load_throughput": 1158025.493, "learn_time_ms": 9.847, "learn_throughput": 36560.431, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 51671160, "num_env_steps_trained": 51671160, "num_agent_steps_sampled": 51671160, "num_agent_steps_trained": 51671160}, "done": false, "episodes_total": 12988, "training_iteration": 4030, "trial_id": "ef964_00000", "date": "2023-08-08_14-18-22", "timestamp": 1691493502, "time_this_iter_s": 13.290613174438477, "time_total_s": 95308.11043143272, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2286.4309809207916, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 21.099999999999998, "ram_util_percent": 65.87777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.0573669433594, "policy_loss": 319762.74375, "vf_loss": 14941440.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3483.0, "diff_num_grad_updates_vs_sampler_policy": 3482.0}}, "num_env_steps_sampled": 51672600, "num_env_steps_trained": 51672600, "num_agent_steps_sampled": 51672600, "num_agent_steps_trained": 51672600}, "sampler_results": {"episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3071.027961985239, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735961549821579, "mean_inference_ms": 0.3782286779041447, "mean_action_processing_ms": 0.0920586675960923, "mean_env_wait_ms": 0.8991146494423538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.0027856826782226562, "ViewRequirementAgentConnector_ms": 0.06663179397583008}}, "episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3071.027961985239, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.4668619329395, -3025.6325398480253, -3045.9098390726126, -3048.0071028244315, -3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735961549821579, "mean_inference_ms": 0.3782286779041447, "mean_action_processing_ms": 0.0920586675960923, "mean_env_wait_ms": 0.8991146494423538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.0027856826782226562, "ViewRequirementAgentConnector_ms": 0.06663179397583008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51672600, "num_agent_steps_trained": 51672600, "num_env_steps_sampled": 51672600, "num_env_steps_trained": 51672600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.06732611991336, "num_env_steps_trained_throughput_per_sec": 109.06732611991336, "timesteps_total": 51672600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51672600, "timers": {"training_iteration_time_ms": 3308.679, "sample_time_ms": 3297.697, "load_time_ms": 0.31, "load_throughput": 1161231.593, "learn_time_ms": 9.879, "learn_throughput": 36439.554, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 51672600, "num_env_steps_trained": 51672600, "num_agent_steps_sampled": 51672600, "num_agent_steps_trained": 51672600}, "done": false, "episodes_total": 12992, "training_iteration": 4031, "trial_id": "ef964_00000", "date": "2023-08-08_14-18-35", "timestamp": 1691493515, "time_this_iter_s": 13.205724954605103, "time_total_s": 95321.31615638733, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2299.6367058753967, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 18.168421052631583, "ram_util_percent": 65.65789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.1733642578125, "policy_loss": -7682213.88125, "vf_loss": 16055707.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3503.0, "diff_num_grad_updates_vs_sampler_policy": 3502.0}}, "num_env_steps_sampled": 51674040, "num_env_steps_trained": 51674040, "num_agent_steps_sampled": 51674040, "num_agent_steps_trained": 51674040}, "sampler_results": {"episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.1264990727377, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735827479174236, "mean_inference_ms": 0.3782298242072978, "mean_action_processing_ms": 0.09206058404500275, "mean_env_wait_ms": 0.8990416033740192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.0027840137481689453, "ViewRequirementAgentConnector_ms": 0.06656932830810547}}, "episode_reward_max": -3000.0773690318824, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3074.1264990727377, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0773690318824, -3045.970579068735, -3073.4779790992948, -3189.7689544108785, -3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735827479174236, "mean_inference_ms": 0.3782298242072978, "mean_action_processing_ms": 0.09206058404500275, "mean_env_wait_ms": 0.8990416033740192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.0027840137481689453, "ViewRequirementAgentConnector_ms": 0.06656932830810547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51674040, "num_agent_steps_trained": 51674040, "num_env_steps_sampled": 51674040, "num_env_steps_trained": 51674040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.88159243407156, "num_env_steps_trained_throughput_per_sec": 109.88159243407156, "timesteps_total": 51674040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51674040, "timers": {"training_iteration_time_ms": 3296.99, "sample_time_ms": 3286.074, "load_time_ms": 0.311, "load_throughput": 1157847.895, "learn_time_ms": 9.806, "learn_throughput": 36712.257, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 51674040, "num_env_steps_trained": 51674040, "num_agent_steps_sampled": 51674040, "num_agent_steps_trained": 51674040}, "done": false, "episodes_total": 12996, "training_iteration": 4032, "trial_id": "ef964_00000", "date": "2023-08-08_14-18-48", "timestamp": 1691493528, "time_this_iter_s": 13.107995748519897, "time_total_s": 95334.42415213585, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2312.7447016239166, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 20.16842105263158, "ram_util_percent": 65.70526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.2369750976562, "policy_loss": -939615.33125, "vf_loss": 15475913.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3523.0, "diff_num_grad_updates_vs_sampler_policy": 3522.0}}, "num_env_steps_sampled": 51675480, "num_env_steps_trained": 51675480, "num_agent_steps_sampled": 51675480, "num_agent_steps_trained": 51675480}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3073.9197722563827, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735713177578618, "mean_inference_ms": 0.3782314290881827, "mean_action_processing_ms": 0.09206254155418592, "mean_env_wait_ms": 0.8989682485019685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035126209259033203, "StateBufferConnector_ms": 0.0027816295623779297, "ViewRequirementAgentConnector_ms": 0.06654119491577148}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3073.9197722563827, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.9883928174986, -3116.662687027655, -3142.5171389829666, -3094.4851374016575, -3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735713177578618, "mean_inference_ms": 0.3782314290881827, "mean_action_processing_ms": 0.09206254155418592, "mean_env_wait_ms": 0.8989682485019685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035126209259033203, "StateBufferConnector_ms": 0.0027816295623779297, "ViewRequirementAgentConnector_ms": 0.06654119491577148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51675480, "num_agent_steps_trained": 51675480, "num_env_steps_sampled": 51675480, "num_env_steps_trained": 51675480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.83821407377128, "num_env_steps_trained_throughput_per_sec": 108.83821407377128, "timesteps_total": 51675480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51675480, "timers": {"training_iteration_time_ms": 3288.631, "sample_time_ms": 3277.762, "load_time_ms": 0.304, "load_throughput": 1185762.086, "learn_time_ms": 9.792, "learn_throughput": 36765.176, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 51675480, "num_env_steps_trained": 51675480, "num_agent_steps_sampled": 51675480, "num_agent_steps_trained": 51675480}, "done": false, "episodes_total": 13000, "training_iteration": 4033, "trial_id": "ef964_00000", "date": "2023-08-08_14-19-01", "timestamp": 1691493541, "time_this_iter_s": 13.233356714248657, "time_total_s": 95347.6575088501, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2325.9780583381653, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 19.35263157894737, "ram_util_percent": 65.70526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.3846801757812, "policy_loss": -357161.5875, "vf_loss": 15428439.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3543.0, "diff_num_grad_updates_vs_sampler_policy": 3542.0}}, "num_env_steps_sampled": 51676920, "num_env_steps_trained": 51676920, "num_agent_steps_sampled": 51676920, "num_agent_steps_trained": 51676920}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3072.778195772311, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735608240364138, "mean_inference_ms": 0.37823351544546824, "mean_action_processing_ms": 0.09206466418026799, "mean_env_wait_ms": 0.8988905517224737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.0027854442596435547, "ViewRequirementAgentConnector_ms": 0.06658148765563965}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3072.778195772311, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.2228591015914, -3163.5473296679156, -3046.519093980989, -3072.371807343263, -3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735608240364138, "mean_inference_ms": 0.37823351544546824, "mean_action_processing_ms": 0.09206466418026799, "mean_env_wait_ms": 0.8988905517224737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.0027854442596435547, "ViewRequirementAgentConnector_ms": 0.06658148765563965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51676920, "num_agent_steps_trained": 51676920, "num_env_steps_sampled": 51676920, "num_env_steps_trained": 51676920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.67843566583232, "num_env_steps_trained_throughput_per_sec": 109.67843566583232, "timesteps_total": 51676920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51676920, "timers": {"training_iteration_time_ms": 3286.888, "sample_time_ms": 3276.005, "load_time_ms": 0.304, "load_throughput": 1184274.071, "learn_time_ms": 9.803, "learn_throughput": 36721.9, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 51676920, "num_env_steps_trained": 51676920, "num_agent_steps_sampled": 51676920, "num_agent_steps_trained": 51676920}, "done": false, "episodes_total": 13004, "training_iteration": 4034, "trial_id": "ef964_00000", "date": "2023-08-08_14-19-15", "timestamp": 1691493555, "time_this_iter_s": 13.13216781616211, "time_total_s": 95360.78967666626, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2339.1102261543274, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 19.716666666666665, "ram_util_percent": 65.49444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.0573303222656, "policy_loss": 322417.1625, "vf_loss": 15138000.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3563.0, "diff_num_grad_updates_vs_sampler_policy": 3562.0}}, "num_env_steps_sampled": 51678360, "num_env_steps_trained": 51678360, "num_agent_steps_sampled": 51678360, "num_agent_steps_trained": 51678360}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3072.562136709756, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735472911984203, "mean_inference_ms": 0.378234968413785, "mean_action_processing_ms": 0.09206656272263818, "mean_env_wait_ms": 0.8988003362475837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035109519958496094, "StateBufferConnector_ms": 0.0027799606323242188, "ViewRequirementAgentConnector_ms": 0.06646847724914551}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3237.8300119651626, "episode_reward_mean": -3072.562136709756, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3237.8300119651626, -3046.815804774745, -3045.605957304626, -3114.1260371593244, -3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735472911984203, "mean_inference_ms": 0.378234968413785, "mean_action_processing_ms": 0.09206656272263818, "mean_env_wait_ms": 0.8988003362475837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035109519958496094, "StateBufferConnector_ms": 0.0027799606323242188, "ViewRequirementAgentConnector_ms": 0.06646847724914551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51678360, "num_agent_steps_trained": 51678360, "num_env_steps_sampled": 51678360, "num_env_steps_trained": 51678360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.42947438543573, "num_env_steps_trained_throughput_per_sec": 111.42947438543573, "timesteps_total": 51678360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51678360, "timers": {"training_iteration_time_ms": 3270.132, "sample_time_ms": 3259.257, "load_time_ms": 0.305, "load_throughput": 1179279.475, "learn_time_ms": 9.799, "learn_throughput": 36740.038, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51678360, "num_env_steps_trained": 51678360, "num_agent_steps_sampled": 51678360, "num_agent_steps_trained": 51678360}, "done": false, "episodes_total": 13008, "training_iteration": 4035, "trial_id": "ef964_00000", "date": "2023-08-08_14-19-28", "timestamp": 1691493568, "time_this_iter_s": 12.92586898803711, "time_total_s": 95373.7155456543, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2352.0360951423645, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 22.61052631578948, "ram_util_percent": 65.38947368421051}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.1434326171875, "policy_loss": -13666574.86875, "vf_loss": 15544825.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3583.0, "diff_num_grad_updates_vs_sampler_policy": 3582.0}}, "num_env_steps_sampled": 51679800, "num_env_steps_trained": 51679800, "num_agent_steps_sampled": 51679800, "num_agent_steps_trained": 51679800}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.279607961849, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7353471282231725, "mean_inference_ms": 0.37823630525437446, "mean_action_processing_ms": 0.09206832323303693, "mean_env_wait_ms": 0.8987057576305293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035123825073242188, "StateBufferConnector_ms": 0.0027818679809570312, "ViewRequirementAgentConnector_ms": 0.06643199920654297}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.279607961849, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.6390168081266, -3047.006269817988, -3022.539502448908, -3069.118905376124, -3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7353471282231725, "mean_inference_ms": 0.37823630525437446, "mean_action_processing_ms": 0.09206832323303693, "mean_env_wait_ms": 0.8987057576305293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035123825073242188, "StateBufferConnector_ms": 0.0027818679809570312, "ViewRequirementAgentConnector_ms": 0.06643199920654297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51679800, "num_agent_steps_trained": 51679800, "num_env_steps_sampled": 51679800, "num_env_steps_trained": 51679800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.29421260889931, "num_env_steps_trained_throughput_per_sec": 109.29421260889931, "timesteps_total": 51679800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51679800, "timers": {"training_iteration_time_ms": 3260.324, "sample_time_ms": 3249.459, "load_time_ms": 0.301, "load_throughput": 1197327.286, "learn_time_ms": 9.795, "learn_throughput": 36754.794, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51679800, "num_env_steps_trained": 51679800, "num_agent_steps_sampled": 51679800, "num_agent_steps_trained": 51679800}, "done": false, "episodes_total": 13012, "training_iteration": 4036, "trial_id": "ef964_00000", "date": "2023-08-08_14-19-41", "timestamp": 1691493581, "time_this_iter_s": 13.178325176239014, "time_total_s": 95386.89387083054, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2365.2144203186035, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 20.98333333333333, "ram_util_percent": 65.65555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.58098754882815, "policy_loss": -4721597.56875, "vf_loss": 15813128.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3603.0, "diff_num_grad_updates_vs_sampler_policy": 3602.0}}, "num_env_steps_sampled": 51681240, "num_env_steps_trained": 51681240, "num_agent_steps_sampled": 51681240, "num_agent_steps_trained": 51681240}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3072.6897996173934, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735234909522055, "mean_inference_ms": 0.3782377668784296, "mean_action_processing_ms": 0.09207005431430551, "mean_env_wait_ms": 0.8986199487364049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035119056701660156, "StateBufferConnector_ms": 0.0027763843536376953, "ViewRequirementAgentConnector_ms": 0.06641507148742676}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3072.6897996173934, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3094.1459920302577, -3095.3259876280495, -3051.241997547046, -3045.23303581525, -3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735234909522055, "mean_inference_ms": 0.3782377668784296, "mean_action_processing_ms": 0.09207005431430551, "mean_env_wait_ms": 0.8986199487364049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035119056701660156, "StateBufferConnector_ms": 0.0027763843536376953, "ViewRequirementAgentConnector_ms": 0.06641507148742676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51681240, "num_agent_steps_trained": 51681240, "num_env_steps_sampled": 51681240, "num_env_steps_trained": 51681240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.590670105798, "num_env_steps_trained_throughput_per_sec": 108.590670105798, "timesteps_total": 51681240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51681240, "timers": {"training_iteration_time_ms": 3296.693, "sample_time_ms": 3285.816, "load_time_ms": 0.306, "load_throughput": 1175606.851, "learn_time_ms": 9.798, "learn_throughput": 36741.647, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51681240, "num_env_steps_trained": 51681240, "num_agent_steps_sampled": 51681240, "num_agent_steps_trained": 51681240}, "done": false, "episodes_total": 13016, "training_iteration": 4037, "trial_id": "ef964_00000", "date": "2023-08-08_14-19-54", "timestamp": 1691493594, "time_this_iter_s": 13.263693809509277, "time_total_s": 95400.15756464005, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2378.478114128113, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 20.33157894736842, "ram_util_percent": 65.85263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.8211364746094, "policy_loss": -17753640.9546875, "vf_loss": 16249393.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3623.0, "diff_num_grad_updates_vs_sampler_policy": 3622.0}}, "num_env_steps_sampled": 51682680, "num_env_steps_trained": 51682680, "num_agent_steps_sampled": 51682680, "num_agent_steps_trained": 51682680}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3073.210338792067, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7351358370475465, "mean_inference_ms": 0.3782391396685824, "mean_action_processing_ms": 0.09207177098707219, "mean_env_wait_ms": 0.8985596341562159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.0027778148651123047, "ViewRequirementAgentConnector_ms": 0.06639361381530762}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3073.210338792067, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3025.207000346558, -3022.924638106817, -3023.30488094316, -3028.593537799572, -3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7351358370475465, "mean_inference_ms": 0.3782391396685824, "mean_action_processing_ms": 0.09207177098707219, "mean_env_wait_ms": 0.8985596341562159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.0027778148651123047, "ViewRequirementAgentConnector_ms": 0.06639361381530762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51682680, "num_agent_steps_trained": 51682680, "num_env_steps_sampled": 51682680, "num_env_steps_trained": 51682680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.37026990322086, "num_env_steps_trained_throughput_per_sec": 108.37026990322086, "timesteps_total": 51682680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51682680, "timers": {"training_iteration_time_ms": 3317.451, "sample_time_ms": 3306.609, "load_time_ms": 0.307, "load_throughput": 1172320.994, "learn_time_ms": 9.765, "learn_throughput": 36865.89, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51682680, "num_env_steps_trained": 51682680, "num_agent_steps_sampled": 51682680, "num_agent_steps_trained": 51682680}, "done": false, "episodes_total": 13020, "training_iteration": 4038, "trial_id": "ef964_00000", "date": "2023-08-08_14-20-07", "timestamp": 1691493607, "time_this_iter_s": 13.290671825408936, "time_total_s": 95413.44823646545, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2391.7687859535217, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 19.542105263157897, "ram_util_percent": 65.84210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.3944519042969, "policy_loss": -7887597.65625, "vf_loss": 15778595.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3643.0, "diff_num_grad_updates_vs_sampler_policy": 3642.0}}, "num_env_steps_sampled": 51684120, "num_env_steps_trained": 51684120, "num_agent_steps_sampled": 51684120, "num_agent_steps_trained": 51684120}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3075.532774278968, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735044115908298, "mean_inference_ms": 0.37824047358270685, "mean_action_processing_ms": 0.09207337732695361, "mean_env_wait_ms": 0.8985087120326122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.002776622772216797, "ViewRequirementAgentConnector_ms": 0.06635379791259766}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3075.532774278968, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3072.526740706057, -3024.1110086571653, -3118.0436674481816, -3022.993916098697, -3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.735044115908298, "mean_inference_ms": 0.37824047358270685, "mean_action_processing_ms": 0.09207337732695361, "mean_env_wait_ms": 0.8985087120326122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.002776622772216797, "ViewRequirementAgentConnector_ms": 0.06635379791259766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51684120, "num_agent_steps_trained": 51684120, "num_env_steps_sampled": 51684120, "num_env_steps_trained": 51684120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.70015129501459, "num_env_steps_trained_throughput_per_sec": 109.70015129501459, "timesteps_total": 51684120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51684120, "timers": {"training_iteration_time_ms": 3304.948, "sample_time_ms": 3294.144, "load_time_ms": 0.301, "load_throughput": 1196094.297, "learn_time_ms": 9.731, "learn_throughput": 36997.048, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 51684120, "num_env_steps_trained": 51684120, "num_agent_steps_sampled": 51684120, "num_agent_steps_trained": 51684120}, "done": false, "episodes_total": 13024, "training_iteration": 4039, "trial_id": "ef964_00000", "date": "2023-08-08_14-20-21", "timestamp": 1691493621, "time_this_iter_s": 13.129528999328613, "time_total_s": 95426.57776546478, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2404.8983149528503, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 20.91111111111111, "ram_util_percent": 65.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.8572509765625, "policy_loss": -9919811.91875, "vf_loss": 15904664.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3663.0, "diff_num_grad_updates_vs_sampler_policy": 3662.0}}, "num_env_steps_sampled": 51685560, "num_env_steps_trained": 51685560, "num_agent_steps_sampled": 51685560, "num_agent_steps_trained": 51685560}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3076.7344780033354, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734930630971186, "mean_inference_ms": 0.3782434324749356, "mean_action_processing_ms": 0.09207531324908363, "mean_env_wait_ms": 0.8984655712420103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515005111694336, "StateBufferConnector_ms": 0.002773761749267578, "ViewRequirementAgentConnector_ms": 0.06632399559020996}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3076.7344780033354, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3116.699774076341, -3095.054460606708, -3094.0770193739654, -3118.664316737547, -3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734930630971186, "mean_inference_ms": 0.3782434324749356, "mean_action_processing_ms": 0.09207531324908363, "mean_env_wait_ms": 0.8984655712420103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515005111694336, "StateBufferConnector_ms": 0.002773761749267578, "ViewRequirementAgentConnector_ms": 0.06632399559020996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51685560, "num_agent_steps_trained": 51685560, "num_env_steps_sampled": 51685560, "num_env_steps_trained": 51685560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.99626856123979, "num_env_steps_trained_throughput_per_sec": 109.99626856123979, "timesteps_total": 51685560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51685560, "timers": {"training_iteration_time_ms": 3294.524, "sample_time_ms": 3283.681, "load_time_ms": 0.301, "load_throughput": 1195904.831, "learn_time_ms": 9.764, "learn_throughput": 36871.201, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 51685560, "num_env_steps_trained": 51685560, "num_agent_steps_sampled": 51685560, "num_agent_steps_trained": 51685560}, "done": false, "episodes_total": 13028, "training_iteration": 4040, "trial_id": "ef964_00000", "date": "2023-08-08_14-20-34", "timestamp": 1691493634, "time_this_iter_s": 13.09452486038208, "time_total_s": 95439.67229032516, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2417.9928398132324, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 21.4, "ram_util_percent": 65.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.40448608398435, "policy_loss": -8604613.5875, "vf_loss": 15229646.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3683.0, "diff_num_grad_updates_vs_sampler_policy": 3682.0}}, "num_env_steps_sampled": 51687000, "num_env_steps_trained": 51687000, "num_agent_steps_sampled": 51687000, "num_agent_steps_trained": 51687000}, "sampler_results": {"episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3075.0323538931802, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734787850294701, "mean_inference_ms": 0.3782466429685357, "mean_action_processing_ms": 0.09207721205231043, "mean_env_wait_ms": 0.8984195170394794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.0027794837951660156, "ViewRequirementAgentConnector_ms": 0.06643795967102051}}, "episode_reward_max": -3000.0786193434865, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3075.0323538931802, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.7665051031195, -3048.476506431795, -3000.0786193434865, -3046.798283085899, -3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734787850294701, "mean_inference_ms": 0.3782466429685357, "mean_action_processing_ms": 0.09207721205231043, "mean_env_wait_ms": 0.8984195170394794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.0027794837951660156, "ViewRequirementAgentConnector_ms": 0.06643795967102051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51687000, "num_agent_steps_trained": 51687000, "num_env_steps_sampled": 51687000, "num_env_steps_trained": 51687000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.95110805107669, "num_env_steps_trained_throughput_per_sec": 110.95110805107669, "timesteps_total": 51687000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51687000, "timers": {"training_iteration_time_ms": 3267.999, "sample_time_ms": 3257.164, "load_time_ms": 0.302, "load_throughput": 1193352.912, "learn_time_ms": 9.759, "learn_throughput": 36888.586, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 51687000, "num_env_steps_trained": 51687000, "num_agent_steps_sampled": 51687000, "num_agent_steps_trained": 51687000}, "done": false, "episodes_total": 13032, "training_iteration": 4041, "trial_id": "ef964_00000", "date": "2023-08-08_14-20-47", "timestamp": 1691493647, "time_this_iter_s": 12.981658935546875, "time_total_s": 95452.65394926071, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2430.9744987487793, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 21.522222222222222, "ram_util_percent": 65.92777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.54096069335935, "policy_loss": -2359330.7296875, "vf_loss": 15406089.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3703.0, "diff_num_grad_updates_vs_sampler_policy": 3702.0}}, "num_env_steps_sampled": 51688440, "num_env_steps_trained": 51688440, "num_agent_steps_sampled": 51688440, "num_agent_steps_trained": 51688440}, "sampler_results": {"episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3076.0025517737276, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734683205781785, "mean_inference_ms": 0.37824946245197616, "mean_action_processing_ms": 0.09207899578405009, "mean_env_wait_ms": 0.8983841394465916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.0027778148651123047, "ViewRequirementAgentConnector_ms": 0.0664985179901123}}, "episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3076.0025517737276, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.568186967294, -3049.5878727069485, -3093.799264343006, -3096.0507455833194, -3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734683205781785, "mean_inference_ms": 0.37824946245197616, "mean_action_processing_ms": 0.09207899578405009, "mean_env_wait_ms": 0.8983841394465916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.0027778148651123047, "ViewRequirementAgentConnector_ms": 0.0664985179901123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51688440, "num_agent_steps_trained": 51688440, "num_env_steps_sampled": 51688440, "num_env_steps_trained": 51688440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.43142113579594, "num_env_steps_trained_throughput_per_sec": 109.43142113579594, "timesteps_total": 51688440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51688440, "timers": {"training_iteration_time_ms": 3259.562, "sample_time_ms": 3248.704, "load_time_ms": 0.301, "load_throughput": 1195999.556, "learn_time_ms": 9.794, "learn_throughput": 36755.6, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 51688440, "num_env_steps_trained": 51688440, "num_agent_steps_sampled": 51688440, "num_agent_steps_trained": 51688440}, "done": false, "episodes_total": 13036, "training_iteration": 4042, "trial_id": "ef964_00000", "date": "2023-08-08_14-21-00", "timestamp": 1691493660, "time_this_iter_s": 13.1617591381073, "time_total_s": 95465.81570839882, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2444.1362578868866, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 19.652631578947368, "ram_util_percent": 65.6315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.4247253417969, "policy_loss": -5338373.81875, "vf_loss": 16168607.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3723.0, "diff_num_grad_updates_vs_sampler_policy": 3722.0}}, "num_env_steps_sampled": 51689880, "num_env_steps_trained": 51689880, "num_agent_steps_sampled": 51689880, "num_agent_steps_trained": 51689880}, "sampler_results": {"episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3076.000200733298, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734577747178625, "mean_inference_ms": 0.37825196982441783, "mean_action_processing_ms": 0.09208058219508346, "mean_env_wait_ms": 0.8983467923922116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035130977630615234, "StateBufferConnector_ms": 0.0027761459350585938, "ViewRequirementAgentConnector_ms": 0.06654047966003418}}, "episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3076.000200733298, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3166.115685013533, -3113.647296608516, -3049.5293536398185, -3124.2284647311967, -3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734577747178625, "mean_inference_ms": 0.37825196982441783, "mean_action_processing_ms": 0.09208058219508346, "mean_env_wait_ms": 0.8983467923922116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035130977630615234, "StateBufferConnector_ms": 0.0027761459350585938, "ViewRequirementAgentConnector_ms": 0.06654047966003418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51689880, "num_agent_steps_trained": 51689880, "num_env_steps_sampled": 51689880, "num_env_steps_trained": 51689880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.54734067283981, "num_env_steps_trained_throughput_per_sec": 109.54734067283981, "timesteps_total": 51689880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51689880, "timers": {"training_iteration_time_ms": 3282.86, "sample_time_ms": 3272.107, "load_time_ms": 0.301, "load_throughput": 1197422.236, "learn_time_ms": 9.69, "learn_throughput": 37151.617, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51689880, "num_env_steps_trained": 51689880, "num_agent_steps_sampled": 51689880, "num_agent_steps_trained": 51689880}, "done": false, "episodes_total": 13040, "training_iteration": 4043, "trial_id": "ef964_00000", "date": "2023-08-08_14-21-13", "timestamp": 1691493673, "time_this_iter_s": 13.147775888442993, "time_total_s": 95478.96348428726, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2457.2840337753296, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 18.894736842105267, "ram_util_percent": 65.66315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -374.0799560546875, "policy_loss": 196542.14375, "vf_loss": 14970530.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3743.0, "diff_num_grad_updates_vs_sampler_policy": 3742.0}}, "num_env_steps_sampled": 51691320, "num_env_steps_trained": 51691320, "num_agent_steps_sampled": 51691320, "num_agent_steps_trained": 51691320}, "sampler_results": {"episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3072.686610458537, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734422286758595, "mean_inference_ms": 0.3782533403164479, "mean_action_processing_ms": 0.09208188918752079, "mean_env_wait_ms": 0.8982974017434079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035059452056884766, "StateBufferConnector_ms": 0.0027751922607421875, "ViewRequirementAgentConnector_ms": 0.06649589538574219}}, "episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3072.686610458537, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.222822849108, -3093.8642493537773, -3048.2328850486965, -3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734422286758595, "mean_inference_ms": 0.3782533403164479, "mean_action_processing_ms": 0.09208188918752079, "mean_env_wait_ms": 0.8982974017434079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035059452056884766, "StateBufferConnector_ms": 0.0027751922607421875, "ViewRequirementAgentConnector_ms": 0.06649589538574219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51691320, "num_agent_steps_trained": 51691320, "num_env_steps_sampled": 51691320, "num_env_steps_trained": 51691320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.8906370659997, "num_env_steps_trained_throughput_per_sec": 112.8906370659997, "timesteps_total": 51691320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51691320, "timers": {"training_iteration_time_ms": 3251.504, "sample_time_ms": 3240.509, "load_time_ms": 0.314, "load_throughput": 1145202.457, "learn_time_ms": 9.886, "learn_throughput": 36415.474, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 51691320, "num_env_steps_trained": 51691320, "num_agent_steps_sampled": 51691320, "num_agent_steps_trained": 51691320}, "done": false, "episodes_total": 13044, "training_iteration": 4044, "trial_id": "ef964_00000", "date": "2023-08-08_14-21-26", "timestamp": 1691493686, "time_this_iter_s": 12.758755207061768, "time_total_s": 95491.72223949432, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2470.0427889823914, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 23.961111111111112, "ram_util_percent": 65.80555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.92265625, "policy_loss": -10978963.6546875, "vf_loss": 15501020.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3758.0, "diff_num_grad_updates_vs_sampler_policy": 3757.0}}, "num_env_steps_sampled": 51692400, "num_env_steps_trained": 51692400, "num_agent_steps_sampled": 51692400, "num_agent_steps_trained": 51692400}, "sampler_results": {"episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3073.154206145285, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7342926177237095, "mean_inference_ms": 0.378271045355371, "mean_action_processing_ms": 0.09208635277368893, "mean_env_wait_ms": 0.8982800659458525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528118133544922, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.06679296493530273}}, "episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3073.154206145285, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.898299902388, -3073.444803296234, -3028.1436699809333, -3049.666822223708, -3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7342926177237095, "mean_inference_ms": 0.378271045355371, "mean_action_processing_ms": 0.09208635277368893, "mean_env_wait_ms": 0.8982800659458525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528118133544922, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.06679296493530273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51692400, "num_agent_steps_trained": 51692400, "num_env_steps_sampled": 51692400, "num_env_steps_trained": 51692400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.45643385272824, "num_env_steps_trained_throughput_per_sec": 107.45643385272824, "timesteps_total": 51692400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51692400, "timers": {"training_iteration_time_ms": 3265.551, "sample_time_ms": 3253.433, "load_time_ms": 0.33, "load_throughput": 1090216.202, "learn_time_ms": 10.921, "learn_throughput": 32963.218, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 51692400, "num_env_steps_trained": 51692400, "num_agent_steps_sampled": 51692400, "num_agent_steps_trained": 51692400}, "done": false, "episodes_total": 13047, "training_iteration": 4045, "trial_id": "ef964_00000", "date": "2023-08-08_14-21-36", "timestamp": 1691493696, "time_this_iter_s": 10.053437948226929, "time_total_s": 95501.77567744255, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2480.0962269306183, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 42.33571428571428, "ram_util_percent": 64.85714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -381.22724609375, "policy_loss": -2010529.975, "vf_loss": 15227973.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3778.0, "diff_num_grad_updates_vs_sampler_policy": 3777.0}}, "num_env_steps_sampled": 51693840, "num_env_steps_trained": 51693840, "num_agent_steps_sampled": 51693840, "num_agent_steps_trained": 51693840}, "sampler_results": {"episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3073.557418935771, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734097965094439, "mean_inference_ms": 0.3782994225303002, "mean_action_processing_ms": 0.09209318286250769, "mean_env_wait_ms": 0.8982571056932857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002822399139404297, "ViewRequirementAgentConnector_ms": 0.06685876846313477}}, "episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3073.557418935771, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.6477278548305, -3068.898161718112, -3047.8082671678226, -3146.535680685085, -3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.734097965094439, "mean_inference_ms": 0.3782994225303002, "mean_action_processing_ms": 0.09209318286250769, "mean_env_wait_ms": 0.8982571056932857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002822399139404297, "ViewRequirementAgentConnector_ms": 0.06685876846313477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51693840, "num_agent_steps_trained": 51693840, "num_env_steps_sampled": 51693840, "num_env_steps_trained": 51693840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.44530202525979, "num_env_steps_trained_throughput_per_sec": 110.44530202525979, "timesteps_total": 51693840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51693840, "timers": {"training_iteration_time_ms": 3262.935, "sample_time_ms": 3250.591, "load_time_ms": 0.341, "load_throughput": 1055097.086, "learn_time_ms": 11.096, "learn_throughput": 32443.913, "synch_weights_time_ms": 0.851}, "counters": {"num_env_steps_sampled": 51693840, "num_env_steps_trained": 51693840, "num_agent_steps_sampled": 51693840, "num_agent_steps_trained": 51693840}, "done": false, "episodes_total": 13051, "training_iteration": 4046, "trial_id": "ef964_00000", "date": "2023-08-08_14-21-49", "timestamp": 1691493709, "time_this_iter_s": 13.041104078292847, "time_total_s": 95514.81678152084, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2493.137331008911, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 38.699999999999996, "ram_util_percent": 64.76842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -374.44837646484376, "policy_loss": -2232597.290625, "vf_loss": 15422074.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3798.0, "diff_num_grad_updates_vs_sampler_policy": 3797.0}}, "num_env_steps_sampled": 51695280, "num_env_steps_trained": 51695280, "num_agent_steps_sampled": 51695280, "num_agent_steps_trained": 51695280}, "sampler_results": {"episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3073.0671303667773, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7339651068885145, "mean_inference_ms": 0.37833157364734055, "mean_action_processing_ms": 0.0921006872771967, "mean_env_wait_ms": 0.8982335113583813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560304641723633, "StateBufferConnector_ms": 0.0028307437896728516, "ViewRequirementAgentConnector_ms": 0.06692218780517578}}, "episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3073.0671303667773, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3094.055361015406, -3070.6937087251135, -3119.613370660296, -3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7339651068885145, "mean_inference_ms": 0.37833157364734055, "mean_action_processing_ms": 0.0921006872771967, "mean_env_wait_ms": 0.8982335113583813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560304641723633, "StateBufferConnector_ms": 0.0028307437896728516, "ViewRequirementAgentConnector_ms": 0.06692218780517578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51695280, "num_agent_steps_trained": 51695280, "num_env_steps_sampled": 51695280, "num_env_steps_trained": 51695280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 105.35162045200882, "num_env_steps_trained_throughput_per_sec": 105.35162045200882, "timesteps_total": 51695280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51695280, "timers": {"training_iteration_time_ms": 3321.478, "sample_time_ms": 3309.121, "load_time_ms": 0.333, "load_throughput": 1081006.186, "learn_time_ms": 11.146, "learn_throughput": 32297.278, "synch_weights_time_ms": 0.828}, "counters": {"num_env_steps_sampled": 51695280, "num_env_steps_trained": 51695280, "num_agent_steps_sampled": 51695280, "num_agent_steps_trained": 51695280}, "done": false, "episodes_total": 13055, "training_iteration": 4047, "trial_id": "ef964_00000", "date": "2023-08-08_14-22-03", "timestamp": 1691493723, "time_this_iter_s": 13.673917055130005, "time_total_s": 95528.49069857597, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2506.811248064041, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 37.24736842105263, "ram_util_percent": 64.67368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.1117858886719, "policy_loss": -14687476.6375, "vf_loss": 15948222.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3813.0, "diff_num_grad_updates_vs_sampler_policy": 3812.0}}, "num_env_steps_sampled": 51696360, "num_env_steps_trained": 51696360, "num_agent_steps_sampled": 51696360, "num_agent_steps_trained": 51696360}, "sampler_results": {"episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3072.8539240019595, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73390522207556, "mean_inference_ms": 0.37836987724821664, "mean_action_processing_ms": 0.09210919923537737, "mean_env_wait_ms": 0.8982385673189347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003568410873413086, "StateBufferConnector_ms": 0.002840280532836914, "ViewRequirementAgentConnector_ms": 0.06710505485534668}}, "episode_reward_max": -3000.079763440192, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3072.8539240019595, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3050.49443610087, -3025.7303817628895, -3000.079763440192, -3146.020322844208, -3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73390522207556, "mean_inference_ms": 0.37836987724821664, "mean_action_processing_ms": 0.09210919923537737, "mean_env_wait_ms": 0.8982385673189347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003568410873413086, "StateBufferConnector_ms": 0.002840280532836914, "ViewRequirementAgentConnector_ms": 0.06710505485534668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51696360, "num_agent_steps_trained": 51696360, "num_env_steps_sampled": 51696360, "num_env_steps_trained": 51696360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 101.82452551666438, "num_env_steps_trained_throughput_per_sec": 101.82452551666438, "timesteps_total": 51696360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51696360, "timers": {"training_iteration_time_ms": 3418.449, "sample_time_ms": 3406.244, "load_time_ms": 0.334, "load_throughput": 1078535.314, "learn_time_ms": 11.006, "learn_throughput": 32708.375, "synch_weights_time_ms": 0.816}, "counters": {"num_env_steps_sampled": 51696360, "num_env_steps_trained": 51696360, "num_agent_steps_sampled": 51696360, "num_agent_steps_trained": 51696360}, "done": false, "episodes_total": 13058, "training_iteration": 4048, "trial_id": "ef964_00000", "date": "2023-08-08_14-22-13", "timestamp": 1691493733, "time_this_iter_s": 10.609493970870972, "time_total_s": 95539.10019254684, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2517.420742034912, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 29.049999999999997, "ram_util_percent": 64.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.0451293945313, "policy_loss": -4180679.49375, "vf_loss": 15372184.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3833.0, "diff_num_grad_updates_vs_sampler_policy": 3832.0}}, "num_env_steps_sampled": 51697800, "num_env_steps_trained": 51697800, "num_agent_steps_sampled": 51697800, "num_agent_steps_trained": 51697800}, "sampler_results": {"episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3072.8296402246633, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733824744228452, "mean_inference_ms": 0.3784193155866303, "mean_action_processing_ms": 0.09212014812326114, "mean_env_wait_ms": 0.898242187115156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003570079803466797, "StateBufferConnector_ms": 0.0028312206268310547, "ViewRequirementAgentConnector_ms": 0.06705665588378906}}, "episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3072.8296402246633, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3165.1261961302725, -3071.8116525711903, -3095.981758942512, -3045.796803181663, -3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733824744228452, "mean_inference_ms": 0.3784193155866303, "mean_action_processing_ms": 0.09212014812326114, "mean_env_wait_ms": 0.898242187115156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003570079803466797, "StateBufferConnector_ms": 0.0028312206268310547, "ViewRequirementAgentConnector_ms": 0.06705665588378906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51697800, "num_agent_steps_trained": 51697800, "num_env_steps_sampled": 51697800, "num_env_steps_trained": 51697800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.76233768169092, "num_env_steps_trained_throughput_per_sec": 109.76233768169092, "timesteps_total": 51697800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51697800, "timers": {"training_iteration_time_ms": 3365.803, "sample_time_ms": 3353.699, "load_time_ms": 0.326, "load_throughput": 1103119.112, "learn_time_ms": 10.954, "learn_throughput": 32865.713, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 51697800, "num_env_steps_trained": 51697800, "num_agent_steps_sampled": 51697800, "num_agent_steps_trained": 51697800}, "done": false, "episodes_total": 13062, "training_iteration": 4049, "trial_id": "ef964_00000", "date": "2023-08-08_14-22-26", "timestamp": 1691493746, "time_this_iter_s": 13.122158765792847, "time_total_s": 95552.22235131264, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2530.542900800705, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 20.58333333333333, "ram_util_percent": 64.4611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.39735717773436, "policy_loss": -1768482.9359375, "vf_loss": 15420485.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3853.0, "diff_num_grad_updates_vs_sampler_policy": 3852.0}}, "num_env_steps_sampled": 51699240, "num_env_steps_trained": 51699240, "num_agent_steps_sampled": 51699240, "num_agent_steps_trained": 51699240}, "sampler_results": {"episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.9109022754487, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73371425017711, "mean_inference_ms": 0.37846702386137193, "mean_action_processing_ms": 0.09213074050948636, "mean_env_wait_ms": 0.8982385506955595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035543441772460938, "StateBufferConnector_ms": 0.0028333663940429688, "ViewRequirementAgentConnector_ms": 0.06713509559631348}}, "episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.9109022754487, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.080572486832, -3045.4696797485617, -3162.8934559254085, -3118.8515534027706, -3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73371425017711, "mean_inference_ms": 0.37846702386137193, "mean_action_processing_ms": 0.09213074050948636, "mean_env_wait_ms": 0.8982385506955595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035543441772460938, "StateBufferConnector_ms": 0.0028333663940429688, "ViewRequirementAgentConnector_ms": 0.06713509559631348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51699240, "num_agent_steps_trained": 51699240, "num_env_steps_sampled": 51699240, "num_env_steps_trained": 51699240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.65809768110024, "num_env_steps_trained_throughput_per_sec": 110.65809768110024, "timesteps_total": 51699240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51699240, "timers": {"training_iteration_time_ms": 3275.06, "sample_time_ms": 3264.203, "load_time_ms": 0.304, "load_throughput": 1185389.732, "learn_time_ms": 9.796, "learn_throughput": 36749.517, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 51699240, "num_env_steps_trained": 51699240, "num_agent_steps_sampled": 51699240, "num_agent_steps_trained": 51699240}, "done": false, "episodes_total": 13066, "training_iteration": 4050, "trial_id": "ef964_00000", "date": "2023-08-08_14-22-40", "timestamp": 1691493760, "time_this_iter_s": 13.015959739685059, "time_total_s": 95565.23831105232, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2543.55886054039, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 19.636842105263153, "ram_util_percent": 64.52105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.28492431640626, "policy_loss": -8478126.30625, "vf_loss": 16261885.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3873.0, "diff_num_grad_updates_vs_sampler_policy": 3872.0}}, "num_env_steps_sampled": 51700680, "num_env_steps_trained": 51700680, "num_agent_steps_sampled": 51700680, "num_agent_steps_trained": 51700680}, "sampler_results": {"episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.039276007925, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733585371723725, "mean_inference_ms": 0.3785131759581897, "mean_action_processing_ms": 0.09214100912275607, "mean_env_wait_ms": 0.8982302511847741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553152084350586, "StateBufferConnector_ms": 0.002827882766723633, "ViewRequirementAgentConnector_ms": 0.06710219383239746}}, "episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.039276007925, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3094.3333256940928, -3071.5114383120454, -3046.3296010337876, -3071.5921729536617, -3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733585371723725, "mean_inference_ms": 0.3785131759581897, "mean_action_processing_ms": 0.09214100912275607, "mean_env_wait_ms": 0.8982302511847741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553152084350586, "StateBufferConnector_ms": 0.002827882766723633, "ViewRequirementAgentConnector_ms": 0.06710219383239746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51700680, "num_agent_steps_trained": 51700680, "num_env_steps_sampled": 51700680, "num_env_steps_trained": 51700680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.7560174668088, "num_env_steps_trained_throughput_per_sec": 110.7560174668088, "timesteps_total": 51700680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51700680, "timers": {"training_iteration_time_ms": 3259.971, "sample_time_ms": 3249.138, "load_time_ms": 0.3, "load_throughput": 1198087.313, "learn_time_ms": 9.774, "learn_throughput": 36834.054, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51700680, "num_env_steps_trained": 51700680, "num_agent_steps_sampled": 51700680, "num_agent_steps_trained": 51700680}, "done": false, "episodes_total": 13070, "training_iteration": 4051, "trial_id": "ef964_00000", "date": "2023-08-08_14-22-53", "timestamp": 1691493773, "time_this_iter_s": 13.004422903060913, "time_total_s": 95578.24273395538, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2556.563283443451, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 20.03333333333333, "ram_util_percent": 64.42222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.6803405761719, "policy_loss": -1391005.809375, "vf_loss": 15120616.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3893.0, "diff_num_grad_updates_vs_sampler_policy": 3892.0}}, "num_env_steps_sampled": 51702120, "num_env_steps_trained": 51702120, "num_agent_steps_sampled": 51702120, "num_agent_steps_trained": 51702120}, "sampler_results": {"episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3069.5360786055626, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733442121383969, "mean_inference_ms": 0.3785577990745816, "mean_action_processing_ms": 0.09215092408055493, "mean_env_wait_ms": 0.8982138830236175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035555362701416016, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.0670614242553711}}, "episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3069.5360786055626, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3116.916719547943, -3040.681629610645, -3003.844188991348, -3025.305720876208, -3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733442121383969, "mean_inference_ms": 0.3785577990745816, "mean_action_processing_ms": 0.09215092408055493, "mean_env_wait_ms": 0.8982138830236175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035555362701416016, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.0670614242553711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51702120, "num_agent_steps_trained": 51702120, "num_env_steps_sampled": 51702120, "num_env_steps_trained": 51702120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.51744591851718, "num_env_steps_trained_throughput_per_sec": 110.51744591851718, "timesteps_total": 51702120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51702120, "timers": {"training_iteration_time_ms": 3250.659, "sample_time_ms": 3239.894, "load_time_ms": 0.302, "load_throughput": 1192787.298, "learn_time_ms": 9.701, "learn_throughput": 37109.524, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 51702120, "num_env_steps_trained": 51702120, "num_agent_steps_sampled": 51702120, "num_agent_steps_trained": 51702120}, "done": false, "episodes_total": 13074, "training_iteration": 4052, "trial_id": "ef964_00000", "date": "2023-08-08_14-23-06", "timestamp": 1691493786, "time_this_iter_s": 13.032400131225586, "time_total_s": 95591.27513408661, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2569.5956835746765, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 19.53684210526316, "ram_util_percent": 64.36315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.9535888671875, "policy_loss": -9349808.89375, "vf_loss": 16638218.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3913.0, "diff_num_grad_updates_vs_sampler_policy": 3912.0}}, "num_env_steps_sampled": 51703560, "num_env_steps_trained": 51703560, "num_agent_steps_sampled": 51703560, "num_agent_steps_trained": 51703560}, "sampler_results": {"episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.729055866235, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733272663080393, "mean_inference_ms": 0.3786007411456309, "mean_action_processing_ms": 0.09216045103964006, "mean_env_wait_ms": 0.8982038358527451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551959991455078, "StateBufferConnector_ms": 0.0028221607208251953, "ViewRequirementAgentConnector_ms": 0.06702184677124023}}, "episode_reward_max": -3000.080413663309, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.729055866235, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3094.105669543475, -3000.080413663309, -3048.2100969563376, -3098.539169465026, -3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733272663080393, "mean_inference_ms": 0.3786007411456309, "mean_action_processing_ms": 0.09216045103964006, "mean_env_wait_ms": 0.8982038358527451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551959991455078, "StateBufferConnector_ms": 0.0028221607208251953, "ViewRequirementAgentConnector_ms": 0.06702184677124023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51703560, "num_agent_steps_trained": 51703560, "num_env_steps_sampled": 51703560, "num_env_steps_trained": 51703560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.9836937260526, "num_env_steps_trained_throughput_per_sec": 110.9836937260526, "timesteps_total": 51703560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51703560, "timers": {"training_iteration_time_ms": 3249.683, "sample_time_ms": 3238.979, "load_time_ms": 0.301, "load_throughput": 1197707.179, "learn_time_ms": 9.641, "learn_throughput": 37339.403, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 51703560, "num_env_steps_trained": 51703560, "num_agent_steps_sampled": 51703560, "num_agent_steps_trained": 51703560}, "done": false, "episodes_total": 13078, "training_iteration": 4053, "trial_id": "ef964_00000", "date": "2023-08-08_14-23-19", "timestamp": 1691493799, "time_this_iter_s": 12.977756977081299, "time_total_s": 95604.25289106369, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2582.573440551758, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 20.188888888888886, "ram_util_percent": 64.50555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -374.5041015625, "policy_loss": -5706364.378125, "vf_loss": 15265929.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3933.0, "diff_num_grad_updates_vs_sampler_policy": 3932.0}}, "num_env_steps_sampled": 51705000, "num_env_steps_trained": 51705000, "num_agent_steps_sampled": 51705000, "num_agent_steps_trained": 51705000}, "sampler_results": {"episode_reward_max": -3000.080822166568, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.7205000541126, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733092003163255, "mean_inference_ms": 0.37864248968654435, "mean_action_processing_ms": 0.09216978490719133, "mean_env_wait_ms": 0.8981963664837841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486221313476562, "StateBufferConnector_ms": 0.002825498580932617, "ViewRequirementAgentConnector_ms": 0.06702375411987305}}, "episode_reward_max": -3000.080822166568, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.7205000541126, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3116.6820140618443, -3022.6905848258693, -3047.4762707414816, -3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.733092003163255, "mean_inference_ms": 0.37864248968654435, "mean_action_processing_ms": 0.09216978490719133, "mean_env_wait_ms": 0.8981963664837841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486221313476562, "StateBufferConnector_ms": 0.002825498580932617, "ViewRequirementAgentConnector_ms": 0.06702375411987305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51705000, "num_agent_steps_trained": 51705000, "num_env_steps_sampled": 51705000, "num_env_steps_trained": 51705000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.82802296719782, "num_env_steps_trained_throughput_per_sec": 110.82802296719782, "timesteps_total": 51705000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51705000, "timers": {"training_iteration_time_ms": 3246.513, "sample_time_ms": 3235.917, "load_time_ms": 0.301, "load_throughput": 1197612.183, "learn_time_ms": 9.537, "learn_throughput": 37747.792, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 51705000, "num_env_steps_trained": 51705000, "num_agent_steps_sampled": 51705000, "num_agent_steps_trained": 51705000}, "done": false, "episodes_total": 13082, "training_iteration": 4054, "trial_id": "ef964_00000", "date": "2023-08-08_14-23-32", "timestamp": 1691493812, "time_this_iter_s": 12.995984077453613, "time_total_s": 95617.24887514114, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2595.5694246292114, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 20.357894736842102, "ram_util_percent": 64.54210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.006689453125, "policy_loss": -6951216.5125, "vf_loss": 15154360.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3948.0, "diff_num_grad_updates_vs_sampler_policy": 3947.0}}, "num_env_steps_sampled": 51706080, "num_env_steps_trained": 51706080, "num_agent_steps_sampled": 51706080, "num_agent_steps_trained": 51706080}, "sampler_results": {"episode_reward_max": -3000.080822166568, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.0522121476383, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732965305464342, "mean_inference_ms": 0.3786889607042188, "mean_action_processing_ms": 0.09218003879499381, "mean_env_wait_ms": 0.8982054966806554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035545825958251953, "StateBufferConnector_ms": 0.002828359603881836, "ViewRequirementAgentConnector_ms": 0.06719303131103516}}, "episode_reward_max": -3000.080822166568, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.0522121476383, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.715703143307, -3146.013490231736, -3140.6919563751485, -3047.0445525560845, -3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732965305464342, "mean_inference_ms": 0.3786889607042188, "mean_action_processing_ms": 0.09218003879499381, "mean_env_wait_ms": 0.8982054966806554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035545825958251953, "StateBufferConnector_ms": 0.002828359603881836, "ViewRequirementAgentConnector_ms": 0.06719303131103516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51706080, "num_agent_steps_trained": 51706080, "num_env_steps_sampled": 51706080, "num_env_steps_trained": 51706080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.77055070887515, "num_env_steps_trained_throughput_per_sec": 104.77055070887515, "timesteps_total": 51706080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51706080, "timers": {"training_iteration_time_ms": 3299.645, "sample_time_ms": 3288.073, "load_time_ms": 0.332, "load_throughput": 1083022.12, "learn_time_ms": 10.384, "learn_throughput": 34668.843, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 51706080, "num_env_steps_trained": 51706080, "num_agent_steps_sampled": 51706080, "num_agent_steps_trained": 51706080}, "done": false, "episodes_total": 13085, "training_iteration": 4055, "trial_id": "ef964_00000", "date": "2023-08-08_14-23-42", "timestamp": 1691493822, "time_this_iter_s": 10.310994863510132, "time_total_s": 95627.55987000465, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2605.8804194927216, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 26.08666666666667, "ram_util_percent": 64.80666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.80158081054685, "policy_loss": -16985235.74375, "vf_loss": 16356238.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3968.0, "diff_num_grad_updates_vs_sampler_policy": 3967.0}}, "num_env_steps_sampled": 51707520, "num_env_steps_trained": 51707520, "num_agent_steps_sampled": 51707520, "num_agent_steps_trained": 51707520}, "sampler_results": {"episode_reward_max": -3000.080822166568, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3069.2490056954143, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732781986704005, "mean_inference_ms": 0.37874717907025357, "mean_action_processing_ms": 0.09219279180521077, "mean_env_wait_ms": 0.8982097678791358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554105758666992, "StateBufferConnector_ms": 0.0028219223022460938, "ViewRequirementAgentConnector_ms": 0.06711173057556152}}, "episode_reward_max": -3000.080822166568, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3069.2490056954143, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.4819764379554, -3024.3043395704744, -3000.080822166568, -3190.6474694147005, -3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732781986704005, "mean_inference_ms": 0.37874717907025357, "mean_action_processing_ms": 0.09219279180521077, "mean_env_wait_ms": 0.8982097678791358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554105758666992, "StateBufferConnector_ms": 0.0028219223022460938, "ViewRequirementAgentConnector_ms": 0.06711173057556152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51707520, "num_agent_steps_trained": 51707520, "num_env_steps_sampled": 51707520, "num_env_steps_trained": 51707520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.16526090296405, "num_env_steps_trained_throughput_per_sec": 110.16526090296405, "timesteps_total": 51707520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51707520, "timers": {"training_iteration_time_ms": 3306.032, "sample_time_ms": 3294.404, "load_time_ms": 0.334, "load_throughput": 1079074.852, "learn_time_ms": 10.445, "learn_throughput": 34466.099, "synch_weights_time_ms": 0.8}, "counters": {"num_env_steps_sampled": 51707520, "num_env_steps_trained": 51707520, "num_agent_steps_sampled": 51707520, "num_agent_steps_trained": 51707520}, "done": false, "episodes_total": 13089, "training_iteration": 4056, "trial_id": "ef964_00000", "date": "2023-08-08_14-23-55", "timestamp": 1691493835, "time_this_iter_s": 13.074144840240479, "time_total_s": 95640.6340148449, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2618.954564332962, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 20.62222222222222, "ram_util_percent": 62.03888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.0152282714844, "policy_loss": -6497423.25625, "vf_loss": 15987761.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3988.0, "diff_num_grad_updates_vs_sampler_policy": 3987.0}}, "num_env_steps_sampled": 51708960, "num_env_steps_trained": 51708960, "num_agent_steps_sampled": 51708960, "num_agent_steps_trained": 51708960}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.955306660689, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732567996288497, "mean_inference_ms": 0.37880424241824057, "mean_action_processing_ms": 0.09220535323245992, "mean_env_wait_ms": 0.8982265698440799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486221313476562, "StateBufferConnector_ms": 0.0028166770935058594, "ViewRequirementAgentConnector_ms": 0.06706809997558594}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.955306660689, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3122.6946144062276, -3069.2275886273383, -3094.3003799796747, -3022.992059640901, -3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732567996288497, "mean_inference_ms": 0.37880424241824057, "mean_action_processing_ms": 0.09220535323245992, "mean_env_wait_ms": 0.8982265698440799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486221313476562, "StateBufferConnector_ms": 0.0028166770935058594, "ViewRequirementAgentConnector_ms": 0.06706809997558594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51708960, "num_agent_steps_trained": 51708960, "num_env_steps_sampled": 51708960, "num_env_steps_trained": 51708960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.50076470370304, "num_env_steps_trained_throughput_per_sec": 110.50076470370304, "timesteps_total": 51708960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51708960, "timers": {"training_iteration_time_ms": 3312.079, "sample_time_ms": 3300.36, "load_time_ms": 0.331, "load_throughput": 1087076.631, "learn_time_ms": 10.533, "learn_throughput": 34177.294, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 51708960, "num_env_steps_trained": 51708960, "num_agent_steps_sampled": 51708960, "num_agent_steps_trained": 51708960}, "done": false, "episodes_total": 13093, "training_iteration": 4057, "trial_id": "ef964_00000", "date": "2023-08-08_14-24-08", "timestamp": 1691493848, "time_this_iter_s": 13.034250020980835, "time_total_s": 95653.66826486588, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2631.988814353943, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 19.642105263157895, "ram_util_percent": 62.11052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -367.1144775390625, "policy_loss": -3767969.9484375, "vf_loss": 15746813.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4008.0, "diff_num_grad_updates_vs_sampler_policy": 4007.0}}, "num_env_steps_sampled": 51710400, "num_env_steps_trained": 51710400, "num_agent_steps_sampled": 51710400, "num_agent_steps_trained": 51710400}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3071.4470131813223, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732349702531867, "mean_inference_ms": 0.3788595965622001, "mean_action_processing_ms": 0.0922176303443528, "mean_env_wait_ms": 0.8982409586596739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545999526977539, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.0670928955078125}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3071.4470131813223, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.264299060608, -3146.445489501067, -3070.9203517726705, -3024.3295009728645, -3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.732349702531867, "mean_inference_ms": 0.3788595965622001, "mean_action_processing_ms": 0.0922176303443528, "mean_env_wait_ms": 0.8982409586596739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545999526977539, "StateBufferConnector_ms": 0.0028159618377685547, "ViewRequirementAgentConnector_ms": 0.0670928955078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51710400, "num_agent_steps_trained": 51710400, "num_env_steps_sampled": 51710400, "num_env_steps_trained": 51710400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.26521680820947, "num_env_steps_trained_throughput_per_sec": 110.26521680820947, "timesteps_total": 51710400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51710400, "timers": {"training_iteration_time_ms": 3265.744, "sample_time_ms": 3254.949, "load_time_ms": 0.302, "load_throughput": 1192316.361, "learn_time_ms": 9.738, "learn_throughput": 36969.421, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 51710400, "num_env_steps_trained": 51710400, "num_agent_steps_sampled": 51710400, "num_agent_steps_trained": 51710400}, "done": false, "episodes_total": 13097, "training_iteration": 4058, "trial_id": "ef964_00000", "date": "2023-08-08_14-24-21", "timestamp": 1691493861, "time_this_iter_s": 13.062419891357422, "time_total_s": 95666.73068475723, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2645.0512342453003, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 19.883333333333336, "ram_util_percent": 62.28888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.302685546875, "policy_loss": -3451838.64375, "vf_loss": 15536170.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4028.0, "diff_num_grad_updates_vs_sampler_policy": 4027.0}}, "num_env_steps_sampled": 51711840, "num_env_steps_trained": 51711840, "num_agent_steps_sampled": 51711840, "num_agent_steps_trained": 51711840}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.9191766579065, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73211669289969, "mean_inference_ms": 0.37891284372206013, "mean_action_processing_ms": 0.09222957109835522, "mean_env_wait_ms": 0.8982464126250584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002814054489135742, "ViewRequirementAgentConnector_ms": 0.06700682640075684}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3192.7843809803517, "episode_reward_mean": -3070.9191766579065, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3192.7843809803517, -3046.1446719259934, -3048.2371539434216, -3091.7153339064366, -3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.73211669289969, "mean_inference_ms": 0.37891284372206013, "mean_action_processing_ms": 0.09222957109835522, "mean_env_wait_ms": 0.8982464126250584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002814054489135742, "ViewRequirementAgentConnector_ms": 0.06700682640075684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51711840, "num_agent_steps_trained": 51711840, "num_env_steps_sampled": 51711840, "num_env_steps_trained": 51711840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.65381796027663, "num_env_steps_trained_throughput_per_sec": 110.65381796027663, "timesteps_total": 51711840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51711840, "timers": {"training_iteration_time_ms": 3259.451, "sample_time_ms": 3248.625, "load_time_ms": 0.301, "load_throughput": 1195715.426, "learn_time_ms": 9.764, "learn_throughput": 36870.661, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51711840, "num_env_steps_trained": 51711840, "num_agent_steps_sampled": 51711840, "num_agent_steps_trained": 51711840}, "done": false, "episodes_total": 13101, "training_iteration": 4059, "trial_id": "ef964_00000", "date": "2023-08-08_14-24-34", "timestamp": 1691493874, "time_this_iter_s": 13.016337156295776, "time_total_s": 95679.74702191353, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2658.067571401596, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 20.510526315789477, "ram_util_percent": 62.09473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.8102722167969, "policy_loss": -9769534.7375, "vf_loss": 15684959.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4048.0, "diff_num_grad_updates_vs_sampler_policy": 4047.0}}, "num_env_steps_sampled": 51713280, "num_env_steps_trained": 51713280, "num_agent_steps_sampled": 51713280, "num_agent_steps_trained": 51713280}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3069.504162194083, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731880499007891, "mean_inference_ms": 0.378964236201087, "mean_action_processing_ms": 0.09224110332319038, "mean_env_wait_ms": 0.898252359209494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035440921783447266, "StateBufferConnector_ms": 0.0028128623962402344, "ViewRequirementAgentConnector_ms": 0.0669243335723877}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3069.504162194083, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3097.307216075492, -3070.7563371203737, -3024.276296735986, -3073.320646380243, -3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731880499007891, "mean_inference_ms": 0.378964236201087, "mean_action_processing_ms": 0.09224110332319038, "mean_env_wait_ms": 0.898252359209494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035440921783447266, "StateBufferConnector_ms": 0.0028128623962402344, "ViewRequirementAgentConnector_ms": 0.0669243335723877}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51713280, "num_agent_steps_trained": 51713280, "num_env_steps_sampled": 51713280, "num_env_steps_trained": 51713280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.61499325454876, "num_env_steps_trained_throughput_per_sec": 110.61499325454876, "timesteps_total": 51713280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51713280, "timers": {"training_iteration_time_ms": 3252.625, "sample_time_ms": 3241.814, "load_time_ms": 0.304, "load_throughput": 1183160.508, "learn_time_ms": 9.734, "learn_throughput": 36982.731, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 51713280, "num_env_steps_trained": 51713280, "num_agent_steps_sampled": 51713280, "num_agent_steps_trained": 51713280}, "done": false, "episodes_total": 13105, "training_iteration": 4060, "trial_id": "ef964_00000", "date": "2023-08-08_14-24-47", "timestamp": 1691493887, "time_this_iter_s": 13.021204948425293, "time_total_s": 95692.76822686195, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2671.0887763500214, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 18.761111111111116, "ram_util_percent": 62.25555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.23671264648436, "policy_loss": -10870245.721875, "vf_loss": 16228412.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4068.0, "diff_num_grad_updates_vs_sampler_policy": 4067.0}}, "num_env_steps_sampled": 51714720, "num_env_steps_trained": 51714720, "num_agent_steps_sampled": 51714720, "num_agent_steps_trained": 51714720}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3069.688352988284, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731624702036684, "mean_inference_ms": 0.37901414054860594, "mean_action_processing_ms": 0.0922523797831223, "mean_env_wait_ms": 0.8982604125442404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035436153411865234, "StateBufferConnector_ms": 0.002813100814819336, "ViewRequirementAgentConnector_ms": 0.06691741943359375}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3069.688352988284, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.3714975322473, -3048.7883947677124, -3070.6443977328727, -3094.9584477212015, -3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731624702036684, "mean_inference_ms": 0.37901414054860594, "mean_action_processing_ms": 0.0922523797831223, "mean_env_wait_ms": 0.8982604125442404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035436153411865234, "StateBufferConnector_ms": 0.002813100814819336, "ViewRequirementAgentConnector_ms": 0.06691741943359375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51714720, "num_agent_steps_trained": 51714720, "num_env_steps_sampled": 51714720, "num_env_steps_trained": 51714720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.41782981913171, "num_env_steps_trained_throughput_per_sec": 112.41782981913171, "timesteps_total": 51714720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51714720, "timers": {"training_iteration_time_ms": 3230.769, "sample_time_ms": 3219.982, "load_time_ms": 0.303, "load_throughput": 1189873.475, "learn_time_ms": 9.713, "learn_throughput": 37062.432, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51714720, "num_env_steps_trained": 51714720, "num_agent_steps_sampled": 51714720, "num_agent_steps_trained": 51714720}, "done": false, "episodes_total": 13109, "training_iteration": 4061, "trial_id": "ef964_00000", "date": "2023-08-08_14-25-00", "timestamp": 1691493900, "time_this_iter_s": 12.8122718334198, "time_total_s": 95705.58049869537, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2683.901048183441, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 22.515789473684215, "ram_util_percent": 62.27368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -366.2835205078125, "policy_loss": -7759702.10625, "vf_loss": 15970721.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4088.0, "diff_num_grad_updates_vs_sampler_policy": 4087.0}}, "num_env_steps_sampled": 51716160, "num_env_steps_trained": 51716160, "num_agent_steps_sampled": 51716160, "num_agent_steps_trained": 51716160}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3069.825251349076, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731358838037065, "mean_inference_ms": 0.3790626005159485, "mean_action_processing_ms": 0.09226334425071352, "mean_env_wait_ms": 0.8982674399398937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542184829711914, "StateBufferConnector_ms": 0.002814054489135742, "ViewRequirementAgentConnector_ms": 0.06690001487731934}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3069.825251349076, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3118.9575841931205, -3094.124395710736, -3094.282432380623, -3120.3409812810055, -3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731358838037065, "mean_inference_ms": 0.3790626005159485, "mean_action_processing_ms": 0.09226334425071352, "mean_env_wait_ms": 0.8982674399398937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542184829711914, "StateBufferConnector_ms": 0.002814054489135742, "ViewRequirementAgentConnector_ms": 0.06690001487731934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51716160, "num_agent_steps_trained": 51716160, "num_env_steps_sampled": 51716160, "num_env_steps_trained": 51716160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.9623881447983, "num_env_steps_trained_throughput_per_sec": 109.9623881447983, "timesteps_total": 51716160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51716160, "timers": {"training_iteration_time_ms": 3237.556, "sample_time_ms": 3226.763, "load_time_ms": 0.301, "load_throughput": 1196378.607, "learn_time_ms": 9.722, "learn_throughput": 37029.258, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51716160, "num_env_steps_trained": 51716160, "num_agent_steps_sampled": 51716160, "num_agent_steps_trained": 51716160}, "done": false, "episodes_total": 13113, "training_iteration": 4062, "trial_id": "ef964_00000", "date": "2023-08-08_14-25-13", "timestamp": 1691493913, "time_this_iter_s": 13.098219156265259, "time_total_s": 95718.67871785164, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2696.9992673397064, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 18.2, "ram_util_percent": 62.349999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.056884765625, "policy_loss": 319762.903125, "vf_loss": 14941489.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4108.0, "diff_num_grad_updates_vs_sampler_policy": 4107.0}}, "num_env_steps_sampled": 51717600, "num_env_steps_trained": 51717600, "num_agent_steps_sampled": 51717600, "num_agent_steps_trained": 51717600}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3066.739171013878, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731055629738169, "mean_inference_ms": 0.3791094850807586, "mean_action_processing_ms": 0.09227396119186519, "mean_env_wait_ms": 0.8982559737528064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003538846969604492, "StateBufferConnector_ms": 0.002814769744873047, "ViewRequirementAgentConnector_ms": 0.06684231758117676}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3066.739171013878, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3002.8098984397297, -3069.4622272766956, -3145.3878234904396, -3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.731055629738169, "mean_inference_ms": 0.3791094850807586, "mean_action_processing_ms": 0.09227396119186519, "mean_env_wait_ms": 0.8982559737528064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003538846969604492, "StateBufferConnector_ms": 0.002814769744873047, "ViewRequirementAgentConnector_ms": 0.06684231758117676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51717600, "num_agent_steps_trained": 51717600, "num_env_steps_sampled": 51717600, "num_env_steps_trained": 51717600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.1195897191507, "num_env_steps_trained_throughput_per_sec": 112.1195897191507, "timesteps_total": 51717600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51717600, "timers": {"training_iteration_time_ms": 3248.208, "sample_time_ms": 3237.38, "load_time_ms": 0.303, "load_throughput": 1188842.957, "learn_time_ms": 9.744, "learn_throughput": 36946.444, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 51717600, "num_env_steps_trained": 51717600, "num_agent_steps_sampled": 51717600, "num_agent_steps_trained": 51717600}, "done": false, "episodes_total": 13117, "training_iteration": 4063, "trial_id": "ef964_00000", "date": "2023-08-08_14-25-26", "timestamp": 1691493926, "time_this_iter_s": 12.846338987350464, "time_total_s": 95731.52505683899, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2709.845606327057, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 20.96842105263158, "ram_util_percent": 62.31578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.94793701171875, "policy_loss": -10767989.6375, "vf_loss": 15970185.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4123.0, "diff_num_grad_updates_vs_sampler_policy": 4122.0}}, "num_env_steps_sampled": 51718680, "num_env_steps_trained": 51718680, "num_agent_steps_sampled": 51718680, "num_agent_steps_trained": 51718680}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3066.2723694725514, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730847635414385, "mean_inference_ms": 0.3791583378933259, "mean_action_processing_ms": 0.09228483036770405, "mean_env_wait_ms": 0.8982565222853242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037071704864501953, "StateBufferConnector_ms": 0.002856016159057617, "ViewRequirementAgentConnector_ms": 0.06774067878723145}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3168.034861712901, "episode_reward_mean": -3066.2723694725514, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3072.4259223795984, -3048.555998631345, -3140.5710723698594, -3070.720612505369, -3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730847635414385, "mean_inference_ms": 0.3791583378933259, "mean_action_processing_ms": 0.09228483036770405, "mean_env_wait_ms": 0.8982565222853242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037071704864501953, "StateBufferConnector_ms": 0.002856016159057617, "ViewRequirementAgentConnector_ms": 0.06774067878723145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51718680, "num_agent_steps_trained": 51718680, "num_env_steps_sampled": 51718680, "num_env_steps_trained": 51718680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.66137888209703, "num_env_steps_trained_throughput_per_sec": 103.66137888209703, "timesteps_total": 51718680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51718680, "timers": {"training_iteration_time_ms": 3314.024, "sample_time_ms": 3303.219, "load_time_ms": 0.302, "load_throughput": 1192504.691, "learn_time_ms": 9.725, "learn_throughput": 37019.544, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 51718680, "num_env_steps_trained": 51718680, "num_agent_steps_sampled": 51718680, "num_agent_steps_trained": 51718680}, "done": false, "episodes_total": 13120, "training_iteration": 4064, "trial_id": "ef964_00000", "date": "2023-08-08_14-25-37", "timestamp": 1691493937, "time_this_iter_s": 10.421431064605713, "time_total_s": 95741.9464879036, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2720.2670373916626, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 26.126666666666665, "ram_util_percent": 61.63999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.83823852539064, "policy_loss": -14202462.3, "vf_loss": 17137228.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4143.0, "diff_num_grad_updates_vs_sampler_policy": 4142.0}}, "num_env_steps_sampled": 51720120, "num_env_steps_trained": 51720120, "num_agent_steps_sampled": 51720120, "num_agent_steps_trained": 51720120}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3068.575696647157, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730562966277168, "mean_inference_ms": 0.3792219608767266, "mean_action_processing_ms": 0.0922991292280626, "mean_env_wait_ms": 0.8982637802790072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036978721618652344, "StateBufferConnector_ms": 0.0028595924377441406, "ViewRequirementAgentConnector_ms": 0.0677947998046875}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3068.575696647157, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3165.110903025521, -3071.168202297927, -3025.9658517996654, -3095.6007482238583, -3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730562966277168, "mean_inference_ms": 0.3792219608767266, "mean_action_processing_ms": 0.0922991292280626, "mean_env_wait_ms": 0.8982637802790072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036978721618652344, "StateBufferConnector_ms": 0.0028595924377441406, "ViewRequirementAgentConnector_ms": 0.0677947998046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51720120, "num_agent_steps_trained": 51720120, "num_env_steps_sampled": 51720120, "num_env_steps_trained": 51720120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.9961363473988, "num_env_steps_trained_throughput_per_sec": 109.9961363473988, "timesteps_total": 51720120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51720120, "timers": {"training_iteration_time_ms": 3309.34, "sample_time_ms": 3298.491, "load_time_ms": 0.299, "load_throughput": 1202476.26, "learn_time_ms": 9.777, "learn_throughput": 36820.581, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 51720120, "num_env_steps_trained": 51720120, "num_agent_steps_sampled": 51720120, "num_agent_steps_trained": 51720120}, "done": false, "episodes_total": 13124, "training_iteration": 4065, "trial_id": "ef964_00000", "date": "2023-08-08_14-25-50", "timestamp": 1691493950, "time_this_iter_s": 13.09422492980957, "time_total_s": 95755.0407128334, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2733.361262321472, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 19.944444444444443, "ram_util_percent": 61.02222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.7982177734375, "policy_loss": -6193544.33125, "vf_loss": 15379291.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4163.0, "diff_num_grad_updates_vs_sampler_policy": 4162.0}}, "num_env_steps_sampled": 51721560, "num_env_steps_trained": 51721560, "num_agent_steps_sampled": 51721560, "num_agent_steps_trained": 51721560}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3067.180844545981, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730283119127666, "mean_inference_ms": 0.37928229434829364, "mean_action_processing_ms": 0.0923127333019011, "mean_env_wait_ms": 0.898262125736384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037102699279785156, "StateBufferConnector_ms": 0.0028641223907470703, "ViewRequirementAgentConnector_ms": 0.06781482696533203}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3067.180844545981, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.224192608802, -3091.3102760645224, -3072.0606874859427, -3045.688003619738, -3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730283119127666, "mean_inference_ms": 0.37928229434829364, "mean_action_processing_ms": 0.0923127333019011, "mean_env_wait_ms": 0.898262125736384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037102699279785156, "StateBufferConnector_ms": 0.0028641223907470703, "ViewRequirementAgentConnector_ms": 0.06781482696533203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51721560, "num_agent_steps_trained": 51721560, "num_env_steps_sampled": 51721560, "num_env_steps_trained": 51721560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.70526748901194, "num_env_steps_trained_throughput_per_sec": 110.70526748901194, "timesteps_total": 51721560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51721560, "timers": {"training_iteration_time_ms": 3260.542, "sample_time_ms": 3249.759, "load_time_ms": 0.301, "load_throughput": 1195147.57, "learn_time_ms": 9.716, "learn_throughput": 37051.883, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51721560, "num_env_steps_trained": 51721560, "num_agent_steps_sampled": 51721560, "num_agent_steps_trained": 51721560}, "done": false, "episodes_total": 13128, "training_iteration": 4066, "trial_id": "ef964_00000", "date": "2023-08-08_14-26-03", "timestamp": 1691493963, "time_this_iter_s": 13.010353088378906, "time_total_s": 95768.05106592178, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2746.371615409851, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 20.03684210526316, "ram_util_percent": 61.17894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.0567993164062, "policy_loss": 319762.9125, "vf_loss": 14941495.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4183.0, "diff_num_grad_updates_vs_sampler_policy": 4182.0}}, "num_env_steps_sampled": 51723000, "num_env_steps_trained": 51723000, "num_agent_steps_sampled": 51723000, "num_agent_steps_trained": 51723000}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3066.291852915879, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730018939898385, "mean_inference_ms": 0.37934067666188154, "mean_action_processing_ms": 0.09232593278677637, "mean_env_wait_ms": 0.898257306141494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036983489990234375, "StateBufferConnector_ms": 0.0028624534606933594, "ViewRequirementAgentConnector_ms": 0.06770515441894531}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3066.291852915879, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.1622310406437, -3095.494163707664, -3027.4988156028116, -3046.9844916679267, -3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.730018939898385, "mean_inference_ms": 0.37934067666188154, "mean_action_processing_ms": 0.09232593278677637, "mean_env_wait_ms": 0.898257306141494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036983489990234375, "StateBufferConnector_ms": 0.0028624534606933594, "ViewRequirementAgentConnector_ms": 0.06770515441894531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51723000, "num_agent_steps_trained": 51723000, "num_env_steps_sampled": 51723000, "num_env_steps_trained": 51723000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.61256837468325, "num_env_steps_trained_throughput_per_sec": 110.61256837468325, "timesteps_total": 51723000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51723000, "timers": {"training_iteration_time_ms": 3257.076, "sample_time_ms": 3246.271, "load_time_ms": 0.302, "load_throughput": 1192598.878, "learn_time_ms": 9.727, "learn_throughput": 37011.195, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 51723000, "num_env_steps_trained": 51723000, "num_agent_steps_sampled": 51723000, "num_agent_steps_trained": 51723000}, "done": false, "episodes_total": 13132, "training_iteration": 4067, "trial_id": "ef964_00000", "date": "2023-08-08_14-26-16", "timestamp": 1691493976, "time_this_iter_s": 13.021264791488647, "time_total_s": 95781.07233071327, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2759.3928802013397, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 18.516666666666666, "ram_util_percent": 61.01111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.1388793945313, "policy_loss": -23780001.75, "vf_loss": 16964788.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4203.0, "diff_num_grad_updates_vs_sampler_policy": 4202.0}}, "num_env_steps_sampled": 51724440, "num_env_steps_trained": 51724440, "num_agent_steps_sampled": 51724440, "num_agent_steps_trained": 51724440}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3068.537352729132, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.729746071401382, "mean_inference_ms": 0.37939821783700706, "mean_action_processing_ms": 0.09233890350458672, "mean_env_wait_ms": 0.8982582626558666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036945343017578125, "StateBufferConnector_ms": 0.002856016159057617, "ViewRequirementAgentConnector_ms": 0.06765890121459961}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3068.537352729132, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.390723298235, -3093.9776612245646, -3045.9784011598776, -3097.4241798749185, -3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.729746071401382, "mean_inference_ms": 0.37939821783700706, "mean_action_processing_ms": 0.09233890350458672, "mean_env_wait_ms": 0.8982582626558666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036945343017578125, "StateBufferConnector_ms": 0.002856016159057617, "ViewRequirementAgentConnector_ms": 0.06765890121459961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51724440, "num_agent_steps_trained": 51724440, "num_env_steps_sampled": 51724440, "num_env_steps_trained": 51724440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.79323677918826, "num_env_steps_trained_throughput_per_sec": 109.79323677918826, "timesteps_total": 51724440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51724440, "timers": {"training_iteration_time_ms": 3261.355, "sample_time_ms": 3250.611, "load_time_ms": 0.304, "load_throughput": 1185203.642, "learn_time_ms": 9.667, "learn_throughput": 37239.027, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 51724440, "num_env_steps_trained": 51724440, "num_agent_steps_sampled": 51724440, "num_agent_steps_trained": 51724440}, "done": false, "episodes_total": 13136, "training_iteration": 4068, "trial_id": "ef964_00000", "date": "2023-08-08_14-26-29", "timestamp": 1691493989, "time_this_iter_s": 13.118352890014648, "time_total_s": 95794.19068360329, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2772.5112330913544, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 19.589473684210525, "ram_util_percent": 60.857894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -366.4477600097656, "policy_loss": -5349492.71875, "vf_loss": 16176885.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4223.0, "diff_num_grad_updates_vs_sampler_policy": 4222.0}}, "num_env_steps_sampled": 51725880, "num_env_steps_trained": 51725880, "num_agent_steps_sampled": 51725880, "num_agent_steps_trained": 51725880}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3068.5221355004337, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.729471063477722, "mean_inference_ms": 0.379454784586533, "mean_action_processing_ms": 0.09235172807545049, "mean_env_wait_ms": 0.8982577962348217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702878952026367, "StateBufferConnector_ms": 0.0028526782989501953, "ViewRequirementAgentConnector_ms": 0.06760025024414062}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3068.5221355004337, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.354966682774, -3048.1688200629414, -3048.869020450578, -3002.768965320687, -3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.729471063477722, "mean_inference_ms": 0.379454784586533, "mean_action_processing_ms": 0.09235172807545049, "mean_env_wait_ms": 0.8982577962348217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702878952026367, "StateBufferConnector_ms": 0.0028526782989501953, "ViewRequirementAgentConnector_ms": 0.06760025024414062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51725880, "num_agent_steps_trained": 51725880, "num_env_steps_sampled": 51725880, "num_env_steps_trained": 51725880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.94954876122668, "num_env_steps_trained_throughput_per_sec": 109.94954876122668, "timesteps_total": 51725880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51725880, "timers": {"training_iteration_time_ms": 3267.557, "sample_time_ms": 3256.848, "load_time_ms": 0.301, "load_throughput": 1195147.57, "learn_time_ms": 9.638, "learn_throughput": 37351.318, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 51725880, "num_env_steps_trained": 51725880, "num_agent_steps_sampled": 51725880, "num_agent_steps_trained": 51725880}, "done": false, "episodes_total": 13140, "training_iteration": 4069, "trial_id": "ef964_00000", "date": "2023-08-08_14-26-42", "timestamp": 1691494002, "time_this_iter_s": 13.099725246429443, "time_total_s": 95807.29040884972, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2785.610958337784, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 17.950000000000003, "ram_util_percent": 60.87777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.8254760742187, "policy_loss": -8713998.8125, "vf_loss": 15596236.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4243.0, "diff_num_grad_updates_vs_sampler_policy": 4242.0}}, "num_env_steps_sampled": 51727320, "num_env_steps_trained": 51727320, "num_agent_steps_sampled": 51727320, "num_agent_steps_trained": 51727320}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3069.4482020337414, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.729217031693252, "mean_inference_ms": 0.37951128652313676, "mean_action_processing_ms": 0.09236453774135937, "mean_env_wait_ms": 0.8982624676677764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037055015563964844, "StateBufferConnector_ms": 0.0028772354125976562, "ViewRequirementAgentConnector_ms": 0.0675954818725586}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3069.4482020337414, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3118.1910415232105, -3070.8278824741483, -3047.060601929071, -3021.864867942309, -3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.729217031693252, "mean_inference_ms": 0.37951128652313676, "mean_action_processing_ms": 0.09236453774135937, "mean_env_wait_ms": 0.8982624676677764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037055015563964844, "StateBufferConnector_ms": 0.0028772354125976562, "ViewRequirementAgentConnector_ms": 0.0675954818725586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51727320, "num_agent_steps_trained": 51727320, "num_env_steps_sampled": 51727320, "num_env_steps_trained": 51727320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.7664447208063, "num_env_steps_trained_throughput_per_sec": 111.7664447208063, "timesteps_total": 51727320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51727320, "timers": {"training_iteration_time_ms": 3262.676, "sample_time_ms": 3251.938, "load_time_ms": 0.303, "load_throughput": 1187440.579, "learn_time_ms": 9.679, "learn_throughput": 37195.729, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 51727320, "num_env_steps_trained": 51727320, "num_agent_steps_sampled": 51727320, "num_agent_steps_trained": 51727320}, "done": false, "episodes_total": 13144, "training_iteration": 4070, "trial_id": "ef964_00000", "date": "2023-08-08_14-26-55", "timestamp": 1691494015, "time_this_iter_s": 12.886851787567139, "time_total_s": 95820.17726063728, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2798.497810125351, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 20.94736842105263, "ram_util_percent": 60.84210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.3277648925781, "policy_loss": -17266663.45, "vf_loss": 16484720.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4263.0, "diff_num_grad_updates_vs_sampler_policy": 4262.0}}, "num_env_steps_sampled": 51728760, "num_env_steps_trained": 51728760, "num_agent_steps_sampled": 51728760, "num_agent_steps_trained": 51728760}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3070.013576957582, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.728988968642934, "mean_inference_ms": 0.3795433485196354, "mean_action_processing_ms": 0.09237230672244329, "mean_env_wait_ms": 0.8982431929554962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686666488647461, "StateBufferConnector_ms": 0.002852201461791992, "ViewRequirementAgentConnector_ms": 0.06724262237548828}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3070.013576957582, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3024.2840640651543, -3167.9546206198806, -3025.371321824444, -3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.728988968642934, "mean_inference_ms": 0.3795433485196354, "mean_action_processing_ms": 0.09237230672244329, "mean_env_wait_ms": 0.8982431929554962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686666488647461, "StateBufferConnector_ms": 0.002852201461791992, "ViewRequirementAgentConnector_ms": 0.06724262237548828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51728760, "num_agent_steps_trained": 51728760, "num_env_steps_sampled": 51728760, "num_env_steps_trained": 51728760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.03315861887438, "num_env_steps_trained_throughput_per_sec": 110.03315861887438, "timesteps_total": 51728760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51728760, "timers": {"training_iteration_time_ms": 3251.0, "sample_time_ms": 3240.17, "load_time_ms": 0.304, "load_throughput": 1182326.709, "learn_time_ms": 9.77, "learn_throughput": 36849.336, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 51728760, "num_env_steps_trained": 51728760, "num_agent_steps_sampled": 51728760, "num_agent_steps_trained": 51728760}, "done": false, "episodes_total": 13148, "training_iteration": 4071, "trial_id": "ef964_00000", "date": "2023-08-08_14-27-08", "timestamp": 1691494028, "time_this_iter_s": 13.08978009223938, "time_total_s": 95833.26704072952, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2811.5875902175903, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 20.105555555555554, "ram_util_percent": 60.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.54027099609374, "policy_loss": -18504859.31875, "vf_loss": 16336473.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4278.0, "diff_num_grad_updates_vs_sampler_policy": 4277.0}}, "num_env_steps_sampled": 51729840, "num_env_steps_trained": 51729840, "num_agent_steps_sampled": 51729840, "num_agent_steps_trained": 51729840}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3072.027211113627, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.728830493439716, "mean_inference_ms": 0.37957874221225113, "mean_action_processing_ms": 0.09238078054203255, "mean_env_wait_ms": 0.8982588960417539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0028727054595947266, "ViewRequirementAgentConnector_ms": 0.06797385215759277}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3072.027211113627, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.60075808014, -3096.026901174957, -3094.7948393984116, -3046.438481872937, -3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.728830493439716, "mean_inference_ms": 0.37957874221225113, "mean_action_processing_ms": 0.09238078054203255, "mean_env_wait_ms": 0.8982588960417539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0028727054595947266, "ViewRequirementAgentConnector_ms": 0.06797385215759277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51729840, "num_agent_steps_trained": 51729840, "num_env_steps_sampled": 51729840, "num_env_steps_trained": 51729840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.44331784323275, "num_env_steps_trained_throughput_per_sec": 104.44331784323275, "timesteps_total": 51729840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 51729840, "timers": {"training_iteration_time_ms": 3310.776, "sample_time_ms": 3299.888, "load_time_ms": 0.305, "load_throughput": 1179095.299, "learn_time_ms": 9.815, "learn_throughput": 36678.102, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51729840, "num_env_steps_trained": 51729840, "num_agent_steps_sampled": 51729840, "num_agent_steps_trained": 51729840}, "done": false, "episodes_total": 13151, "training_iteration": 4072, "trial_id": "ef964_00000", "date": "2023-08-08_14-27-18", "timestamp": 1691494038, "time_this_iter_s": 10.343358993530273, "time_total_s": 95843.61039972305, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2821.9309492111206, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 27.246666666666666, "ram_util_percent": 61.013333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -372.96156005859376, "policy_loss": -2906487.315625, "vf_loss": 15897778.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4298.0, "diff_num_grad_updates_vs_sampler_policy": 4297.0}}, "num_env_steps_sampled": 51731280, "num_env_steps_trained": 51731280, "num_agent_steps_sampled": 51731280, "num_agent_steps_trained": 51731280}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3072.3329762412486, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.728536886099862, "mean_inference_ms": 0.37962098778131165, "mean_action_processing_ms": 0.09239117403257545, "mean_env_wait_ms": 0.8982841563874808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037031173706054688, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.06773900985717773}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3072.3329762412486, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3050.596445618968, -3095.4117712275875, -3117.0335870725226, -3024.4119970645293, -3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.728536886099862, "mean_inference_ms": 0.37962098778131165, "mean_action_processing_ms": 0.09239117403257545, "mean_env_wait_ms": 0.8982841563874808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037031173706054688, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.06773900985717773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51731280, "num_agent_steps_trained": 51731280, "num_env_steps_sampled": 51731280, "num_env_steps_trained": 51731280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.29271388144195, "num_env_steps_trained_throughput_per_sec": 110.29271388144195, "timesteps_total": 51731280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51731280, "timers": {"training_iteration_time_ms": 3323.053, "sample_time_ms": 3312.074, "load_time_ms": 0.302, "load_throughput": 1191187.63, "learn_time_ms": 9.914, "learn_throughput": 36310.827, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51731280, "num_env_steps_trained": 51731280, "num_agent_steps_sampled": 51731280, "num_agent_steps_trained": 51731280}, "done": false, "episodes_total": 13155, "training_iteration": 4073, "trial_id": "ef964_00000", "date": "2023-08-08_14-27-32", "timestamp": 1691494052, "time_this_iter_s": 13.058995008468628, "time_total_s": 95856.66939473152, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2834.9899442195892, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 18.049999999999997, "ram_util_percent": 60.72222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -376.7535339355469, "policy_loss": -949240.78125, "vf_loss": 15234258.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4318.0, "diff_num_grad_updates_vs_sampler_policy": 4317.0}}, "num_env_steps_sampled": 51732720, "num_env_steps_trained": 51732720, "num_agent_steps_sampled": 51732720, "num_agent_steps_trained": 51732720}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3070.664875492922, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.728183432786716, "mean_inference_ms": 0.37964295816426696, "mean_action_processing_ms": 0.09239741807731308, "mean_env_wait_ms": 0.8982720455239877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693103790283203, "StateBufferConnector_ms": 0.0028464794158935547, "ViewRequirementAgentConnector_ms": 0.06752562522888184}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3070.664875492922, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3075.6342746545456, -3074.042904823372, -3045.8073498760145, -3021.8656621567106, -3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.728183432786716, "mean_inference_ms": 0.37964295816426696, "mean_action_processing_ms": 0.09239741807731308, "mean_env_wait_ms": 0.8982720455239877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693103790283203, "StateBufferConnector_ms": 0.0028464794158935547, "ViewRequirementAgentConnector_ms": 0.06752562522888184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51732720, "num_agent_steps_trained": 51732720, "num_env_steps_sampled": 51732720, "num_env_steps_trained": 51732720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.61329967646175, "num_env_steps_trained_throughput_per_sec": 110.61329967646175, "timesteps_total": 51732720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51732720, "timers": {"training_iteration_time_ms": 3312.82, "sample_time_ms": 3301.988, "load_time_ms": 0.3, "load_throughput": 1199991.608, "learn_time_ms": 9.767, "learn_throughput": 36858.061, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51732720, "num_env_steps_trained": 51732720, "num_agent_steps_sampled": 51732720, "num_agent_steps_trained": 51732720}, "done": false, "episodes_total": 13159, "training_iteration": 4074, "trial_id": "ef964_00000", "date": "2023-08-08_14-27-45", "timestamp": 1691494065, "time_this_iter_s": 13.021186113357544, "time_total_s": 95869.69058084488, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2848.011130332947, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 20.021052631578947, "ram_util_percent": 61.173684210526304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -360.5346435546875, "policy_loss": -19345234.2625, "vf_loss": 16023686.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4338.0, "diff_num_grad_updates_vs_sampler_policy": 4337.0}}, "num_env_steps_sampled": 51734160, "num_env_steps_trained": 51734160, "num_agent_steps_sampled": 51734160, "num_agent_steps_trained": 51734160}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3071.0223212091123, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7278272877390695, "mean_inference_ms": 0.3796648703582373, "mean_action_processing_ms": 0.09240369625858072, "mean_env_wait_ms": 0.8982616430247569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036776065826416016, "StateBufferConnector_ms": 0.002847909927368164, "ViewRequirementAgentConnector_ms": 0.06744241714477539}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3071.0223212091123, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3092.933009945153, -3023.002650198823, -3049.0412936036037, -3050.6623521552406, -3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7278272877390695, "mean_inference_ms": 0.3796648703582373, "mean_action_processing_ms": 0.09240369625858072, "mean_env_wait_ms": 0.8982616430247569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036776065826416016, "StateBufferConnector_ms": 0.002847909927368164, "ViewRequirementAgentConnector_ms": 0.06744241714477539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51734160, "num_agent_steps_trained": 51734160, "num_env_steps_sampled": 51734160, "num_env_steps_trained": 51734160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.27056976940283, "num_env_steps_trained_throughput_per_sec": 110.27056976940283, "timesteps_total": 51734160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51734160, "timers": {"training_iteration_time_ms": 3260.182, "sample_time_ms": 3249.353, "load_time_ms": 0.299, "load_throughput": 1203626.497, "learn_time_ms": 9.77, "learn_throughput": 36846.279, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 51734160, "num_env_steps_trained": 51734160, "num_agent_steps_sampled": 51734160, "num_agent_steps_trained": 51734160}, "done": false, "episodes_total": 13163, "training_iteration": 4075, "trial_id": "ef964_00000", "date": "2023-08-08_14-27-58", "timestamp": 1691494078, "time_this_iter_s": 13.061676025390625, "time_total_s": 95882.75225687027, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2861.0728063583374, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 20.27777777777778, "ram_util_percent": 61.37222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.50902099609374, "policy_loss": -10637229.359375, "vf_loss": 15958420.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4358.0, "diff_num_grad_updates_vs_sampler_policy": 4357.0}}, "num_env_steps_sampled": 51735600, "num_env_steps_trained": 51735600, "num_agent_steps_sampled": 51735600, "num_agent_steps_trained": 51735600}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3071.278463179727, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.727472190310948, "mean_inference_ms": 0.3796866553650651, "mean_action_processing_ms": 0.09240997530351777, "mean_env_wait_ms": 0.8982534355771228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681659698486328, "StateBufferConnector_ms": 0.0028505325317382812, "ViewRequirementAgentConnector_ms": 0.06743264198303223}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3071.278463179727, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3069.4123075791426, -3024.0303085151945, -3143.027666561514, -3048.8721673685077, -3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.727472190310948, "mean_inference_ms": 0.3796866553650651, "mean_action_processing_ms": 0.09240997530351777, "mean_env_wait_ms": 0.8982534355771228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681659698486328, "StateBufferConnector_ms": 0.0028505325317382812, "ViewRequirementAgentConnector_ms": 0.06743264198303223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51735600, "num_agent_steps_trained": 51735600, "num_env_steps_sampled": 51735600, "num_env_steps_trained": 51735600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.78278656651372, "num_env_steps_trained_throughput_per_sec": 110.78278656651372, "timesteps_total": 51735600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51735600, "timers": {"training_iteration_time_ms": 3257.821, "sample_time_ms": 3246.932, "load_time_ms": 0.301, "load_throughput": 1195620.746, "learn_time_ms": 9.828, "learn_throughput": 36628.455, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 51735600, "num_env_steps_trained": 51735600, "num_agent_steps_sampled": 51735600, "num_agent_steps_trained": 51735600}, "done": false, "episodes_total": 13167, "training_iteration": 4076, "trial_id": "ef964_00000", "date": "2023-08-08_14-28-11", "timestamp": 1691494091, "time_this_iter_s": 13.00113296508789, "time_total_s": 95895.75338983536, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2874.0739393234253, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 19.9, "ram_util_percent": 61.55789473684209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.1636169433594, "policy_loss": -6435792.571875, "vf_loss": 15504935.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4378.0, "diff_num_grad_updates_vs_sampler_policy": 4377.0}}, "num_env_steps_sampled": 51737040, "num_env_steps_trained": 51737040, "num_agent_steps_sampled": 51737040, "num_agent_steps_trained": 51737040}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3071.017017715973, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.727115802660183, "mean_inference_ms": 0.3797088251909491, "mean_action_processing_ms": 0.09241636726408956, "mean_env_wait_ms": 0.8982461763870998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037012100219726562, "StateBufferConnector_ms": 0.0028569698333740234, "ViewRequirementAgentConnector_ms": 0.06753206253051758}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3071.017017715973, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3116.720401246556, -3044.8501745856743, -3023.004054556724, -3045.3286629157496, -3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.727115802660183, "mean_inference_ms": 0.3797088251909491, "mean_action_processing_ms": 0.09241636726408956, "mean_env_wait_ms": 0.8982461763870998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037012100219726562, "StateBufferConnector_ms": 0.0028569698333740234, "ViewRequirementAgentConnector_ms": 0.06753206253051758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51737040, "num_agent_steps_trained": 51737040, "num_env_steps_sampled": 51737040, "num_env_steps_trained": 51737040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.99133373067356, "num_env_steps_trained_throughput_per_sec": 110.99133373067356, "timesteps_total": 51737040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51737040, "timers": {"training_iteration_time_ms": 3255.571, "sample_time_ms": 3244.789, "load_time_ms": 0.303, "load_throughput": 1188468.666, "learn_time_ms": 9.729, "learn_throughput": 37003.214, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 51737040, "num_env_steps_trained": 51737040, "num_agent_steps_sampled": 51737040, "num_agent_steps_trained": 51737040}, "done": false, "episodes_total": 13171, "training_iteration": 4077, "trial_id": "ef964_00000", "date": "2023-08-08_14-28-24", "timestamp": 1691494104, "time_this_iter_s": 12.976798057556152, "time_total_s": 95908.73018789291, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2887.0507373809814, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 19.794444444444444, "ram_util_percent": 61.227777777777774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -370.5764526367187, "policy_loss": -2936018.325, "vf_loss": 15611910.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4398.0, "diff_num_grad_updates_vs_sampler_policy": 4397.0}}, "num_env_steps_sampled": 51738480, "num_env_steps_trained": 51738480, "num_agent_steps_sampled": 51738480, "num_agent_steps_trained": 51738480}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3072.5392344978663, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.726786101797508, "mean_inference_ms": 0.3797309574967898, "mean_action_processing_ms": 0.09242279754604084, "mean_env_wait_ms": 0.8982465676213508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699064254760742, "StateBufferConnector_ms": 0.0028641223907470703, "ViewRequirementAgentConnector_ms": 0.06757616996765137}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3072.5392344978663, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.099327852575, -3047.205392168715, -3143.412602156223, -3071.3836323994756, -3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.726786101797508, "mean_inference_ms": 0.3797309574967898, "mean_action_processing_ms": 0.09242279754604084, "mean_env_wait_ms": 0.8982465676213508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699064254760742, "StateBufferConnector_ms": 0.0028641223907470703, "ViewRequirementAgentConnector_ms": 0.06757616996765137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51738480, "num_agent_steps_trained": 51738480, "num_env_steps_sampled": 51738480, "num_env_steps_trained": 51738480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.63503636086055, "num_env_steps_trained_throughput_per_sec": 108.63503636086055, "timesteps_total": 51738480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51738480, "timers": {"training_iteration_time_ms": 3275.841, "sample_time_ms": 3265.022, "load_time_ms": 0.303, "load_throughput": 1189779.718, "learn_time_ms": 9.75, "learn_throughput": 36921.239, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51738480, "num_env_steps_trained": 51738480, "num_agent_steps_sampled": 51738480, "num_agent_steps_trained": 51738480}, "done": false, "episodes_total": 13175, "training_iteration": 4078, "trial_id": "ef964_00000", "date": "2023-08-08_14-28-37", "timestamp": 1691494117, "time_this_iter_s": 13.258366823196411, "time_total_s": 95921.98855471611, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2900.309104204178, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 18.978947368421053, "ram_util_percent": 61.01052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -371.669921875, "policy_loss": -11078584.00625, "vf_loss": 16118006.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4418.0, "diff_num_grad_updates_vs_sampler_policy": 4417.0}}, "num_env_steps_sampled": 51739920, "num_env_steps_trained": 51739920, "num_agent_steps_sampled": 51739920, "num_agent_steps_trained": 51739920}, "sampler_results": {"episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3071.85975108073, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.726445612337668, "mean_inference_ms": 0.37975324938505806, "mean_action_processing_ms": 0.092429238992274, "mean_env_wait_ms": 0.8982455688497436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037004947662353516, "StateBufferConnector_ms": 0.0028638839721679688, "ViewRequirementAgentConnector_ms": 0.06750369071960449}}, "episode_reward_max": -3000.0842083732246, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3071.85975108073, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3025.084146079368, -3118.654680501489, -3024.957309435593, -3000.0842083732246, -3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.726445612337668, "mean_inference_ms": 0.37975324938505806, "mean_action_processing_ms": 0.092429238992274, "mean_env_wait_ms": 0.8982455688497436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037004947662353516, "StateBufferConnector_ms": 0.0028638839721679688, "ViewRequirementAgentConnector_ms": 0.06750369071960449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51739920, "num_agent_steps_trained": 51739920, "num_env_steps_sampled": 51739920, "num_env_steps_trained": 51739920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.09839747747888, "num_env_steps_trained_throughput_per_sec": 112.09839747747888, "timesteps_total": 51739920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51739920, "timers": {"training_iteration_time_ms": 3261.56, "sample_time_ms": 3250.772, "load_time_ms": 0.302, "load_throughput": 1193352.912, "learn_time_ms": 9.714, "learn_throughput": 37059.34, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 51739920, "num_env_steps_trained": 51739920, "num_agent_steps_sampled": 51739920, "num_agent_steps_trained": 51739920}, "done": false, "episodes_total": 13179, "training_iteration": 4079, "trial_id": "ef964_00000", "date": "2023-08-08_14-28-50", "timestamp": 1691494130, "time_this_iter_s": 12.848728895187378, "time_total_s": 95934.8372836113, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2913.1578330993652, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 21.755555555555553, "ram_util_percent": 60.97222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.97845458984375, "policy_loss": -6593198.08125, "vf_loss": 16241889.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4438.0, "diff_num_grad_updates_vs_sampler_policy": 4437.0}}, "num_env_steps_sampled": 51741360, "num_env_steps_trained": 51741360, "num_agent_steps_sampled": 51741360, "num_agent_steps_trained": 51741360}, "sampler_results": {"episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3074.259614760008, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.726097819796885, "mean_inference_ms": 0.3797694794756207, "mean_action_processing_ms": 0.09243429895568489, "mean_env_wait_ms": 0.898243177085639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.002858400344848633, "ViewRequirementAgentConnector_ms": 0.06746864318847656}}, "episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3074.259614760008, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3097.074007449908, -3022.8618631586596, -3046.392786095712, -3025.1836689111205, -3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.726097819796885, "mean_inference_ms": 0.3797694794756207, "mean_action_processing_ms": 0.09243429895568489, "mean_env_wait_ms": 0.898243177085639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.002858400344848633, "ViewRequirementAgentConnector_ms": 0.06746864318847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51741360, "num_agent_steps_trained": 51741360, "num_env_steps_sampled": 51741360, "num_env_steps_trained": 51741360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.8148464648339, "num_env_steps_trained_throughput_per_sec": 110.8148464648339, "timesteps_total": 51741360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51741360, "timers": {"training_iteration_time_ms": 3245.666, "sample_time_ms": 3234.968, "load_time_ms": 0.304, "load_throughput": 1185110.619, "learn_time_ms": 9.642, "learn_throughput": 37337.187, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 51741360, "num_env_steps_trained": 51741360, "num_agent_steps_sampled": 51741360, "num_agent_steps_trained": 51741360}, "done": false, "episodes_total": 13183, "training_iteration": 4080, "trial_id": "ef964_00000", "date": "2023-08-08_14-29-03", "timestamp": 1691494143, "time_this_iter_s": 12.997507810592651, "time_total_s": 95947.83479142189, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2926.155340909958, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 22.515789473684208, "ram_util_percent": 60.836842105263166}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -360.7100524902344, "policy_loss": -14359317.3625, "vf_loss": 16714916.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4458.0, "diff_num_grad_updates_vs_sampler_policy": 4457.0}}, "num_env_steps_sampled": 51742800, "num_env_steps_trained": 51742800, "num_agent_steps_sampled": 51742800, "num_agent_steps_trained": 51742800}, "sampler_results": {"episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3076.884919423236, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.725737286472858, "mean_inference_ms": 0.3797677728046992, "mean_action_processing_ms": 0.09243551080903277, "mean_env_wait_ms": 0.8982297756891575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036880970001220703, "StateBufferConnector_ms": 0.0028524398803710938, "ViewRequirementAgentConnector_ms": 0.06725239753723145}}, "episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3076.884919423236, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3095.8525191741537, -3134.7160829029253, -3119.428282461764, -3168.034861712901, -3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.725737286472858, "mean_inference_ms": 0.3797677728046992, "mean_action_processing_ms": 0.09243551080903277, "mean_env_wait_ms": 0.8982297756891575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036880970001220703, "StateBufferConnector_ms": 0.0028524398803710938, "ViewRequirementAgentConnector_ms": 0.06725239753723145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51742800, "num_agent_steps_trained": 51742800, "num_env_steps_sampled": 51742800, "num_env_steps_trained": 51742800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.08728099370586, "num_env_steps_trained_throughput_per_sec": 110.08728099370586, "timesteps_total": 51742800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51742800, "timers": {"training_iteration_time_ms": 3240.028, "sample_time_ms": 3229.324, "load_time_ms": 0.309, "load_throughput": 1163199.63, "learn_time_ms": 9.648, "learn_throughput": 37313.013, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 51742800, "num_env_steps_trained": 51742800, "num_agent_steps_sampled": 51742800, "num_agent_steps_trained": 51742800}, "done": false, "episodes_total": 13187, "training_iteration": 4081, "trial_id": "ef964_00000", "date": "2023-08-08_14-29-16", "timestamp": 1691494156, "time_this_iter_s": 13.083470106124878, "time_total_s": 95960.91826152802, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2939.2388110160828, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 19.494444444444444, "ram_util_percent": 61.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.36279296875, "policy_loss": -5982247.58125, "vf_loss": 15831630.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4478.0, "diff_num_grad_updates_vs_sampler_policy": 4477.0}}, "num_env_steps_sampled": 51744240, "num_env_steps_trained": 51744240, "num_agent_steps_sampled": 51744240, "num_agent_steps_trained": 51744240}, "sampler_results": {"episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3074.923484808572, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.725386168744075, "mean_inference_ms": 0.379765058526418, "mean_action_processing_ms": 0.09243654785090555, "mean_env_wait_ms": 0.8982116823675542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036764144897460938, "StateBufferConnector_ms": 0.0028595924377441406, "ViewRequirementAgentConnector_ms": 0.06721901893615723}}, "episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3074.923484808572, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3051.0187387762935, -3118.6628211662974, -3119.222592596771, -3070.7982392837243, -3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.725386168744075, "mean_inference_ms": 0.379765058526418, "mean_action_processing_ms": 0.09243654785090555, "mean_env_wait_ms": 0.8982116823675542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036764144897460938, "StateBufferConnector_ms": 0.0028595924377441406, "ViewRequirementAgentConnector_ms": 0.06721901893615723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51744240, "num_agent_steps_trained": 51744240, "num_env_steps_sampled": 51744240, "num_env_steps_trained": 51744240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.3505939317163, "num_env_steps_trained_throughput_per_sec": 110.3505939317163, "timesteps_total": 51744240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51744240, "timers": {"training_iteration_time_ms": 3264.643, "sample_time_ms": 3253.883, "load_time_ms": 0.311, "load_throughput": 1155720.964, "learn_time_ms": 9.7, "learn_throughput": 37111.531, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 51744240, "num_env_steps_trained": 51744240, "num_agent_steps_sampled": 51744240, "num_agent_steps_trained": 51744240}, "done": false, "episodes_total": 13191, "training_iteration": 4082, "trial_id": "ef964_00000", "date": "2023-08-08_14-29-29", "timestamp": 1691494169, "time_this_iter_s": 13.05226993560791, "time_total_s": 95973.97053146362, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2952.2910809516907, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 20.157894736842106, "ram_util_percent": 61.31578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.82994384765624, "policy_loss": -5729369.08125, "vf_loss": 15765749.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4498.0, "diff_num_grad_updates_vs_sampler_policy": 4497.0}}, "num_env_steps_sampled": 51745680, "num_env_steps_trained": 51745680, "num_agent_steps_sampled": 51745680, "num_agent_steps_trained": 51745680}, "sampler_results": {"episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3075.4997958182234, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.725041075490995, "mean_inference_ms": 0.3797621890563336, "mean_action_processing_ms": 0.09243757254118146, "mean_env_wait_ms": 0.8981919580433869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366973876953125, "StateBufferConnector_ms": 0.0028777122497558594, "ViewRequirementAgentConnector_ms": 0.06733417510986328}}, "episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3075.4997958182234, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3094.351285789676, -3074.0131770472, -3097.580893975084, -3045.526156927607, -3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.725041075490995, "mean_inference_ms": 0.3797621890563336, "mean_action_processing_ms": 0.09243757254118146, "mean_env_wait_ms": 0.8981919580433869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366973876953125, "StateBufferConnector_ms": 0.0028777122497558594, "ViewRequirementAgentConnector_ms": 0.06733417510986328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51745680, "num_agent_steps_trained": 51745680, "num_env_steps_sampled": 51745680, "num_env_steps_trained": 51745680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.351771387031, "num_env_steps_trained_throughput_per_sec": 110.351771387031, "timesteps_total": 51745680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51745680, "timers": {"training_iteration_time_ms": 3265.143, "sample_time_ms": 3254.27, "load_time_ms": 0.312, "load_throughput": 1155544.073, "learn_time_ms": 9.807, "learn_throughput": 36709.49, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 51745680, "num_env_steps_trained": 51745680, "num_agent_steps_sampled": 51745680, "num_agent_steps_trained": 51745680}, "done": false, "episodes_total": 13195, "training_iteration": 4083, "trial_id": "ef964_00000", "date": "2023-08-08_14-29-42", "timestamp": 1691494182, "time_this_iter_s": 13.05206298828125, "time_total_s": 95987.0225944519, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2965.343143939972, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 19.200000000000003, "ram_util_percent": 61.87777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -360.4979614257812, "policy_loss": -17403734.81875, "vf_loss": 16068313.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4518.0, "diff_num_grad_updates_vs_sampler_policy": 4517.0}}, "num_env_steps_sampled": 51747120, "num_env_steps_trained": 51747120, "num_agent_steps_sampled": 51747120, "num_agent_steps_trained": 51747120}, "sampler_results": {"episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3075.984401465539, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.724695870801417, "mean_inference_ms": 0.3797602275770865, "mean_action_processing_ms": 0.09243872955603578, "mean_env_wait_ms": 0.8981758200680372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036706924438476562, "StateBufferConnector_ms": 0.002872467041015625, "ViewRequirementAgentConnector_ms": 0.06734418869018555}}, "episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3075.984401465539, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.3553682286006, -3048.7135698342418, -3048.1533683179464, -3070.574111429787, -3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.724695870801417, "mean_inference_ms": 0.3797602275770865, "mean_action_processing_ms": 0.09243872955603578, "mean_env_wait_ms": 0.8981758200680372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036706924438476562, "StateBufferConnector_ms": 0.002872467041015625, "ViewRequirementAgentConnector_ms": 0.06734418869018555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51747120, "num_agent_steps_trained": 51747120, "num_env_steps_sampled": 51747120, "num_env_steps_trained": 51747120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.41436792037848, "num_env_steps_trained_throughput_per_sec": 110.41436792037848, "timesteps_total": 51747120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51747120, "timers": {"training_iteration_time_ms": 3267.457, "sample_time_ms": 3256.487, "load_time_ms": 0.306, "load_throughput": 1178083.358, "learn_time_ms": 9.898, "learn_throughput": 36369.163, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51747120, "num_env_steps_trained": 51747120, "num_agent_steps_sampled": 51747120, "num_agent_steps_trained": 51747120}, "done": false, "episodes_total": 13199, "training_iteration": 4084, "trial_id": "ef964_00000", "date": "2023-08-08_14-29-55", "timestamp": 1691494195, "time_this_iter_s": 13.04466986656189, "time_total_s": 96000.06726431847, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2978.387813806534, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 19.46315789473684, "ram_util_percent": 62.04210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.26298828125, "policy_loss": -13868033.6171875, "vf_loss": 15930045.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4538.0, "diff_num_grad_updates_vs_sampler_policy": 4537.0}}, "num_env_steps_sampled": 51748560, "num_env_steps_trained": 51748560, "num_agent_steps_sampled": 51748560, "num_agent_steps_trained": 51748560}, "sampler_results": {"episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3076.974953501939, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.724370317556696, "mean_inference_ms": 0.3797585619723815, "mean_action_processing_ms": 0.09243990761674309, "mean_env_wait_ms": 0.8981634533466267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366973876953125, "StateBufferConnector_ms": 0.0028731822967529297, "ViewRequirementAgentConnector_ms": 0.06736946105957031}}, "episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3076.974953501939, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.6470485354175, -3073.0055660908506, -3045.2425285217264, -3072.2432945062205, -3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.724370317556696, "mean_inference_ms": 0.3797585619723815, "mean_action_processing_ms": 0.09243990761674309, "mean_env_wait_ms": 0.8981634533466267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366973876953125, "StateBufferConnector_ms": 0.0028731822967529297, "ViewRequirementAgentConnector_ms": 0.06736946105957031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51748560, "num_agent_steps_trained": 51748560, "num_env_steps_sampled": 51748560, "num_env_steps_trained": 51748560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.29870031350414, "num_env_steps_trained_throughput_per_sec": 109.29870031350414, "timesteps_total": 51748560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51748560, "timers": {"training_iteration_time_ms": 3277.664, "sample_time_ms": 3266.707, "load_time_ms": 0.301, "load_throughput": 1194769.299, "learn_time_ms": 9.885, "learn_throughput": 36417.758, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51748560, "num_env_steps_trained": 51748560, "num_agent_steps_sampled": 51748560, "num_agent_steps_trained": 51748560}, "done": false, "episodes_total": 13203, "training_iteration": 4085, "trial_id": "ef964_00000", "date": "2023-08-08_14-30-08", "timestamp": 1691494208, "time_this_iter_s": 13.177708148956299, "time_total_s": 96013.24497246742, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2991.56552195549, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 19.263157894736842, "ram_util_percent": 63.38947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.7493591308594, "policy_loss": -8239040.2125, "vf_loss": 16157827.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4558.0, "diff_num_grad_updates_vs_sampler_policy": 4557.0}}, "num_env_steps_sampled": 51750000, "num_env_steps_trained": 51750000, "num_agent_steps_sampled": 51750000, "num_agent_steps_trained": 51750000}, "sampler_results": {"episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3077.9654476384626, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72407151517215, "mean_inference_ms": 0.37975700273892765, "mean_action_processing_ms": 0.09244110881426142, "mean_env_wait_ms": 0.8981552214410109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036704540252685547, "StateBufferConnector_ms": 0.0028722286224365234, "ViewRequirementAgentConnector_ms": 0.06745457649230957}}, "episode_reward_max": -3000.0853334077037, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3077.9654476384626, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3022.295412961077, -3144.298339743108, -3000.0853334077037, -3076.2411081738264, -3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72407151517215, "mean_inference_ms": 0.37975700273892765, "mean_action_processing_ms": 0.09244110881426142, "mean_env_wait_ms": 0.8981552214410109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036704540252685547, "StateBufferConnector_ms": 0.0028722286224365234, "ViewRequirementAgentConnector_ms": 0.06745457649230957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51750000, "num_agent_steps_trained": 51750000, "num_env_steps_sampled": 51750000, "num_env_steps_trained": 51750000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.7291095440761, "num_env_steps_trained_throughput_per_sec": 109.7291095440761, "timesteps_total": 51750000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51750000, "timers": {"training_iteration_time_ms": 3289.176, "sample_time_ms": 3278.296, "load_time_ms": 0.301, "load_throughput": 1194485.753, "learn_time_ms": 9.812, "learn_throughput": 36690.491, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 51750000, "num_env_steps_trained": 51750000, "num_agent_steps_sampled": 51750000, "num_agent_steps_trained": 51750000}, "done": false, "episodes_total": 13207, "training_iteration": 4086, "trial_id": "ef964_00000", "date": "2023-08-08_14-30-22", "timestamp": 1691494222, "time_this_iter_s": 13.12602686882019, "time_total_s": 96026.37099933624, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3004.6915488243103, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 19.083333333333332, "ram_util_percent": 64.29444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.50550537109376, "policy_loss": -6227946.45625, "vf_loss": 15901659.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4578.0, "diff_num_grad_updates_vs_sampler_policy": 4577.0}}, "num_env_steps_sampled": 51751440, "num_env_steps_trained": 51751440, "num_agent_steps_sampled": 51751440, "num_agent_steps_trained": 51751440}, "sampler_results": {"episode_reward_max": -3000.085477605849, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3078.723077282418, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72379419204665, "mean_inference_ms": 0.37975542567306997, "mean_action_processing_ms": 0.09244232271211654, "mean_env_wait_ms": 0.8981543724147386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670215606689453, "StateBufferConnector_ms": 0.002875089645385742, "ViewRequirementAgentConnector_ms": 0.06747961044311523}}, "episode_reward_max": -3000.085477605849, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3078.723077282418, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3082.19902958119, -3092.9271026705223, -3023.7726128872164, -3095.1537832903487, -3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72379419204665, "mean_inference_ms": 0.37975542567306997, "mean_action_processing_ms": 0.09244232271211654, "mean_env_wait_ms": 0.8981543724147386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670215606689453, "StateBufferConnector_ms": 0.002875089645385742, "ViewRequirementAgentConnector_ms": 0.06747961044311523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51751440, "num_agent_steps_trained": 51751440, "num_env_steps_sampled": 51751440, "num_env_steps_trained": 51751440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.51064256070565, "num_env_steps_trained_throughput_per_sec": 109.51064256070565, "timesteps_total": 51751440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51751440, "timers": {"training_iteration_time_ms": 3289.594, "sample_time_ms": 3278.839, "load_time_ms": 0.3, "load_throughput": 1200468.628, "learn_time_ms": 9.697, "learn_throughput": 37126.77, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 51751440, "num_env_steps_trained": 51751440, "num_agent_steps_sampled": 51751440, "num_agent_steps_trained": 51751440}, "done": false, "episodes_total": 13211, "training_iteration": 4087, "trial_id": "ef964_00000", "date": "2023-08-08_14-30-35", "timestamp": 1691494235, "time_this_iter_s": 13.152206182479858, "time_total_s": 96039.52320551872, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3017.84375500679, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 19.473684210526315, "ram_util_percent": 64.17368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.25734252929686, "policy_loss": -4507143.1875, "vf_loss": 15193797.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4598.0, "diff_num_grad_updates_vs_sampler_policy": 4597.0}}, "num_env_steps_sampled": 51752880, "num_env_steps_trained": 51752880, "num_agent_steps_sampled": 51752880, "num_agent_steps_trained": 51752880}, "sampler_results": {"episode_reward_max": -3000.085477605849, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3078.127763235198, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.723508866500217, "mean_inference_ms": 0.3797549826647378, "mean_action_processing_ms": 0.09244382057350407, "mean_env_wait_ms": 0.8981560238239175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674745559692383, "StateBufferConnector_ms": 0.0028769969940185547, "ViewRequirementAgentConnector_ms": 0.06757211685180664}}, "episode_reward_max": -3000.085477605849, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3078.127763235198, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.085477605849, -3000.0854862622814, -3073.8279091710274, -3000.085508489872, -3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.723508866500217, "mean_inference_ms": 0.3797549826647378, "mean_action_processing_ms": 0.09244382057350407, "mean_env_wait_ms": 0.8981560238239175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674745559692383, "StateBufferConnector_ms": 0.0028769969940185547, "ViewRequirementAgentConnector_ms": 0.06757211685180664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51752880, "num_agent_steps_trained": 51752880, "num_env_steps_sampled": 51752880, "num_env_steps_trained": 51752880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.63008071568663, "num_env_steps_trained_throughput_per_sec": 111.63008071568663, "timesteps_total": 51752880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51752880, "timers": {"training_iteration_time_ms": 3261.998, "sample_time_ms": 3251.281, "load_time_ms": 0.301, "load_throughput": 1195147.57, "learn_time_ms": 9.66, "learn_throughput": 37267.703, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 51752880, "num_env_steps_trained": 51752880, "num_agent_steps_sampled": 51752880, "num_agent_steps_trained": 51752880}, "done": false, "episodes_total": 13215, "training_iteration": 4088, "trial_id": "ef964_00000", "date": "2023-08-08_14-30-48", "timestamp": 1691494248, "time_this_iter_s": 12.902578115463257, "time_total_s": 96052.42578363419, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3030.7463331222534, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 24.58888888888889, "ram_util_percent": 64.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.3058349609375, "policy_loss": -3097105.084375, "vf_loss": 15232706.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4618.0, "diff_num_grad_updates_vs_sampler_policy": 4617.0}}, "num_env_steps_sampled": 51754320, "num_env_steps_trained": 51754320, "num_agent_steps_sampled": 51754320, "num_agent_steps_trained": 51754320}, "sampler_results": {"episode_reward_max": -3000.0860763333026, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3079.562456502374, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.723222383143946, "mean_inference_ms": 0.3797458844489311, "mean_action_processing_ms": 0.09244352615369003, "mean_env_wait_ms": 0.8981466802322648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035123825073242188, "StateBufferConnector_ms": 0.0028314590454101562, "ViewRequirementAgentConnector_ms": 0.06669497489929199}}, "episode_reward_max": -3000.0860763333026, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3079.562456502374, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3097.0663774133186, -3115.7393802690735, -3118.269383927457, -3094.6368360703937, -3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.723222383143946, "mean_inference_ms": 0.3797458844489311, "mean_action_processing_ms": 0.09244352615369003, "mean_env_wait_ms": 0.8981466802322648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035123825073242188, "StateBufferConnector_ms": 0.0028314590454101562, "ViewRequirementAgentConnector_ms": 0.06669497489929199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51754320, "num_agent_steps_trained": 51754320, "num_env_steps_sampled": 51754320, "num_env_steps_trained": 51754320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.00838750972487, "num_env_steps_trained_throughput_per_sec": 110.00838750972487, "timesteps_total": 51754320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51754320, "timers": {"training_iteration_time_ms": 3254.556, "sample_time_ms": 3243.826, "load_time_ms": 0.301, "load_throughput": 1194863.844, "learn_time_ms": 9.664, "learn_throughput": 37250.327, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 51754320, "num_env_steps_trained": 51754320, "num_agent_steps_sampled": 51754320, "num_agent_steps_trained": 51754320}, "done": false, "episodes_total": 13219, "training_iteration": 4089, "trial_id": "ef964_00000", "date": "2023-08-08_14-31-01", "timestamp": 1691494261, "time_this_iter_s": 13.092720031738281, "time_total_s": 96065.51850366592, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3043.8390531539917, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 20.368421052631575, "ram_util_percent": 64.99473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -375.92872314453126, "policy_loss": -3633383.309375, "vf_loss": 15483100.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4638.0, "diff_num_grad_updates_vs_sampler_policy": 4637.0}}, "num_env_steps_sampled": 51755760, "num_env_steps_trained": 51755760, "num_agent_steps_sampled": 51755760, "num_agent_steps_trained": 51755760}, "sampler_results": {"episode_reward_max": -3000.0860763333026, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3078.925470826463, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.722928664663393, "mean_inference_ms": 0.379728776135853, "mean_action_processing_ms": 0.09244147545705929, "mean_env_wait_ms": 0.8981205270081182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0028722286224365234, "ViewRequirementAgentConnector_ms": 0.06692886352539062}}, "episode_reward_max": -3000.0860763333026, "episode_reward_min": -3233.960723079778, "episode_reward_mean": -3078.925470826463, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3233.960723079778, -3073.0709030189746, -3023.9637764439117, -3071.805448114114, -3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.722928664663393, "mean_inference_ms": 0.379728776135853, "mean_action_processing_ms": 0.09244147545705929, "mean_env_wait_ms": 0.8981205270081182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0028722286224365234, "ViewRequirementAgentConnector_ms": 0.06692886352539062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51755760, "num_agent_steps_trained": 51755760, "num_env_steps_sampled": 51755760, "num_env_steps_trained": 51755760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.8401793699269, "num_env_steps_trained_throughput_per_sec": 109.8401793699269, "timesteps_total": 51755760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51755760, "timers": {"training_iteration_time_ms": 3260.349, "sample_time_ms": 3249.523, "load_time_ms": 0.303, "load_throughput": 1187160.5, "learn_time_ms": 9.761, "learn_throughput": 36880.297, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 51755760, "num_env_steps_trained": 51755760, "num_agent_steps_sampled": 51755760, "num_agent_steps_trained": 51755760}, "done": false, "episodes_total": 13223, "training_iteration": 4090, "trial_id": "ef964_00000", "date": "2023-08-08_14-31-14", "timestamp": 1691494274, "time_this_iter_s": 13.112874031066895, "time_total_s": 96078.63137769699, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3056.9519271850586, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 18.33684210526316, "ram_util_percent": 65.02105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.9880310058594, "policy_loss": -12902678.0125, "vf_loss": 16519001.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4658.0, "diff_num_grad_updates_vs_sampler_policy": 4657.0}}, "num_env_steps_sampled": 51757200, "num_env_steps_trained": 51757200, "num_agent_steps_sampled": 51757200, "num_agent_steps_trained": 51757200}, "sampler_results": {"episode_reward_max": -3000.0860763333026, "episode_reward_min": -3190.3207451122807, "episode_reward_mean": -3077.8382063866015, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.722648722897991, "mean_inference_ms": 0.3797129836846642, "mean_action_processing_ms": 0.09243969098934565, "mean_env_wait_ms": 0.8980957972820298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035190582275390625, "StateBufferConnector_ms": 0.0028715133666992188, "ViewRequirementAgentConnector_ms": 0.06694674491882324}}, "episode_reward_max": -3000.0860763333026, "episode_reward_min": -3190.3207451122807, "episode_reward_mean": -3077.8382063866015, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3049.5203676522747, -3048.839795167355, -3093.393776606495, -3023.0643486617487, -3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.722648722897991, "mean_inference_ms": 0.3797129836846642, "mean_action_processing_ms": 0.09243969098934565, "mean_env_wait_ms": 0.8980957972820298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035190582275390625, "StateBufferConnector_ms": 0.0028715133666992188, "ViewRequirementAgentConnector_ms": 0.06694674491882324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51757200, "num_agent_steps_trained": 51757200, "num_env_steps_sampled": 51757200, "num_env_steps_trained": 51757200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.59604792127895, "num_env_steps_trained_throughput_per_sec": 109.59604792127895, "timesteps_total": 51757200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51757200, "timers": {"training_iteration_time_ms": 3279.398, "sample_time_ms": 3268.571, "load_time_ms": 0.304, "load_throughput": 1182604.511, "learn_time_ms": 9.76, "learn_throughput": 36886.424, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 51757200, "num_env_steps_trained": 51757200, "num_agent_steps_sampled": 51757200, "num_agent_steps_trained": 51757200}, "done": false, "episodes_total": 13227, "training_iteration": 4091, "trial_id": "ef964_00000", "date": "2023-08-08_14-31-27", "timestamp": 1691494287, "time_this_iter_s": 13.142053127288818, "time_total_s": 96091.77343082428, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3070.0939803123474, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 20.572222222222223, "ram_util_percent": 64.9111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.94896240234374, "policy_loss": -11812745.18125, "vf_loss": 15807450.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4678.0, "diff_num_grad_updates_vs_sampler_policy": 4677.0}}, "num_env_steps_sampled": 51758640, "num_env_steps_trained": 51758640, "num_agent_steps_sampled": 51758640, "num_agent_steps_trained": 51758640}, "sampler_results": {"episode_reward_max": -3000.0860763333026, "episode_reward_min": -3190.3207451122807, "episode_reward_mean": -3079.5910775572997, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.722385454989828, "mean_inference_ms": 0.3796983378816162, "mean_action_processing_ms": 0.09243821333079076, "mean_env_wait_ms": 0.8980811122059953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513336181640625, "StateBufferConnector_ms": 0.0028727054595947266, "ViewRequirementAgentConnector_ms": 0.06696105003356934}}, "episode_reward_max": -3000.0860763333026, "episode_reward_min": -3190.3207451122807, "episode_reward_mean": -3079.5910775572997, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0860763333026, -3106.593519229114, -3052.807082501385, -3115.9683365016886, -3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.722385454989828, "mean_inference_ms": 0.3796983378816162, "mean_action_processing_ms": 0.09243821333079076, "mean_env_wait_ms": 0.8980811122059953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513336181640625, "StateBufferConnector_ms": 0.0028727054595947266, "ViewRequirementAgentConnector_ms": 0.06696105003356934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51758640, "num_agent_steps_trained": 51758640, "num_env_steps_sampled": 51758640, "num_env_steps_trained": 51758640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.8972768242356, "num_env_steps_trained_throughput_per_sec": 108.8972768242356, "timesteps_total": 51758640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51758640, "timers": {"training_iteration_time_ms": 3291.011, "sample_time_ms": 3279.895, "load_time_ms": 0.306, "load_throughput": 1177348.491, "learn_time_ms": 10.005, "learn_throughput": 35983.562, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 51758640, "num_env_steps_trained": 51758640, "num_agent_steps_sampled": 51758640, "num_agent_steps_trained": 51758640}, "done": false, "episodes_total": 13231, "training_iteration": 4092, "trial_id": "ef964_00000", "date": "2023-08-08_14-31-40", "timestamp": 1691494300, "time_this_iter_s": 13.226470232009888, "time_total_s": 96104.99990105629, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3083.3204505443573, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 20.889473684210525, "ram_util_percent": 65.05789473684212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -371.2937072753906, "policy_loss": -4419647.375, "vf_loss": 15213643.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4698.0, "diff_num_grad_updates_vs_sampler_policy": 4697.0}}, "num_env_steps_sampled": 51760080, "num_env_steps_trained": 51760080, "num_agent_steps_sampled": 51760080, "num_agent_steps_trained": 51760080}, "sampler_results": {"episode_reward_max": -3000.0867022627253, "episode_reward_min": -3190.3207451122807, "episode_reward_mean": -3079.4146229603507, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72212882258756, "mean_inference_ms": 0.379685197161016, "mean_action_processing_ms": 0.0924369999697399, "mean_env_wait_ms": 0.8980626831537561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035147666931152344, "StateBufferConnector_ms": 0.0028831958770751953, "ViewRequirementAgentConnector_ms": 0.06700277328491211}}, "episode_reward_max": -3000.0867022627253, "episode_reward_min": -3190.3207451122807, "episode_reward_mean": -3079.4146229603507, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3190.3207451122807, -3117.5510876433054, -3045.91538689832, -3023.002448750763, -3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72212882258756, "mean_inference_ms": 0.379685197161016, "mean_action_processing_ms": 0.0924369999697399, "mean_env_wait_ms": 0.8980626831537561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035147666931152344, "StateBufferConnector_ms": 0.0028831958770751953, "ViewRequirementAgentConnector_ms": 0.06700277328491211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51760080, "num_agent_steps_trained": 51760080, "num_env_steps_sampled": 51760080, "num_env_steps_trained": 51760080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.8348900828721, "num_env_steps_trained_throughput_per_sec": 109.8348900828721, "timesteps_total": 51760080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51760080, "timers": {"training_iteration_time_ms": 3294.036, "sample_time_ms": 3282.986, "load_time_ms": 0.301, "load_throughput": 1194107.9, "learn_time_ms": 9.955, "learn_throughput": 36161.776, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 51760080, "num_env_steps_trained": 51760080, "num_agent_steps_sampled": 51760080, "num_agent_steps_trained": 51760080}, "done": false, "episodes_total": 13235, "training_iteration": 4093, "trial_id": "ef964_00000", "date": "2023-08-08_14-31-54", "timestamp": 1691494314, "time_this_iter_s": 13.113468885421753, "time_total_s": 96118.11336994171, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3096.433919429779, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 19.857894736842102, "ram_util_percent": 65.13157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.9482360839844, "policy_loss": -4147583.603125, "vf_loss": 15428102.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4718.0, "diff_num_grad_updates_vs_sampler_policy": 4717.0}}, "num_env_steps_sampled": 51761520, "num_env_steps_trained": 51761520, "num_agent_steps_sampled": 51761520, "num_agent_steps_trained": 51761520}, "sampler_results": {"episode_reward_max": -3000.0867022627253, "episode_reward_min": -3184.8224156892925, "episode_reward_mean": -3077.7647202379867, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.721880822676878, "mean_inference_ms": 0.379673002714338, "mean_action_processing_ms": 0.09243600916234283, "mean_env_wait_ms": 0.898042153188623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247802734375, "StateBufferConnector_ms": 0.0028862953186035156, "ViewRequirementAgentConnector_ms": 0.06702661514282227}}, "episode_reward_max": -3000.0867022627253, "episode_reward_min": -3184.8224156892925, "episode_reward_mean": -3077.7647202379867, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3096.780319395234, -3046.9018436469864, -3048.467887754258, -3048.5479000413015, -3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.721880822676878, "mean_inference_ms": 0.379673002714338, "mean_action_processing_ms": 0.09243600916234283, "mean_env_wait_ms": 0.898042153188623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247802734375, "StateBufferConnector_ms": 0.0028862953186035156, "ViewRequirementAgentConnector_ms": 0.06702661514282227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51761520, "num_agent_steps_trained": 51761520, "num_env_steps_sampled": 51761520, "num_env_steps_trained": 51761520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.52039467684772, "num_env_steps_trained_throughput_per_sec": 109.52039467684772, "timesteps_total": 51761520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51761520, "timers": {"training_iteration_time_ms": 3283.195, "sample_time_ms": 3272.204, "load_time_ms": 0.3, "load_throughput": 1199514.967, "learn_time_ms": 9.909, "learn_throughput": 36331.359, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 51761520, "num_env_steps_trained": 51761520, "num_agent_steps_sampled": 51761520, "num_agent_steps_trained": 51761520}, "done": false, "episodes_total": 13239, "training_iteration": 4094, "trial_id": "ef964_00000", "date": "2023-08-08_14-32-07", "timestamp": 1691494327, "time_this_iter_s": 13.15125584602356, "time_total_s": 96131.26462578773, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3109.5851752758026, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 19.284210526315793, "ram_util_percent": 65.1842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -373.7984252929688, "policy_loss": -5681768.2375, "vf_loss": 15881942.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4738.0, "diff_num_grad_updates_vs_sampler_policy": 4737.0}}, "num_env_steps_sampled": 51762960, "num_env_steps_trained": 51762960, "num_agent_steps_sampled": 51762960, "num_agent_steps_trained": 51762960}, "sampler_results": {"episode_reward_max": -3000.0867022627253, "episode_reward_min": -3184.8224156892925, "episode_reward_mean": -3077.8562056925193, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.721654053894497, "mean_inference_ms": 0.3796616316168842, "mean_action_processing_ms": 0.09243516402574857, "mean_env_wait_ms": 0.8980206024420585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00353240966796875, "StateBufferConnector_ms": 0.0028619766235351562, "ViewRequirementAgentConnector_ms": 0.06708812713623047}}, "episode_reward_max": -3000.0867022627253, "episode_reward_min": -3184.8224156892925, "episode_reward_mean": -3077.8562056925193, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3070.850794405295, -3143.8206282563015, -3000.0867022627253, -3026.6333606604844, -3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.721654053894497, "mean_inference_ms": 0.3796616316168842, "mean_action_processing_ms": 0.09243516402574857, "mean_env_wait_ms": 0.8980206024420585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00353240966796875, "StateBufferConnector_ms": 0.0028619766235351562, "ViewRequirementAgentConnector_ms": 0.06708812713623047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51762960, "num_agent_steps_trained": 51762960, "num_env_steps_sampled": 51762960, "num_env_steps_trained": 51762960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.09396524694712, "num_env_steps_trained_throughput_per_sec": 110.09396524694712, "timesteps_total": 51762960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51762960, "timers": {"training_iteration_time_ms": 3282.514, "sample_time_ms": 3271.705, "load_time_ms": 0.302, "load_throughput": 1191657.675, "learn_time_ms": 9.75, "learn_throughput": 36922.864, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 51762960, "num_env_steps_trained": 51762960, "num_agent_steps_sampled": 51762960, "num_agent_steps_trained": 51762960}, "done": false, "episodes_total": 13243, "training_iteration": 4095, "trial_id": "ef964_00000", "date": "2023-08-08_14-32-20", "timestamp": 1691494340, "time_this_iter_s": 13.082617044448853, "time_total_s": 96144.34724283218, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3122.6677923202515, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 19.62777777777778, "ram_util_percent": 64.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.32733764648435, "policy_loss": -1821259.6640625, "vf_loss": 15253635.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4758.0, "diff_num_grad_updates_vs_sampler_policy": 4757.0}}, "num_env_steps_sampled": 51764400, "num_env_steps_trained": 51764400, "num_agent_steps_sampled": 51764400, "num_agent_steps_trained": 51764400}, "sampler_results": {"episode_reward_max": -3000.0870333309404, "episode_reward_min": -3184.8224156892925, "episode_reward_mean": -3077.8069169838877, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72144722407706, "mean_inference_ms": 0.37965094348764483, "mean_action_processing_ms": 0.09243442699839562, "mean_env_wait_ms": 0.8979970284575458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035276412963867188, "StateBufferConnector_ms": 0.0028629302978515625, "ViewRequirementAgentConnector_ms": 0.06710600852966309}}, "episode_reward_max": -3000.0870333309404, "episode_reward_min": -3184.8224156892925, "episode_reward_mean": -3077.8069169838877, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3143.941195073208, -3092.9714535308512, -3141.1795528939256, -3184.8224156892925, -3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.72144722407706, "mean_inference_ms": 0.37965094348764483, "mean_action_processing_ms": 0.09243442699839562, "mean_env_wait_ms": 0.8979970284575458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035276412963867188, "StateBufferConnector_ms": 0.0028629302978515625, "ViewRequirementAgentConnector_ms": 0.06710600852966309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51764400, "num_agent_steps_trained": 51764400, "num_env_steps_sampled": 51764400, "num_env_steps_trained": 51764400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.3517044554635, "num_env_steps_trained_throughput_per_sec": 109.3517044554635, "timesteps_total": 51764400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51764400, "timers": {"training_iteration_time_ms": 3283.942, "sample_time_ms": 3273.16, "load_time_ms": 0.306, "load_throughput": 1177073.152, "learn_time_ms": 9.718, "learn_throughput": 37043.793, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 51764400, "num_env_steps_trained": 51764400, "num_agent_steps_sampled": 51764400, "num_agent_steps_trained": 51764400}, "done": false, "episodes_total": 13247, "training_iteration": 4096, "trial_id": "ef964_00000", "date": "2023-08-08_14-32-33", "timestamp": 1691494353, "time_this_iter_s": 13.17147421836853, "time_total_s": 96157.51871705055, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3135.83926653862, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 19.515789473684208, "ram_util_percent": 65.03684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.2985595703125, "policy_loss": -909720.60625, "vf_loss": 15183912.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4778.0, "diff_num_grad_updates_vs_sampler_policy": 4777.0}}, "num_env_steps_sampled": 51765840, "num_env_steps_trained": 51765840, "num_agent_steps_sampled": 51765840, "num_agent_steps_trained": 51765840}, "sampler_results": {"episode_reward_max": -3000.0870333309404, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3074.759978072478, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.721244184595178, "mean_inference_ms": 0.37962585461051485, "mean_action_processing_ms": 0.09243044115423431, "mean_env_wait_ms": 0.8979442808668077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034775733947753906, "StateBufferConnector_ms": 0.002827882766723633, "ViewRequirementAgentConnector_ms": 0.06617498397827148}}, "episode_reward_max": -3000.0870333309404, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3074.759978072478, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3051.0729260490725, -3096.889393381164, -3075.3242296407193, -3092.1509442175907, -3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.721244184595178, "mean_inference_ms": 0.37962585461051485, "mean_action_processing_ms": 0.09243044115423431, "mean_env_wait_ms": 0.8979442808668077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034775733947753906, "StateBufferConnector_ms": 0.002827882766723633, "ViewRequirementAgentConnector_ms": 0.06617498397827148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51765840, "num_agent_steps_trained": 51765840, "num_env_steps_sampled": 51765840, "num_env_steps_trained": 51765840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.47682247311057, "num_env_steps_trained_throughput_per_sec": 109.47682247311057, "timesteps_total": 51765840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51765840, "timers": {"training_iteration_time_ms": 3284.041, "sample_time_ms": 3273.25, "load_time_ms": 0.305, "load_throughput": 1181771.496, "learn_time_ms": 9.723, "learn_throughput": 37026.897, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 51765840, "num_env_steps_trained": 51765840, "num_agent_steps_sampled": 51765840, "num_agent_steps_trained": 51765840}, "done": false, "episodes_total": 13251, "training_iteration": 4097, "trial_id": "ef964_00000", "date": "2023-08-08_14-32-46", "timestamp": 1691494366, "time_this_iter_s": 13.156265020370483, "time_total_s": 96170.67498207092, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3148.9955315589905, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 19.242105263157896, "ram_util_percent": 64.93684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -369.0336975097656, "policy_loss": -3743703.275, "vf_loss": 15522413.3}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4798.0, "diff_num_grad_updates_vs_sampler_policy": 4797.0}}, "num_env_steps_sampled": 51767280, "num_env_steps_trained": 51767280, "num_agent_steps_sampled": 51767280, "num_agent_steps_trained": 51767280}, "sampler_results": {"episode_reward_max": -3000.0870333309404, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3074.0036728515474, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.721060884470461, "mean_inference_ms": 0.37959687602602765, "mean_action_processing_ms": 0.09242556874660864, "mean_env_wait_ms": 0.8978777708494161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.0028302669525146484, "ViewRequirementAgentConnector_ms": 0.06630730628967285}}, "episode_reward_max": -3000.0870333309404, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3074.0036728515474, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0870333309404, -3024.96302772851, -3072.7886109237015, -3022.8050541678163, -3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.721060884470461, "mean_inference_ms": 0.37959687602602765, "mean_action_processing_ms": 0.09242556874660864, "mean_env_wait_ms": 0.8978777708494161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.0028302669525146484, "ViewRequirementAgentConnector_ms": 0.06630730628967285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51767280, "num_agent_steps_trained": 51767280, "num_env_steps_sampled": 51767280, "num_env_steps_trained": 51767280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.35849768694506, "num_env_steps_trained_throughput_per_sec": 109.35849768694506, "timesteps_total": 51767280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51767280, "timers": {"training_iteration_time_ms": 3287.862, "sample_time_ms": 3277.037, "load_time_ms": 0.303, "load_throughput": 1188094.61, "learn_time_ms": 9.763, "learn_throughput": 36873.813, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 51767280, "num_env_steps_trained": 51767280, "num_agent_steps_sampled": 51767280, "num_agent_steps_trained": 51767280}, "done": false, "episodes_total": 13255, "training_iteration": 4098, "trial_id": "ef964_00000", "date": "2023-08-08_14-32-59", "timestamp": 1691494379, "time_this_iter_s": 13.17057991027832, "time_total_s": 96183.8455619812, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3162.166111469269, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 20.933333333333334, "ram_util_percent": 64.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.3395202636719, "policy_loss": -9549166.13125, "vf_loss": 15232782.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4818.0, "diff_num_grad_updates_vs_sampler_policy": 4817.0}}, "num_env_steps_sampled": 51768720, "num_env_steps_trained": 51768720, "num_agent_steps_sampled": 51768720, "num_agent_steps_trained": 51768720}, "sampler_results": {"episode_reward_max": -3002.143128312636, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.1316087327996, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720885124563267, "mean_inference_ms": 0.37956939820229413, "mean_action_processing_ms": 0.09242095474409616, "mean_env_wait_ms": 0.8978184561212902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495454788208008, "StateBufferConnector_ms": 0.002838134765625, "ViewRequirementAgentConnector_ms": 0.06638932228088379}}, "episode_reward_max": -3002.143128312636, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.1316087327996, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3046.9080381216136, -3023.825825409923, -3049.9343177960923, -3132.426581802005, -3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720885124563267, "mean_inference_ms": 0.37956939820229413, "mean_action_processing_ms": 0.09242095474409616, "mean_env_wait_ms": 0.8978184561212902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495454788208008, "StateBufferConnector_ms": 0.002838134765625, "ViewRequirementAgentConnector_ms": 0.06638932228088379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51768720, "num_agent_steps_trained": 51768720, "num_env_steps_sampled": 51768720, "num_env_steps_trained": 51768720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.633318724749, "num_env_steps_trained_throughput_per_sec": 109.633318724749, "timesteps_total": 51768720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51768720, "timers": {"training_iteration_time_ms": 3289.764, "sample_time_ms": 3278.974, "load_time_ms": 0.301, "load_throughput": 1195999.556, "learn_time_ms": 9.743, "learn_throughput": 36948.523, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 51768720, "num_env_steps_trained": 51768720, "num_agent_steps_sampled": 51768720, "num_agent_steps_trained": 51768720}, "done": false, "episodes_total": 13259, "training_iteration": 4099, "trial_id": "ef964_00000", "date": "2023-08-08_14-33-13", "timestamp": 1691494393, "time_this_iter_s": 13.13744306564331, "time_total_s": 96196.98300504684, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3175.303554534912, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 19.236842105263158, "ram_util_percent": 64.94210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.7175659179687, "policy_loss": -4124880.25625, "vf_loss": 15299074.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4838.0, "diff_num_grad_updates_vs_sampler_policy": 4837.0}}, "num_env_steps_sampled": 51770160, "num_env_steps_trained": 51770160, "num_agent_steps_sampled": 51770160, "num_agent_steps_trained": 51770160}, "sampler_results": {"episode_reward_max": -3002.143128312636, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.7265738323085, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720714629576001, "mean_inference_ms": 0.37954342291553417, "mean_action_processing_ms": 0.09241658926219014, "mean_env_wait_ms": 0.8977640629465629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035028457641601562, "StateBufferConnector_ms": 0.002836465835571289, "ViewRequirementAgentConnector_ms": 0.06645035743713379}}, "episode_reward_max": -3002.143128312636, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.7265738323085, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.6941676278684, -3002.143128312636, -3095.5509277806495, -3094.865279243071, -3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720714629576001, "mean_inference_ms": 0.37954342291553417, "mean_action_processing_ms": 0.09241658926219014, "mean_env_wait_ms": 0.8977640629465629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035028457641601562, "StateBufferConnector_ms": 0.002836465835571289, "ViewRequirementAgentConnector_ms": 0.06645035743713379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51770160, "num_agent_steps_trained": 51770160, "num_env_steps_sampled": 51770160, "num_env_steps_trained": 51770160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.59060912028346, "num_env_steps_trained_throughput_per_sec": 109.59060912028346, "timesteps_total": 51770160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51770160, "timers": {"training_iteration_time_ms": 3288.272, "sample_time_ms": 3277.421, "load_time_ms": 0.302, "load_throughput": 1191939.88, "learn_time_ms": 9.798, "learn_throughput": 36742.094, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 51770160, "num_env_steps_trained": 51770160, "num_agent_steps_sampled": 51770160, "num_agent_steps_trained": 51770160}, "done": false, "episodes_total": 13263, "training_iteration": 4100, "trial_id": "ef964_00000", "date": "2023-08-08_14-33-26", "timestamp": 1691494406, "time_this_iter_s": 13.142577171325684, "time_total_s": 96210.12558221817, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3188.446131706238, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 23.842105263157894, "ram_util_percent": 65.01052631578949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -371.640966796875, "policy_loss": -4182923.928125, "vf_loss": 15545301.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4858.0, "diff_num_grad_updates_vs_sampler_policy": 4857.0}}, "num_env_steps_sampled": 51771600, "num_env_steps_trained": 51771600, "num_agent_steps_sampled": 51771600, "num_agent_steps_trained": 51771600}, "sampler_results": {"episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.7880922233308, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720550198778833, "mean_inference_ms": 0.3795190054269861, "mean_action_processing_ms": 0.09241248451178918, "mean_env_wait_ms": 0.8977103565369672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035064220428466797, "StateBufferConnector_ms": 0.0028476715087890625, "ViewRequirementAgentConnector_ms": 0.0665440559387207}}, "episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.7880922233308, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.831105491021, -3046.0450619597136, -3092.586684528465, -3048.735051669823, -3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720550198778833, "mean_inference_ms": 0.3795190054269861, "mean_action_processing_ms": 0.09241248451178918, "mean_env_wait_ms": 0.8977103565369672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035064220428466797, "StateBufferConnector_ms": 0.0028476715087890625, "ViewRequirementAgentConnector_ms": 0.0665440559387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51771600, "num_agent_steps_trained": 51771600, "num_env_steps_sampled": 51771600, "num_env_steps_trained": 51771600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.39766735809481, "num_env_steps_trained_throughput_per_sec": 110.39766735809481, "timesteps_total": 51771600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51771600, "timers": {"training_iteration_time_ms": 3274.951, "sample_time_ms": 3264.121, "load_time_ms": 0.304, "load_throughput": 1182419.295, "learn_time_ms": 9.776, "learn_throughput": 36824.353, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 51771600, "num_env_steps_trained": 51771600, "num_agent_steps_sampled": 51771600, "num_agent_steps_trained": 51771600}, "done": false, "episodes_total": 13267, "training_iteration": 4101, "trial_id": "ef964_00000", "date": "2023-08-08_14-33-39", "timestamp": 1691494419, "time_this_iter_s": 13.046550750732422, "time_total_s": 96223.1721329689, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3201.49268245697, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 20.92777777777778, "ram_util_percent": 65.15555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.4075561523438, "policy_loss": -16753563.80625, "vf_loss": 16988346.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4878.0, "diff_num_grad_updates_vs_sampler_policy": 4877.0}}, "num_env_steps_sampled": 51773040, "num_env_steps_trained": 51773040, "num_agent_steps_sampled": 51773040, "num_agent_steps_trained": 51773040}, "sampler_results": {"episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3076.5304779471066, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720393077080605, "mean_inference_ms": 0.37949577833899384, "mean_action_processing_ms": 0.0924086034175777, "mean_env_wait_ms": 0.8976624307399014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034902095794677734, "StateBufferConnector_ms": 0.0028378963470458984, "ViewRequirementAgentConnector_ms": 0.06648111343383789}}, "episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3076.5304779471066, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3096.347121258353, -3171.0328690364177, -3055.730978339417, -3059.0140028598016, -3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720393077080605, "mean_inference_ms": 0.37949577833899384, "mean_action_processing_ms": 0.0924086034175777, "mean_env_wait_ms": 0.8976624307399014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034902095794677734, "StateBufferConnector_ms": 0.0028378963470458984, "ViewRequirementAgentConnector_ms": 0.06648111343383789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51773040, "num_agent_steps_trained": 51773040, "num_env_steps_sampled": 51773040, "num_env_steps_trained": 51773040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.16556030475003, "num_env_steps_trained_throughput_per_sec": 110.16556030475003, "timesteps_total": 51773040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51773040, "timers": {"training_iteration_time_ms": 3271.453, "sample_time_ms": 3260.57, "load_time_ms": 0.305, "load_throughput": 1181679.011, "learn_time_ms": 9.815, "learn_throughput": 36677.568, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 51773040, "num_env_steps_trained": 51773040, "num_agent_steps_sampled": 51773040, "num_agent_steps_trained": 51773040}, "done": false, "episodes_total": 13271, "training_iteration": 4102, "trial_id": "ef964_00000", "date": "2023-08-08_14-33-52", "timestamp": 1691494432, "time_this_iter_s": 13.074107885360718, "time_total_s": 96236.24624085426, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3214.566790342331, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 20.036842105263162, "ram_util_percent": 65.26315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -362.1361938476563, "policy_loss": -3920346.853125, "vf_loss": 15476096.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4898.0, "diff_num_grad_updates_vs_sampler_policy": 4897.0}}, "num_env_steps_sampled": 51774480, "num_env_steps_trained": 51774480, "num_agent_steps_sampled": 51774480, "num_agent_steps_trained": 51774480}, "sampler_results": {"episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.5521233158443, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7202259108022995, "mean_inference_ms": 0.37947386819805845, "mean_action_processing_ms": 0.09240494857899784, "mean_env_wait_ms": 0.8976125204655655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034906864166259766, "StateBufferConnector_ms": 0.0028395652770996094, "ViewRequirementAgentConnector_ms": 0.0664970874786377}}, "episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.5521233158443, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3073.100504857274, -3071.2954442942905, -3023.095914250603, -3096.6607494611903, -3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7202259108022995, "mean_inference_ms": 0.37947386819805845, "mean_action_processing_ms": 0.09240494857899784, "mean_env_wait_ms": 0.8976125204655655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034906864166259766, "StateBufferConnector_ms": 0.0028395652770996094, "ViewRequirementAgentConnector_ms": 0.0664970874786377}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51774480, "num_agent_steps_trained": 51774480, "num_env_steps_sampled": 51774480, "num_env_steps_trained": 51774480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.39990692726742, "num_env_steps_trained_throughput_per_sec": 109.39990692726742, "timesteps_total": 51774480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51774480, "timers": {"training_iteration_time_ms": 3277.726, "sample_time_ms": 3266.854, "load_time_ms": 0.307, "load_throughput": 1173687.866, "learn_time_ms": 9.801, "learn_throughput": 36731.905, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51774480, "num_env_steps_trained": 51774480, "num_agent_steps_sampled": 51774480, "num_agent_steps_trained": 51774480}, "done": false, "episodes_total": 13275, "training_iteration": 4103, "trial_id": "ef964_00000", "date": "2023-08-08_14-34-05", "timestamp": 1691494445, "time_this_iter_s": 13.165594100952148, "time_total_s": 96249.41183495522, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3227.732384443283, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 19.715789473684207, "ram_util_percent": 65.32105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.40012817382814, "policy_loss": -1178760.709375, "vf_loss": 15495817.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4918.0, "diff_num_grad_updates_vs_sampler_policy": 4917.0}}, "num_env_steps_sampled": 51775920, "num_env_steps_trained": 51775920, "num_agent_steps_sampled": 51775920, "num_agent_steps_trained": 51775920}, "sampler_results": {"episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.1244917921845, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720096184846575, "mean_inference_ms": 0.379452786003785, "mean_action_processing_ms": 0.092401525838733, "mean_env_wait_ms": 0.8975630358644334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498077392578125, "StateBufferConnector_ms": 0.0028388500213623047, "ViewRequirementAgentConnector_ms": 0.06655621528625488}}, "episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3075.1244917921845, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3073.8190592164415, -3073.5766476323724, -3141.31016442594, -3120.0608410427944, -3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.720096184846575, "mean_inference_ms": 0.379452786003785, "mean_action_processing_ms": 0.092401525838733, "mean_env_wait_ms": 0.8975630358644334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498077392578125, "StateBufferConnector_ms": 0.0028388500213623047, "ViewRequirementAgentConnector_ms": 0.06655621528625488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51775920, "num_agent_steps_trained": 51775920, "num_env_steps_sampled": 51775920, "num_env_steps_trained": 51775920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.54293981271775, "num_env_steps_trained_throughput_per_sec": 109.54293981271775, "timesteps_total": 51775920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51775920, "timers": {"training_iteration_time_ms": 3282.109, "sample_time_ms": 3271.373, "load_time_ms": 0.31, "load_throughput": 1161499.569, "learn_time_ms": 9.666, "learn_throughput": 37242.609, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 51775920, "num_env_steps_trained": 51775920, "num_agent_steps_sampled": 51775920, "num_agent_steps_trained": 51775920}, "done": false, "episodes_total": 13279, "training_iteration": 4104, "trial_id": "ef964_00000", "date": "2023-08-08_14-34-18", "timestamp": 1691494458, "time_this_iter_s": 13.14857006072998, "time_total_s": 96262.56040501595, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3240.880954504013, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 18.688888888888886, "ram_util_percent": 65.26666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.54853515625, "policy_loss": -12127755.7875, "vf_loss": 15364529.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4938.0, "diff_num_grad_updates_vs_sampler_policy": 4937.0}}, "num_env_steps_sampled": 51777360, "num_env_steps_trained": 51777360, "num_agent_steps_sampled": 51777360, "num_agent_steps_trained": 51777360}, "sampler_results": {"episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3073.4161070360856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719985632227985, "mean_inference_ms": 0.37943305739994515, "mean_action_processing_ms": 0.09239847497546806, "mean_env_wait_ms": 0.8975077685027347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003508329391479492, "StateBufferConnector_ms": 0.002849102020263672, "ViewRequirementAgentConnector_ms": 0.06676316261291504}}, "episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.3362822387835, "episode_reward_mean": -3073.4161070360856, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3092.2797725690693, -3117.5844324546033, -3069.8423046757275, -3174.3362822387835, -3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719985632227985, "mean_inference_ms": 0.37943305739994515, "mean_action_processing_ms": 0.09239847497546806, "mean_env_wait_ms": 0.8975077685027347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003508329391479492, "StateBufferConnector_ms": 0.002849102020263672, "ViewRequirementAgentConnector_ms": 0.06676316261291504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51777360, "num_agent_steps_trained": 51777360, "num_env_steps_sampled": 51777360, "num_env_steps_trained": 51777360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.90092881949768, "num_env_steps_trained_throughput_per_sec": 109.90092881949768, "timesteps_total": 51777360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51777360, "timers": {"training_iteration_time_ms": 3282.725, "sample_time_ms": 3271.897, "load_time_ms": 0.31, "load_throughput": 1162035.893, "learn_time_ms": 9.753, "learn_throughput": 36910.138, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 51777360, "num_env_steps_trained": 51777360, "num_agent_steps_sampled": 51777360, "num_agent_steps_trained": 51777360}, "done": false, "episodes_total": 13283, "training_iteration": 4105, "trial_id": "ef964_00000", "date": "2023-08-08_14-34-31", "timestamp": 1691494471, "time_this_iter_s": 13.105687856674194, "time_total_s": 96275.66609287262, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3253.9866423606873, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 20.068421052631578, "ram_util_percent": 65.11578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -365.42760009765624, "policy_loss": -6854001.209375, "vf_loss": 15716020.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4958.0, "diff_num_grad_updates_vs_sampler_policy": 4957.0}}, "num_env_steps_sampled": 51778800, "num_env_steps_trained": 51778800, "num_agent_steps_sampled": 51778800, "num_agent_steps_trained": 51778800}, "sampler_results": {"episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3071.70983496738, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7198852167702885, "mean_inference_ms": 0.3794143937194488, "mean_action_processing_ms": 0.09239557883458371, "mean_env_wait_ms": 0.8974469922884257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003549337387084961, "StateBufferConnector_ms": 0.0028514862060546875, "ViewRequirementAgentConnector_ms": 0.06681394577026367}}, "episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3071.70983496738, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3095.1836463202367, -3047.3717940600372, -3095.1050854108207, -3084.2277589942087, -3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.7198852167702885, "mean_inference_ms": 0.3794143937194488, "mean_action_processing_ms": 0.09239557883458371, "mean_env_wait_ms": 0.8974469922884257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003549337387084961, "StateBufferConnector_ms": 0.0028514862060546875, "ViewRequirementAgentConnector_ms": 0.06681394577026367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51778800, "num_agent_steps_trained": 51778800, "num_env_steps_sampled": 51778800, "num_env_steps_trained": 51778800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.786782566613, "num_env_steps_trained_throughput_per_sec": 109.786782566613, "timesteps_total": 51778800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51778800, "timers": {"training_iteration_time_ms": 3273.697, "sample_time_ms": 3262.814, "load_time_ms": 0.308, "load_throughput": 1169868.629, "learn_time_ms": 9.791, "learn_throughput": 36767.145, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 51778800, "num_env_steps_trained": 51778800, "num_agent_steps_sampled": 51778800, "num_agent_steps_trained": 51778800}, "done": false, "episodes_total": 13287, "training_iteration": 4106, "trial_id": "ef964_00000", "date": "2023-08-08_14-34-45", "timestamp": 1691494485, "time_this_iter_s": 13.119378089904785, "time_total_s": 96288.78547096252, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3267.106020450592, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 19.605263157894733, "ram_util_percent": 65.14736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.45807495117185, "policy_loss": -12148157.75625, "vf_loss": 16079730.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4978.0, "diff_num_grad_updates_vs_sampler_policy": 4977.0}}, "num_env_steps_sampled": 51780240, "num_env_steps_trained": 51780240, "num_agent_steps_sampled": 51780240, "num_agent_steps_trained": 51780240}, "sampler_results": {"episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3071.312154042007, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719797810562523, "mean_inference_ms": 0.3793972263652314, "mean_action_processing_ms": 0.09239292702361034, "mean_env_wait_ms": 0.8973886508374406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003555774688720703, "StateBufferConnector_ms": 0.0028524398803710938, "ViewRequirementAgentConnector_ms": 0.0668344497680664}}, "episode_reward_max": -3022.3087310313535, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3071.312154042007, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.4183243000407, -3157.3669168228876, -3093.122526512816, -3095.4257251525555, -3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719797810562523, "mean_inference_ms": 0.3793972263652314, "mean_action_processing_ms": 0.09239292702361034, "mean_env_wait_ms": 0.8973886508374406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003555774688720703, "StateBufferConnector_ms": 0.0028524398803710938, "ViewRequirementAgentConnector_ms": 0.0668344497680664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51780240, "num_agent_steps_trained": 51780240, "num_env_steps_sampled": 51780240, "num_env_steps_trained": 51780240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.23751811499938, "num_env_steps_trained_throughput_per_sec": 109.23751811499938, "timesteps_total": 51780240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51780240, "timers": {"training_iteration_time_ms": 3286.225, "sample_time_ms": 3275.412, "load_time_ms": 0.303, "load_throughput": 1186600.739, "learn_time_ms": 9.737, "learn_throughput": 36972.679, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51780240, "num_env_steps_trained": 51780240, "num_agent_steps_sampled": 51780240, "num_agent_steps_trained": 51780240}, "done": false, "episodes_total": 13291, "training_iteration": 4107, "trial_id": "ef964_00000", "date": "2023-08-08_14-34-58", "timestamp": 1691494498, "time_this_iter_s": 13.185054063796997, "time_total_s": 96301.97052502632, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3280.291074514389, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 20.610526315789475, "ram_util_percent": 65.06842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -364.1717102050781, "policy_loss": -17256651.83125, "vf_loss": 16873416.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4998.0, "diff_num_grad_updates_vs_sampler_policy": 4997.0}}, "num_env_steps_sampled": 51781680, "num_env_steps_trained": 51781680, "num_agent_steps_sampled": 51781680, "num_agent_steps_trained": 51781680}, "sampler_results": {"episode_reward_max": -3022.0781625190584, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3070.4280762306234, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719720904340043, "mean_inference_ms": 0.3793812441741278, "mean_action_processing_ms": 0.09239050484380598, "mean_env_wait_ms": 0.8973270323858417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035657882690429688, "StateBufferConnector_ms": 0.002835988998413086, "ViewRequirementAgentConnector_ms": 0.06671428680419922}}, "episode_reward_max": -3022.0781625190584, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3070.4280762306234, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3073.4362682734786, -3022.7940709257464, -3120.69795942991, -3143.0037798419776, -3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719720904340043, "mean_inference_ms": 0.3793812441741278, "mean_action_processing_ms": 0.09239050484380598, "mean_env_wait_ms": 0.8973270323858417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035657882690429688, "StateBufferConnector_ms": 0.002835988998413086, "ViewRequirementAgentConnector_ms": 0.06671428680419922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51781680, "num_agent_steps_trained": 51781680, "num_env_steps_sampled": 51781680, "num_env_steps_trained": 51781680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.87042277953536, "num_env_steps_trained_throughput_per_sec": 109.87042277953536, "timesteps_total": 51781680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51781680, "timers": {"training_iteration_time_ms": 3283.017, "sample_time_ms": 3272.233, "load_time_ms": 0.308, "load_throughput": 1168601.068, "learn_time_ms": 9.717, "learn_throughput": 37047.61, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 51781680, "num_env_steps_trained": 51781680, "num_agent_steps_sampled": 51781680, "num_agent_steps_trained": 51781680}, "done": false, "episodes_total": 13295, "training_iteration": 4108, "trial_id": "ef964_00000", "date": "2023-08-08_14-35-11", "timestamp": 1691494511, "time_this_iter_s": 13.109230041503906, "time_total_s": 96315.07975506783, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3293.400304555893, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 19.37777777777778, "ram_util_percent": 64.98888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -382.05604248046876, "policy_loss": 319763.153125, "vf_loss": 14941571.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5018.0, "diff_num_grad_updates_vs_sampler_policy": 5017.0}}, "num_env_steps_sampled": 51783120, "num_env_steps_trained": 51783120, "num_agent_steps_sampled": 51783120, "num_agent_steps_trained": 51783120}, "sampler_results": {"episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3069.0363570806153, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719645386885916, "mean_inference_ms": 0.379365748269896, "mean_action_processing_ms": 0.09238816112950815, "mean_env_wait_ms": 0.8972611166081412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003569364547729492, "StateBufferConnector_ms": 0.0028383731842041016, "ViewRequirementAgentConnector_ms": 0.06673598289489746}}, "episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3069.0363570806153, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3071.788184105527, -3095.13290638161, -3050.5941190901276, -3094.336411873279, -3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719645386885916, "mean_inference_ms": 0.379365748269896, "mean_action_processing_ms": 0.09238816112950815, "mean_env_wait_ms": 0.8972611166081412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003569364547729492, "StateBufferConnector_ms": 0.0028383731842041016, "ViewRequirementAgentConnector_ms": 0.06673598289489746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51783120, "num_agent_steps_trained": 51783120, "num_env_steps_sampled": 51783120, "num_env_steps_trained": 51783120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.76324224402106, "num_env_steps_trained_throughput_per_sec": 110.76324224402106, "timesteps_total": 51783120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51783120, "timers": {"training_iteration_time_ms": 3275.977, "sample_time_ms": 3265.12, "load_time_ms": 0.308, "load_throughput": 1170503.442, "learn_time_ms": 9.785, "learn_throughput": 36792.409, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51783120, "num_env_steps_trained": 51783120, "num_agent_steps_sampled": 51783120, "num_agent_steps_trained": 51783120}, "done": false, "episodes_total": 13299, "training_iteration": 4109, "trial_id": "ef964_00000", "date": "2023-08-08_14-35-24", "timestamp": 1691494524, "time_this_iter_s": 13.003461837768555, "time_total_s": 96328.0832169056, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3306.4037663936615, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 20.26315789473684, "ram_util_percent": 65.02631578947367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -381.81874389648436, "policy_loss": -913507.60625, "vf_loss": 15227815.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5038.0, "diff_num_grad_updates_vs_sampler_policy": 5037.0}}, "num_env_steps_sampled": 51784560, "num_env_steps_trained": 51784560, "num_agent_steps_sampled": 51784560, "num_agent_steps_trained": 51784560}, "sampler_results": {"episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3067.8347035289853, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719577909827624, "mean_inference_ms": 0.37935111171399877, "mean_action_processing_ms": 0.09238603482754751, "mean_env_wait_ms": 0.8971918089269388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035758018493652344, "StateBufferConnector_ms": 0.002840757369995117, "ViewRequirementAgentConnector_ms": 0.06675982475280762}}, "episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3067.8347035289853, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3094.2911217736, -3051.2626552190645, -3071.9805121694844, -3117.6535621444064, -3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719577909827624, "mean_inference_ms": 0.37935111171399877, "mean_action_processing_ms": 0.09238603482754751, "mean_env_wait_ms": 0.8971918089269388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035758018493652344, "StateBufferConnector_ms": 0.002840757369995117, "ViewRequirementAgentConnector_ms": 0.06675982475280762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51784560, "num_agent_steps_trained": 51784560, "num_env_steps_sampled": 51784560, "num_env_steps_trained": 51784560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.90606773343973, "num_env_steps_trained_throughput_per_sec": 108.90606773343973, "timesteps_total": 51784560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51784560, "timers": {"training_iteration_time_ms": 3277.142, "sample_time_ms": 3266.21, "load_time_ms": 0.302, "load_throughput": 1193070.038, "learn_time_ms": 9.857, "learn_throughput": 36521.963, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51784560, "num_env_steps_trained": 51784560, "num_agent_steps_sampled": 51784560, "num_agent_steps_trained": 51784560}, "done": false, "episodes_total": 13303, "training_iteration": 4110, "trial_id": "ef964_00000", "date": "2023-08-08_14-35-37", "timestamp": 1691494537, "time_this_iter_s": 13.225275754928589, "time_total_s": 96341.30849266052, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3319.62904214859, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 20.98421052631579, "ram_util_percent": 65.23684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.01801147460935, "policy_loss": -10094963.603125, "vf_loss": 15792417.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5058.0, "diff_num_grad_updates_vs_sampler_policy": 5057.0}}, "num_env_steps_sampled": 51786000, "num_env_steps_trained": 51786000, "num_agent_steps_sampled": 51786000, "num_agent_steps_trained": 51786000}, "sampler_results": {"episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3067.834920977229, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719519363173052, "mean_inference_ms": 0.37933791254061716, "mean_action_processing_ms": 0.09238413147163385, "mean_env_wait_ms": 0.8971223292796268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035791397094726562, "StateBufferConnector_ms": 0.0028471946716308594, "ViewRequirementAgentConnector_ms": 0.06673288345336914}}, "episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3067.834920977229, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3138.348778600641, -3029.618058994153, -3075.625797153899, -3075.0905239326194, -3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719519363173052, "mean_inference_ms": 0.37933791254061716, "mean_action_processing_ms": 0.09238413147163385, "mean_env_wait_ms": 0.8971223292796268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035791397094726562, "StateBufferConnector_ms": 0.0028471946716308594, "ViewRequirementAgentConnector_ms": 0.06673288345336914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51786000, "num_agent_steps_trained": 51786000, "num_env_steps_sampled": 51786000, "num_env_steps_trained": 51786000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.02124238125384, "num_env_steps_trained_throughput_per_sec": 109.02124238125384, "timesteps_total": 51786000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51786000, "timers": {"training_iteration_time_ms": 3295.681, "sample_time_ms": 3284.766, "load_time_ms": 0.301, "load_throughput": 1196094.297, "learn_time_ms": 9.849, "learn_throughput": 36553.262, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 51786000, "num_env_steps_trained": 51786000, "num_agent_steps_sampled": 51786000, "num_agent_steps_trained": 51786000}, "done": false, "episodes_total": 13307, "training_iteration": 4111, "trial_id": "ef964_00000", "date": "2023-08-08_14-35-50", "timestamp": 1691494550, "time_this_iter_s": 13.211337089538574, "time_total_s": 96354.51982975006, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3332.8403792381287, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 20.377777777777776, "ram_util_percent": 65.24999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -363.0261474609375, "policy_loss": -17693026.35625, "vf_loss": 16339111.7}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5078.0, "diff_num_grad_updates_vs_sampler_policy": 5077.0}}, "num_env_steps_sampled": 51787440, "num_env_steps_trained": 51787440, "num_agent_steps_sampled": 51787440, "num_agent_steps_trained": 51787440}, "sampler_results": {"episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3069.7425913921406, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446, -3169.514995405516, -3045.5073763529617, -3138.897107620661, -3155.530720793352], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719472865296114, "mean_inference_ms": 0.37932636502666484, "mean_action_processing_ms": 0.09238255473606007, "mean_env_wait_ms": 0.8970563829545959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035779476165771484, "StateBufferConnector_ms": 0.002849578857421875, "ViewRequirementAgentConnector_ms": 0.06676650047302246}}, "episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3069.7425913921406, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3047.462444506838, -3025.1076660992135, -3139.3841452373986, -3022.566867863805, -3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446, -3169.514995405516, -3045.5073763529617, -3138.897107620661, -3155.530720793352], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719472865296114, "mean_inference_ms": 0.37932636502666484, "mean_action_processing_ms": 0.09238255473606007, "mean_env_wait_ms": 0.8970563829545959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035779476165771484, "StateBufferConnector_ms": 0.002849578857421875, "ViewRequirementAgentConnector_ms": 0.06676650047302246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51787440, "num_agent_steps_trained": 51787440, "num_env_steps_sampled": 51787440, "num_env_steps_trained": 51787440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.23458481373127, "num_env_steps_trained_throughput_per_sec": 108.23458481373127, "timesteps_total": 51787440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51787440, "timers": {"training_iteration_time_ms": 3315.486, "sample_time_ms": 3304.578, "load_time_ms": 0.301, "load_throughput": 1194958.405, "learn_time_ms": 9.83, "learn_throughput": 36623.746, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 51787440, "num_env_steps_trained": 51787440, "num_agent_steps_sampled": 51787440, "num_agent_steps_trained": 51787440}, "done": false, "episodes_total": 13311, "training_iteration": 4112, "trial_id": "ef964_00000", "date": "2023-08-08_14-36-04", "timestamp": 1691494564, "time_this_iter_s": 13.30732798576355, "time_total_s": 96367.82715773582, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3346.147707223892, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 19.047368421052635, "ram_util_percent": 65.34210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -378.82277221679686, "policy_loss": -3196539.775, "vf_loss": 15662353.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5098.0, "diff_num_grad_updates_vs_sampler_policy": 5097.0}}, "num_env_steps_sampled": 51788880, "num_env_steps_trained": 51788880, "num_agent_steps_sampled": 51788880, "num_agent_steps_trained": 51788880}, "sampler_results": {"episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3069.5223803783483, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446, -3169.514995405516, -3045.5073763529617, -3138.897107620661, -3155.530720793352, -3046.7853165408314, -3025.8977937644627, -3069.02137521607, -3070.795536806567], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719443453620272, "mean_inference_ms": 0.3793150266782939, "mean_action_processing_ms": 0.09238098466343385, "mean_env_wait_ms": 0.8969902207837872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035712718963623047, "StateBufferConnector_ms": 0.002849578857421875, "ViewRequirementAgentConnector_ms": 0.0667121410369873}}, "episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3069.5223803783483, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3048.4096543714054, -3049.2328405381845, -3070.619900550835, -3049.2913127863108, -3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446, -3169.514995405516, -3045.5073763529617, -3138.897107620661, -3155.530720793352, -3046.7853165408314, -3025.8977937644627, -3069.02137521607, -3070.795536806567], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719443453620272, "mean_inference_ms": 0.3793150266782939, "mean_action_processing_ms": 0.09238098466343385, "mean_env_wait_ms": 0.8969902207837872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035712718963623047, "StateBufferConnector_ms": 0.002849578857421875, "ViewRequirementAgentConnector_ms": 0.0667121410369873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51788880, "num_agent_steps_trained": 51788880, "num_env_steps_sampled": 51788880, "num_env_steps_trained": 51788880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.58041078958942, "num_env_steps_trained_throughput_per_sec": 110.58041078958942, "timesteps_total": 51788880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51788880, "timers": {"training_iteration_time_ms": 3294.823, "sample_time_ms": 3283.971, "load_time_ms": 0.302, "load_throughput": 1193070.038, "learn_time_ms": 9.772, "learn_throughput": 36840.435, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 51788880, "num_env_steps_trained": 51788880, "num_agent_steps_sampled": 51788880, "num_agent_steps_trained": 51788880}, "done": false, "episodes_total": 13315, "training_iteration": 4113, "trial_id": "ef964_00000", "date": "2023-08-08_14-36-17", "timestamp": 1691494577, "time_this_iter_s": 13.02496886253357, "time_total_s": 96380.85212659836, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3359.172676086426, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 21.321052631578947, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -361.7414794921875, "policy_loss": -9636097.56875, "vf_loss": 15849256.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5118.0, "diff_num_grad_updates_vs_sampler_policy": 5117.0}}, "num_env_steps_sampled": 51790320, "num_env_steps_trained": 51790320, "num_agent_steps_sampled": 51790320, "num_agent_steps_trained": 51790320}, "sampler_results": {"episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3070.5218796080126, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446, -3169.514995405516, -3045.5073763529617, -3138.897107620661, -3155.530720793352, -3046.7853165408314, -3025.8977937644627, -3069.02137521607, -3070.795536806567, -3070.6920895695334, -3058.3849600825865, -3094.2050660815016, -3094.221515479617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719412300271615, "mean_inference_ms": 0.37930360528901774, "mean_action_processing_ms": 0.09237939283430814, "mean_env_wait_ms": 0.8969249308515608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035734176635742188, "StateBufferConnector_ms": 0.002836465835571289, "ViewRequirementAgentConnector_ms": 0.06670236587524414}}, "episode_reward_max": -3000.0932513516786, "episode_reward_min": -3174.083154447855, "episode_reward_mean": -3070.5218796080126, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3045.7081466218233, -3174.083154447855, -3093.8007352516975, -3048.421373767641, -3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446, -3169.514995405516, -3045.5073763529617, -3138.897107620661, -3155.530720793352, -3046.7853165408314, -3025.8977937644627, -3069.02137521607, -3070.795536806567, -3070.6920895695334, -3058.3849600825865, -3094.2050660815016, -3094.221515479617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719412300271615, "mean_inference_ms": 0.37930360528901774, "mean_action_processing_ms": 0.09237939283430814, "mean_env_wait_ms": 0.8969249308515608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035734176635742188, "StateBufferConnector_ms": 0.002836465835571289, "ViewRequirementAgentConnector_ms": 0.06670236587524414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51790320, "num_agent_steps_trained": 51790320, "num_env_steps_sampled": 51790320, "num_env_steps_trained": 51790320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.18514551977214, "num_env_steps_trained_throughput_per_sec": 110.18514551977214, "timesteps_total": 51790320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51790320, "timers": {"training_iteration_time_ms": 3275.525, "sample_time_ms": 3264.665, "load_time_ms": 0.301, "load_throughput": 1196757.898, "learn_time_ms": 9.785, "learn_throughput": 36789.361, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 51790320, "num_env_steps_trained": 51790320, "num_agent_steps_sampled": 51790320, "num_agent_steps_trained": 51790320}, "done": false, "episodes_total": 13319, "training_iteration": 4114, "trial_id": "ef964_00000", "date": "2023-08-08_14-36-30", "timestamp": 1691494590, "time_this_iter_s": 13.071874618530273, "time_total_s": 96393.92400121689, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3372.244550704956, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 19.922222222222224, "ram_util_percent": 65.11666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.15, "policy_entropy": -368.0219421386719, "policy_loss": -4139909.25625, "vf_loss": 15771757.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5138.0, "diff_num_grad_updates_vs_sampler_policy": 5137.0}}, "num_env_steps_sampled": 51791760, "num_env_steps_trained": 51791760, "num_agent_steps_sampled": 51791760, "num_agent_steps_trained": 51791760}, "sampler_results": {"episode_reward_max": -3000.0932513516786, "episode_reward_min": -3169.514995405516, "episode_reward_mean": -3070.477404826837, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446, -3169.514995405516, -3045.5073763529617, -3138.897107620661, -3155.530720793352, -3046.7853165408314, -3025.8977937644627, -3069.02137521607, -3070.795536806567, -3070.6920895695334, -3058.3849600825865, -3094.2050660815016, -3094.221515479617, -3070.745107958803, -3097.307129256748, -3119.9521919538015, -3069.5615028021175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719387156965367, "mean_inference_ms": 0.3792922769550101, "mean_action_processing_ms": 0.09237783550431304, "mean_env_wait_ms": 0.8968616561146108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035698413848876953, "StateBufferConnector_ms": 0.0027976036071777344, "ViewRequirementAgentConnector_ms": 0.06644654273986816}}, "episode_reward_max": -3000.0932513516786, "episode_reward_min": -3169.514995405516, "episode_reward_mean": -3070.477404826837, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3023.682980052085, -3048.5274855603957, -3075.805149817844, -3146.0587912403944, -3101.0486056149102, -3098.977052356963, -3119.5199120485413, -3070.559835137195, -3046.8077112401315, -3046.6511786682445, -3142.0419339308614, -3022.3087310313535, -3046.2364121878218, -3046.192133250565, -3048.65534890428, -3070.7155018256167, -3024.4484396537814, -3082.091037084723, -3069.074374709329, -3074.2326448433046, -3071.954974957549, -3093.8383129302997, -3022.9679344822193, -3047.7013923515156, -3044.9082988892546, -3092.895647874195, -3072.9233652632743, -3047.4934140195114, -3050.6193090505276, -3117.262842742832, -3023.014615279943, -3048.910204122156, -3048.07354444834, -3045.3163013253397, -3094.0560262673303, -3045.9914422352676, -3050.1840296853775, -3093.7775998800885, -3120.724803780382, -3047.904839734749, -3046.194598150534, -3096.642174404636, -3049.5329093121572, -3055.0356601989856, -3094.6459828390184, -3025.49857611054, -3046.1569265841404, -3167.134990493029, -3119.796053877802, -3046.5092671590783, -3049.235500217187, -3068.748687113551, -3049.7393144309463, -3069.468502574241, -3047.6304841597566, -3054.5511593324127, -3047.2831289792557, -3046.942890229347, -3072.4708593407368, -3071.2313581583435, -3069.218180927359, -3071.242052300402, -3071.698849923845, -3071.2565019160847, -3068.9176017408154, -3046.762270252334, -3048.830319329562, -3117.6100009253337, -3069.924272767046, -3022.0781625190584, -3070.9317593258324, -3165.991517037933, -3050.082516056411, -3047.736751217581, -3122.8476448446263, -3000.0932513516786, -3049.170423825402, -3046.553974934425, -3069.5707194740717, -3026.391148053675, -3024.2220592877356, -3045.48284150762, -3146.283644009129, -3119.221051326446, -3169.514995405516, -3045.5073763529617, -3138.897107620661, -3155.530720793352, -3046.7853165408314, -3025.8977937644627, -3069.02137521607, -3070.795536806567, -3070.6920895695334, -3058.3849600825865, -3094.2050660815016, -3094.221515479617, -3070.745107958803, -3097.307129256748, -3119.9521919538015, -3069.5615028021175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.719387156965367, "mean_inference_ms": 0.3792922769550101, "mean_action_processing_ms": 0.09237783550431304, "mean_env_wait_ms": 0.8968616561146108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035698413848876953, "StateBufferConnector_ms": 0.0027976036071777344, "ViewRequirementAgentConnector_ms": 0.06644654273986816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51791760, "num_agent_steps_trained": 51791760, "num_env_steps_sampled": 51791760, "num_env_steps_trained": 51791760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.29784783883775, "num_env_steps_trained_throughput_per_sec": 109.29784783883775, "timesteps_total": 51791760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 51791760, "timers": {"training_iteration_time_ms": 3274.597, "sample_time_ms": 3263.738, "load_time_ms": 0.3, "load_throughput": 1199800.906, "learn_time_ms": 9.788, "learn_throughput": 36780.848, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 51791760, "num_env_steps_trained": 51791760, "num_agent_steps_sampled": 51791760, "num_agent_steps_trained": 51791760}, "done": true, "episodes_total": 13323, "training_iteration": 4115, "trial_id": "ef964_00000", "date": "2023-08-08_14-36-43", "timestamp": 1691494603, "time_this_iter_s": 13.177806854248047, "time_total_s": 96407.10180807114, "pid": 23865, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51425280, 5e-07], [51428880, 5e-07], [51432480, 5e-07], [51436080, 2.5e-07], [51439680, 2.5e-07], [51443280, 2.5e-07], [51446880, 2.5e-07], [51450480, 1e-07], [51454080, 1e-07], [51457680, 1e-07], [51461280, 1e-07], [51464880, 1e-07], [51468480, 5e-08], [51472080, 5e-08], [51475680, 5e-08], [51479280, 5e-08], [51482880, 2.5e-08], [51486480, 2.5e-08], [51490080, 2.5e-08], [51493680, 2.5e-09], [51497280, 1e-09], [51500880, 1e-09], [51504480, 1e-09], [51508080, 5e-10], [51511680, 5e-10], [51515280, 5e-10]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.3, "final_epsilon": 0.01, "epsilon_timesteps": 51518880}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f4b2820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3385.422357559204, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 18.957894736842107, "ram_util_percent": 65.14736842105263}}
