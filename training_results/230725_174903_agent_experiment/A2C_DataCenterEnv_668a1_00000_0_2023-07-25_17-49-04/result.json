{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00033611111111111114, "entropy_coeff": 0.1, "policy_entropy": -926.6512451171875, "policy_loss": -276158394400768.0, "vf_loss": 535514624.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 9000}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8583.379329401037, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.105376806285573, "mean_inference_ms": 0.4198016222163911, "mean_action_processing_ms": 0.0968223793684941, "mean_env_wait_ms": 10.955247852610748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449122111002604, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.06943543752034505}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8583.379329401037, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.105376806285573, "mean_inference_ms": 0.4198016222163911, "mean_action_processing_ms": 0.0968223793684941, "mean_env_wait_ms": 10.955247852610748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449122111002604, "StateBufferConnector_ms": 0.002956390380859375, "ViewRequirementAgentConnector_ms": 0.06943543752034505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 9000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 9000, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 29.590925464449537, "num_env_steps_trained_throughput_per_sec": 29.590925464449537, "timesteps_total": 9000, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 4055.282, "sample_time_ms": 4046.227, "load_time_ms": 0.356, "load_throughput": 337117.535, "learn_time_ms": 7.844, "learn_throughput": 15297.753, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 9000}, "done": false, "episodes_total": 27, "training_iteration": 6, "trial_id": "668a1_00000", "date": "2023-07-25_17-49-23", "timestamp": 1690296563, "time_this_iter_s": 12.16845703125, "time_total_s": 67.53206086158752, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.16845703125, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.049999999999997, "ram_util_percent": 76.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00026944444444444444, "entropy_coeff": 0.1, "policy_entropy": -926.6593627929688, "policy_loss": -2.670093121093632e+16, "vf_loss": 581590400.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 9480, "num_env_steps_trained": 9480, "num_agent_steps_sampled": 9480, "num_agent_steps_trained": 9480}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8571.419640572434, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.096320096011535, "mean_inference_ms": 0.41025462479859975, "mean_action_processing_ms": 0.09627884872533159, "mean_env_wait_ms": 8.268005010831136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037738255092075895, "StateBufferConnector_ms": 0.0028644289289202008, "ViewRequirementAgentConnector_ms": 0.06908689226422991}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8571.419640572434, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.096320096011535, "mean_inference_ms": 0.41025462479859975, "mean_action_processing_ms": 0.09627884872533159, "mean_env_wait_ms": 8.268005010831136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037738255092075895, "StateBufferConnector_ms": 0.0028644289289202008, "ViewRequirementAgentConnector_ms": 0.06908689226422991}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9480, "num_agent_steps_trained": 9480, "num_env_steps_sampled": 9480, "num_env_steps_trained": 9480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.441466622840764, "num_env_steps_trained_throughput_per_sec": 39.441466622840764, "timesteps_total": 9480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 9480, "timers": {"training_iteration_time_ms": 3476.533, "sample_time_ms": 3470.505, "load_time_ms": 0.275, "load_throughput": 436041.505, "learn_time_ms": 4.966, "learn_throughput": 24163.72, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 9480, "num_env_steps_trained": 9480, "num_agent_steps_sampled": 9480, "num_agent_steps_trained": 9480}, "done": false, "episodes_total": 31, "training_iteration": 7, "trial_id": "668a1_00000", "date": "2023-07-25_17-49-35", "timestamp": 1690296575, "time_this_iter_s": 12.172340154647827, "time_total_s": 79.70440101623535, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 24.340797185897827, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.982352941176472, "ram_util_percent": 75.7470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00022166666666666667, "entropy_coeff": 0.1, "policy_entropy": -926.6641845703125, "policy_loss": -7681692890300416.0, "vf_loss": 565223744.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8555.823847141934, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.046346193293807, "mean_inference_ms": 0.4071617441476114, "mean_action_processing_ms": 0.09611071259042202, "mean_env_wait_ms": 7.094436243510759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038862228393554688, "StateBufferConnector_ms": 0.0028155066750266337, "ViewRequirementAgentConnector_ms": 0.06917823444713246}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8555.823847141934, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.046346193293807, "mean_inference_ms": 0.4071617441476114, "mean_action_processing_ms": 0.09611071259042202, "mean_env_wait_ms": 7.094436243510759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038862228393554688, "StateBufferConnector_ms": 0.0028155066750266337, "ViewRequirementAgentConnector_ms": 0.06917823444713246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960, "num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.65341231927287, "num_env_steps_trained_throughput_per_sec": 39.65341231927287, "timesteps_total": 9960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 9960, "timers": {"training_iteration_time_ms": 3053.133, "sample_time_ms": 3049.342, "load_time_ms": 0.215, "load_throughput": 557506.07, "learn_time_ms": 2.824, "learn_throughput": 42486.872, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960}, "done": false, "episodes_total": 35, "training_iteration": 8, "trial_id": "668a1_00000", "date": "2023-07-25_17-49-47", "timestamp": 1690296587, "time_this_iter_s": 12.107346057891846, "time_total_s": 91.8117470741272, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 36.44814324378967, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.200000000000003, "ram_util_percent": 76.58823529411767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00018166666666666667, "entropy_coeff": 0.1, "policy_entropy": -926.6663208007812, "policy_loss": -2319557486182400.0, "vf_loss": 556490368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8542.936716292781, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.056602577682337, "mean_inference_ms": 0.40478477761794757, "mean_action_processing_ms": 0.09587681435994917, "mean_env_wait_ms": 6.398737682191398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037145614624023438, "StateBufferConnector_ms": 0.0027577082316080728, "ViewRequirementAgentConnector_ms": 0.0688028335571289}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8542.936716292781, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.056602577682337, "mean_inference_ms": 0.40478477761794757, "mean_action_processing_ms": 0.09587681435994917, "mean_env_wait_ms": 6.398737682191398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037145614624023438, "StateBufferConnector_ms": 0.0027577082316080728, "ViewRequirementAgentConnector_ms": 0.0688028335571289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.53975999734909, "num_env_steps_trained_throughput_per_sec": 38.53975999734909, "timesteps_total": 10440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 10440, "timers": {"training_iteration_time_ms": 3074.36, "sample_time_ms": 3070.599, "load_time_ms": 0.218, "load_throughput": 549952.448, "learn_time_ms": 2.799, "learn_throughput": 42878.141, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "done": false, "episodes_total": 39, "training_iteration": 9, "trial_id": "668a1_00000", "date": "2023-07-25_17-50-00", "timestamp": 1690296600, "time_this_iter_s": 12.45722484588623, "time_total_s": 104.26897192001343, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 48.9053680896759, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.461111111111112, "ram_util_percent": 76.60555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00014166666666666668, "entropy_coeff": 0.1, "policy_entropy": -926.675048828125, "policy_loss": -1.387973979406336e+16, "vf_loss": 550280896.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 10920, "num_env_steps_trained": 10920, "num_agent_steps_sampled": 10920, "num_agent_steps_trained": 10920}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8546.639066844145, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.061325312465602, "mean_inference_ms": 0.4033956260747018, "mean_action_processing_ms": 0.09573093512806281, "mean_env_wait_ms": 5.923636923385281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036227075677168997, "StateBufferConnector_ms": 0.002715462132504112, "ViewRequirementAgentConnector_ms": 0.06864572826184724}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8546.639066844145, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.061325312465602, "mean_inference_ms": 0.4033956260747018, "mean_action_processing_ms": 0.09573093512806281, "mean_env_wait_ms": 5.923636923385281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036227075677168997, "StateBufferConnector_ms": 0.002715462132504112, "ViewRequirementAgentConnector_ms": 0.06864572826184724}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10920, "num_agent_steps_trained": 10920, "num_env_steps_sampled": 10920, "num_env_steps_trained": 10920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.24732749890578, "num_env_steps_trained_throughput_per_sec": 39.24732749890578, "timesteps_total": 10920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 10920, "timers": {"training_iteration_time_ms": 3075.854, "sample_time_ms": 3072.092, "load_time_ms": 0.218, "load_throughput": 550433.596, "learn_time_ms": 2.795, "learn_throughput": 42931.539, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 10920, "num_env_steps_trained": 10920, "num_agent_steps_sampled": 10920, "num_agent_steps_trained": 10920}, "done": false, "episodes_total": 43, "training_iteration": 10, "trial_id": "668a1_00000", "date": "2023-07-25_17-50-12", "timestamp": 1690296612, "time_this_iter_s": 12.232599258422852, "time_total_s": 116.50157117843628, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 61.137967348098755, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 26.08888888888889, "ram_util_percent": 76.37777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00010166666666666665, "entropy_coeff": 0.1, "policy_entropy": -926.6818237304688, "policy_loss": -3378281957031936.0, "vf_loss": 568601088.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8548.91309896112, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.061282320841226, "mean_inference_ms": 0.4023952420231737, "mean_action_processing_ms": 0.09562749950557885, "mean_env_wait_ms": 5.576600399366764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035980473393979278, "StateBufferConnector_ms": 0.002695166546365489, "ViewRequirementAgentConnector_ms": 0.06885943205460258}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8548.91309896112, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.061282320841226, "mean_inference_ms": 0.4023952420231737, "mean_action_processing_ms": 0.09562749950557885, "mean_env_wait_ms": 5.576600399366764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035980473393979278, "StateBufferConnector_ms": 0.002695166546365489, "ViewRequirementAgentConnector_ms": 0.06885943205460258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.2881505903831, "num_env_steps_trained_throughput_per_sec": 39.2881505903831, "timesteps_total": 11400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 11400, "timers": {"training_iteration_time_ms": 3055.009, "sample_time_ms": 3051.25, "load_time_ms": 0.219, "load_throughput": 547916.917, "learn_time_ms": 2.779, "learn_throughput": 43176.077, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400}, "done": false, "episodes_total": 47, "training_iteration": 11, "trial_id": "668a1_00000", "date": "2023-07-25_17-50-24", "timestamp": 1690296624, "time_this_iter_s": 12.220118999481201, "time_total_s": 128.72169017791748, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 73.35808634757996, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.852941176470583, "ram_util_percent": 76.35882352941178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.722222222222223e-05, "entropy_coeff": 0.1, "policy_entropy": -926.68896484375, "policy_loss": -8669525167833088.0, "vf_loss": 569156352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 11880, "num_env_steps_trained": 11880, "num_agent_steps_sampled": 11880, "num_agent_steps_trained": 11880}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8555.25244674883, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.06021045814088, "mean_inference_ms": 0.4016448965905901, "mean_action_processing_ms": 0.09555711530970745, "mean_env_wait_ms": 5.308983914916009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036804764359085647, "StateBufferConnector_ms": 0.0026711711177119504, "ViewRequirementAgentConnector_ms": 0.06869722295690465}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8555.25244674883, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.06021045814088, "mean_inference_ms": 0.4016448965905901, "mean_action_processing_ms": 0.09555711530970745, "mean_env_wait_ms": 5.308983914916009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036804764359085647, "StateBufferConnector_ms": 0.0026711711177119504, "ViewRequirementAgentConnector_ms": 0.06869722295690465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11880, "num_agent_steps_trained": 11880, "num_env_steps_sampled": 11880, "num_env_steps_trained": 11880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.30545942803761, "num_env_steps_trained_throughput_per_sec": 39.30545942803761, "timesteps_total": 11880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 11880, "timers": {"training_iteration_time_ms": 3055.443, "sample_time_ms": 3051.716, "load_time_ms": 0.218, "load_throughput": 550554.014, "learn_time_ms": 2.752, "learn_throughput": 43603.611, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 11880, "num_env_steps_trained": 11880, "num_agent_steps_sampled": 11880, "num_agent_steps_trained": 11880}, "done": false, "episodes_total": 51, "training_iteration": 12, "trial_id": "668a1_00000", "date": "2023-07-25_17-50-36", "timestamp": 1690296636, "time_this_iter_s": 12.214597225189209, "time_total_s": 140.9362874031067, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 85.57268357276917, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.30588235294118, "ram_util_percent": 76.30588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.38888888888889e-05, "entropy_coeff": 0.1, "policy_entropy": -926.69482421875, "policy_loss": -2821233020239872.0, "vf_loss": 577568768.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 12360, "num_env_steps_trained": 12360, "num_agent_steps_sampled": 12360, "num_agent_steps_trained": 12360}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8562.97988574205, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.059433611117104, "mean_inference_ms": 0.4011055276841913, "mean_action_processing_ms": 0.0955126241717837, "mean_env_wait_ms": 5.093467264419895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037554771669449346, "StateBufferConnector_ms": 0.002666442624984249, "ViewRequirementAgentConnector_ms": 0.06865378349058089}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8562.97988574205, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.059433611117104, "mean_inference_ms": 0.4011055276841913, "mean_action_processing_ms": 0.0955126241717837, "mean_env_wait_ms": 5.093467264419895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037554771669449346, "StateBufferConnector_ms": 0.002666442624984249, "ViewRequirementAgentConnector_ms": 0.06865378349058089}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12360, "num_agent_steps_trained": 12360, "num_env_steps_sampled": 12360, "num_env_steps_trained": 12360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.40752070999802, "num_env_steps_trained_throughput_per_sec": 39.40752070999802, "timesteps_total": 12360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 12360, "timers": {"training_iteration_time_ms": 3063.157, "sample_time_ms": 3059.432, "load_time_ms": 0.218, "load_throughput": 549652.157, "learn_time_ms": 2.756, "learn_throughput": 43534.592, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 12360, "num_env_steps_trained": 12360, "num_agent_steps_sampled": 12360, "num_agent_steps_trained": 12360}, "done": false, "episodes_total": 55, "training_iteration": 13, "trial_id": "668a1_00000", "date": "2023-07-25_17-50-49", "timestamp": 1690296649, "time_this_iter_s": 12.182910203933716, "time_total_s": 153.1191976070404, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 97.75559377670288, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.98888888888889, "ram_util_percent": 76.51111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.055555555555556e-05, "entropy_coeff": 0.1, "policy_entropy": -926.70263671875, "policy_loss": -4666496462618624.0, "vf_loss": 556880256.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8562.869349170407, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.061980478831384, "mean_inference_ms": 0.4006269870392524, "mean_action_processing_ms": 0.09547168216017164, "mean_env_wait_ms": 4.9175780033791385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037077495029994418, "StateBufferConnector_ms": 0.0026539393833705355, "ViewRequirementAgentConnector_ms": 0.0686229978288923}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8562.869349170407, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.061980478831384, "mean_inference_ms": 0.4006269870392524, "mean_action_processing_ms": 0.09547168216017164, "mean_env_wait_ms": 4.9175780033791385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037077495029994418, "StateBufferConnector_ms": 0.0026539393833705355, "ViewRequirementAgentConnector_ms": 0.0686229978288923}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840, "num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.82200103353541, "num_env_steps_trained_throughput_per_sec": 38.82200103353541, "timesteps_total": 12840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 12840, "timers": {"training_iteration_time_ms": 3066.4, "sample_time_ms": 3062.674, "load_time_ms": 0.22, "load_throughput": 545718.833, "learn_time_ms": 2.754, "learn_throughput": 43576.053, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840}, "done": false, "episodes_total": 59, "training_iteration": 14, "trial_id": "668a1_00000", "date": "2023-07-25_17-51-01", "timestamp": 1690296661, "time_this_iter_s": 12.366712093353271, "time_total_s": 165.48590970039368, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 110.12230587005615, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.864705882352943, "ram_util_percent": 76.28235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.8611111111111115e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7074584960938, "policy_loss": -5507376970989568.0, "vf_loss": 564044992.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 13320, "num_env_steps_trained": 13320, "num_agent_steps_sampled": 13320, "num_agent_steps_trained": 13320}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8557.578001370466, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.06589520612151, "mean_inference_ms": 0.4001847986904488, "mean_action_processing_ms": 0.09543010596131768, "mean_env_wait_ms": 4.771048010998143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036704234587840545, "StateBufferConnector_ms": 0.002654393513997396, "ViewRequirementAgentConnector_ms": 0.0687397443331205}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8557.578001370466, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.06589520612151, "mean_inference_ms": 0.4001847986904488, "mean_action_processing_ms": 0.09543010596131768, "mean_env_wait_ms": 4.771048010998143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036704234587840545, "StateBufferConnector_ms": 0.002654393513997396, "ViewRequirementAgentConnector_ms": 0.0687397443331205}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13320, "num_agent_steps_trained": 13320, "num_env_steps_sampled": 13320, "num_env_steps_trained": 13320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.85190925253821, "num_env_steps_trained_throughput_per_sec": 38.85190925253821, "timesteps_total": 13320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 13320, "timers": {"training_iteration_time_ms": 3072.55, "sample_time_ms": 3068.797, "load_time_ms": 0.217, "load_throughput": 552306.024, "learn_time_ms": 2.787, "learn_throughput": 43061.564, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 13320, "num_env_steps_trained": 13320, "num_agent_steps_sampled": 13320, "num_agent_steps_trained": 13320}, "done": false, "episodes_total": 63, "training_iteration": 15, "trial_id": "668a1_00000", "date": "2023-07-25_17-51-13", "timestamp": 1690296673, "time_this_iter_s": 12.357330083847046, "time_total_s": 177.84323978424072, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 122.4796359539032, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.13888888888889, "ram_util_percent": 76.20555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.194444444444445e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7135009765625, "policy_loss": -1810123630575616.0, "vf_loss": 556464000.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 13800, "num_env_steps_trained": 13800, "num_agent_steps_sampled": 13800, "num_agent_steps_trained": 13800}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8559.516913119865, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.070957642031978, "mean_inference_ms": 0.399788519199995, "mean_action_processing_ms": 0.09539210175137405, "mean_env_wait_ms": 4.645968443205874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003798063411269077, "StateBufferConnector_ms": 0.002710209336391715, "ViewRequirementAgentConnector_ms": 0.06960713586141896}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8559.516913119865, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.070957642031978, "mean_inference_ms": 0.399788519199995, "mean_action_processing_ms": 0.09539210175137405, "mean_env_wait_ms": 4.645968443205874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003798063411269077, "StateBufferConnector_ms": 0.002710209336391715, "ViewRequirementAgentConnector_ms": 0.06960713586141896}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13800, "num_agent_steps_trained": 13800, "num_env_steps_sampled": 13800, "num_env_steps_trained": 13800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.913982117627555, "num_env_steps_trained_throughput_per_sec": 38.913982117627555, "timesteps_total": 13800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 13800, "timers": {"training_iteration_time_ms": 3072.167, "sample_time_ms": 3068.389, "load_time_ms": 0.219, "load_throughput": 547202.087, "learn_time_ms": 2.803, "learn_throughput": 42810.67, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 13800, "num_env_steps_trained": 13800, "num_agent_steps_sampled": 13800, "num_agent_steps_trained": 13800}, "done": false, "episodes_total": 67, "training_iteration": 16, "trial_id": "668a1_00000", "date": "2023-07-25_17-51-26", "timestamp": 1690296686, "time_this_iter_s": 12.337477684020996, "time_total_s": 190.18071746826172, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 134.8171136379242, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.63529411764706, "ram_util_percent": 76.41764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.527777777777778e-05, "entropy_coeff": 0.1, "policy_entropy": -926.71923828125, "policy_loss": -2004326750879744.0, "vf_loss": 572500864.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8559.349197496833, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.072038196053544, "mean_inference_ms": 0.39942070711858435, "mean_action_processing_ms": 0.0953521468434062, "mean_env_wait_ms": 4.53896330400766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037639699083693483, "StateBufferConnector_ms": 0.002711884518887134, "ViewRequirementAgentConnector_ms": 0.06950966855312915}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.007861941896, "episode_reward_mean": -8559.349197496833, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.072038196053544, "mean_inference_ms": 0.39942070711858435, "mean_action_processing_ms": 0.0953521468434062, "mean_env_wait_ms": 4.53896330400766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037639699083693483, "StateBufferConnector_ms": 0.002711884518887134, "ViewRequirementAgentConnector_ms": 0.06950966855312915}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280, "num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.63219643980589, "num_env_steps_trained_throughput_per_sec": 39.63219643980589, "timesteps_total": 14280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 14280, "timers": {"training_iteration_time_ms": 3075.04, "sample_time_ms": 3071.23, "load_time_ms": 0.22, "load_throughput": 545955.613, "learn_time_ms": 2.832, "learn_throughput": 42368.49, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280}, "done": false, "episodes_total": 71, "training_iteration": 17, "trial_id": "668a1_00000", "date": "2023-07-25_17-51-38", "timestamp": 1690296698, "time_this_iter_s": 12.1141517162323, "time_total_s": 202.29486918449402, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.9312653541565, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.82777777777778, "ram_util_percent": 76.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8611111111111113e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7240600585938, "policy_loss": -1847766603005952.0, "vf_loss": 564047616.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 14760, "num_env_steps_trained": 14760, "num_agent_steps_sampled": 14760, "num_agent_steps_trained": 14760}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8566.287571735656, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.07480609431155, "mean_inference_ms": 0.39906305050715496, "mean_action_processing_ms": 0.09531231734901294, "mean_env_wait_ms": 4.44455075499877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003799270181094899, "StateBufferConnector_ms": 0.0027104920031977633, "ViewRequirementAgentConnector_ms": 0.06955277686025582}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8566.287571735656, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.07480609431155, "mean_inference_ms": 0.39906305050715496, "mean_action_processing_ms": 0.09531231734901294, "mean_env_wait_ms": 4.44455075499877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003799270181094899, "StateBufferConnector_ms": 0.0027104920031977633, "ViewRequirementAgentConnector_ms": 0.06955277686025582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14760, "num_agent_steps_trained": 14760, "num_env_steps_sampled": 14760, "num_env_steps_trained": 14760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.98302934459304, "num_env_steps_trained_throughput_per_sec": 38.98302934459304, "timesteps_total": 14760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 14760, "timers": {"training_iteration_time_ms": 3074.639, "sample_time_ms": 3070.767, "load_time_ms": 0.221, "load_throughput": 542893.41, "learn_time_ms": 2.894, "learn_throughput": 41465.837, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 14760, "num_env_steps_trained": 14760, "num_agent_steps_sampled": 14760, "num_agent_steps_trained": 14760}, "done": false, "episodes_total": 75, "training_iteration": 18, "trial_id": "668a1_00000", "date": "2023-07-25_17-51-50", "timestamp": 1690296710, "time_this_iter_s": 12.315833806991577, "time_total_s": 214.6107029914856, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 159.24709916114807, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.035294117647055, "ram_util_percent": 76.1470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.316666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7297973632812, "policy_loss": -2891991801135104.0, "vf_loss": 567408704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 15240, "num_env_steps_trained": 15240, "num_agent_steps_sampled": 15240, "num_agent_steps_trained": 15240}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8569.002692482114, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.07853534439832, "mean_inference_ms": 0.39879192930842, "mean_action_processing_ms": 0.09528387149804415, "mean_env_wait_ms": 4.361761353730388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003785220059481534, "StateBufferConnector_ms": 0.002711035988547585, "ViewRequirementAgentConnector_ms": 0.06968151439319957}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8569.002692482114, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.07853534439832, "mean_inference_ms": 0.39879192930842, "mean_action_processing_ms": 0.09528387149804415, "mean_env_wait_ms": 4.361761353730388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003785220059481534, "StateBufferConnector_ms": 0.002711035988547585, "ViewRequirementAgentConnector_ms": 0.06968151439319957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15240, "num_agent_steps_trained": 15240, "num_env_steps_sampled": 15240, "num_env_steps_trained": 15240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.63934760522866, "num_env_steps_trained_throughput_per_sec": 38.63934760522866, "timesteps_total": 15240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 15240, "timers": {"training_iteration_time_ms": 3084.129, "sample_time_ms": 3080.145, "load_time_ms": 0.219, "load_throughput": 547440.157, "learn_time_ms": 2.957, "learn_throughput": 40588.075, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 15240, "num_env_steps_trained": 15240, "num_agent_steps_sampled": 15240, "num_agent_steps_trained": 15240}, "done": false, "episodes_total": 79, "training_iteration": 19, "trial_id": "668a1_00000", "date": "2023-07-25_17-52-03", "timestamp": 1690296723, "time_this_iter_s": 12.425468921661377, "time_total_s": 227.03617191314697, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 171.67256808280945, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.03888888888889, "ram_util_percent": 76.33333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7349243164062, "policy_loss": -1836217704382464.0, "vf_loss": 552948224.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8565.256134888194, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.081564327967364, "mean_inference_ms": 0.398582012001664, "mean_action_processing_ms": 0.09526089753215505, "mean_env_wait_ms": 4.288373267609064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037536782733464647, "StateBufferConnector_ms": 0.0027131226103184586, "ViewRequirementAgentConnector_ms": 0.06962347838838222}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8565.256134888194, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.081564327967364, "mean_inference_ms": 0.398582012001664, "mean_action_processing_ms": 0.09526089753215505, "mean_env_wait_ms": 4.288373267609064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037536782733464647, "StateBufferConnector_ms": 0.0027131226103184586, "ViewRequirementAgentConnector_ms": 0.06962347838838222}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720, "num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.115281406019704, "num_env_steps_trained_throughput_per_sec": 39.115281406019704, "timesteps_total": 15720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 15720, "timers": {"training_iteration_time_ms": 3072.462, "sample_time_ms": 3068.586, "load_time_ms": 0.218, "load_throughput": 550313.23, "learn_time_ms": 2.857, "learn_throughput": 41999.74, "synch_weights_time_ms": 0.76}, "counters": {"num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720}, "done": false, "episodes_total": 83, "training_iteration": 20, "trial_id": "668a1_00000", "date": "2023-07-25_17-52-15", "timestamp": 1690296735, "time_this_iter_s": 12.274074077606201, "time_total_s": 239.31024599075317, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 183.94664216041565, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.076470588235292, "ram_util_percent": 76.14117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5166666666666668e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7406616210938, "policy_loss": -1727473293197312.0, "vf_loss": 566686720.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 16200, "num_env_steps_trained": 16200, "num_agent_steps_sampled": 16200, "num_agent_steps_trained": 16200}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8562.624113801294, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.083453222852715, "mean_inference_ms": 0.3984002232569419, "mean_action_processing_ms": 0.09524165865503309, "mean_env_wait_ms": 4.222739878428281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780637468610491, "StateBufferConnector_ms": 0.002700563461061508, "ViewRequirementAgentConnector_ms": 0.06951528882223462}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8562.624113801294, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.083453222852715, "mean_inference_ms": 0.3984002232569419, "mean_action_processing_ms": 0.09524165865503309, "mean_env_wait_ms": 4.222739878428281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780637468610491, "StateBufferConnector_ms": 0.002700563461061508, "ViewRequirementAgentConnector_ms": 0.06951528882223462}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16200, "num_agent_steps_trained": 16200, "num_env_steps_sampled": 16200, "num_env_steps_trained": 16200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.38026967950944, "num_env_steps_trained_throughput_per_sec": 39.38026967950944, "timesteps_total": 16200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 16200, "timers": {"training_iteration_time_ms": 3060.16, "sample_time_ms": 3056.363, "load_time_ms": 0.22, "load_throughput": 544655.86, "learn_time_ms": 2.805, "learn_throughput": 42778.65, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 16200, "num_env_steps_trained": 16200, "num_agent_steps_sampled": 16200, "num_agent_steps_trained": 16200}, "done": false, "episodes_total": 87, "training_iteration": 21, "trial_id": "668a1_00000", "date": "2023-07-25_17-52-27", "timestamp": 1690296747, "time_this_iter_s": 12.19136381149292, "time_total_s": 251.5016098022461, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 196.13800597190857, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.072222222222216, "ram_util_percent": 75.78888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1166666666666666e-05, "entropy_coeff": 0.1, "policy_entropy": -926.745361328125, "policy_loss": -1829679019327488.0, "vf_loss": 545866432.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 16680, "num_env_steps_trained": 16680, "num_agent_steps_sampled": 16680, "num_agent_steps_trained": 16680}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8561.289307399946, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.084366565849646, "mean_inference_ms": 0.3982371822273804, "mean_action_processing_ms": 0.09522739084633651, "mean_env_wait_ms": 4.163227643217838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038090036876166043, "StateBufferConnector_ms": 0.002699823521856052, "ViewRequirementAgentConnector_ms": 0.06957801420297195}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8561.289307399946, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.084366565849646, "mean_inference_ms": 0.3982371822273804, "mean_action_processing_ms": 0.09522739084633651, "mean_env_wait_ms": 4.163227643217838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038090036876166043, "StateBufferConnector_ms": 0.002699823521856052, "ViewRequirementAgentConnector_ms": 0.06957801420297195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16680, "num_agent_steps_trained": 16680, "num_env_steps_sampled": 16680, "num_env_steps_trained": 16680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.618241583859145, "num_env_steps_trained_throughput_per_sec": 39.618241583859145, "timesteps_total": 16680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 16680, "timers": {"training_iteration_time_ms": 3061.068, "sample_time_ms": 3057.331, "load_time_ms": 0.22, "load_throughput": 546548.463, "learn_time_ms": 2.777, "learn_throughput": 43218.712, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 16680, "num_env_steps_trained": 16680, "num_agent_steps_sampled": 16680, "num_agent_steps_trained": 16680}, "done": false, "episodes_total": 91, "training_iteration": 22, "trial_id": "668a1_00000", "date": "2023-07-25_17-52-39", "timestamp": 1690296759, "time_this_iter_s": 12.11823058128357, "time_total_s": 263.61984038352966, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 208.25623655319214, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.158823529411762, "ram_util_percent": 75.95882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.52777777777778e-06, "entropy_coeff": 0.1, "policy_entropy": -926.75, "policy_loss": -1590666371006464.0, "vf_loss": 539753472.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8560.894709590226, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.085705555232924, "mean_inference_ms": 0.39806844519350665, "mean_action_processing_ms": 0.09520946467248062, "mean_env_wait_ms": 4.1096814721904815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037730579644861357, "StateBufferConnector_ms": 0.0026998385577134683, "ViewRequirementAgentConnector_ms": 0.06949229979179275}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8560.894709590226, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.085705555232924, "mean_inference_ms": 0.39806844519350665, "mean_action_processing_ms": 0.09520946467248062, "mean_env_wait_ms": 4.1096814721904815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037730579644861357, "StateBufferConnector_ms": 0.0026998385577134683, "ViewRequirementAgentConnector_ms": 0.06949229979179275}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160, "num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.7365152007945, "num_env_steps_trained_throughput_per_sec": 38.7365152007945, "timesteps_total": 17160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 17160, "timers": {"training_iteration_time_ms": 3068.783, "sample_time_ms": 3065.051, "load_time_ms": 0.217, "load_throughput": 551761.105, "learn_time_ms": 2.766, "learn_throughput": 43390.1, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160}, "done": false, "episodes_total": 95, "training_iteration": 23, "trial_id": "668a1_00000", "date": "2023-07-25_17-52-52", "timestamp": 1690296772, "time_this_iter_s": 12.393979787826538, "time_total_s": 276.0138201713562, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 220.65021634101868, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 23.58888888888889, "ram_util_percent": 76.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.861111111111111e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7554321289062, "policy_loss": -1961578538729472.0, "vf_loss": 536822912.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8555.065039287158, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.086207227490963, "mean_inference_ms": 0.39793583947966327, "mean_action_processing_ms": 0.09519666243931059, "mean_env_wait_ms": 4.061117356802093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003758112589518229, "StateBufferConnector_ms": 0.0027068456013997397, "ViewRequirementAgentConnector_ms": 0.06956958770751953}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8555.065039287158, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.086207227490963, "mean_inference_ms": 0.39793583947966327, "mean_action_processing_ms": 0.09519666243931059, "mean_env_wait_ms": 4.061117356802093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003758112589518229, "StateBufferConnector_ms": 0.0027068456013997397, "ViewRequirementAgentConnector_ms": 0.06956958770751953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.37901337090061, "num_env_steps_trained_throughput_per_sec": 39.37901337090061, "timesteps_total": 17640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 17640, "timers": {"training_iteration_time_ms": 3063.054, "sample_time_ms": 3059.328, "load_time_ms": 0.217, "load_throughput": 554191.235, "learn_time_ms": 2.754, "learn_throughput": 43567.377, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "done": false, "episodes_total": 99, "training_iteration": 24, "trial_id": "668a1_00000", "date": "2023-07-25_17-53-04", "timestamp": 1690296784, "time_this_iter_s": 12.191924333572388, "time_total_s": 288.2057445049286, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 232.84214067459106, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 26.88235294117647, "ram_util_percent": 76.3058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.194444444444445e-06, "entropy_coeff": 0.1, "policy_entropy": -926.759521484375, "policy_loss": -1717430317481984.0, "vf_loss": 551503680.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 18120, "num_env_steps_trained": 18120, "num_agent_steps_sampled": 18120, "num_agent_steps_trained": 18120}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8558.410865982361, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.087363121200923, "mean_inference_ms": 0.39780783599950337, "mean_action_processing_ms": 0.09518400598209618, "mean_env_wait_ms": 4.0164119167540795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037428698962247826, "StateBufferConnector_ms": 0.0026968461048753954, "ViewRequirementAgentConnector_ms": 0.06951229481757441}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8558.410865982361, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.087363121200923, "mean_inference_ms": 0.39780783599950337, "mean_action_processing_ms": 0.09518400598209618, "mean_env_wait_ms": 4.0164119167540795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037428698962247826, "StateBufferConnector_ms": 0.0026968461048753954, "ViewRequirementAgentConnector_ms": 0.06951229481757441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18120, "num_agent_steps_trained": 18120, "num_env_steps_sampled": 18120, "num_env_steps_trained": 18120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.879860991860525, "num_env_steps_trained_throughput_per_sec": 38.879860991860525, "timesteps_total": 18120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 18120, "timers": {"training_iteration_time_ms": 3058.803, "sample_time_ms": 3055.037, "load_time_ms": 0.217, "load_throughput": 553764.419, "learn_time_ms": 2.775, "learn_throughput": 43235.79, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 18120, "num_env_steps_trained": 18120, "num_agent_steps_sampled": 18120, "num_agent_steps_trained": 18120}, "done": false, "episodes_total": 103, "training_iteration": 25, "trial_id": "668a1_00000", "date": "2023-07-25_17-53-16", "timestamp": 1690296796, "time_this_iter_s": 12.348299026489258, "time_total_s": 300.55404353141785, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 245.19043970108032, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.772222222222226, "ram_util_percent": 76.60555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.527777777777778e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7658081054688, "policy_loss": -1369474615738368.0, "vf_loss": 551412352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8556.10449056402, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.088290526332013, "mean_inference_ms": 0.39771010950858376, "mean_action_processing_ms": 0.09517524676439172, "mean_env_wait_ms": 3.975379409617412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038290598306311182, "StateBufferConnector_ms": 0.0026998749698501035, "ViewRequirementAgentConnector_ms": 0.06967797336808171}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8556.10449056402, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.088290526332013, "mean_inference_ms": 0.39771010950858376, "mean_action_processing_ms": 0.09517524676439172, "mean_env_wait_ms": 3.975379409617412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038290598306311182, "StateBufferConnector_ms": 0.0026998749698501035, "ViewRequirementAgentConnector_ms": 0.06967797336808171}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600, "num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.15553160159474, "num_env_steps_trained_throughput_per_sec": 39.15553160159474, "timesteps_total": 18600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 18600, "timers": {"training_iteration_time_ms": 3064.872, "sample_time_ms": 3061.077, "load_time_ms": 0.217, "load_throughput": 553155.819, "learn_time_ms": 2.787, "learn_throughput": 43051.987, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600}, "done": false, "episodes_total": 107, "training_iteration": 26, "trial_id": "668a1_00000", "date": "2023-07-25_17-53-29", "timestamp": 1690296809, "time_this_iter_s": 12.261482954025269, "time_total_s": 312.8155264854431, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 257.4519226551056, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.61176470588235, "ram_util_percent": 76.75882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.861111111111112e-06, "entropy_coeff": 0.1, "policy_entropy": -926.770751953125, "policy_loss": -1346260720156672.0, "vf_loss": 556717824.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 19080, "num_env_steps_trained": 19080, "num_agent_steps_sampled": 19080, "num_agent_steps_trained": 19080}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8555.831958954037, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.088989384376752, "mean_inference_ms": 0.3975993288487478, "mean_action_processing_ms": 0.09516412782396245, "mean_env_wait_ms": 3.937390235230727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003844842143442439, "StateBufferConnector_ms": 0.002705365761943247, "ViewRequirementAgentConnector_ms": 0.0695614979184907}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8555.831958954037, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.088989384376752, "mean_inference_ms": 0.3975993288487478, "mean_action_processing_ms": 0.09516412782396245, "mean_env_wait_ms": 3.937390235230727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003844842143442439, "StateBufferConnector_ms": 0.002705365761943247, "ViewRequirementAgentConnector_ms": 0.0695614979184907}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19080, "num_agent_steps_trained": 19080, "num_env_steps_sampled": 19080, "num_env_steps_trained": 19080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.34838687547939, "num_env_steps_trained_throughput_per_sec": 39.34838687547939, "timesteps_total": 19080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 19080, "timers": {"training_iteration_time_ms": 3079.594, "sample_time_ms": 3075.79, "load_time_ms": 0.219, "load_throughput": 547738.035, "learn_time_ms": 2.807, "learn_throughput": 42747.404, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 19080, "num_env_steps_trained": 19080, "num_agent_steps_sampled": 19080, "num_agent_steps_trained": 19080}, "done": false, "episodes_total": 111, "training_iteration": 27, "trial_id": "668a1_00000", "date": "2023-07-25_17-53-41", "timestamp": 1690296821, "time_this_iter_s": 12.201688051223755, "time_total_s": 325.01721453666687, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 269.65361070632935, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.11176470588235, "ram_util_percent": 76.65294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.194444444444445e-06, "entropy_coeff": 0.1, "policy_entropy": -926.775390625, "policy_loss": -1192273526128640.0, "vf_loss": 563803584.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 19560, "num_env_steps_trained": 19560, "num_agent_steps_sampled": 19560, "num_agent_steps_trained": 19560}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8555.63982324335, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.089945139275613, "mean_inference_ms": 0.3975201612593746, "mean_action_processing_ms": 0.09515899920239508, "mean_env_wait_ms": 3.902284747123631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038283211844308035, "StateBufferConnector_ms": 0.0027111598423549105, "ViewRequirementAgentConnector_ms": 0.06965752486344222}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8555.63982324335, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.089945139275613, "mean_inference_ms": 0.3975201612593746, "mean_action_processing_ms": 0.09515899920239508, "mean_env_wait_ms": 3.902284747123631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038283211844308035, "StateBufferConnector_ms": 0.0027111598423549105, "ViewRequirementAgentConnector_ms": 0.06965752486344222}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19560, "num_agent_steps_trained": 19560, "num_env_steps_sampled": 19560, "num_env_steps_trained": 19560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.814429587981124, "num_env_steps_trained_throughput_per_sec": 38.814429587981124, "timesteps_total": 19560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 19560, "timers": {"training_iteration_time_ms": 3067.099, "sample_time_ms": 3063.33, "load_time_ms": 0.218, "load_throughput": 549352.194, "learn_time_ms": 2.79, "learn_throughput": 43004.535, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 19560, "num_env_steps_trained": 19560, "num_agent_steps_sampled": 19560, "num_agent_steps_trained": 19560}, "done": false, "episodes_total": 115, "training_iteration": 28, "trial_id": "668a1_00000", "date": "2023-07-25_17-53-53", "timestamp": 1690296833, "time_this_iter_s": 12.36948299407959, "time_total_s": 337.38669753074646, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 282.02309370040894, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.827777777777783, "ram_util_percent": 76.82777777777775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.527777777777779e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7794189453125, "policy_loss": -999310242086912.0, "vf_loss": 567158912.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8554.668950056532, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.091134649084967, "mean_inference_ms": 0.397458347004279, "mean_action_processing_ms": 0.09515669762805337, "mean_env_wait_ms": 3.869516604732706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003817457901804071, "StateBufferConnector_ms": 0.0027139563309518913, "ViewRequirementAgentConnector_ms": 0.06975977044356496}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8554.668950056532, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.091134649084967, "mean_inference_ms": 0.397458347004279, "mean_action_processing_ms": 0.09515669762805337, "mean_env_wait_ms": 3.869516604732706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003817457901804071, "StateBufferConnector_ms": 0.0027139563309518913, "ViewRequirementAgentConnector_ms": 0.06975977044356496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040, "num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.98203601162313, "num_env_steps_trained_throughput_per_sec": 38.98203601162313, "timesteps_total": 20040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 20040, "timers": {"training_iteration_time_ms": 3069.685, "sample_time_ms": 3065.903, "load_time_ms": 0.221, "load_throughput": 542893.41, "learn_time_ms": 2.806, "learn_throughput": 42757.935, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040}, "done": false, "episodes_total": 119, "training_iteration": 29, "trial_id": "668a1_00000", "date": "2023-07-25_17-54-05", "timestamp": 1690296845, "time_this_iter_s": 12.316298007965088, "time_total_s": 349.70299553871155, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.339391708374, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.750000000000004, "ram_util_percent": 76.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.861111111111111e-06, "entropy_coeff": 0.1, "policy_entropy": -926.783203125, "policy_loss": -788973748224000.0, "vf_loss": 580490432.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 20520, "num_env_steps_trained": 20520, "num_agent_steps_sampled": 20520, "num_agent_steps_trained": 20520}, "sampler_results": {"episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8553.438290436115, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.091756916890436, "mean_inference_ms": 0.3973935357049058, "mean_action_processing_ms": 0.09515342963803403, "mean_env_wait_ms": 3.839001598347573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037975985594470092, "StateBufferConnector_ms": 0.0027088203815498735, "ViewRequirementAgentConnector_ms": 0.06965483077848801}}, "episode_reward_max": -8349.322319935482, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8553.438290436115, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.807806325729, -8827.007861941896, -8349.322319935482, -8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.091756916890436, "mean_inference_ms": 0.3973935357049058, "mean_action_processing_ms": 0.09515342963803403, "mean_env_wait_ms": 3.839001598347573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037975985594470092, "StateBufferConnector_ms": 0.0027088203815498735, "ViewRequirementAgentConnector_ms": 0.06965483077848801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20520, "num_agent_steps_trained": 20520, "num_env_steps_sampled": 20520, "num_env_steps_trained": 20520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.56786513750877, "num_env_steps_trained_throughput_per_sec": 39.56786513750877, "timesteps_total": 20520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 20520, "timers": {"training_iteration_time_ms": 3055.922, "sample_time_ms": 3052.181, "load_time_ms": 0.219, "load_throughput": 547857.277, "learn_time_ms": 2.772, "learn_throughput": 43282.265, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 20520, "num_env_steps_trained": 20520, "num_agent_steps_sampled": 20520, "num_agent_steps_trained": 20520}, "done": false, "episodes_total": 123, "training_iteration": 30, "trial_id": "668a1_00000", "date": "2023-07-25_17-54-18", "timestamp": 1690296858, "time_this_iter_s": 12.1338050365448, "time_total_s": 361.83680057525635, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 306.4731967449188, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.094117647058823, "ram_util_percent": 76.48235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.194444444444445e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7862548828125, "policy_loss": -575387306295296.0, "vf_loss": 550600064.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 21000}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8551.569328662235, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.09176160939545, "mean_inference_ms": 0.3966458497693948, "mean_action_processing_ms": 0.09509751619980072, "mean_env_wait_ms": 3.5959422465671604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06956672668457031}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8551.569328662235, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8575.135955063348, -8576.2780708058, -8421.472826348163, -8676.912643586627, -8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.09176160939545, "mean_inference_ms": 0.3966458497693948, "mean_action_processing_ms": 0.09509751619980072, "mean_env_wait_ms": 3.5959422465671604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06956672668457031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 21000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 21000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.545988728819395, "num_env_steps_trained_throughput_per_sec": 39.545988728819395, "timesteps_total": 21000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 3051.239, "sample_time_ms": 3047.484, "load_time_ms": 0.22, "load_throughput": 544891.718, "learn_time_ms": 2.78, "learn_throughput": 43157.936, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 21000}, "done": false, "episodes_total": 127, "training_iteration": 31, "trial_id": "668a1_00000", "date": "2023-07-25_17-54-30", "timestamp": 1690296870, "time_this_iter_s": 12.140476942062378, "time_total_s": 373.9772775173187, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 318.6136736869812, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 24.705882352941178, "ram_util_percent": 76.4705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.527777777777778e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7889404296875, "policy_loss": -412828162850816.0, "vf_loss": 565964864.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8550.322457950735, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.09251720315556, "mean_inference_ms": 0.39633898789802985, "mean_action_processing_ms": 0.09506225488540626, "mean_env_wait_ms": 3.4694657401807603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037994384765625, "StateBufferConnector_ms": 0.0026891231536865234, "ViewRequirementAgentConnector_ms": 0.06953549385070801}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8550.322457950735, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8531.975211758001, -8534.151039951103, -8465.814670852084, -8582.18391199304, -8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.09251720315556, "mean_inference_ms": 0.39633898789802985, "mean_action_processing_ms": 0.09506225488540626, "mean_env_wait_ms": 3.4694657401807603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037994384765625, "StateBufferConnector_ms": 0.0026891231536865234, "ViewRequirementAgentConnector_ms": 0.06953549385070801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480, "num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.92027645791844, "num_env_steps_trained_throughput_per_sec": 38.92027645791844, "timesteps_total": 21480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 21480, "timers": {"training_iteration_time_ms": 3062.65, "sample_time_ms": 3058.87, "load_time_ms": 0.221, "load_throughput": 543538.315, "learn_time_ms": 2.794, "learn_throughput": 42954.988, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480}, "done": false, "episodes_total": 131, "training_iteration": 32, "trial_id": "668a1_00000", "date": "2023-07-25_17-54-42", "timestamp": 1690296882, "time_this_iter_s": 12.335719108581543, "time_total_s": 386.31299662590027, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 330.94939279556274, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.072222222222226, "ram_util_percent": 76.5111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8611111111111114e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7911376953125, "policy_loss": -268232569126912.0, "vf_loss": 547571008.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 110.0}}, "num_env_steps_sampled": 21960, "num_env_steps_trained": 21960, "num_agent_steps_sampled": 21960, "num_agent_steps_trained": 21960}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8554.127267047095, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.098690334109307, "mean_inference_ms": 0.39607732956943065, "mean_action_processing_ms": 0.09502746337742103, "mean_env_wait_ms": 3.391107638659323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037920475006103516, "StateBufferConnector_ms": 0.0026824474334716797, "ViewRequirementAgentConnector_ms": 0.06945157051086426}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8554.127267047095, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8476.656410427979, -8617.440176770091, -8411.015545643839, -8524.876292988549, -8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.098690334109307, "mean_inference_ms": 0.39607732956943065, "mean_action_processing_ms": 0.09502746337742103, "mean_env_wait_ms": 3.391107638659323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037920475006103516, "StateBufferConnector_ms": 0.0026824474334716797, "ViewRequirementAgentConnector_ms": 0.06945157051086426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21960, "num_agent_steps_trained": 21960, "num_env_steps_sampled": 21960, "num_env_steps_trained": 21960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.99490948313448, "num_env_steps_trained_throughput_per_sec": 38.99490948313448, "timesteps_total": 21960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 21960, "timers": {"training_iteration_time_ms": 3066.406, "sample_time_ms": 3062.621, "load_time_ms": 0.22, "load_throughput": 544891.718, "learn_time_ms": 2.803, "learn_throughput": 42805.936, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 21960, "num_env_steps_trained": 21960, "num_agent_steps_sampled": 21960, "num_agent_steps_trained": 21960}, "done": false, "episodes_total": 135, "training_iteration": 33, "trial_id": "668a1_00000", "date": "2023-07-25_17-54-54", "timestamp": 1690296894, "time_this_iter_s": 12.3121919631958, "time_total_s": 398.62518858909607, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 343.26158475875854, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.476470588235294, "ram_util_percent": 76.3529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.316666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7920532226562, "policy_loss": -167742296555520.0, "vf_loss": 544647808.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 115.0, "diff_num_grad_updates_vs_sampler_policy": 114.0}}, "num_env_steps_sampled": 22440, "num_env_steps_trained": 22440, "num_agent_steps_sampled": 22440, "num_agent_steps_trained": 22440}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8554.909439501695, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.09976230521181, "mean_inference_ms": 0.3959510354938074, "mean_action_processing_ms": 0.09501458366588998, "mean_env_wait_ms": 3.334718304573288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037963390350341797, "StateBufferConnector_ms": 0.0026826858520507812, "ViewRequirementAgentConnector_ms": 0.06949996948242188}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8554.909439501695, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8553.833233727406, -8636.966599270181, -8548.203760337543, -8503.087932311937, -8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.09976230521181, "mean_inference_ms": 0.3959510354938074, "mean_action_processing_ms": 0.09501458366588998, "mean_env_wait_ms": 3.334718304573288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037963390350341797, "StateBufferConnector_ms": 0.0026826858520507812, "ViewRequirementAgentConnector_ms": 0.06949996948242188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22440, "num_agent_steps_trained": 22440, "num_env_steps_sampled": 22440, "num_env_steps_trained": 22440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.14782951332356, "num_env_steps_trained_throughput_per_sec": 39.14782951332356, "timesteps_total": 22440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 22440, "timers": {"training_iteration_time_ms": 3061.977, "sample_time_ms": 3058.16, "load_time_ms": 0.226, "load_throughput": 531485.195, "learn_time_ms": 2.827, "learn_throughput": 42442.446, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 22440, "num_env_steps_trained": 22440, "num_agent_steps_sampled": 22440, "num_agent_steps_trained": 22440}, "done": false, "episodes_total": 139, "training_iteration": 34, "trial_id": "668a1_00000", "date": "2023-07-25_17-55-07", "timestamp": 1690296907, "time_this_iter_s": 12.263998985290527, "time_total_s": 410.8891875743866, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 355.5255837440491, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.79444444444444, "ram_util_percent": 76.47222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.916666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7930908203125, "policy_loss": -115149784481792.0, "vf_loss": 563917568.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 118.0}}, "num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8552.450864006758, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10063865425559, "mean_inference_ms": 0.3958228920889805, "mean_action_processing_ms": 0.09500276577962863, "mean_env_wait_ms": 3.2918779207524858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003796815872192383, "StateBufferConnector_ms": 0.0026836395263671875, "ViewRequirementAgentConnector_ms": 0.06949806213378906}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8552.450864006758, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8620.848282892082, -8491.259462660604, -8512.664876503974, -8614.086384010337, -8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10063865425559, "mean_inference_ms": 0.3958228920889805, "mean_action_processing_ms": 0.09500276577962863, "mean_env_wait_ms": 3.2918779207524858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003796815872192383, "StateBufferConnector_ms": 0.0026836395263671875, "ViewRequirementAgentConnector_ms": 0.06949806213378906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920, "num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.542455425944055, "num_env_steps_trained_throughput_per_sec": 39.542455425944055, "timesteps_total": 22920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 22920, "timers": {"training_iteration_time_ms": 3061.965, "sample_time_ms": 3058.177, "load_time_ms": 0.226, "load_throughput": 531092.624, "learn_time_ms": 2.792, "learn_throughput": 42983.234, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920}, "done": false, "episodes_total": 143, "training_iteration": 35, "trial_id": "668a1_00000", "date": "2023-07-25_17-55-19", "timestamp": 1690296919, "time_this_iter_s": 12.141602039337158, "time_total_s": 423.03078961372375, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 367.66718578338623, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.458823529411763, "ram_util_percent": 76.54117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5166666666666666e-06, "entropy_coeff": 0.1, "policy_entropy": -926.793701171875, "policy_loss": -71930921091072.0, "vf_loss": 574107520.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123.0, "diff_num_grad_updates_vs_sampler_policy": 122.0}}, "num_env_steps_sampled": 23400, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 23400, "num_agent_steps_trained": 23400}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8552.194266435466, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.102615788276548, "mean_inference_ms": 0.39571171545383704, "mean_action_processing_ms": 0.09499209663213098, "mean_env_wait_ms": 3.257259722334013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.002693653106689453, "ViewRequirementAgentConnector_ms": 0.06945013999938965}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8552.194266435466, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8515.104085317329, -8642.549930059753, -8602.921206748499, -8606.239563987037, -8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.102615788276548, "mean_inference_ms": 0.39571171545383704, "mean_action_processing_ms": 0.09499209663213098, "mean_env_wait_ms": 3.257259722334013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.002693653106689453, "ViewRequirementAgentConnector_ms": 0.06945013999938965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23400, "num_agent_steps_trained": 23400, "num_env_steps_sampled": 23400, "num_env_steps_trained": 23400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.79958941464992, "num_env_steps_trained_throughput_per_sec": 38.79958941464992, "timesteps_total": 23400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 23400, "timers": {"training_iteration_time_ms": 3074.756, "sample_time_ms": 3070.999, "load_time_ms": 0.225, "load_throughput": 533513.335, "learn_time_ms": 2.771, "learn_throughput": 43300.511, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 23400, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 23400, "num_agent_steps_trained": 23400}, "done": false, "episodes_total": 147, "training_iteration": 36, "trial_id": "668a1_00000", "date": "2023-07-25_17-55-31", "timestamp": 1690296931, "time_this_iter_s": 12.374153852462769, "time_total_s": 435.4049434661865, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 380.041339635849, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.933333333333334, "ram_util_percent": 76.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1166666666666666e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -39540928544768.0, "vf_loss": 546946752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 126.0}}, "num_env_steps_sampled": 23880, "num_env_steps_trained": 23880, "num_agent_steps_sampled": 23880, "num_agent_steps_trained": 23880}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8547.954929637304, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.104928739118726, "mean_inference_ms": 0.3956065782864075, "mean_action_processing_ms": 0.09497924076046087, "mean_env_wait_ms": 3.2288277755940293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003790140151977539, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06945514678955078}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8547.954929637304, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8440.279116384148, -8751.717120364348, -8614.06206960116, -8654.50208943551, -8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.104928739118726, "mean_inference_ms": 0.3956065782864075, "mean_action_processing_ms": 0.09497924076046087, "mean_env_wait_ms": 3.2288277755940293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003790140151977539, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06945514678955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23880, "num_agent_steps_trained": 23880, "num_env_steps_sampled": 23880, "num_env_steps_trained": 23880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.95425377861497, "num_env_steps_trained_throughput_per_sec": 38.95425377861497, "timesteps_total": 23880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 23880, "timers": {"training_iteration_time_ms": 3075.44, "sample_time_ms": 3071.696, "load_time_ms": 0.219, "load_throughput": 548275.033, "learn_time_ms": 2.769, "learn_throughput": 43343.766, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 23880, "num_env_steps_trained": 23880, "num_agent_steps_sampled": 23880, "num_agent_steps_trained": 23880}, "done": false, "episodes_total": 151, "training_iteration": 37, "trial_id": "668a1_00000", "date": "2023-07-25_17-55-44", "timestamp": 1690296944, "time_this_iter_s": 12.324863910675049, "time_total_s": 447.7298073768616, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 392.36620354652405, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.22941176470588, "ram_util_percent": 76.42352941176469}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.055555555555556e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7939453125, "policy_loss": -23031638392832.0, "vf_loss": 568027136.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8545.252512534453, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.107449344647762, "mean_inference_ms": 0.3954949813572719, "mean_action_processing_ms": 0.09496367876751532, "mean_env_wait_ms": 3.2054405492543685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037839412689208984, "StateBufferConnector_ms": 0.002691984176635742, "ViewRequirementAgentConnector_ms": 0.06943535804748535}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8545.252512534453, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8554.677961824988, -8487.980072377602, -8687.19523773682, -8518.197491021272, -8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.107449344647762, "mean_inference_ms": 0.3954949813572719, "mean_action_processing_ms": 0.09496367876751532, "mean_env_wait_ms": 3.2054405492543685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037839412689208984, "StateBufferConnector_ms": 0.002691984176635742, "ViewRequirementAgentConnector_ms": 0.06943535804748535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360, "num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.85297919278033, "num_env_steps_trained_throughput_per_sec": 38.85297919278033, "timesteps_total": 24360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 24360, "timers": {"training_iteration_time_ms": 3071.62, "sample_time_ms": 3067.835, "load_time_ms": 0.218, "load_throughput": 551398.422, "learn_time_ms": 2.803, "learn_throughput": 42805.936, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360}, "done": false, "episodes_total": 155, "training_iteration": 38, "trial_id": "668a1_00000", "date": "2023-07-25_17-55-56", "timestamp": 1690296956, "time_this_iter_s": 12.357163906097412, "time_total_s": 460.086971282959, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 404.72336745262146, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.51111111111111, "ram_util_percent": 76.62777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.722222222222222e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -16414557601792.0, "vf_loss": 550345664.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.0, "diff_num_grad_updates_vs_sampler_policy": 134.0}}, "num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8544.006140537622, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108960838073337, "mean_inference_ms": 0.39540576414991463, "mean_action_processing_ms": 0.0949508650962402, "mean_env_wait_ms": 3.18519090766298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780841827392578, "StateBufferConnector_ms": 0.0026924610137939453, "ViewRequirementAgentConnector_ms": 0.06940102577209473}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8544.006140537622, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8511.573706170358, -8500.03763913437, -8470.256354035142, -8563.24713314405, -8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108960838073337, "mean_inference_ms": 0.39540576414991463, "mean_action_processing_ms": 0.0949508650962402, "mean_env_wait_ms": 3.18519090766298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780841827392578, "StateBufferConnector_ms": 0.0026924610137939453, "ViewRequirementAgentConnector_ms": 0.06940102577209473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840, "num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.03535496191909, "num_env_steps_trained_throughput_per_sec": 39.03535496191909, "timesteps_total": 24840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 24840, "timers": {"training_iteration_time_ms": 3075.846, "sample_time_ms": 3072.047, "load_time_ms": 0.217, "load_throughput": 552306.024, "learn_time_ms": 2.812, "learn_throughput": 42667.679, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840}, "done": false, "episodes_total": 159, "training_iteration": 39, "trial_id": "668a1_00000", "date": "2023-07-25_17-56-08", "timestamp": 1690296968, "time_this_iter_s": 12.29924488067627, "time_total_s": 472.38621616363525, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 417.02261233329773, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.85882352941176, "ram_util_percent": 76.61176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.388888888888889e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943115234375, "policy_loss": -11164825157632.0, "vf_loss": 572685440.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 139.0, "diff_num_grad_updates_vs_sampler_policy": 138.0}}, "num_env_steps_sampled": 25320, "num_env_steps_trained": 25320, "num_agent_steps_sampled": 25320, "num_agent_steps_trained": 25320}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8545.285987479294, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1095604844634, "mean_inference_ms": 0.3953371912876933, "mean_action_processing_ms": 0.09494093772219536, "mean_env_wait_ms": 3.1672860282074398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003777742385864258, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.0693199634552002}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8545.285987479294, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8489.480072467886, -8702.551616503677, -8605.618228893938, -8516.035292840439, -8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1095604844634, "mean_inference_ms": 0.3953371912876933, "mean_action_processing_ms": 0.09494093772219536, "mean_env_wait_ms": 3.1672860282074398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003777742385864258, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.0693199634552002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25320, "num_agent_steps_trained": 25320, "num_env_steps_sampled": 25320, "num_env_steps_trained": 25320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.46374656526496, "num_env_steps_trained_throughput_per_sec": 39.46374656526496, "timesteps_total": 25320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 25320, "timers": {"training_iteration_time_ms": 3076.459, "sample_time_ms": 3072.653, "load_time_ms": 0.218, "load_throughput": 550072.656, "learn_time_ms": 2.815, "learn_throughput": 42633.345, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 25320, "num_env_steps_trained": 25320, "num_agent_steps_sampled": 25320, "num_agent_steps_trained": 25320}, "done": false, "episodes_total": 163, "training_iteration": 40, "trial_id": "668a1_00000", "date": "2023-07-25_17-56-21", "timestamp": 1690296981, "time_this_iter_s": 12.166357040405273, "time_total_s": 484.5525732040405, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 429.188969373703, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 26.06666666666667, "ram_util_percent": 76.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.055555555555555e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -7321918373888.0, "vf_loss": 558327424.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8543.107805859581, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.109218369682832, "mean_inference_ms": 0.39527884028226723, "mean_action_processing_ms": 0.094931712324556, "mean_env_wait_ms": 3.1517693926868047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003746509552001953, "StateBufferConnector_ms": 0.0026636123657226562, "ViewRequirementAgentConnector_ms": 0.06897163391113281}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8543.107805859581, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8547.718655068578, -8521.160423968475, -8503.167831845403, -8658.138107314531, -8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.109218369682832, "mean_inference_ms": 0.39527884028226723, "mean_action_processing_ms": 0.094931712324556, "mean_env_wait_ms": 3.1517693926868047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003746509552001953, "StateBufferConnector_ms": 0.0026636123657226562, "ViewRequirementAgentConnector_ms": 0.06897163391113281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.22136107888174, "num_env_steps_trained_throughput_per_sec": 39.22136107888174, "timesteps_total": 25800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 25800, "timers": {"training_iteration_time_ms": 3060.932, "sample_time_ms": 3057.154, "load_time_ms": 0.219, "load_throughput": 548932.795, "learn_time_ms": 2.778, "learn_throughput": 43194.233, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800}, "done": false, "episodes_total": 167, "training_iteration": 41, "trial_id": "668a1_00000", "date": "2023-07-25_17-56-33", "timestamp": 1690296993, "time_this_iter_s": 12.241193056106567, "time_total_s": 496.7937662601471, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 441.43016242980957, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 24.435294117647057, "ram_util_percent": 76.46470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.977777777777778e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -3523168698368.0, "vf_loss": 551500544.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 147.0, "diff_num_grad_updates_vs_sampler_policy": 146.0}}, "num_env_steps_sampled": 26280, "num_env_steps_trained": 26280, "num_agent_steps_sampled": 26280, "num_agent_steps_trained": 26280}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8542.776930605447, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110343112163083, "mean_inference_ms": 0.39523484556784405, "mean_action_processing_ms": 0.09492550542435502, "mean_env_wait_ms": 3.137574197515377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037527084350585938, "StateBufferConnector_ms": 0.002665281295776367, "ViewRequirementAgentConnector_ms": 0.06902337074279785}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8827.154898821142, "episode_reward_mean": -8542.776930605447, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8586.561662147875, -8570.1153205196, -8827.154898821142, -8607.421994678742, -8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110343112163083, "mean_inference_ms": 0.39523484556784405, "mean_action_processing_ms": 0.09492550542435502, "mean_env_wait_ms": 3.137574197515377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037527084350585938, "StateBufferConnector_ms": 0.002665281295776367, "ViewRequirementAgentConnector_ms": 0.06902337074279785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26280, "num_agent_steps_trained": 26280, "num_env_steps_sampled": 26280, "num_env_steps_trained": 26280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.15591846095595, "num_env_steps_trained_throughput_per_sec": 39.15591846095595, "timesteps_total": 26280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 26280, "timers": {"training_iteration_time_ms": 3053.696, "sample_time_ms": 3049.894, "load_time_ms": 0.223, "load_throughput": 537157.396, "learn_time_ms": 2.786, "learn_throughput": 43067.091, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 26280, "num_env_steps_trained": 26280, "num_agent_steps_sampled": 26280, "num_agent_steps_trained": 26280}, "done": false, "episodes_total": 171, "training_iteration": 42, "trial_id": "668a1_00000", "date": "2023-07-25_17-56-45", "timestamp": 1690297005, "time_this_iter_s": 12.261631965637207, "time_total_s": 509.0553982257843, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 453.6917943954468, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.647058823529413, "ram_util_percent": 76.48823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9111111111111105e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -1983004803072.0, "vf_loss": 551998336.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 151.0, "diff_num_grad_updates_vs_sampler_policy": 150.0}}, "num_env_steps_sampled": 26760, "num_env_steps_trained": 26760, "num_agent_steps_sampled": 26760, "num_agent_steps_trained": 26760}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8538.085611076236, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110575025191448, "mean_inference_ms": 0.39520955249479345, "mean_action_processing_ms": 0.09492182147178273, "mean_env_wait_ms": 3.1253419164931273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003758668899536133, "StateBufferConnector_ms": 0.002666473388671875, "ViewRequirementAgentConnector_ms": 0.06900739669799805}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8538.085611076236, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8600.112678220179, -8665.845568600314, -8519.106749401142, -8629.416931776148, -8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110575025191448, "mean_inference_ms": 0.39520955249479345, "mean_action_processing_ms": 0.09492182147178273, "mean_env_wait_ms": 3.1253419164931273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003758668899536133, "StateBufferConnector_ms": 0.002666473388671875, "ViewRequirementAgentConnector_ms": 0.06900739669799805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26760, "num_agent_steps_trained": 26760, "num_env_steps_sampled": 26760, "num_env_steps_trained": 26760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.07507671473987, "num_env_steps_trained_throughput_per_sec": 39.07507671473987, "timesteps_total": 26760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 26760, "timers": {"training_iteration_time_ms": 3051.761, "sample_time_ms": 3047.943, "load_time_ms": 0.222, "load_throughput": 541316.928, "learn_time_ms": 2.799, "learn_throughput": 42875.219, "synch_weights_time_ms": 0.757}, "counters": {"num_env_steps_sampled": 26760, "num_env_steps_trained": 26760, "num_agent_steps_sampled": 26760, "num_agent_steps_trained": 26760}, "done": false, "episodes_total": 175, "training_iteration": 43, "trial_id": "668a1_00000", "date": "2023-07-25_17-56-57", "timestamp": 1690297017, "time_this_iter_s": 12.28671407699585, "time_total_s": 521.3421123027802, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 465.9785084724426, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 24.011111111111113, "ram_util_percent": 76.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8444444444444444e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952880859375, "policy_loss": -710168608768.0, "vf_loss": 544962176.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 155.0, "diff_num_grad_updates_vs_sampler_policy": 154.0}}, "num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240}, "sampler_results": {"episode_reward_max": -8382.086952052126, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8537.31638300859, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.109508326846665, "mean_inference_ms": 0.395167490639205, "mean_action_processing_ms": 0.09491511905694043, "mean_env_wait_ms": 3.1141618937713327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037491321563720703, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.06896543502807617}}, "episode_reward_max": -8382.086952052126, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8537.31638300859, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8612.289260503709, -8513.024369481598, -8425.548307374564, -8504.101934527298, -8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.109508326846665, "mean_inference_ms": 0.395167490639205, "mean_action_processing_ms": 0.09491511905694043, "mean_env_wait_ms": 3.1141618937713327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037491321563720703, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.06896543502807617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240, "num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.882987320985094, "num_env_steps_trained_throughput_per_sec": 39.882987320985094, "timesteps_total": 27240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 27240, "timers": {"training_iteration_time_ms": 3043.866, "sample_time_ms": 3040.086, "load_time_ms": 0.219, "load_throughput": 548454.266, "learn_time_ms": 2.783, "learn_throughput": 43119.853, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240}, "done": false, "episodes_total": 179, "training_iteration": 44, "trial_id": "668a1_00000", "date": "2023-07-25_17-57-10", "timestamp": 1690297030, "time_this_iter_s": 12.037843942642212, "time_total_s": 533.3799562454224, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 478.01635241508484, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.123529411764707, "ram_util_percent": 76.62352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7946166992188, "policy_loss": -135239303168.0, "vf_loss": 566239936.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 159.0, "diff_num_grad_updates_vs_sampler_policy": 158.0}}, "num_env_steps_sampled": 27720, "num_env_steps_trained": 27720, "num_agent_steps_sampled": 27720, "num_agent_steps_trained": 27720}, "sampler_results": {"episode_reward_max": -8378.550400120364, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8537.574947393381, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108645915129905, "mean_inference_ms": 0.395107280796687, "mean_action_processing_ms": 0.09490675155505218, "mean_env_wait_ms": 3.1038551218595045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037488937377929688, "StateBufferConnector_ms": 0.0026521682739257812, "ViewRequirementAgentConnector_ms": 0.06887483596801758}}, "episode_reward_max": -8378.550400120364, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8537.574947393381, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8430.826551971011, -8594.410205382816, -8499.536051071904, -8570.434402652289, -8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108645915129905, "mean_inference_ms": 0.395107280796687, "mean_action_processing_ms": 0.09490675155505218, "mean_env_wait_ms": 3.1038551218595045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037488937377929688, "StateBufferConnector_ms": 0.0026521682739257812, "ViewRequirementAgentConnector_ms": 0.06887483596801758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27720, "num_agent_steps_trained": 27720, "num_env_steps_sampled": 27720, "num_env_steps_trained": 27720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.102425558708696, "num_env_steps_trained_throughput_per_sec": 39.102425558708696, "timesteps_total": 27720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 27720, "timers": {"training_iteration_time_ms": 3061.297, "sample_time_ms": 3057.574, "load_time_ms": 0.218, "load_throughput": 549652.157, "learn_time_ms": 2.752, "learn_throughput": 43601.344, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 27720, "num_env_steps_trained": 27720, "num_agent_steps_sampled": 27720, "num_agent_steps_trained": 27720}, "done": false, "episodes_total": 183, "training_iteration": 45, "trial_id": "668a1_00000", "date": "2023-07-25_17-57-22", "timestamp": 1690297042, "time_this_iter_s": 12.278302192687988, "time_total_s": 545.6582584381104, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 490.2946546077728, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 24.688888888888886, "ram_util_percent": 76.55555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -154871316480.0, "vf_loss": 535182336.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 163.0, "diff_num_grad_updates_vs_sampler_policy": 162.0}}, "num_env_steps_sampled": 28200, "num_env_steps_trained": 28200, "num_agent_steps_sampled": 28200, "num_agent_steps_trained": 28200}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.804011487873, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108282588994488, "mean_inference_ms": 0.395040160707239, "mean_action_processing_ms": 0.09489676732280483, "mean_env_wait_ms": 3.0945486487013305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747701644897461, "StateBufferConnector_ms": 0.0026540756225585938, "ViewRequirementAgentConnector_ms": 0.06883978843688965}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.804011487873, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8525.315122494183, -8619.009386039561, -8544.52006641606, -8472.219851365226, -8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108282588994488, "mean_inference_ms": 0.395040160707239, "mean_action_processing_ms": 0.09489676732280483, "mean_env_wait_ms": 3.0945486487013305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747701644897461, "StateBufferConnector_ms": 0.0026540756225585938, "ViewRequirementAgentConnector_ms": 0.06883978843688965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28200, "num_agent_steps_trained": 28200, "num_env_steps_sampled": 28200, "num_env_steps_trained": 28200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.877858600729105, "num_env_steps_trained_throughput_per_sec": 38.877858600729105, "timesteps_total": 28200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 28200, "timers": {"training_iteration_time_ms": 3075.839, "sample_time_ms": 3072.074, "load_time_ms": 0.221, "load_throughput": 543244.987, "learn_time_ms": 2.78, "learn_throughput": 43171.262, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 28200, "num_env_steps_trained": 28200, "num_agent_steps_sampled": 28200, "num_agent_steps_trained": 28200}, "done": false, "episodes_total": 187, "training_iteration": 46, "trial_id": "668a1_00000", "date": "2023-07-25_17-57-34", "timestamp": 1690297054, "time_this_iter_s": 12.349379062652588, "time_total_s": 558.0076375007629, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 502.6440336704254, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 24.98235294117647, "ram_util_percent": 76.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794189453125, "policy_loss": -110800928768.0, "vf_loss": 559630336.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 166.0}}, "num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8534.200620402558, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10852426450755, "mean_inference_ms": 0.3949704192682588, "mean_action_processing_ms": 0.09488395518141005, "mean_env_wait_ms": 3.086296467147514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741741180419922, "StateBufferConnector_ms": 0.0026514530181884766, "ViewRequirementAgentConnector_ms": 0.06874465942382812}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8534.200620402558, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8610.73730437555, -8524.46935983046, -8635.538481655465, -8446.395639248196, -8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10852426450755, "mean_inference_ms": 0.3949704192682588, "mean_action_processing_ms": 0.09488395518141005, "mean_env_wait_ms": 3.086296467147514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741741180419922, "StateBufferConnector_ms": 0.0026514530181884766, "ViewRequirementAgentConnector_ms": 0.06874465942382812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680, "num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.92312978039486, "num_env_steps_trained_throughput_per_sec": 38.92312978039486, "timesteps_total": 28680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 28680, "timers": {"training_iteration_time_ms": 3074.896, "sample_time_ms": 3071.088, "load_time_ms": 0.221, "load_throughput": 543244.987, "learn_time_ms": 2.811, "learn_throughput": 42691.565, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680}, "done": false, "episodes_total": 191, "training_iteration": 47, "trial_id": "668a1_00000", "date": "2023-07-25_17-57-47", "timestamp": 1690297067, "time_this_iter_s": 12.334858894348145, "time_total_s": 570.3424963951111, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 514.9788925647736, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 25.533333333333335, "ram_util_percent": 76.52222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7940063476562, "policy_loss": -71305773056.0, "vf_loss": 561049152.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 171.0, "diff_num_grad_updates_vs_sampler_policy": 170.0}}, "num_env_steps_sampled": 29160, "num_env_steps_trained": 29160, "num_agent_steps_sampled": 29160, "num_agent_steps_trained": 29160}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.828635333475, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10854619763593, "mean_inference_ms": 0.3949104247162204, "mean_action_processing_ms": 0.09487339439911459, "mean_env_wait_ms": 3.078528345573363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003753662109375, "StateBufferConnector_ms": 0.0026459693908691406, "ViewRequirementAgentConnector_ms": 0.06874251365661621}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.828635333475, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8398.878079476282, -8383.399654711951, -8595.314018962594, -8428.761812480072, -8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10854619763593, "mean_inference_ms": 0.3949104247162204, "mean_action_processing_ms": 0.09487339439911459, "mean_env_wait_ms": 3.078528345573363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003753662109375, "StateBufferConnector_ms": 0.0026459693908691406, "ViewRequirementAgentConnector_ms": 0.06874251365661621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29160, "num_agent_steps_trained": 29160, "num_env_steps_sampled": 29160, "num_env_steps_trained": 29160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.75665737662867, "num_env_steps_trained_throughput_per_sec": 38.75665737662867, "timesteps_total": 29160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 29160, "timers": {"training_iteration_time_ms": 3069.339, "sample_time_ms": 3065.528, "load_time_ms": 0.219, "load_throughput": 547678.433, "learn_time_ms": 2.808, "learn_throughput": 42736.515, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 29160, "num_env_steps_trained": 29160, "num_agent_steps_sampled": 29160, "num_agent_steps_trained": 29160}, "done": false, "episodes_total": 195, "training_iteration": 48, "trial_id": "668a1_00000", "date": "2023-07-25_17-57-59", "timestamp": 1690297079, "time_this_iter_s": 12.38778305053711, "time_total_s": 582.7302794456482, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 527.3666756153107, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 23.58235294117647, "ram_util_percent": 76.74117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943115234375, "policy_loss": -177095901184.0, "vf_loss": 571394880.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 175.0, "diff_num_grad_updates_vs_sampler_policy": 174.0}}, "num_env_steps_sampled": 29640, "num_env_steps_trained": 29640, "num_agent_steps_sampled": 29640, "num_agent_steps_trained": 29640}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8537.142961337528, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108938426940227, "mean_inference_ms": 0.39483565411984217, "mean_action_processing_ms": 0.09486015323489645, "mean_env_wait_ms": 3.071289935724293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748655319213867, "StateBufferConnector_ms": 0.0026388168334960938, "ViewRequirementAgentConnector_ms": 0.06862139701843262}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8537.142961337528, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8683.3725604766, -8684.425880581988, -8607.515607374458, -8509.266417636696, -8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108938426940227, "mean_inference_ms": 0.39483565411984217, "mean_action_processing_ms": 0.09486015323489645, "mean_env_wait_ms": 3.071289935724293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748655319213867, "StateBufferConnector_ms": 0.0026388168334960938, "ViewRequirementAgentConnector_ms": 0.06862139701843262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29640, "num_agent_steps_trained": 29640, "num_env_steps_sampled": 29640, "num_env_steps_trained": 29640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.20494690563687, "num_env_steps_trained_throughput_per_sec": 39.20494690563687, "timesteps_total": 29640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 29640, "timers": {"training_iteration_time_ms": 3084.98, "sample_time_ms": 3081.196, "load_time_ms": 0.219, "load_throughput": 547321.096, "learn_time_ms": 2.795, "learn_throughput": 42933.37, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 29640, "num_env_steps_trained": 29640, "num_agent_steps_sampled": 29640, "num_agent_steps_trained": 29640}, "done": false, "episodes_total": 199, "training_iteration": 49, "trial_id": "668a1_00000", "date": "2023-07-25_17-58-11", "timestamp": 1690297091, "time_this_iter_s": 12.245976209640503, "time_total_s": 594.9762556552887, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 539.6126518249512, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 27.711111111111112, "ram_util_percent": 76.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -161059471360.0, "vf_loss": 555566656.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 179.0, "diff_num_grad_updates_vs_sampler_policy": 178.0}}, "num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8534.676997561655, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108924354671462, "mean_inference_ms": 0.39477398616990445, "mean_action_processing_ms": 0.0948490636231599, "mean_env_wait_ms": 3.064771449698298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751993179321289, "StateBufferConnector_ms": 0.002643108367919922, "ViewRequirementAgentConnector_ms": 0.06871485710144043}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8534.676997561655, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8418.343750833461, -8558.930463999623, -8574.68128349924, -8490.258805874493, -8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.108924354671462, "mean_inference_ms": 0.39477398616990445, "mean_action_processing_ms": 0.0948490636231599, "mean_env_wait_ms": 3.064771449698298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751993179321289, "StateBufferConnector_ms": 0.002643108367919922, "ViewRequirementAgentConnector_ms": 0.06871485710144043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120, "num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.85770727964462, "num_env_steps_trained_throughput_per_sec": 38.85770727964462, "timesteps_total": 30120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 30120, "timers": {"training_iteration_time_ms": 3086.254, "sample_time_ms": 3082.491, "load_time_ms": 0.218, "load_throughput": 550734.741, "learn_time_ms": 2.771, "learn_throughput": 43301.256, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120}, "done": false, "episodes_total": 203, "training_iteration": 50, "trial_id": "668a1_00000", "date": "2023-07-25_17-58-24", "timestamp": 1690297104, "time_this_iter_s": 12.355661153793335, "time_total_s": 607.331916809082, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 551.9683129787445, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 25.664705882352937, "ram_util_percent": 76.58823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -52543815680.0, "vf_loss": 569476608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 183.0, "diff_num_grad_updates_vs_sampler_policy": 182.0}}, "num_env_steps_sampled": 30600, "num_env_steps_trained": 30600, "num_agent_steps_sampled": 30600, "num_agent_steps_trained": 30600}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8536.993280628449, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.109341315965413, "mean_inference_ms": 0.39469150395270364, "mean_action_processing_ms": 0.09483466756708057, "mean_env_wait_ms": 3.058585365782783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037317276000976562, "StateBufferConnector_ms": 0.0026395320892333984, "ViewRequirementAgentConnector_ms": 0.06851053237915039}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8536.993280628449, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8685.783707271046, -8470.985720316032, -8503.29036729706, -8540.647917303457, -8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.109341315965413, "mean_inference_ms": 0.39469150395270364, "mean_action_processing_ms": 0.09483466756708057, "mean_env_wait_ms": 3.058585365782783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037317276000976562, "StateBufferConnector_ms": 0.0026395320892333984, "ViewRequirementAgentConnector_ms": 0.06851053237915039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30600, "num_agent_steps_trained": 30600, "num_env_steps_sampled": 30600, "num_env_steps_trained": 30600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.70150364605362, "num_env_steps_trained_throughput_per_sec": 38.70150364605362, "timesteps_total": 30600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 30600, "timers": {"training_iteration_time_ms": 3081.376, "sample_time_ms": 3077.606, "load_time_ms": 0.224, "load_throughput": 536756.404, "learn_time_ms": 2.773, "learn_throughput": 43278.172, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 30600, "num_env_steps_trained": 30600, "num_agent_steps_sampled": 30600, "num_agent_steps_trained": 30600}, "done": false, "episodes_total": 207, "training_iteration": 51, "trial_id": "668a1_00000", "date": "2023-07-25_17-58-36", "timestamp": 1690297116, "time_this_iter_s": 12.405416011810303, "time_total_s": 619.7373328208923, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 564.3737289905548, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.48888888888889, "ram_util_percent": 76.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943115234375, "policy_loss": -83138084864.0, "vf_loss": 558428480.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 187.0, "diff_num_grad_updates_vs_sampler_policy": 186.0}}, "num_env_steps_sampled": 31080, "num_env_steps_trained": 31080, "num_agent_steps_sampled": 31080, "num_agent_steps_trained": 31080}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8536.12430772105, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110012649851843, "mean_inference_ms": 0.39462668538917045, "mean_action_processing_ms": 0.09482292992072182, "mean_env_wait_ms": 3.0529805877075704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037240982055664062, "StateBufferConnector_ms": 0.002634763717651367, "ViewRequirementAgentConnector_ms": 0.06854033470153809}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8536.12430772105, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8485.59234940831, -8484.309875905345, -8644.153409481198, -8591.787851348709, -8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110012649851843, "mean_inference_ms": 0.39462668538917045, "mean_action_processing_ms": 0.09482292992072182, "mean_env_wait_ms": 3.0529805877075704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037240982055664062, "StateBufferConnector_ms": 0.002634763717651367, "ViewRequirementAgentConnector_ms": 0.06854033470153809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31080, "num_agent_steps_trained": 31080, "num_env_steps_sampled": 31080, "num_env_steps_trained": 31080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.79004755343813, "num_env_steps_trained_throughput_per_sec": 38.79004755343813, "timesteps_total": 31080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 31080, "timers": {"training_iteration_time_ms": 3083.837, "sample_time_ms": 3080.047, "load_time_ms": 0.223, "load_throughput": 537673.838, "learn_time_ms": 2.801, "learn_throughput": 42840.914, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 31080, "num_env_steps_trained": 31080, "num_agent_steps_sampled": 31080, "num_agent_steps_trained": 31080}, "done": false, "episodes_total": 211, "training_iteration": 52, "trial_id": "668a1_00000", "date": "2023-07-25_17-58-48", "timestamp": 1690297128, "time_this_iter_s": 12.377161026000977, "time_total_s": 632.1144938468933, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 576.7508900165558, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 22.033333333333335, "ram_util_percent": 76.62777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7946166992188, "policy_loss": -74980515840.0, "vf_loss": 543715776.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.636763952623, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11029285072027, "mean_inference_ms": 0.39453872982523164, "mean_action_processing_ms": 0.09480582782394772, "mean_env_wait_ms": 3.047767186275648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718852996826172, "StateBufferConnector_ms": 0.002628803253173828, "ViewRequirementAgentConnector_ms": 0.0683748722076416}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.636763952623, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8387.218559563486, -8769.472884091314, -8382.086952052126, -8591.547944518717, -8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11029285072027, "mean_inference_ms": 0.39453872982523164, "mean_action_processing_ms": 0.09480582782394772, "mean_env_wait_ms": 3.047767186275648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718852996826172, "StateBufferConnector_ms": 0.002628803253173828, "ViewRequirementAgentConnector_ms": 0.0683748722076416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560, "num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.153336243353394, "num_env_steps_trained_throughput_per_sec": 39.153336243353394, "timesteps_total": 31560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 31560, "timers": {"training_iteration_time_ms": 3087.414, "sample_time_ms": 3083.636, "load_time_ms": 0.223, "load_throughput": 536928.184, "learn_time_ms": 2.789, "learn_throughput": 43019.606, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560}, "done": false, "episodes_total": 215, "training_iteration": 53, "trial_id": "668a1_00000", "date": "2023-07-25_17-59-01", "timestamp": 1690297141, "time_this_iter_s": 12.262186050415039, "time_total_s": 644.3766798973083, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 589.0130760669708, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 25.194117647058825, "ram_util_percent": 76.65294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -70897819648.0, "vf_loss": 548563136.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 195.0, "diff_num_grad_updates_vs_sampler_policy": 194.0}}, "num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.728884321303, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110644388037617, "mean_inference_ms": 0.3944378804217432, "mean_action_processing_ms": 0.0947857713599843, "mean_env_wait_ms": 3.042992093069521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037217140197753906, "StateBufferConnector_ms": 0.002630949020385742, "ViewRequirementAgentConnector_ms": 0.06841874122619629}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.728884321303, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8434.690125655437, -8586.862460698525, -8394.204274120473, -8681.083637330588, -8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110644388037617, "mean_inference_ms": 0.3944378804217432, "mean_action_processing_ms": 0.0947857713599843, "mean_env_wait_ms": 3.042992093069521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037217140197753906, "StateBufferConnector_ms": 0.002630949020385742, "ViewRequirementAgentConnector_ms": 0.06841874122619629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040, "num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.52055969466664, "num_env_steps_trained_throughput_per_sec": 38.52055969466664, "timesteps_total": 32040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 32040, "timers": {"training_iteration_time_ms": 3102.723, "sample_time_ms": 3098.834, "load_time_ms": 0.229, "load_throughput": 523578.987, "learn_time_ms": 2.866, "learn_throughput": 41868.375, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040}, "done": false, "episodes_total": 219, "training_iteration": 54, "trial_id": "668a1_00000", "date": "2023-07-25_17-59-13", "timestamp": 1690297153, "time_this_iter_s": 12.46378493309021, "time_total_s": 656.8404648303986, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 601.476861000061, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 27.0, "ram_util_percent": 76.02777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7939453125, "policy_loss": -41379758080.0, "vf_loss": 570771072.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 199.0, "diff_num_grad_updates_vs_sampler_policy": 198.0}}, "num_env_steps_sampled": 32520, "num_env_steps_trained": 32520, "num_agent_steps_sampled": 32520, "num_agent_steps_trained": 32520}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8536.66636457079, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.111697791728112, "mean_inference_ms": 0.39434454579544975, "mean_action_processing_ms": 0.09476703194615446, "mean_env_wait_ms": 3.0385583252288404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037224292755126953, "StateBufferConnector_ms": 0.0026350021362304688, "ViewRequirementAgentConnector_ms": 0.06845450401306152}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8536.66636457079, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8606.661332367456, -8607.327736600384, -8442.345762655028, -8460.345269628482, -8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.111697791728112, "mean_inference_ms": 0.39434454579544975, "mean_action_processing_ms": 0.09476703194615446, "mean_env_wait_ms": 3.0385583252288404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037224292755126953, "StateBufferConnector_ms": 0.0026350021362304688, "ViewRequirementAgentConnector_ms": 0.06845450401306152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32520, "num_agent_steps_trained": 32520, "num_env_steps_sampled": 32520, "num_env_steps_trained": 32520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.56936258743749, "num_env_steps_trained_throughput_per_sec": 38.56936258743749, "timesteps_total": 32520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 32520, "timers": {"training_iteration_time_ms": 3105.917, "sample_time_ms": 3101.981, "load_time_ms": 0.229, "load_throughput": 524998.936, "learn_time_ms": 2.905, "learn_throughput": 41305.897, "synch_weights_time_ms": 0.757}, "counters": {"num_env_steps_sampled": 32520, "num_env_steps_trained": 32520, "num_agent_steps_sampled": 32520, "num_agent_steps_trained": 32520}, "done": false, "episodes_total": 223, "training_iteration": 55, "trial_id": "668a1_00000", "date": "2023-07-25_17-59-26", "timestamp": 1690297166, "time_this_iter_s": 12.448017120361328, "time_total_s": 669.2884819507599, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 613.9248781204224, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 23.87777777777778, "ram_util_percent": 75.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943725585938, "policy_loss": -108061474816.0, "vf_loss": 547765120.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8534.041063192459, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.112947682122158, "mean_inference_ms": 0.3942748842866116, "mean_action_processing_ms": 0.09475296454258433, "mean_env_wait_ms": 3.0345456070063768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742694854736328, "StateBufferConnector_ms": 0.002651214599609375, "ViewRequirementAgentConnector_ms": 0.0687711238861084}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8534.041063192459, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8394.250523661534, -8762.83277173031, -8404.30041232139, -8563.728716940648, -8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.112947682122158, "mean_inference_ms": 0.3942748842866116, "mean_action_processing_ms": 0.09475296454258433, "mean_env_wait_ms": 3.0345456070063768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742694854736328, "StateBufferConnector_ms": 0.002651214599609375, "ViewRequirementAgentConnector_ms": 0.0687711238861084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000, "num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.15788409875329, "num_env_steps_trained_throughput_per_sec": 39.15788409875329, "timesteps_total": 33000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 3081.942, "sample_time_ms": 3078.052, "load_time_ms": 0.222, "load_throughput": 539460.322, "learn_time_ms": 2.856, "learn_throughput": 42019.024, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000}, "done": false, "episodes_total": 227, "training_iteration": 56, "trial_id": "668a1_00000", "date": "2023-07-25_17-59-38", "timestamp": 1690297178, "time_this_iter_s": 12.260946989059448, "time_total_s": 681.5494289398193, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 626.1858251094818, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.78235294117647, "ram_util_percent": 76.55882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -101982527488.0, "vf_loss": 548100160.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 207.0, "diff_num_grad_updates_vs_sampler_policy": 206.0}}, "num_env_steps_sampled": 33480, "num_env_steps_trained": 33480, "num_agent_steps_sampled": 33480, "num_agent_steps_trained": 33480}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.049987029031, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1138538259872, "mean_inference_ms": 0.3942032426993606, "mean_action_processing_ms": 0.09473883371304648, "mean_env_wait_ms": 3.030831091316806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003740072250366211, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06876134872436523}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8791.864790620519, "episode_reward_mean": -8533.049987029031, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8517.601830539807, -8739.888942930524, -8791.864790620519, -8445.250180099323, -8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1138538259872, "mean_inference_ms": 0.3942032426993606, "mean_action_processing_ms": 0.09473883371304648, "mean_env_wait_ms": 3.030831091316806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003740072250366211, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06876134872436523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33480, "num_agent_steps_trained": 33480, "num_env_steps_sampled": 33480, "num_env_steps_trained": 33480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.23035953158863, "num_env_steps_trained_throughput_per_sec": 39.23035953158863, "timesteps_total": 33480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 33480, "timers": {"training_iteration_time_ms": 3064.34, "sample_time_ms": 3060.471, "load_time_ms": 0.221, "load_throughput": 542483.811, "learn_time_ms": 2.838, "learn_throughput": 42277.384, "synch_weights_time_ms": 0.767}, "counters": {"num_env_steps_sampled": 33480, "num_env_steps_trained": 33480, "num_agent_steps_sampled": 33480, "num_agent_steps_trained": 33480}, "done": false, "episodes_total": 231, "training_iteration": 57, "trial_id": "668a1_00000", "date": "2023-07-25_17-59-50", "timestamp": 1690297190, "time_this_iter_s": 12.238178014755249, "time_total_s": 693.7876069545746, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 638.4240031242371, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 25.82941176470588, "ram_util_percent": 76.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -91722489856.0, "vf_loss": 542986688.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 211.0, "diff_num_grad_updates_vs_sampler_policy": 210.0}}, "num_env_steps_sampled": 33960, "num_env_steps_trained": 33960, "num_agent_steps_sampled": 33960, "num_agent_steps_trained": 33960}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8736.913944028896, "episode_reward_mean": -8529.77534556487, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11447897168526, "mean_inference_ms": 0.39414162538114733, "mean_action_processing_ms": 0.09472640471967518, "mean_env_wait_ms": 3.0273252060438254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003755331039428711, "StateBufferConnector_ms": 0.002645730972290039, "ViewRequirementAgentConnector_ms": 0.06889462471008301}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8736.913944028896, "episode_reward_mean": -8529.77534556487, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8651.583681358945, -8487.040262548746, -8510.504017113355, -8459.077710269203, -8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11447897168526, "mean_inference_ms": 0.39414162538114733, "mean_action_processing_ms": 0.09472640471967518, "mean_env_wait_ms": 3.0273252060438254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003755331039428711, "StateBufferConnector_ms": 0.002645730972290039, "ViewRequirementAgentConnector_ms": 0.06889462471008301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33960, "num_agent_steps_trained": 33960, "num_env_steps_sampled": 33960, "num_env_steps_trained": 33960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.39670227210673, "num_env_steps_trained_throughput_per_sec": 39.39670227210673, "timesteps_total": 33960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 33960, "timers": {"training_iteration_time_ms": 3068.188, "sample_time_ms": 3064.393, "load_time_ms": 0.22, "load_throughput": 546607.819, "learn_time_ms": 2.793, "learn_throughput": 42964.521, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 33960, "num_env_steps_trained": 33960, "num_agent_steps_sampled": 33960, "num_agent_steps_trained": 33960}, "done": false, "episodes_total": 235, "training_iteration": 58, "trial_id": "668a1_00000", "date": "2023-07-25_18-00-02", "timestamp": 1690297202, "time_this_iter_s": 12.187116861343384, "time_total_s": 705.974723815918, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 650.6111199855804, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 25.81111111111111, "ram_util_percent": 75.95555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7940673828125, "policy_loss": -133016674304.0, "vf_loss": 564952512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 215.0, "diff_num_grad_updates_vs_sampler_policy": 214.0}}, "num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8736.913944028896, "episode_reward_mean": -8531.07808907939, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115008987497195, "mean_inference_ms": 0.39408353354472114, "mean_action_processing_ms": 0.09471534204042831, "mean_env_wait_ms": 3.0239043117420135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003756999969482422, "StateBufferConnector_ms": 0.0026443004608154297, "ViewRequirementAgentConnector_ms": 0.06903219223022461}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8736.913944028896, "episode_reward_mean": -8531.07808907939, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8495.110044766358, -8450.529042557651, -8440.981629240889, -8609.613259588532, -8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115008987497195, "mean_inference_ms": 0.39408353354472114, "mean_action_processing_ms": 0.09471534204042831, "mean_env_wait_ms": 3.0239043117420135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003756999969482422, "StateBufferConnector_ms": 0.0026443004608154297, "ViewRequirementAgentConnector_ms": 0.06903219223022461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440, "num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.57511493990891, "num_env_steps_trained_throughput_per_sec": 39.57511493990891, "timesteps_total": 34440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 34440, "timers": {"training_iteration_time_ms": 3055.768, "sample_time_ms": 3052.012, "load_time_ms": 0.219, "load_throughput": 548394.509, "learn_time_ms": 2.763, "learn_throughput": 43437.657, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440}, "done": false, "episodes_total": 239, "training_iteration": 59, "trial_id": "668a1_00000", "date": "2023-07-25_18-00-15", "timestamp": 1690297215, "time_this_iter_s": 12.13174319267273, "time_total_s": 718.1064670085907, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 662.7428631782532, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.635294117647057, "ram_util_percent": 76.17058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -125475217408.0, "vf_loss": 566065088.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 219.0, "diff_num_grad_updates_vs_sampler_policy": 218.0}}, "num_env_steps_sampled": 34920, "num_env_steps_trained": 34920, "num_agent_steps_sampled": 34920, "num_agent_steps_trained": 34920}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8736.913944028896, "episode_reward_mean": -8531.411859881235, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115698078907634, "mean_inference_ms": 0.3940232444747491, "mean_action_processing_ms": 0.09470421132677771, "mean_env_wait_ms": 3.0205549938429797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003764629364013672, "StateBufferConnector_ms": 0.002642393112182617, "ViewRequirementAgentConnector_ms": 0.06909036636352539}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8736.913944028896, "episode_reward_mean": -8531.411859881235, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8480.563702202315, -8566.781127746373, -8548.049572106633, -8617.804846882585, -8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115698078907634, "mean_inference_ms": 0.3940232444747491, "mean_action_processing_ms": 0.09470421132677771, "mean_env_wait_ms": 3.0205549938429797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003764629364013672, "StateBufferConnector_ms": 0.002642393112182617, "ViewRequirementAgentConnector_ms": 0.06909036636352539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34920, "num_agent_steps_trained": 34920, "num_env_steps_sampled": 34920, "num_env_steps_trained": 34920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.78327087216531, "num_env_steps_trained_throughput_per_sec": 39.78327087216531, "timesteps_total": 34920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 34920, "timers": {"training_iteration_time_ms": 3010.523, "sample_time_ms": 3006.765, "load_time_ms": 0.217, "load_throughput": 552306.024, "learn_time_ms": 2.774, "learn_throughput": 43264.779, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 34920, "num_env_steps_trained": 34920, "num_agent_steps_sampled": 34920, "num_agent_steps_trained": 34920}, "done": false, "episodes_total": 243, "training_iteration": 60, "trial_id": "668a1_00000", "date": "2023-07-25_18-00-27", "timestamp": 1690297227, "time_this_iter_s": 12.068170070648193, "time_total_s": 730.1746370792389, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 674.8110332489014, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 27.0, "ram_util_percent": 76.37647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943725585938, "policy_loss": -97724211200.0, "vf_loss": 562073856.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 223.0, "diff_num_grad_updates_vs_sampler_policy": 222.0}}, "num_env_steps_sampled": 35400, "num_env_steps_trained": 35400, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35400}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8534.108229551168, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115812216448656, "mean_inference_ms": 0.39396922955619096, "mean_action_processing_ms": 0.09469424200924013, "mean_env_wait_ms": 3.017397866404427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00377655029296875, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.06922745704650879}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8534.108229551168, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8529.415255055439, -8533.730035534658, -8437.652044022723, -8442.083771683547, -8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115812216448656, "mean_inference_ms": 0.39396922955619096, "mean_action_processing_ms": 0.09469424200924013, "mean_env_wait_ms": 3.017397866404427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00377655029296875, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.06922745704650879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35400, "num_env_steps_sampled": 35400, "num_env_steps_trained": 35400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.66491377340507, "num_env_steps_trained_throughput_per_sec": 39.66491377340507, "timesteps_total": 35400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 35400, "timers": {"training_iteration_time_ms": 3011.475, "sample_time_ms": 3007.678, "load_time_ms": 0.222, "load_throughput": 539749.576, "learn_time_ms": 2.808, "learn_throughput": 42735.063, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 35400, "num_env_steps_trained": 35400, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35400}, "done": false, "episodes_total": 247, "training_iteration": 61, "trial_id": "668a1_00000", "date": "2023-07-25_18-00-39", "timestamp": 1690297239, "time_this_iter_s": 12.104279041290283, "time_total_s": 742.2789161205292, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 686.9153122901917, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.90555555555555, "ram_util_percent": 76.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -87402700800.0, "vf_loss": 552154944.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 227.0, "diff_num_grad_updates_vs_sampler_policy": 226.0}}, "num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8536.497520363397, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1156172984791, "mean_inference_ms": 0.39391880598947, "mean_action_processing_ms": 0.09468503575454378, "mean_env_wait_ms": 3.014273856141721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003777027130126953, "StateBufferConnector_ms": 0.002637624740600586, "ViewRequirementAgentConnector_ms": 0.06927084922790527}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8536.497520363397, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8551.29651914829, -8555.087403833433, -8453.805018534822, -8630.129743983605, -8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1156172984791, "mean_inference_ms": 0.39391880598947, "mean_action_processing_ms": 0.09468503575454378, "mean_env_wait_ms": 3.014273856141721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003777027130126953, "StateBufferConnector_ms": 0.002637624740600586, "ViewRequirementAgentConnector_ms": 0.06927084922790527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880, "num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.75579304908161, "num_env_steps_trained_throughput_per_sec": 39.75579304908161, "timesteps_total": 35880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 35880, "timers": {"training_iteration_time_ms": 3015.882, "sample_time_ms": 3012.064, "load_time_ms": 0.223, "load_throughput": 537558.988, "learn_time_ms": 2.83, "learn_throughput": 42410.26, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880}, "done": false, "episodes_total": 251, "training_iteration": 62, "trial_id": "668a1_00000", "date": "2023-07-25_18-00-51", "timestamp": 1690297251, "time_this_iter_s": 12.076406002044678, "time_total_s": 754.3553221225739, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 698.9917182922363, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 25.258823529411767, "ram_util_percent": 76.36470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7941284179688, "policy_loss": -56050573312.0, "vf_loss": 578180736.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 231.0, "diff_num_grad_updates_vs_sampler_policy": 230.0}}, "num_env_steps_sampled": 36360, "num_env_steps_trained": 36360, "num_agent_steps_sampled": 36360, "num_agent_steps_trained": 36360}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8541.89340384961, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115160449430793, "mean_inference_ms": 0.3938662208169083, "mean_action_processing_ms": 0.0946757629127811, "mean_env_wait_ms": 3.0112280444502026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003778219223022461, "StateBufferConnector_ms": 0.002635478973388672, "ViewRequirementAgentConnector_ms": 0.0692453384399414}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8541.89340384961, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8540.95723363816, -8552.765117339412, -8561.53986690975, -8468.151345390183, -8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115160449430793, "mean_inference_ms": 0.3938662208169083, "mean_action_processing_ms": 0.0946757629127811, "mean_env_wait_ms": 3.0112280444502026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003778219223022461, "StateBufferConnector_ms": 0.002635478973388672, "ViewRequirementAgentConnector_ms": 0.0692453384399414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36360, "num_agent_steps_trained": 36360, "num_env_steps_sampled": 36360, "num_env_steps_trained": 36360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.39884867621209, "num_env_steps_trained_throughput_per_sec": 39.39884867621209, "timesteps_total": 36360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 36360, "timers": {"training_iteration_time_ms": 3047.578, "sample_time_ms": 3043.763, "load_time_ms": 0.222, "load_throughput": 540213.03, "learn_time_ms": 2.827, "learn_throughput": 42447.457, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 36360, "num_env_steps_trained": 36360, "num_agent_steps_sampled": 36360, "num_agent_steps_trained": 36360}, "done": false, "episodes_total": 255, "training_iteration": 63, "trial_id": "668a1_00000", "date": "2023-07-25_18-01-03", "timestamp": 1690297263, "time_this_iter_s": 12.18588900566101, "time_total_s": 766.5412111282349, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 711.1776072978973, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 25.388235294117646, "ram_util_percent": 76.3529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -51313983488.0, "vf_loss": 555350720.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 235.0, "diff_num_grad_updates_vs_sampler_policy": 234.0}}, "num_env_steps_sampled": 36840, "num_env_steps_trained": 36840, "num_agent_steps_sampled": 36840, "num_agent_steps_trained": 36840}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8542.736895955713, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11462564618113, "mean_inference_ms": 0.39381087051304897, "mean_action_processing_ms": 0.09466566429645638, "mean_env_wait_ms": 3.0082832663789363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037844181060791016, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.0693356990814209}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8542.736895955713, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8455.67982662766, -8540.826640504994, -8546.491062722298, -8630.101996796071, -8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11462564618113, "mean_inference_ms": 0.39381087051304897, "mean_action_processing_ms": 0.09466566429645638, "mean_env_wait_ms": 3.0082832663789363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037844181060791016, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.0693356990814209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36840, "num_agent_steps_trained": 36840, "num_env_steps_sampled": 36840, "num_env_steps_trained": 36840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.258854841958644, "num_env_steps_trained_throughput_per_sec": 39.258854841958644, "timesteps_total": 36840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 36840, "timers": {"training_iteration_time_ms": 3052.509, "sample_time_ms": 3048.688, "load_time_ms": 0.218, "load_throughput": 550313.23, "learn_time_ms": 2.818, "learn_throughput": 42576.724, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 36840, "num_env_steps_trained": 36840, "num_agent_steps_sampled": 36840, "num_agent_steps_trained": 36840}, "done": false, "episodes_total": 259, "training_iteration": 64, "trial_id": "668a1_00000", "date": "2023-07-25_18-01-15", "timestamp": 1690297275, "time_this_iter_s": 12.22938871383667, "time_total_s": 778.7705998420715, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 723.406996011734, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 24.170588235294115, "ram_util_percent": 76.42941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -103687774208.0, "vf_loss": 564921472.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 238.0}}, "num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8543.078904714099, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11425932082334, "mean_inference_ms": 0.3937552869398063, "mean_action_processing_ms": 0.09465545896157765, "mean_env_wait_ms": 3.0055574091351684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037841796875, "StateBufferConnector_ms": 0.0026323795318603516, "ViewRequirementAgentConnector_ms": 0.06932544708251953}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8543.078904714099, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8479.505925423697, -8515.646220587523, -8568.412430303519, -8532.302472420022, -8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11425932082334, "mean_inference_ms": 0.3937552869398063, "mean_action_processing_ms": 0.09465545896157765, "mean_env_wait_ms": 3.0055574091351684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037841796875, "StateBufferConnector_ms": 0.0026323795318603516, "ViewRequirementAgentConnector_ms": 0.06932544708251953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320, "num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.14839815821879, "num_env_steps_trained_throughput_per_sec": 39.14839815821879, "timesteps_total": 37320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 37320, "timers": {"training_iteration_time_ms": 3045.005, "sample_time_ms": 3041.233, "load_time_ms": 0.219, "load_throughput": 548394.509, "learn_time_ms": 2.783, "learn_throughput": 43117.267, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320}, "done": false, "episodes_total": 263, "training_iteration": 65, "trial_id": "668a1_00000", "date": "2023-07-25_18-01-28", "timestamp": 1690297288, "time_this_iter_s": 12.263861179351807, "time_total_s": 791.0344610214233, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 735.6708571910858, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 23.327777777777776, "ram_util_percent": 76.40555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -85152497664.0, "vf_loss": 546439360.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 243.0, "diff_num_grad_updates_vs_sampler_policy": 242.0}}, "num_env_steps_sampled": 37800, "num_env_steps_trained": 37800, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37800}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8542.655946798328, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11397784176693, "mean_inference_ms": 0.39370080319092876, "mean_action_processing_ms": 0.09464550278972186, "mean_env_wait_ms": 3.002810931498658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037758350372314453, "StateBufferConnector_ms": 0.0026280879974365234, "ViewRequirementAgentConnector_ms": 0.06922793388366699}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8542.655946798328, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8475.213150734106, -8533.02936781766, -8684.42844691608, -8504.426527315649, -8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11397784176693, "mean_inference_ms": 0.39370080319092876, "mean_action_processing_ms": 0.09464550278972186, "mean_env_wait_ms": 3.002810931498658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037758350372314453, "StateBufferConnector_ms": 0.0026280879974365234, "ViewRequirementAgentConnector_ms": 0.06922793388366699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37800, "num_env_steps_sampled": 37800, "num_env_steps_trained": 37800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.43288545607598, "num_env_steps_trained_throughput_per_sec": 39.43288545607598, "timesteps_total": 37800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 37800, "timers": {"training_iteration_time_ms": 3036.37, "sample_time_ms": 3032.621, "load_time_ms": 0.216, "load_throughput": 554496.508, "learn_time_ms": 2.763, "learn_throughput": 43426.789, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 37800, "num_env_steps_trained": 37800, "num_agent_steps_sampled": 37800, "num_agent_steps_trained": 37800}, "done": false, "episodes_total": 267, "training_iteration": 66, "trial_id": "668a1_00000", "date": "2023-07-25_18-01-40", "timestamp": 1690297300, "time_this_iter_s": 12.175226211547852, "time_total_s": 803.2096872329712, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 747.8460834026337, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 24.735294117647058, "ram_util_percent": 76.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -67265175552.0, "vf_loss": 556195456.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 247.0, "diff_num_grad_updates_vs_sampler_policy": 246.0}}, "num_env_steps_sampled": 38280, "num_env_steps_trained": 38280, "num_agent_steps_sampled": 38280, "num_agent_steps_trained": 38280}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8542.731598098117, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.113523046519685, "mean_inference_ms": 0.3936471849673534, "mean_action_processing_ms": 0.09463597074650959, "mean_env_wait_ms": 3.000198723442279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003769397735595703, "StateBufferConnector_ms": 0.002618074417114258, "ViewRequirementAgentConnector_ms": 0.06912493705749512}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8542.731598098117, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8457.57005695472, -8587.603252360626, -8595.978884698832, -8480.96972923209, -8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.113523046519685, "mean_inference_ms": 0.3936471849673534, "mean_action_processing_ms": 0.09463597074650959, "mean_env_wait_ms": 3.000198723442279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003769397735595703, "StateBufferConnector_ms": 0.002618074417114258, "ViewRequirementAgentConnector_ms": 0.06912493705749512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38280, "num_agent_steps_trained": 38280, "num_env_steps_sampled": 38280, "num_env_steps_trained": 38280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.55793082249429, "num_env_steps_trained_throughput_per_sec": 39.55793082249429, "timesteps_total": 38280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 38280, "timers": {"training_iteration_time_ms": 3053.028, "sample_time_ms": 3049.283, "load_time_ms": 0.214, "load_throughput": 559551.395, "learn_time_ms": 2.762, "learn_throughput": 43439.157, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 38280, "num_env_steps_trained": 38280, "num_agent_steps_sampled": 38280, "num_agent_steps_trained": 38280}, "done": false, "episodes_total": 271, "training_iteration": 67, "trial_id": "668a1_00000", "date": "2023-07-25_18-01-52", "timestamp": 1690297312, "time_this_iter_s": 12.136899709701538, "time_total_s": 815.3465869426727, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 759.9829831123352, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 27.16111111111111, "ram_util_percent": 76.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -68161880064.0, "vf_loss": 557007680.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8541.672948107342, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11309642425781, "mean_inference_ms": 0.3935971215970319, "mean_action_processing_ms": 0.09462661590349697, "mean_env_wait_ms": 2.9976907499124343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037610530853271484, "StateBufferConnector_ms": 0.002613067626953125, "ViewRequirementAgentConnector_ms": 0.0690619945526123}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8541.672948107342, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8523.388193808318, -8736.913944028896, -8622.465068868762, -8454.791914527468, -8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11309642425781, "mean_inference_ms": 0.3935971215970319, "mean_action_processing_ms": 0.09462661590349697, "mean_env_wait_ms": 2.9976907499124343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037610530853271484, "StateBufferConnector_ms": 0.002613067626953125, "ViewRequirementAgentConnector_ms": 0.0690619945526123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760, "num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.99028160511838, "num_env_steps_trained_throughput_per_sec": 38.99028160511838, "timesteps_total": 38760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 38760, "timers": {"training_iteration_time_ms": 3065.942, "sample_time_ms": 3062.167, "load_time_ms": 0.213, "load_throughput": 562113.558, "learn_time_ms": 2.779, "learn_throughput": 43178.299, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760}, "done": false, "episodes_total": 275, "training_iteration": 68, "trial_id": "668a1_00000", "date": "2023-07-25_18-02-04", "timestamp": 1690297324, "time_this_iter_s": 12.313602209091187, "time_total_s": 827.6601891517639, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 772.2965853214264, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 24.641176470588235, "ram_util_percent": 76.42941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952880859375, "policy_loss": -53968732160.0, "vf_loss": 548128128.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 255.0, "diff_num_grad_updates_vs_sampler_policy": 254.0}}, "num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8541.13812015597, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11335765788338, "mean_inference_ms": 0.393541918515592, "mean_action_processing_ms": 0.09461681638580523, "mean_env_wait_ms": 2.995191376923458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003763914108276367, "StateBufferConnector_ms": 0.0026102066040039062, "ViewRequirementAgentConnector_ms": 0.06899094581604004}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8541.13812015597, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8583.180513857951, -8378.550400120364, -8555.190931357778, -8563.898465029892, -8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11335765788338, "mean_inference_ms": 0.393541918515592, "mean_action_processing_ms": 0.09461681638580523, "mean_env_wait_ms": 2.995191376923458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003763914108276367, "StateBufferConnector_ms": 0.0026102066040039062, "ViewRequirementAgentConnector_ms": 0.06899094581604004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240, "num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.9251533947299, "num_env_steps_trained_throughput_per_sec": 38.9251533947299, "timesteps_total": 39240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 39240, "timers": {"training_iteration_time_ms": 3071.425, "sample_time_ms": 3067.666, "load_time_ms": 0.215, "load_throughput": 559240.533, "learn_time_ms": 2.76, "learn_throughput": 43481.563, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240}, "done": false, "episodes_total": 279, "training_iteration": 69, "trial_id": "668a1_00000", "date": "2023-07-25_18-02-17", "timestamp": 1690297337, "time_this_iter_s": 12.33427381515503, "time_total_s": 839.994462966919, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 784.6308591365814, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.744444444444444, "ram_util_percent": 76.5111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947387695312, "policy_loss": -47898558464.0, "vf_loss": 559623424.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 259.0, "diff_num_grad_updates_vs_sampler_policy": 258.0}}, "num_env_steps_sampled": 39720, "num_env_steps_trained": 39720, "num_agent_steps_sampled": 39720, "num_agent_steps_trained": 39720}, "sampler_results": {"episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8543.207697014359, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11359838054156, "mean_inference_ms": 0.39348800555313557, "mean_action_processing_ms": 0.09460735333147895, "mean_env_wait_ms": 2.9928827800388205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003758668899536133, "StateBufferConnector_ms": 0.002616405487060547, "ViewRequirementAgentConnector_ms": 0.06903648376464844}}, "episode_reward_max": -8343.186438290424, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8543.207697014359, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8446.815595865099, -8456.24702918305, -8471.864557188801, -8343.186438290424, -8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11359838054156, "mean_inference_ms": 0.39348800555313557, "mean_action_processing_ms": 0.09460735333147895, "mean_env_wait_ms": 2.9928827800388205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003758668899536133, "StateBufferConnector_ms": 0.002616405487060547, "ViewRequirementAgentConnector_ms": 0.06903648376464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39720, "num_agent_steps_trained": 39720, "num_env_steps_sampled": 39720, "num_env_steps_trained": 39720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.87750799703002, "num_env_steps_trained_throughput_per_sec": 38.87750799703002, "timesteps_total": 39720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 39720, "timers": {"training_iteration_time_ms": 3072.891, "sample_time_ms": 3069.152, "load_time_ms": 0.215, "load_throughput": 557320.873, "learn_time_ms": 2.748, "learn_throughput": 43664.892, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 39720, "num_env_steps_trained": 39720, "num_agent_steps_sampled": 39720, "num_agent_steps_trained": 39720}, "done": false, "episodes_total": 283, "training_iteration": 70, "trial_id": "668a1_00000", "date": "2023-07-25_18-02-29", "timestamp": 1690297349, "time_this_iter_s": 12.349328994750977, "time_total_s": 852.3437919616699, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 796.9801881313324, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 23.794117647058822, "ram_util_percent": 76.2764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -118944284672.0, "vf_loss": 578538432.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 262.0}}, "num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8551.998596897014, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.113731012236677, "mean_inference_ms": 0.39343791968538755, "mean_action_processing_ms": 0.09459877483081153, "mean_env_wait_ms": 2.990506833050056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037603378295898438, "StateBufferConnector_ms": 0.0026149749755859375, "ViewRequirementAgentConnector_ms": 0.06907272338867188}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8551.998596897014, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8530.523711449478, -8556.032650579938, -8530.33494034546, -8583.834015408396, -8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.113731012236677, "mean_inference_ms": 0.39343791968538755, "mean_action_processing_ms": 0.09459877483081153, "mean_env_wait_ms": 2.990506833050056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037603378295898438, "StateBufferConnector_ms": 0.0026149749755859375, "ViewRequirementAgentConnector_ms": 0.06907272338867188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200, "num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.36361835613316, "num_env_steps_trained_throughput_per_sec": 39.36361835613316, "timesteps_total": 40200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 40200, "timers": {"training_iteration_time_ms": 3067.819, "sample_time_ms": 3064.111, "load_time_ms": 0.214, "load_throughput": 560548.48, "learn_time_ms": 2.733, "learn_throughput": 43907.919, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200}, "done": false, "episodes_total": 287, "training_iteration": 71, "trial_id": "668a1_00000", "date": "2023-07-25_18-02-41", "timestamp": 1690297361, "time_this_iter_s": 12.196706056594849, "time_total_s": 864.5404980182648, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 809.1768941879272, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 26.361111111111107, "ram_util_percent": 76.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -79327322112.0, "vf_loss": 549736192.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 267.0, "diff_num_grad_updates_vs_sampler_policy": 266.0}}, "num_env_steps_sampled": 40680, "num_env_steps_trained": 40680, "num_agent_steps_sampled": 40680, "num_agent_steps_trained": 40680}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8551.392139484455, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11391484571253, "mean_inference_ms": 0.3933934828884714, "mean_action_processing_ms": 0.09459144430305205, "mean_env_wait_ms": 2.9881567007386387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037605762481689453, "StateBufferConnector_ms": 0.002617359161376953, "ViewRequirementAgentConnector_ms": 0.0691380500793457}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8551.392139484455, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8577.204974984244, -8480.960156706158, -8521.315171325394, -8600.46197518582, -8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11391484571253, "mean_inference_ms": 0.3933934828884714, "mean_action_processing_ms": 0.09459144430305205, "mean_env_wait_ms": 2.9881567007386387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037605762481689453, "StateBufferConnector_ms": 0.002617359161376953, "ViewRequirementAgentConnector_ms": 0.0691380500793457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40680, "num_agent_steps_trained": 40680, "num_env_steps_sampled": 40680, "num_env_steps_trained": 40680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.796907441206315, "num_env_steps_trained_throughput_per_sec": 38.796907441206315, "timesteps_total": 40680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 40680, "timers": {"training_iteration_time_ms": 3089.252, "sample_time_ms": 3085.527, "load_time_ms": 0.214, "load_throughput": 560860.798, "learn_time_ms": 2.747, "learn_throughput": 43679.671, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 40680, "num_env_steps_trained": 40680, "num_agent_steps_sampled": 40680, "num_agent_steps_trained": 40680}, "done": false, "episodes_total": 291, "training_iteration": 72, "trial_id": "668a1_00000", "date": "2023-07-25_18-02-54", "timestamp": 1690297374, "time_this_iter_s": 12.374972343444824, "time_total_s": 876.9154703617096, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 821.5518665313721, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 76.37058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -67636707328.0, "vf_loss": 561065920.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 271.0, "diff_num_grad_updates_vs_sampler_policy": 270.0}}, "num_env_steps_sampled": 41160, "num_env_steps_trained": 41160, "num_agent_steps_sampled": 41160, "num_agent_steps_trained": 41160}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8549.154861376623, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114117399107055, "mean_inference_ms": 0.39335684273681587, "mean_action_processing_ms": 0.09458536379854882, "mean_env_wait_ms": 2.985861104682125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759145736694336, "StateBufferConnector_ms": 0.0026192665100097656, "ViewRequirementAgentConnector_ms": 0.0692286491394043}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8549.154861376623, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8657.115973817085, -8399.039170412749, -8475.58757921108, -8606.04344259521, -8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114117399107055, "mean_inference_ms": 0.39335684273681587, "mean_action_processing_ms": 0.09458536379854882, "mean_env_wait_ms": 2.985861104682125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759145736694336, "StateBufferConnector_ms": 0.0026192665100097656, "ViewRequirementAgentConnector_ms": 0.0692286491394043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41160, "num_agent_steps_trained": 41160, "num_env_steps_sampled": 41160, "num_env_steps_trained": 41160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.53045462667916, "num_env_steps_trained_throughput_per_sec": 38.53045462667916, "timesteps_total": 41160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 41160, "timers": {"training_iteration_time_ms": 3107.061, "sample_time_ms": 3103.32, "load_time_ms": 0.214, "load_throughput": 560486.058, "learn_time_ms": 2.759, "learn_throughput": 43498.097, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 41160, "num_env_steps_trained": 41160, "num_agent_steps_sampled": 41160, "num_agent_steps_trained": 41160}, "done": false, "episodes_total": 295, "training_iteration": 73, "trial_id": "668a1_00000", "date": "2023-07-25_18-03-06", "timestamp": 1690297386, "time_this_iter_s": 12.460529804229736, "time_total_s": 889.3760001659393, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 834.0123963356018, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 24.36111111111111, "ram_util_percent": 76.42777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -70660743168.0, "vf_loss": 576199360.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 274.0}}, "num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8549.354130598915, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11453212653548, "mean_inference_ms": 0.39331906501917785, "mean_action_processing_ms": 0.09457924852743883, "mean_env_wait_ms": 2.9835725144568155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037605762481689453, "StateBufferConnector_ms": 0.002623319625854492, "ViewRequirementAgentConnector_ms": 0.06926918029785156}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8549.354130598915, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8616.517159093783, -8529.325307940457, -8532.585132032591, -8559.556489415545, -8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11453212653548, "mean_inference_ms": 0.39331906501917785, "mean_action_processing_ms": 0.09457924852743883, "mean_env_wait_ms": 2.9835725144568155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037605762481689453, "StateBufferConnector_ms": 0.002623319625854492, "ViewRequirementAgentConnector_ms": 0.06926918029785156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640, "num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.87622125306479, "num_env_steps_trained_throughput_per_sec": 38.87622125306479, "timesteps_total": 41640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 41640, "timers": {"training_iteration_time_ms": 3092.039, "sample_time_ms": 3088.283, "load_time_ms": 0.215, "load_throughput": 558310.017, "learn_time_ms": 2.764, "learn_throughput": 43411.806, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640}, "done": false, "episodes_total": 299, "training_iteration": 74, "trial_id": "668a1_00000", "date": "2023-07-25_18-03-19", "timestamp": 1690297399, "time_this_iter_s": 12.34969711303711, "time_total_s": 901.7256972789764, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 846.3620934486389, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 25.366666666666667, "ram_util_percent": 76.42777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943725585938, "policy_loss": -82522447872.0, "vf_loss": 578443392.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 279.0, "diff_num_grad_updates_vs_sampler_policy": 278.0}}, "num_env_steps_sampled": 42120, "num_env_steps_trained": 42120, "num_agent_steps_sampled": 42120, "num_agent_steps_trained": 42120}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8549.439625686306, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114895069095418, "mean_inference_ms": 0.39327282758218984, "mean_action_processing_ms": 0.09457151573812819, "mean_env_wait_ms": 2.9813816433689793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003753185272216797, "StateBufferConnector_ms": 0.002625703811645508, "ViewRequirementAgentConnector_ms": 0.06919288635253906}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8549.439625686306, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8553.315363469017, -8516.234995609026, -8559.164470732196, -8645.127781075915, -8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114895069095418, "mean_inference_ms": 0.39327282758218984, "mean_action_processing_ms": 0.09457151573812819, "mean_env_wait_ms": 2.9813816433689793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003753185272216797, "StateBufferConnector_ms": 0.002625703811645508, "ViewRequirementAgentConnector_ms": 0.06919288635253906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42120, "num_agent_steps_trained": 42120, "num_env_steps_sampled": 42120, "num_env_steps_trained": 42120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.79676389467675, "num_env_steps_trained_throughput_per_sec": 38.79676389467675, "timesteps_total": 42120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 42120, "timers": {"training_iteration_time_ms": 3082.04, "sample_time_ms": 3078.273, "load_time_ms": 0.217, "load_throughput": 553703.498, "learn_time_ms": 2.762, "learn_throughput": 43448.157, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 42120, "num_env_steps_trained": 42120, "num_agent_steps_sampled": 42120, "num_agent_steps_trained": 42120}, "done": false, "episodes_total": 303, "training_iteration": 75, "trial_id": "668a1_00000", "date": "2023-07-25_18-03-31", "timestamp": 1690297411, "time_this_iter_s": 12.374898195266724, "time_total_s": 914.1005954742432, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 858.7369916439056, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.999999999999996, "ram_util_percent": 76.36470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7948608398438, "policy_loss": -135000752128.0, "vf_loss": 548394688.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 283.0, "diff_num_grad_updates_vs_sampler_policy": 282.0}}, "num_env_steps_sampled": 42600, "num_env_steps_trained": 42600, "num_agent_steps_sampled": 42600, "num_agent_steps_trained": 42600}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8549.305715653198, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114841882106457, "mean_inference_ms": 0.393234956210269, "mean_action_processing_ms": 0.09456531044210965, "mean_env_wait_ms": 2.979375791316613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037581920623779297, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.06923532485961914}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8549.305715653198, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8629.12628496824, -8460.682533178144, -8433.934916062623, -8590.066687238628, -8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114841882106457, "mean_inference_ms": 0.393234956210269, "mean_action_processing_ms": 0.09456531044210965, "mean_env_wait_ms": 2.979375791316613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037581920623779297, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.06923532485961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42600, "num_agent_steps_trained": 42600, "num_env_steps_sampled": 42600, "num_env_steps_trained": 42600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.241936569431836, "num_env_steps_trained_throughput_per_sec": 39.241936569431836, "timesteps_total": 42600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 42600, "timers": {"training_iteration_time_ms": 3083.091, "sample_time_ms": 3079.314, "load_time_ms": 0.217, "load_throughput": 553459.952, "learn_time_ms": 2.771, "learn_throughput": 43306.099, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 42600, "num_env_steps_trained": 42600, "num_agent_steps_sampled": 42600, "num_agent_steps_trained": 42600}, "done": false, "episodes_total": 307, "training_iteration": 76, "trial_id": "668a1_00000", "date": "2023-07-25_18-03-43", "timestamp": 1690297423, "time_this_iter_s": 12.234515905380249, "time_total_s": 926.3351113796234, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 870.9715075492859, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 27.88823529411765, "ram_util_percent": 76.42352941176469}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7946166992188, "policy_loss": -66547036160.0, "vf_loss": 566679232.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 287.0, "diff_num_grad_updates_vs_sampler_policy": 286.0}}, "num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8553.479286510576, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114844561830843, "mean_inference_ms": 0.3931952625958043, "mean_action_processing_ms": 0.09455864029068227, "mean_env_wait_ms": 2.9773637749677615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037763118743896484, "StateBufferConnector_ms": 0.0026290416717529297, "ViewRequirementAgentConnector_ms": 0.0693199634552002}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8553.479286510576, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8541.563723190902, -8493.384255165412, -8525.2958891375, -8396.845241807137, -8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114844561830843, "mean_inference_ms": 0.3931952625958043, "mean_action_processing_ms": 0.09455864029068227, "mean_env_wait_ms": 2.9773637749677615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037763118743896484, "StateBufferConnector_ms": 0.0026290416717529297, "ViewRequirementAgentConnector_ms": 0.0693199634552002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080, "num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.672579697203155, "num_env_steps_trained_throughput_per_sec": 38.672579697203155, "timesteps_total": 43080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 43080, "timers": {"training_iteration_time_ms": 3090.872, "sample_time_ms": 3087.116, "load_time_ms": 0.217, "load_throughput": 552852.021, "learn_time_ms": 2.762, "learn_throughput": 43452.658, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080}, "done": false, "episodes_total": 311, "training_iteration": 77, "trial_id": "668a1_00000", "date": "2023-07-25_18-03-56", "timestamp": 1690297436, "time_this_iter_s": 12.41480278968811, "time_total_s": 938.7499141693115, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 883.386310338974, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.983333333333334, "ram_util_percent": 76.3111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -68140888064.0, "vf_loss": 559767808.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 291.0, "diff_num_grad_updates_vs_sampler_policy": 290.0}}, "num_env_steps_sampled": 43560, "num_env_steps_trained": 43560, "num_agent_steps_sampled": 43560, "num_agent_steps_trained": 43560}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8556.84923616166, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115170655575813, "mean_inference_ms": 0.39315500151422667, "mean_action_processing_ms": 0.09455209817839341, "mean_env_wait_ms": 2.9752923859778924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037839412689208984, "StateBufferConnector_ms": 0.0026252269744873047, "ViewRequirementAgentConnector_ms": 0.06939101219177246}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8556.84923616166, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8519.487174263173, -8505.568351234908, -8657.025137603616, -8457.457713992007, -8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115170655575813, "mean_inference_ms": 0.39315500151422667, "mean_action_processing_ms": 0.09455209817839341, "mean_env_wait_ms": 2.9752923859778924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037839412689208984, "StateBufferConnector_ms": 0.0026252269744873047, "ViewRequirementAgentConnector_ms": 0.06939101219177246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43560, "num_agent_steps_trained": 43560, "num_env_steps_sampled": 43560, "num_env_steps_trained": 43560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.62778685550505, "num_env_steps_trained_throughput_per_sec": 38.62778685550505, "timesteps_total": 43560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 43560, "timers": {"training_iteration_time_ms": 3093.957, "sample_time_ms": 3090.21, "load_time_ms": 0.217, "load_throughput": 553764.419, "learn_time_ms": 2.761, "learn_throughput": 43455.659, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 43560, "num_env_steps_trained": 43560, "num_agent_steps_sampled": 43560, "num_agent_steps_trained": 43560}, "done": false, "episodes_total": 315, "training_iteration": 78, "trial_id": "668a1_00000", "date": "2023-07-25_18-04-08", "timestamp": 1690297448, "time_this_iter_s": 12.429098129272461, "time_total_s": 951.179012298584, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 895.8154084682465, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.477777777777778, "ram_util_percent": 76.47777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -55575117824.0, "vf_loss": 559003776.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 295.0, "diff_num_grad_updates_vs_sampler_policy": 294.0}}, "num_env_steps_sampled": 44040, "num_env_steps_trained": 44040, "num_agent_steps_sampled": 44040, "num_agent_steps_trained": 44040}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8559.71879323905, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115194813392346, "mean_inference_ms": 0.3931128350536721, "mean_action_processing_ms": 0.09454550073496269, "mean_env_wait_ms": 2.9733160709737287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037679672241210938, "StateBufferConnector_ms": 0.0026111602783203125, "ViewRequirementAgentConnector_ms": 0.0691535472869873}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8559.71879323905, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8581.583471142123, -8577.497986777336, -8561.512817150691, -8669.99424768372, -8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115194813392346, "mean_inference_ms": 0.3931128350536721, "mean_action_processing_ms": 0.09454550073496269, "mean_env_wait_ms": 2.9733160709737287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037679672241210938, "StateBufferConnector_ms": 0.0026111602783203125, "ViewRequirementAgentConnector_ms": 0.0691535472869873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44040, "num_agent_steps_trained": 44040, "num_env_steps_sampled": 44040, "num_env_steps_trained": 44040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.97138879052155, "num_env_steps_trained_throughput_per_sec": 38.97138879052155, "timesteps_total": 44040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 44040, "timers": {"training_iteration_time_ms": 3085.097, "sample_time_ms": 3081.341, "load_time_ms": 0.218, "load_throughput": 550433.596, "learn_time_ms": 2.77, "learn_throughput": 43317.281, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 44040, "num_env_steps_trained": 44040, "num_agent_steps_sampled": 44040, "num_agent_steps_trained": 44040}, "done": false, "episodes_total": 319, "training_iteration": 79, "trial_id": "668a1_00000", "date": "2023-07-25_18-04-21", "timestamp": 1690297461, "time_this_iter_s": 12.319496870040894, "time_total_s": 963.4985091686249, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 908.1349053382874, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 23.629411764705882, "ram_util_percent": 76.37647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947387695312, "policy_loss": -63483211776.0, "vf_loss": 557442752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 299.0, "diff_num_grad_updates_vs_sampler_policy": 298.0}}, "num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520}, "sampler_results": {"episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8555.929912838616, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114855485477637, "mean_inference_ms": 0.39306980860884094, "mean_action_processing_ms": 0.09453855574266364, "mean_env_wait_ms": 2.971452232582612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037717819213867188, "StateBufferConnector_ms": 0.0026078224182128906, "ViewRequirementAgentConnector_ms": 0.06920218467712402}}, "episode_reward_max": -8385.415174753778, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8555.929912838616, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8385.415174753778, -8491.80530745785, -8476.931216352157, -8499.998264854437, -8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114855485477637, "mean_inference_ms": 0.39306980860884094, "mean_action_processing_ms": 0.09453855574266364, "mean_env_wait_ms": 2.971452232582612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037717819213867188, "StateBufferConnector_ms": 0.0026078224182128906, "ViewRequirementAgentConnector_ms": 0.06920218467712402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520, "num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.18130948476591, "num_env_steps_trained_throughput_per_sec": 39.18130948476591, "timesteps_total": 44520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 44520, "timers": {"training_iteration_time_ms": 3077.095, "sample_time_ms": 3073.328, "load_time_ms": 0.22, "load_throughput": 545600.52, "learn_time_ms": 2.779, "learn_throughput": 43188.673, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520}, "done": false, "episodes_total": 323, "training_iteration": 80, "trial_id": "668a1_00000", "date": "2023-07-25_18-04-33", "timestamp": 1690297473, "time_this_iter_s": 12.253588199615479, "time_total_s": 975.7520973682404, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 920.3884935379028, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 25.011764705882353, "ram_util_percent": 76.56470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943725585938, "policy_loss": -63565799424.0, "vf_loss": 556125568.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 303.0, "diff_num_grad_updates_vs_sampler_policy": 302.0}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8560.051855804815, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114488018569556, "mean_inference_ms": 0.3930216752406045, "mean_action_processing_ms": 0.0945305432648897, "mean_env_wait_ms": 2.969716490554348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003746509552001953, "StateBufferConnector_ms": 0.0025873184204101562, "ViewRequirementAgentConnector_ms": 0.0688784122467041}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8560.051855804815, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8526.809315564708, -8453.291737611285, -8597.149485801247, -8448.75426933395, -8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114488018569556, "mean_inference_ms": 0.3930216752406045, "mean_action_processing_ms": 0.0945305432648897, "mean_env_wait_ms": 2.969716490554348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003746509552001953, "StateBufferConnector_ms": 0.0025873184204101562, "ViewRequirementAgentConnector_ms": 0.0688784122467041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000, "num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.10378656262536, "num_env_steps_trained_throughput_per_sec": 39.10378656262536, "timesteps_total": 45000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 3085.439, "sample_time_ms": 3081.683, "load_time_ms": 0.219, "load_throughput": 548693.426, "learn_time_ms": 2.771, "learn_throughput": 43304.609, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000}, "done": false, "episodes_total": 327, "training_iteration": 81, "trial_id": "668a1_00000", "date": "2023-07-25_18-04-45", "timestamp": 1690297485, "time_this_iter_s": 12.277667999267578, "time_total_s": 988.0297653675079, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 932.6661615371704, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 26.18333333333333, "ram_util_percent": 75.56111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -48564813824.0, "vf_loss": 548114368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 307.0, "diff_num_grad_updates_vs_sampler_policy": 306.0}}, "num_env_steps_sampled": 45480, "num_env_steps_trained": 45480, "num_agent_steps_sampled": 45480, "num_agent_steps_trained": 45480}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8560.36147054153, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114278646756652, "mean_inference_ms": 0.3929752411279421, "mean_action_processing_ms": 0.09452261280606698, "mean_env_wait_ms": 2.968005538394682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037479400634765625, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06889677047729492}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8560.36147054153, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8552.549969048943, -8596.725326093541, -8555.13372680428, -8462.732575827313, -8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114278646756652, "mean_inference_ms": 0.3929752411279421, "mean_action_processing_ms": 0.09452261280606698, "mean_env_wait_ms": 2.968005538394682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037479400634765625, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06889677047729492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45480, "num_agent_steps_trained": 45480, "num_env_steps_sampled": 45480, "num_env_steps_trained": 45480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.925926321929566, "num_env_steps_trained_throughput_per_sec": 38.925926321929566, "timesteps_total": 45480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 45480, "timers": {"training_iteration_time_ms": 3075.706, "sample_time_ms": 3071.966, "load_time_ms": 0.217, "load_throughput": 552730.595, "learn_time_ms": 2.75, "learn_throughput": 43633.852, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 45480, "num_env_steps_trained": 45480, "num_agent_steps_sampled": 45480, "num_agent_steps_trained": 45480}, "done": false, "episodes_total": 331, "training_iteration": 82, "trial_id": "668a1_00000", "date": "2023-07-25_18-04-58", "timestamp": 1690297498, "time_this_iter_s": 12.334120988845825, "time_total_s": 1000.3638863563538, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 945.0002825260162, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 23.235294117647058, "ram_util_percent": 75.98823529411766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -61894025216.0, "vf_loss": 556126464.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8560.261069756243, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11414654917192, "mean_inference_ms": 0.3929241379811769, "mean_action_processing_ms": 0.09451413347885065, "mean_env_wait_ms": 2.966428252681202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446022033691406, "StateBufferConnector_ms": 0.0025975704193115234, "ViewRequirementAgentConnector_ms": 0.06881546974182129}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8560.261069756243, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8613.789087334462, -8527.49106292692, -8506.995873731868, -8590.203998748912, -8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11414654917192, "mean_inference_ms": 0.3929241379811769, "mean_action_processing_ms": 0.09451413347885065, "mean_env_wait_ms": 2.966428252681202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446022033691406, "StateBufferConnector_ms": 0.0025975704193115234, "ViewRequirementAgentConnector_ms": 0.06881546974182129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960, "num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.08416446424231, "num_env_steps_trained_throughput_per_sec": 39.08416446424231, "timesteps_total": 45960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 45960, "timers": {"training_iteration_time_ms": 3059.172, "sample_time_ms": 3055.401, "load_time_ms": 0.224, "load_throughput": 535272.232, "learn_time_ms": 2.76, "learn_throughput": 43475.553, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960}, "done": false, "episodes_total": 335, "training_iteration": 83, "trial_id": "668a1_00000", "date": "2023-07-25_18-05-10", "timestamp": 1690297510, "time_this_iter_s": 12.283926963806152, "time_total_s": 1012.6478133201599, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 957.2842094898224, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 23.6, "ram_util_percent": 76.04444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7944946289062, "policy_loss": -82785435648.0, "vf_loss": 565955072.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 315.0, "diff_num_grad_updates_vs_sampler_policy": 314.0}}, "num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8559.689189025494, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11403951920306, "mean_inference_ms": 0.3928710991965132, "mean_action_processing_ms": 0.09450508964542893, "mean_env_wait_ms": 2.96502706942731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446022033691406, "StateBufferConnector_ms": 0.00260162353515625, "ViewRequirementAgentConnector_ms": 0.06865906715393066}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8559.689189025494, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8448.2702135377, -8465.003395815951, -8537.520264680463, -8578.817182303761, -8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11403951920306, "mean_inference_ms": 0.3928710991965132, "mean_action_processing_ms": 0.09450508964542893, "mean_env_wait_ms": 2.96502706942731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446022033691406, "StateBufferConnector_ms": 0.00260162353515625, "ViewRequirementAgentConnector_ms": 0.06865906715393066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440, "num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.33952560805539, "num_env_steps_trained_throughput_per_sec": 39.33952560805539, "timesteps_total": 46440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 46440, "timers": {"training_iteration_time_ms": 3047.862, "sample_time_ms": 3044.087, "load_time_ms": 0.225, "load_throughput": 534136.135, "learn_time_ms": 2.762, "learn_throughput": 43444.031, "synch_weights_time_ms": 0.747}, "counters": {"num_env_steps_sampled": 46440, "num_env_steps_trained": 46440, "num_agent_steps_sampled": 46440, "num_agent_steps_trained": 46440}, "done": false, "episodes_total": 339, "training_iteration": 84, "trial_id": "668a1_00000", "date": "2023-07-25_18-05-22", "timestamp": 1690297522, "time_this_iter_s": 12.204117059707642, "time_total_s": 1024.8519303798676, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 969.48832654953, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.2, "ram_util_percent": 76.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -56241647616.0, "vf_loss": 568319488.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 319.0, "diff_num_grad_updates_vs_sampler_policy": 318.0}}, "num_env_steps_sampled": 46920, "num_env_steps_trained": 46920, "num_agent_steps_sampled": 46920, "num_agent_steps_trained": 46920}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8560.853711214955, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11421985776049, "mean_inference_ms": 0.3928223110716877, "mean_action_processing_ms": 0.09449682021831958, "mean_env_wait_ms": 2.9636436916721345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037415027618408203, "StateBufferConnector_ms": 0.002603292465209961, "ViewRequirementAgentConnector_ms": 0.06866455078125}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8879.969105503784, "episode_reward_mean": -8560.853711214955, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8879.969105503784, -8527.948890825603, -8498.88961272374, -8576.028606878173, -8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11421985776049, "mean_inference_ms": 0.3928223110716877, "mean_action_processing_ms": 0.09449682021831958, "mean_env_wait_ms": 2.9636436916721345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037415027618408203, "StateBufferConnector_ms": 0.002603292465209961, "ViewRequirementAgentConnector_ms": 0.06866455078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46920, "num_agent_steps_trained": 46920, "num_env_steps_sampled": 46920, "num_env_steps_trained": 46920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.26481249803385, "num_env_steps_trained_throughput_per_sec": 39.26481249803385, "timesteps_total": 46920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 46920, "timers": {"training_iteration_time_ms": 3070.83, "sample_time_ms": 3067.066, "load_time_ms": 0.224, "load_throughput": 536699.168, "learn_time_ms": 2.755, "learn_throughput": 43561.721, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 46920, "num_env_steps_trained": 46920, "num_agent_steps_sampled": 46920, "num_agent_steps_trained": 46920}, "done": false, "episodes_total": 343, "training_iteration": 85, "trial_id": "668a1_00000", "date": "2023-07-25_18-05-34", "timestamp": 1690297534, "time_this_iter_s": 12.227508306503296, "time_total_s": 1037.0794386863708, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 981.7158348560333, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 26.21764705882353, "ram_util_percent": 76.32352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7953491210938, "policy_loss": -45103566848.0, "vf_loss": 545484544.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 322.0}}, "num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8557.86849854898, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114569054325493, "mean_inference_ms": 0.39277057546288807, "mean_action_processing_ms": 0.09448781478797208, "mean_env_wait_ms": 2.962369387472529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003730297088623047, "StateBufferConnector_ms": 0.0026056766510009766, "ViewRequirementAgentConnector_ms": 0.0686039924621582}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8557.86849854898, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8512.946361241253, -8495.796159041516, -8658.632801344906, -8514.434865891417, -8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.114569054325493, "mean_inference_ms": 0.39277057546288807, "mean_action_processing_ms": 0.09448781478797208, "mean_env_wait_ms": 2.962369387472529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003730297088623047, "StateBufferConnector_ms": 0.0026056766510009766, "ViewRequirementAgentConnector_ms": 0.0686039924621582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400, "num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.17562107681368, "num_env_steps_trained_throughput_per_sec": 39.17562107681368, "timesteps_total": 47400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 47400, "timers": {"training_iteration_time_ms": 3072.067, "sample_time_ms": 3068.326, "load_time_ms": 0.216, "load_throughput": 555046.846, "learn_time_ms": 2.755, "learn_throughput": 43564.737, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400}, "done": false, "episodes_total": 347, "training_iteration": 86, "trial_id": "668a1_00000", "date": "2023-07-25_18-05-47", "timestamp": 1690297547, "time_this_iter_s": 12.255208015441895, "time_total_s": 1049.3346467018127, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 993.9710428714752, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 30.866666666666667, "ram_util_percent": 76.51666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7940673828125, "policy_loss": -48761745408.0, "vf_loss": 568878400.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 327.0, "diff_num_grad_updates_vs_sampler_policy": 326.0}}, "num_env_steps_sampled": 47880, "num_env_steps_trained": 47880, "num_agent_steps_sampled": 47880, "num_agent_steps_trained": 47880}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8558.252204288588, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115305259457646, "mean_inference_ms": 0.39272043965849235, "mean_action_processing_ms": 0.09447942421476054, "mean_env_wait_ms": 2.961135635298117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037374496459960938, "StateBufferConnector_ms": 0.002605438232421875, "ViewRequirementAgentConnector_ms": 0.06869840621948242}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8558.252204288588, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8606.65244488383, -8754.325412623868, -8659.004499190825, -8709.924677423103, -8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.115305259457646, "mean_inference_ms": 0.39272043965849235, "mean_action_processing_ms": 0.09447942421476054, "mean_env_wait_ms": 2.961135635298117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037374496459960938, "StateBufferConnector_ms": 0.002605438232421875, "ViewRequirementAgentConnector_ms": 0.06869840621948242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47880, "num_agent_steps_trained": 47880, "num_env_steps_sampled": 47880, "num_env_steps_trained": 47880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.786089103710225, "num_env_steps_trained_throughput_per_sec": 38.786089103710225, "timesteps_total": 47880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 47880, "timers": {"training_iteration_time_ms": 3065.735, "sample_time_ms": 3061.98, "load_time_ms": 0.216, "load_throughput": 555843.711, "learn_time_ms": 2.762, "learn_throughput": 43447.781, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 47880, "num_env_steps_trained": 47880, "num_agent_steps_sampled": 47880, "num_agent_steps_trained": 47880}, "done": false, "episodes_total": 351, "training_iteration": 87, "trial_id": "668a1_00000", "date": "2023-07-25_18-05-59", "timestamp": 1690297559, "time_this_iter_s": 12.378366947174072, "time_total_s": 1061.7130136489868, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1006.3494098186493, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 23.86470588235294, "ram_util_percent": 76.33529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7946166992188, "policy_loss": -60818972672.0, "vf_loss": 560743296.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 331.0, "diff_num_grad_updates_vs_sampler_policy": 330.0}}, "num_env_steps_sampled": 48360, "num_env_steps_trained": 48360, "num_agent_steps_sampled": 48360, "num_agent_steps_trained": 48360}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8552.513440029126, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.116248177051435, "mean_inference_ms": 0.3926727691750733, "mean_action_processing_ms": 0.09447107209941119, "mean_env_wait_ms": 2.9600195203804867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037381649017333984, "StateBufferConnector_ms": 0.0026061534881591797, "ViewRequirementAgentConnector_ms": 0.06875443458557129}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8552.513440029126, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8480.01648488619, -8580.525049047857, -8661.264205799569, -8485.957034154182, -8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.116248177051435, "mean_inference_ms": 0.3926727691750733, "mean_action_processing_ms": 0.09447107209941119, "mean_env_wait_ms": 2.9600195203804867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037381649017333984, "StateBufferConnector_ms": 0.0026061534881591797, "ViewRequirementAgentConnector_ms": 0.06875443458557129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48360, "num_agent_steps_trained": 48360, "num_env_steps_sampled": 48360, "num_env_steps_trained": 48360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.57152545963024, "num_env_steps_trained_throughput_per_sec": 38.57152545963024, "timesteps_total": 48360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 48360, "timers": {"training_iteration_time_ms": 3072.315, "sample_time_ms": 3068.546, "load_time_ms": 0.215, "load_throughput": 556889.223, "learn_time_ms": 2.776, "learn_throughput": 43222.795, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 48360, "num_env_steps_trained": 48360, "num_agent_steps_sampled": 48360, "num_agent_steps_trained": 48360}, "done": false, "episodes_total": 355, "training_iteration": 88, "trial_id": "668a1_00000", "date": "2023-07-25_18-06-11", "timestamp": 1690297571, "time_this_iter_s": 12.447103023529053, "time_total_s": 1074.1601166725159, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1018.7965128421783, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 24.105555555555558, "ram_util_percent": 76.57222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7941284179688, "policy_loss": -40068919296.0, "vf_loss": 571391872.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 335.0, "diff_num_grad_updates_vs_sampler_policy": 334.0}}, "num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8552.115211626546, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.116992177839055, "mean_inference_ms": 0.39262445752440045, "mean_action_processing_ms": 0.09446247702476934, "mean_env_wait_ms": 2.958999695917007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446022033691406, "StateBufferConnector_ms": 0.002626180648803711, "ViewRequirementAgentConnector_ms": 0.06883835792541504}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8552.115211626546, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8620.051892791664, -8567.783368266213, -8454.587901756156, -8564.877239675556, -8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.116992177839055, "mean_inference_ms": 0.39262445752440045, "mean_action_processing_ms": 0.09446247702476934, "mean_env_wait_ms": 2.958999695917007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446022033691406, "StateBufferConnector_ms": 0.002626180648803711, "ViewRequirementAgentConnector_ms": 0.06883835792541504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840, "num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.72795255187005, "num_env_steps_trained_throughput_per_sec": 39.72795255187005, "timesteps_total": 48840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 48840, "timers": {"training_iteration_time_ms": 3081.386, "sample_time_ms": 3077.617, "load_time_ms": 0.216, "load_throughput": 556335.227, "learn_time_ms": 2.778, "learn_throughput": 43194.233, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840}, "done": false, "episodes_total": 359, "training_iteration": 89, "trial_id": "668a1_00000", "date": "2023-07-25_18-06-24", "timestamp": 1690297584, "time_this_iter_s": 12.084907054901123, "time_total_s": 1086.245023727417, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1030.8814198970795, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 26.605882352941176, "ram_util_percent": 76.54117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -50061529088.0, "vf_loss": 544442752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 339.0, "diff_num_grad_updates_vs_sampler_policy": 338.0}}, "num_env_steps_sampled": 49320, "num_env_steps_trained": 49320, "num_agent_steps_sampled": 49320, "num_agent_steps_trained": 49320}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8549.697603217752, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11792873390287, "mean_inference_ms": 0.3925801080996102, "mean_action_processing_ms": 0.09445447426851893, "mean_env_wait_ms": 2.9580236174486907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037550926208496094, "StateBufferConnector_ms": 0.002626657485961914, "ViewRequirementAgentConnector_ms": 0.06888580322265625}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8549.697603217752, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8398.492115946337, -8549.730693625082, -8646.731522125505, -8458.616925460772, -8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11792873390287, "mean_inference_ms": 0.3925801080996102, "mean_action_processing_ms": 0.09445447426851893, "mean_env_wait_ms": 2.9580236174486907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037550926208496094, "StateBufferConnector_ms": 0.002626657485961914, "ViewRequirementAgentConnector_ms": 0.06888580322265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49320, "num_agent_steps_trained": 49320, "num_env_steps_sampled": 49320, "num_env_steps_trained": 49320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.45538861601521, "num_env_steps_trained_throughput_per_sec": 38.45538861601521, "timesteps_total": 49320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 49320, "timers": {"training_iteration_time_ms": 3090.498, "sample_time_ms": 3086.706, "load_time_ms": 0.221, "load_throughput": 541841.404, "learn_time_ms": 2.801, "learn_throughput": 42837.633, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 49320, "num_env_steps_trained": 49320, "num_agent_steps_sampled": 49320, "num_agent_steps_trained": 49320}, "done": false, "episodes_total": 363, "training_iteration": 90, "trial_id": "668a1_00000", "date": "2023-07-25_18-06-36", "timestamp": 1690297596, "time_this_iter_s": 12.484768152236938, "time_total_s": 1098.729791879654, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1043.3661880493164, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 26.783333333333335, "ram_util_percent": 76.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -55327137792.0, "vf_loss": 546897344.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.0, "diff_num_grad_updates_vs_sampler_policy": 342.0}}, "num_env_steps_sampled": 49800, "num_env_steps_trained": 49800, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49800}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8551.805563155292, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.119046201357655, "mean_inference_ms": 0.3925378139501646, "mean_action_processing_ms": 0.09444694127113831, "mean_env_wait_ms": 2.9571441223757087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003765583038330078, "StateBufferConnector_ms": 0.0026369094848632812, "ViewRequirementAgentConnector_ms": 0.0689549446105957}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8551.805563155292, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8533.328280694568, -8754.99806681123, -8432.163991109366, -8484.172284147244, -8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.119046201357655, "mean_inference_ms": 0.3925378139501646, "mean_action_processing_ms": 0.09444694127113831, "mean_env_wait_ms": 2.9571441223757087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003765583038330078, "StateBufferConnector_ms": 0.0026369094848632812, "ViewRequirementAgentConnector_ms": 0.0689549446105957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49800, "num_env_steps_sampled": 49800, "num_env_steps_trained": 49800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.6976443224753, "num_env_steps_trained_throughput_per_sec": 38.6976443224753, "timesteps_total": 49800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 49800, "timers": {"training_iteration_time_ms": 3090.002, "sample_time_ms": 3086.228, "load_time_ms": 0.222, "load_throughput": 541258.716, "learn_time_ms": 2.794, "learn_throughput": 42946.924, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 49800, "num_env_steps_trained": 49800, "num_agent_steps_sampled": 49800, "num_agent_steps_trained": 49800}, "done": false, "episodes_total": 367, "training_iteration": 91, "trial_id": "668a1_00000", "date": "2023-07-25_18-06-49", "timestamp": 1690297609, "time_this_iter_s": 12.406689167022705, "time_total_s": 1111.1364810466766, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1055.772877216339, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.258823529411764, "ram_util_percent": 76.36470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -63757848576.0, "vf_loss": 565453312.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 346.0}}, "num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280}, "sampler_results": {"episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8550.981874297891, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.120371071426028, "mean_inference_ms": 0.39250004907694774, "mean_action_processing_ms": 0.09444017151272653, "mean_env_wait_ms": 2.956323999342601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037708282470703125, "StateBufferConnector_ms": 0.0026390552520751953, "ViewRequirementAgentConnector_ms": 0.0690617561340332}}, "episode_reward_max": -8390.915468217887, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8550.981874297891, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8525.633075769825, -8469.146100213839, -8521.107150474476, -8500.370597710378, -8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.120371071426028, "mean_inference_ms": 0.39250004907694774, "mean_action_processing_ms": 0.09444017151272653, "mean_env_wait_ms": 2.956323999342601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037708282470703125, "StateBufferConnector_ms": 0.0026390552520751953, "ViewRequirementAgentConnector_ms": 0.0690617561340332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280, "num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.86490848030713, "num_env_steps_trained_throughput_per_sec": 38.86490848030713, "timesteps_total": 50280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 50280, "timers": {"training_iteration_time_ms": 3087.453, "sample_time_ms": 3083.718, "load_time_ms": 0.217, "load_throughput": 554069.221, "learn_time_ms": 2.764, "learn_throughput": 43412.181, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280}, "done": false, "episodes_total": 371, "training_iteration": 92, "trial_id": "668a1_00000", "date": "2023-07-25_18-07-01", "timestamp": 1690297621, "time_this_iter_s": 12.353263854980469, "time_total_s": 1123.489744901657, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1068.1261410713196, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.92222222222222, "ram_util_percent": 76.4388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -81545650176.0, "vf_loss": 577700608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 351.0, "diff_num_grad_updates_vs_sampler_policy": 350.0}}, "num_env_steps_sampled": 50760, "num_env_steps_trained": 50760, "num_agent_steps_sampled": 50760, "num_agent_steps_trained": 50760}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8552.332840678873, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.121567540558946, "mean_inference_ms": 0.39246487747940795, "mean_action_processing_ms": 0.0944337336015749, "mean_env_wait_ms": 2.95556295312715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003765106201171875, "StateBufferConnector_ms": 0.002637147903442383, "ViewRequirementAgentConnector_ms": 0.06911349296569824}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8552.332840678873, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8679.757667989745, -8511.77760208035, -8609.565934542215, -8482.975121484098, -8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.121567540558946, "mean_inference_ms": 0.39246487747940795, "mean_action_processing_ms": 0.0944337336015749, "mean_env_wait_ms": 2.95556295312715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003765106201171875, "StateBufferConnector_ms": 0.002637147903442383, "ViewRequirementAgentConnector_ms": 0.06911349296569824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50760, "num_agent_steps_trained": 50760, "num_env_steps_sampled": 50760, "num_env_steps_trained": 50760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.188168114539536, "num_env_steps_trained_throughput_per_sec": 39.188168114539536, "timesteps_total": 50760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 50760, "timers": {"training_iteration_time_ms": 3071.907, "sample_time_ms": 3068.162, "load_time_ms": 0.219, "load_throughput": 548992.67, "learn_time_ms": 2.771, "learn_throughput": 43304.609, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 50760, "num_env_steps_trained": 50760, "num_agent_steps_sampled": 50760, "num_agent_steps_trained": 50760}, "done": false, "episodes_total": 375, "training_iteration": 93, "trial_id": "668a1_00000", "date": "2023-07-25_18-07-13", "timestamp": 1690297633, "time_this_iter_s": 12.251214981079102, "time_total_s": 1135.7409598827362, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1080.3773560523987, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 25.052941176470586, "ram_util_percent": 76.37058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7948608398438, "policy_loss": -76695044096.0, "vf_loss": 577451264.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 355.0, "diff_num_grad_updates_vs_sampler_policy": 354.0}}, "num_env_steps_sampled": 51240, "num_env_steps_trained": 51240, "num_agent_steps_sampled": 51240, "num_agent_steps_trained": 51240}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8551.778552073301, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.122725692344083, "mean_inference_ms": 0.39243063730229766, "mean_action_processing_ms": 0.09442732856847343, "mean_env_wait_ms": 2.9548085532047548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00376129150390625, "StateBufferConnector_ms": 0.002640247344970703, "ViewRequirementAgentConnector_ms": 0.0690453052520752}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8551.778552073301, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8558.440930806204, -8609.146578392625, -8599.114283382303, -8521.076203623732, -8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.122725692344083, "mean_inference_ms": 0.39243063730229766, "mean_action_processing_ms": 0.09442732856847343, "mean_env_wait_ms": 2.9548085532047548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00376129150390625, "StateBufferConnector_ms": 0.002640247344970703, "ViewRequirementAgentConnector_ms": 0.0690453052520752}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51240, "num_agent_steps_trained": 51240, "num_env_steps_sampled": 51240, "num_env_steps_trained": 51240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.975815999904285, "num_env_steps_trained_throughput_per_sec": 38.975815999904285, "timesteps_total": 51240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 51240, "timers": {"training_iteration_time_ms": 3086.855, "sample_time_ms": 3083.034, "load_time_ms": 0.218, "load_throughput": 550674.486, "learn_time_ms": 2.814, "learn_throughput": 42646.711, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 51240, "num_env_steps_trained": 51240, "num_agent_steps_sampled": 51240, "num_agent_steps_trained": 51240}, "done": false, "episodes_total": 379, "training_iteration": 94, "trial_id": "668a1_00000", "date": "2023-07-25_18-07-26", "timestamp": 1690297646, "time_this_iter_s": 12.318295001983643, "time_total_s": 1148.0592548847198, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1092.6956510543823, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 25.577777777777776, "ram_util_percent": 76.3777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7940063476562, "policy_loss": -52604989440.0, "vf_loss": 560424576.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 359.0, "diff_num_grad_updates_vs_sampler_policy": 358.0}}, "num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8552.952870199648, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.123956929246624, "mean_inference_ms": 0.3923985209619157, "mean_action_processing_ms": 0.09442131233277216, "mean_env_wait_ms": 2.9540793442978766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003772735595703125, "StateBufferConnector_ms": 0.0026366710662841797, "ViewRequirementAgentConnector_ms": 0.06913256645202637}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8847.910023348737, "episode_reward_mean": -8552.952870199648, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8518.519669285572, -8847.910023348737, -8561.30494300321, -8669.46897315517, -8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.123956929246624, "mean_inference_ms": 0.3923985209619157, "mean_action_processing_ms": 0.09442131233277216, "mean_env_wait_ms": 2.9540793442978766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003772735595703125, "StateBufferConnector_ms": 0.0026366710662841797, "ViewRequirementAgentConnector_ms": 0.06913256645202637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720, "num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.4768983146516, "num_env_steps_trained_throughput_per_sec": 38.4768983146516, "timesteps_total": 51720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 51720, "timers": {"training_iteration_time_ms": 3100.174, "sample_time_ms": 3096.345, "load_time_ms": 0.215, "load_throughput": 558557.852, "learn_time_ms": 2.824, "learn_throughput": 42489.741, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720}, "done": false, "episodes_total": 383, "training_iteration": 95, "trial_id": "668a1_00000", "date": "2023-07-25_18-07-38", "timestamp": 1690297658, "time_this_iter_s": 12.477769136428833, "time_total_s": 1160.5370240211487, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1105.1734201908112, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 23.11176470588235, "ram_util_percent": 76.4705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -44968624128.0, "vf_loss": 570693888.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 363.0, "diff_num_grad_updates_vs_sampler_policy": 362.0}}, "num_env_steps_sampled": 52200, "num_env_steps_trained": 52200, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 52200}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8549.014209713088, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.125364983138855, "mean_inference_ms": 0.39236814330082526, "mean_action_processing_ms": 0.09441554367040882, "mean_env_wait_ms": 2.953308670707849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.06961274147033691}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8549.014209713088, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8557.321808115295, -8481.904887060446, -8620.00895201877, -8480.843929332916, -8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.125364983138855, "mean_inference_ms": 0.39236814330082526, "mean_action_processing_ms": 0.09441554367040882, "mean_env_wait_ms": 2.953308670707849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.002649545669555664, "ViewRequirementAgentConnector_ms": 0.06961274147033691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 52200, "num_env_steps_sampled": 52200, "num_env_steps_trained": 52200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.00163047126363, "num_env_steps_trained_throughput_per_sec": 39.00163047126363, "timesteps_total": 52200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 52200, "timers": {"training_iteration_time_ms": 3081.054, "sample_time_ms": 3077.257, "load_time_ms": 0.214, "load_throughput": 560548.48, "learn_time_ms": 2.809, "learn_throughput": 42725.631, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 52200, "num_env_steps_trained": 52200, "num_agent_steps_sampled": 52200, "num_agent_steps_trained": 52200}, "done": false, "episodes_total": 387, "training_iteration": 96, "trial_id": "668a1_00000", "date": "2023-07-25_18-07-50", "timestamp": 1690297670, "time_this_iter_s": 12.309880018234253, "time_total_s": 1172.846904039383, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1117.4833002090454, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 25.388888888888886, "ram_util_percent": 76.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7944946289062, "policy_loss": -59614490624.0, "vf_loss": 548353728.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 367.0, "diff_num_grad_updates_vs_sampler_policy": 366.0}}, "num_env_steps_sampled": 52680, "num_env_steps_trained": 52680, "num_agent_steps_sampled": 52680, "num_agent_steps_trained": 52680}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8548.869202319414, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.12675203154072, "mean_inference_ms": 0.39233567152328247, "mean_action_processing_ms": 0.09440925143677995, "mean_env_wait_ms": 2.9525622984197826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037941932678222656, "StateBufferConnector_ms": 0.002644062042236328, "ViewRequirementAgentConnector_ms": 0.06955957412719727}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8548.869202319414, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8390.915468217887, -8483.185967879459, -8550.398005740324, -8531.71502558063, -8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.12675203154072, "mean_inference_ms": 0.39233567152328247, "mean_action_processing_ms": 0.09440925143677995, "mean_env_wait_ms": 2.9525622984197826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037941932678222656, "StateBufferConnector_ms": 0.002644062042236328, "ViewRequirementAgentConnector_ms": 0.06955957412719727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52680, "num_agent_steps_trained": 52680, "num_env_steps_sampled": 52680, "num_env_steps_trained": 52680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.69427139229489, "num_env_steps_trained_throughput_per_sec": 38.69427139229489, "timesteps_total": 52680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 52680, "timers": {"training_iteration_time_ms": 3081.675, "sample_time_ms": 3077.962, "load_time_ms": 0.215, "load_throughput": 558248.092, "learn_time_ms": 2.755, "learn_throughput": 43556.443, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 52680, "num_env_steps_trained": 52680, "num_agent_steps_sampled": 52680, "num_agent_steps_trained": 52680}, "done": false, "episodes_total": 391, "training_iteration": 97, "trial_id": "668a1_00000", "date": "2023-07-25_18-08-03", "timestamp": 1690297683, "time_this_iter_s": 12.407723188400269, "time_total_s": 1185.2546272277832, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1129.8910233974457, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 23.49411764705882, "ram_util_percent": 76.35882352941178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -60371128320.0, "vf_loss": 539746240.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 371.0, "diff_num_grad_updates_vs_sampler_policy": 370.0}}, "num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8549.990917163075, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.127861051439524, "mean_inference_ms": 0.3923106467783819, "mean_action_processing_ms": 0.09440454380914652, "mean_env_wait_ms": 2.9517844524353416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037925243377685547, "StateBufferConnector_ms": 0.0026433467864990234, "ViewRequirementAgentConnector_ms": 0.0695340633392334}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8549.990917163075, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8581.994947586676, -8462.453524441806, -8483.919292926304, -8629.345323310637, -8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.127861051439524, "mean_inference_ms": 0.3923106467783819, "mean_action_processing_ms": 0.09440454380914652, "mean_env_wait_ms": 2.9517844524353416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037925243377685547, "StateBufferConnector_ms": 0.0026433467864990234, "ViewRequirementAgentConnector_ms": 0.0695340633392334}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160, "num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.38748248804216, "num_env_steps_trained_throughput_per_sec": 39.38748248804216, "timesteps_total": 53160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 53160, "timers": {"training_iteration_time_ms": 3090.538, "sample_time_ms": 3086.832, "load_time_ms": 0.215, "load_throughput": 557012.483, "learn_time_ms": 2.749, "learn_throughput": 43648.231, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160}, "done": false, "episodes_total": 395, "training_iteration": 98, "trial_id": "668a1_00000", "date": "2023-07-25_18-08-15", "timestamp": 1690297695, "time_this_iter_s": 12.189440965652466, "time_total_s": 1197.4440681934357, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1142.0804643630981, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 27.155555555555555, "ram_util_percent": 76.63888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -59494199296.0, "vf_loss": 556919744.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 375.0, "diff_num_grad_updates_vs_sampler_policy": 374.0}}, "num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8550.030522257615, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.12898872491098, "mean_inference_ms": 0.39228628944803107, "mean_action_processing_ms": 0.09439975190841504, "mean_env_wait_ms": 2.950985580260154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037980079650878906, "StateBufferConnector_ms": 0.0026335716247558594, "ViewRequirementAgentConnector_ms": 0.0695641040802002}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8550.030522257615, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8597.88375385443, -8466.811811353673, -8495.5528984322, -8686.285133581134, -8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.12898872491098, "mean_inference_ms": 0.39228628944803107, "mean_action_processing_ms": 0.09439975190841504, "mean_env_wait_ms": 2.950985580260154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037980079650878906, "StateBufferConnector_ms": 0.0026335716247558594, "ViewRequirementAgentConnector_ms": 0.0695641040802002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640, "num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.82821023587809, "num_env_steps_trained_throughput_per_sec": 38.82821023587809, "timesteps_total": 53640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 53640, "timers": {"training_iteration_time_ms": 3081.454, "sample_time_ms": 3077.725, "load_time_ms": 0.215, "load_throughput": 558557.852, "learn_time_ms": 2.769, "learn_throughput": 43343.393, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 53640, "num_env_steps_trained": 53640, "num_agent_steps_sampled": 53640, "num_agent_steps_trained": 53640}, "done": false, "episodes_total": 399, "training_iteration": 99, "trial_id": "668a1_00000", "date": "2023-07-25_18-08-27", "timestamp": 1690297707, "time_this_iter_s": 12.365133047103882, "time_total_s": 1209.8092012405396, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1154.445597410202, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 24.13529411764706, "ram_util_percent": 76.39411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -56855666688.0, "vf_loss": 574261440.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 379.0, "diff_num_grad_updates_vs_sampler_policy": 378.0}}, "num_env_steps_sampled": 54120, "num_env_steps_trained": 54120, "num_agent_steps_sampled": 54120, "num_agent_steps_trained": 54120}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8551.574464567291, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.130083676964524, "mean_inference_ms": 0.39226614963658635, "mean_action_processing_ms": 0.09439578575657805, "mean_env_wait_ms": 2.9501894111776643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037996768951416016, "StateBufferConnector_ms": 0.002625703811645508, "ViewRequirementAgentConnector_ms": 0.06953573226928711}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8551.574464567291, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8478.864941838521, -8630.019221356732, -8657.050843782308, -8494.51660059797, -8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.130083676964524, "mean_inference_ms": 0.39226614963658635, "mean_action_processing_ms": 0.09439578575657805, "mean_env_wait_ms": 2.9501894111776643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037996768951416016, "StateBufferConnector_ms": 0.002625703811645508, "ViewRequirementAgentConnector_ms": 0.06953573226928711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54120, "num_agent_steps_trained": 54120, "num_env_steps_sampled": 54120, "num_env_steps_trained": 54120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.800250431882446, "num_env_steps_trained_throughput_per_sec": 38.800250431882446, "timesteps_total": 54120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 54120, "timers": {"training_iteration_time_ms": 3074.897, "sample_time_ms": 3071.147, "load_time_ms": 0.217, "load_throughput": 553520.818, "learn_time_ms": 2.773, "learn_throughput": 43281.521, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 54120, "num_env_steps_trained": 54120, "num_agent_steps_sampled": 54120, "num_agent_steps_trained": 54120}, "done": false, "episodes_total": 403, "training_iteration": 100, "trial_id": "668a1_00000", "date": "2023-07-25_18-08-40", "timestamp": 1690297720, "time_this_iter_s": 12.373901128768921, "time_total_s": 1222.1831023693085, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1166.819498538971, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 24.422222222222224, "ram_util_percent": 76.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943115234375, "policy_loss": -69630738432.0, "vf_loss": 576229888.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 382.0}}, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8550.72941326365, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.131331977982363, "mean_inference_ms": 0.3922424121799301, "mean_action_processing_ms": 0.09439119605650977, "mean_env_wait_ms": 2.949406156479345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037899017333984375, "StateBufferConnector_ms": 0.0026175975799560547, "ViewRequirementAgentConnector_ms": 0.06946611404418945}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8736.79329633866, "episode_reward_mean": -8550.72941326365, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8736.79329633866, -8579.548454537076, -8590.579558835248, -8624.246197474553, -8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.131331977982363, "mean_inference_ms": 0.3922424121799301, "mean_action_processing_ms": 0.09439119605650977, "mean_env_wait_ms": 2.949406156479345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037899017333984375, "StateBufferConnector_ms": 0.0026175975799560547, "ViewRequirementAgentConnector_ms": 0.06946611404418945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.7269328188583, "num_env_steps_trained_throughput_per_sec": 38.7269328188583, "timesteps_total": 54600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 54600, "timers": {"training_iteration_time_ms": 3078.244, "sample_time_ms": 3074.457, "load_time_ms": 0.217, "load_throughput": 554069.221, "learn_time_ms": 2.788, "learn_throughput": 43037.262, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600}, "done": false, "episodes_total": 407, "training_iteration": 101, "trial_id": "668a1_00000", "date": "2023-07-25_18-08-52", "timestamp": 1690297732, "time_this_iter_s": 12.397222995758057, "time_total_s": 1234.5803253650665, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1179.216721534729, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 23.935294117647057, "ram_util_percent": 76.45294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -61180805120.0, "vf_loss": 568156928.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 387.0, "diff_num_grad_updates_vs_sampler_policy": 386.0}}, "num_env_steps_sampled": 55080, "num_env_steps_trained": 55080, "num_agent_steps_sampled": 55080, "num_agent_steps_trained": 55080}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8720.34548087364, "episode_reward_mean": -8547.411600418352, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.132284727124134, "mean_inference_ms": 0.3922207823886268, "mean_action_processing_ms": 0.09438687492143777, "mean_env_wait_ms": 2.948668342109764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.0026051998138427734, "ViewRequirementAgentConnector_ms": 0.06937932968139648}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8720.34548087364, "episode_reward_mean": -8547.411600418352, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8612.30440704698, -8585.867961893273, -8538.479301839727, -8557.432403629347, -8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.132284727124134, "mean_inference_ms": 0.3922207823886268, "mean_action_processing_ms": 0.09438687492143777, "mean_env_wait_ms": 2.948668342109764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.0026051998138427734, "ViewRequirementAgentConnector_ms": 0.06937932968139648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55080, "num_agent_steps_trained": 55080, "num_env_steps_sampled": 55080, "num_env_steps_trained": 55080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.45839965130673, "num_env_steps_trained_throughput_per_sec": 39.45839965130673, "timesteps_total": 55080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 55080, "timers": {"training_iteration_time_ms": 3078.94, "sample_time_ms": 3075.161, "load_time_ms": 0.214, "load_throughput": 560673.365, "learn_time_ms": 2.779, "learn_throughput": 43178.299, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 55080, "num_env_steps_trained": 55080, "num_agent_steps_sampled": 55080, "num_agent_steps_trained": 55080}, "done": false, "episodes_total": 411, "training_iteration": 102, "trial_id": "668a1_00000", "date": "2023-07-25_18-09-04", "timestamp": 1690297744, "time_this_iter_s": 12.167133092880249, "time_total_s": 1246.7474584579468, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1191.3838546276093, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 26.499999999999996, "ram_util_percent": 76.34444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -44949118976.0, "vf_loss": 566981952.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 391.0, "diff_num_grad_updates_vs_sampler_policy": 390.0}}, "num_env_steps_sampled": 55560, "num_env_steps_trained": 55560, "num_agent_steps_sampled": 55560, "num_agent_steps_trained": 55560}, "sampler_results": {"episode_reward_max": -8366.426700100397, "episode_reward_min": -8720.34548087364, "episode_reward_mean": -8549.507360093501, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.133077199178913, "mean_inference_ms": 0.39220059160352533, "mean_action_processing_ms": 0.09438277075782288, "mean_env_wait_ms": 2.9479731319419717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037882328033447266, "StateBufferConnector_ms": 0.0026013851165771484, "ViewRequirementAgentConnector_ms": 0.06933093070983887}}, "episode_reward_max": -8366.426700100397, "episode_reward_min": -8720.34548087364, "episode_reward_mean": -8549.507360093501, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8641.871882611418, -8638.79699428343, -8608.749599529016, -8537.075608408759, -8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.133077199178913, "mean_inference_ms": 0.39220059160352533, "mean_action_processing_ms": 0.09438277075782288, "mean_env_wait_ms": 2.9479731319419717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037882328033447266, "StateBufferConnector_ms": 0.0026013851165771484, "ViewRequirementAgentConnector_ms": 0.06933093070983887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55560, "num_agent_steps_trained": 55560, "num_env_steps_sampled": 55560, "num_env_steps_trained": 55560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.92175348164487, "num_env_steps_trained_throughput_per_sec": 38.92175348164487, "timesteps_total": 55560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 55560, "timers": {"training_iteration_time_ms": 3083.308, "sample_time_ms": 3079.544, "load_time_ms": 0.214, "load_throughput": 560798.306, "learn_time_ms": 2.781, "learn_throughput": 43155.346, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 55560, "num_env_steps_trained": 55560, "num_agent_steps_sampled": 55560, "num_agent_steps_trained": 55560}, "done": false, "episodes_total": 415, "training_iteration": 103, "trial_id": "668a1_00000", "date": "2023-07-25_18-09-17", "timestamp": 1690297757, "time_this_iter_s": 12.33528995513916, "time_total_s": 1259.082748413086, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1203.7191445827484, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 23.888235294117646, "ram_util_percent": 75.99411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7939453125, "policy_loss": -47881969664.0, "vf_loss": 563059520.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 395.0, "diff_num_grad_updates_vs_sampler_policy": 394.0}}, "num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8720.34548087364, "episode_reward_mean": -8545.72657631103, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.133793922777258, "mean_inference_ms": 0.3921849128626442, "mean_action_processing_ms": 0.09437928436173572, "mean_env_wait_ms": 2.9473263936836465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037899017333984375, "StateBufferConnector_ms": 0.0026073455810546875, "ViewRequirementAgentConnector_ms": 0.06932282447814941}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8720.34548087364, "episode_reward_mean": -8545.72657631103, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8462.932754697356, -8580.406846006405, -8445.828701145183, -8522.532180861399, -8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.133793922777258, "mean_inference_ms": 0.3921849128626442, "mean_action_processing_ms": 0.09437928436173572, "mean_env_wait_ms": 2.9473263936836465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037899017333984375, "StateBufferConnector_ms": 0.0026073455810546875, "ViewRequirementAgentConnector_ms": 0.06932282447814941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040, "num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.04369960491172, "num_env_steps_trained_throughput_per_sec": 39.04369960491172, "timesteps_total": 56040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 56040, "timers": {"training_iteration_time_ms": 3075.698, "sample_time_ms": 3071.936, "load_time_ms": 0.214, "load_throughput": 559800.334, "learn_time_ms": 2.79, "learn_throughput": 43004.903, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040}, "done": false, "episodes_total": 419, "training_iteration": 104, "trial_id": "668a1_00000", "date": "2023-07-25_18-09-29", "timestamp": 1690297769, "time_this_iter_s": 12.296773672103882, "time_total_s": 1271.3795220851898, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1216.0159182548523, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 24.583333333333336, "ram_util_percent": 75.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -59857838080.0, "vf_loss": 546302528.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 399.0, "diff_num_grad_updates_vs_sampler_policy": 398.0}}, "num_env_steps_sampled": 56520, "num_env_steps_trained": 56520, "num_agent_steps_sampled": 56520, "num_agent_steps_trained": 56520}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8720.34548087364, "episode_reward_mean": -8546.482918389036, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13467974591653, "mean_inference_ms": 0.3921736531066899, "mean_action_processing_ms": 0.09437644690420882, "mean_env_wait_ms": 2.946597019396772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037889480590820312, "StateBufferConnector_ms": 0.002606630325317383, "ViewRequirementAgentConnector_ms": 0.06926131248474121}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8720.34548087364, "episode_reward_mean": -8546.482918389036, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8488.118787272007, -8614.968647378671, -8594.891142146944, -8568.365683240832, -8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13467974591653, "mean_inference_ms": 0.3921736531066899, "mean_action_processing_ms": 0.09437644690420882, "mean_env_wait_ms": 2.946597019396772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037889480590820312, "StateBufferConnector_ms": 0.002606630325317383, "ViewRequirementAgentConnector_ms": 0.06926131248474121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56520, "num_agent_steps_trained": 56520, "num_env_steps_sampled": 56520, "num_env_steps_trained": 56520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.894693515233165, "num_env_steps_trained_throughput_per_sec": 38.894693515233165, "timesteps_total": 56520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 56520, "timers": {"training_iteration_time_ms": 3067.409, "sample_time_ms": 3063.648, "load_time_ms": 0.215, "load_throughput": 557938.676, "learn_time_ms": 2.782, "learn_throughput": 43138.701, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 56520, "num_env_steps_trained": 56520, "num_agent_steps_sampled": 56520, "num_agent_steps_trained": 56520}, "done": false, "episodes_total": 423, "training_iteration": 105, "trial_id": "668a1_00000", "date": "2023-07-25_18-09-41", "timestamp": 1690297781, "time_this_iter_s": 12.343883991241455, "time_total_s": 1283.7234060764313, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1228.3598022460938, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 25.45294117647059, "ram_util_percent": 75.98235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7944946289062, "policy_loss": -54990651392.0, "vf_loss": 571885184.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 403.0, "diff_num_grad_updates_vs_sampler_policy": 402.0}}, "num_env_steps_sampled": 57000, "num_env_steps_trained": 57000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 57000}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8548.073145970473, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13557185139759, "mean_inference_ms": 0.39215534601310226, "mean_action_processing_ms": 0.09437244073423531, "mean_env_wait_ms": 2.945922442093539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003789186477661133, "StateBufferConnector_ms": 0.0026092529296875, "ViewRequirementAgentConnector_ms": 0.06925678253173828}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8548.073145970473, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8431.09683392314, -8523.474340688146, -8602.315771679163, -8500.079335691946, -8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13557185139759, "mean_inference_ms": 0.39215534601310226, "mean_action_processing_ms": 0.09437244073423531, "mean_env_wait_ms": 2.945922442093539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003789186477661133, "StateBufferConnector_ms": 0.0026092529296875, "ViewRequirementAgentConnector_ms": 0.06925678253173828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 57000, "num_env_steps_sampled": 57000, "num_env_steps_trained": 57000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.931079452594965, "num_env_steps_trained_throughput_per_sec": 38.931079452594965, "timesteps_total": 57000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 57000, "timers": {"training_iteration_time_ms": 3072.716, "sample_time_ms": 3068.941, "load_time_ms": 0.216, "load_throughput": 554679.832, "learn_time_ms": 2.792, "learn_throughput": 42974.793, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 57000, "num_env_steps_trained": 57000, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 57000}, "done": false, "episodes_total": 427, "training_iteration": 106, "trial_id": "668a1_00000", "date": "2023-07-25_18-09-54", "timestamp": 1690297794, "time_this_iter_s": 12.332146883010864, "time_total_s": 1296.0555529594421, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1240.6919491291046, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 25.622222222222224, "ram_util_percent": 76.3111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -33612462080.0, "vf_loss": 562202560.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 407.0, "diff_num_grad_updates_vs_sampler_policy": 406.0}}, "num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8548.868884607546, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13629284821419, "mean_inference_ms": 0.39213870780766086, "mean_action_processing_ms": 0.09436881688459142, "mean_env_wait_ms": 2.945218017909969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003786325454711914, "StateBufferConnector_ms": 0.002602815628051758, "ViewRequirementAgentConnector_ms": 0.0691976547241211}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8548.868884607546, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8470.402266347306, -8635.707833071852, -8502.109663163408, -8548.881756663015, -8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13629284821419, "mean_inference_ms": 0.39213870780766086, "mean_action_processing_ms": 0.09436881688459142, "mean_env_wait_ms": 2.945218017909969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003786325454711914, "StateBufferConnector_ms": 0.002602815628051758, "ViewRequirementAgentConnector_ms": 0.0691976547241211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480, "num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.674175564538906, "num_env_steps_trained_throughput_per_sec": 39.674175564538906, "timesteps_total": 57480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 57480, "timers": {"training_iteration_time_ms": 3065.144, "sample_time_ms": 3061.36, "load_time_ms": 0.216, "load_throughput": 554985.643, "learn_time_ms": 2.787, "learn_throughput": 43050.146, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480}, "done": false, "episodes_total": 431, "training_iteration": 107, "trial_id": "668a1_00000", "date": "2023-07-25_18-10-06", "timestamp": 1690297806, "time_this_iter_s": 12.101424932479858, "time_total_s": 1308.156977891922, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1252.7933740615845, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 25.882352941176467, "ram_util_percent": 75.17058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -38480277504.0, "vf_loss": 577060352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 411.0, "diff_num_grad_updates_vs_sampler_policy": 410.0}}, "num_env_steps_sampled": 57960, "num_env_steps_trained": 57960, "num_agent_steps_sampled": 57960, "num_agent_steps_trained": 57960}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8549.239704176458, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13704207255344, "mean_inference_ms": 0.3921243184981212, "mean_action_processing_ms": 0.0943655041409431, "mean_env_wait_ms": 2.9444727682196974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003786802291870117, "StateBufferConnector_ms": 0.002602100372314453, "ViewRequirementAgentConnector_ms": 0.06926655769348145}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8549.239704176458, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8465.006084715262, -8598.77904493635, -8526.872187585162, -8590.634632430469, -8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13704207255344, "mean_inference_ms": 0.3921243184981212, "mean_action_processing_ms": 0.0943655041409431, "mean_env_wait_ms": 2.9444727682196974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003786802291870117, "StateBufferConnector_ms": 0.002602100372314453, "ViewRequirementAgentConnector_ms": 0.06926655769348145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57960, "num_agent_steps_trained": 57960, "num_env_steps_sampled": 57960, "num_env_steps_trained": 57960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.14996867832812, "num_env_steps_trained_throughput_per_sec": 39.14996867832812, "timesteps_total": 57960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 57960, "timers": {"training_iteration_time_ms": 3059.295, "sample_time_ms": 3055.51, "load_time_ms": 0.216, "load_throughput": 554374.358, "learn_time_ms": 2.791, "learn_throughput": 43000.861, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 57960, "num_env_steps_trained": 57960, "num_agent_steps_sampled": 57960, "num_agent_steps_trained": 57960}, "done": false, "episodes_total": 435, "training_iteration": 108, "trial_id": "668a1_00000", "date": "2023-07-25_18-10-18", "timestamp": 1690297818, "time_this_iter_s": 12.2633957862854, "time_total_s": 1320.4203736782074, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1265.0567698478699, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 23.98235294117647, "ram_util_percent": 75.31764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794189453125, "policy_loss": -24446699520.0, "vf_loss": 575247488.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 415.0, "diff_num_grad_updates_vs_sampler_policy": 414.0}}, "num_env_steps_sampled": 58440, "num_env_steps_trained": 58440, "num_agent_steps_sampled": 58440, "num_agent_steps_trained": 58440}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8549.775551069211, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.138016786419886, "mean_inference_ms": 0.39211180248854843, "mean_action_processing_ms": 0.09436255767839333, "mean_env_wait_ms": 2.9437165423602414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037877559661865234, "StateBufferConnector_ms": 0.002599000930786133, "ViewRequirementAgentConnector_ms": 0.0692906379699707}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8549.775551069211, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8490.051292746773, -8435.615759377006, -8609.789903798506, -8610.606319361632, -8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.138016786419886, "mean_inference_ms": 0.39211180248854843, "mean_action_processing_ms": 0.09436255767839333, "mean_env_wait_ms": 2.9437165423602414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037877559661865234, "StateBufferConnector_ms": 0.002599000930786133, "ViewRequirementAgentConnector_ms": 0.0692906379699707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58440, "num_agent_steps_trained": 58440, "num_env_steps_sampled": 58440, "num_env_steps_trained": 58440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.593588486773896, "num_env_steps_trained_throughput_per_sec": 38.593588486773896, "timesteps_total": 58440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 58440, "timers": {"training_iteration_time_ms": 3062.298, "sample_time_ms": 3058.533, "load_time_ms": 0.218, "load_throughput": 550313.23, "learn_time_ms": 2.771, "learn_throughput": 43304.609, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 58440, "num_env_steps_trained": 58440, "num_agent_steps_sampled": 58440, "num_agent_steps_trained": 58440}, "done": false, "episodes_total": 439, "training_iteration": 109, "trial_id": "668a1_00000", "date": "2023-07-25_18-10-31", "timestamp": 1690297831, "time_this_iter_s": 12.440192699432373, "time_total_s": 1332.8605663776398, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1277.4969625473022, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 23.28333333333333, "ram_util_percent": 75.88888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7948608398438, "policy_loss": -66360647680.0, "vf_loss": 572361536.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 418.0}}, "num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8551.078325503691, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13895297710217, "mean_inference_ms": 0.3921005119737629, "mean_action_processing_ms": 0.09435964027107752, "mean_env_wait_ms": 2.9430510903329083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003787517547607422, "StateBufferConnector_ms": 0.002600431442260742, "ViewRequirementAgentConnector_ms": 0.06928539276123047}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8721.979052680646, "episode_reward_mean": -8551.078325503691, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8630.298636595193, -8575.783418940124, -8518.550569245015, -8459.68232455339, -8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13895297710217, "mean_inference_ms": 0.3921005119737629, "mean_action_processing_ms": 0.09435964027107752, "mean_env_wait_ms": 2.9430510903329083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003787517547607422, "StateBufferConnector_ms": 0.002600431442260742, "ViewRequirementAgentConnector_ms": 0.06928539276123047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920, "num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.123841208889445, "num_env_steps_trained_throughput_per_sec": 39.123841208889445, "timesteps_total": 58920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 58920, "timers": {"training_iteration_time_ms": 3065.588, "sample_time_ms": 3061.818, "load_time_ms": 0.218, "load_throughput": 551519.264, "learn_time_ms": 2.785, "learn_throughput": 43084.418, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920}, "done": false, "episodes_total": 443, "training_iteration": 110, "trial_id": "668a1_00000", "date": "2023-07-25_18-10-43", "timestamp": 1690297843, "time_this_iter_s": 12.27158236503601, "time_total_s": 1345.1321487426758, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1289.7685449123383, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 24.455555555555552, "ram_util_percent": 75.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7940673828125, "policy_loss": -30575779840.0, "vf_loss": 596090368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 423.0, "diff_num_grad_updates_vs_sampler_policy": 422.0}}, "num_env_steps_sampled": 59400, "num_env_steps_trained": 59400, "num_agent_steps_sampled": 59400, "num_agent_steps_trained": 59400}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8745.844451672365, "episode_reward_mean": -8552.95457990242, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.139849379193805, "mean_inference_ms": 0.39208908915067753, "mean_action_processing_ms": 0.09435676444614531, "mean_env_wait_ms": 2.942398494861593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003789663314819336, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06923484802246094}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8745.844451672365, "episode_reward_mean": -8552.95457990242, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8495.059977579102, -8459.074314544676, -8595.728446654206, -8670.318022702035, -8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.139849379193805, "mean_inference_ms": 0.39208908915067753, "mean_action_processing_ms": 0.09435676444614531, "mean_env_wait_ms": 2.942398494861593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003789663314819336, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06923484802246094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59400, "num_agent_steps_trained": 59400, "num_env_steps_sampled": 59400, "num_env_steps_trained": 59400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.32938214786211, "num_env_steps_trained_throughput_per_sec": 39.32938214786211, "timesteps_total": 59400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 59400, "timers": {"training_iteration_time_ms": 3072.834, "sample_time_ms": 3069.078, "load_time_ms": 0.218, "load_throughput": 550915.587, "learn_time_ms": 2.777, "learn_throughput": 43217.599, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 59400, "num_env_steps_trained": 59400, "num_agent_steps_sampled": 59400, "num_agent_steps_trained": 59400}, "done": false, "episodes_total": 447, "training_iteration": 111, "trial_id": "668a1_00000", "date": "2023-07-25_18-10-55", "timestamp": 1690297855, "time_this_iter_s": 12.207329988479614, "time_total_s": 1357.3394787311554, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1301.9758749008179, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 26.811764705882354, "ram_util_percent": 75.88235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952270507812, "policy_loss": -54404853760.0, "vf_loss": 549778944.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 427.0, "diff_num_grad_updates_vs_sampler_policy": 426.0}}, "num_env_steps_sampled": 59880, "num_env_steps_trained": 59880, "num_agent_steps_sampled": 59880, "num_agent_steps_trained": 59880}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8745.844451672365, "episode_reward_mean": -8553.593798995344, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.14070795564704, "mean_inference_ms": 0.3920781099736173, "mean_action_processing_ms": 0.09435395930427826, "mean_env_wait_ms": 2.9417567920273964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037789344787597656, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06909728050231934}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8745.844451672365, "episode_reward_mean": -8553.593798995344, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8449.888906148139, -8550.26673275803, -8570.454909470136, -8585.42005979906, -8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.14070795564704, "mean_inference_ms": 0.3920781099736173, "mean_action_processing_ms": 0.09435395930427826, "mean_env_wait_ms": 2.9417567920273964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037789344787597656, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06909728050231934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59880, "num_agent_steps_trained": 59880, "num_env_steps_sampled": 59880, "num_env_steps_trained": 59880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.81546229211527, "num_env_steps_trained_throughput_per_sec": 38.81546229211527, "timesteps_total": 59880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 59880, "timers": {"training_iteration_time_ms": 3085.624, "sample_time_ms": 3081.857, "load_time_ms": 0.214, "load_throughput": 560486.058, "learn_time_ms": 2.783, "learn_throughput": 43119.114, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 59880, "num_env_steps_trained": 59880, "num_agent_steps_sampled": 59880, "num_agent_steps_trained": 59880}, "done": false, "episodes_total": 451, "training_iteration": 112, "trial_id": "668a1_00000", "date": "2023-07-25_18-11-08", "timestamp": 1690297868, "time_this_iter_s": 12.36893081665039, "time_total_s": 1369.7084095478058, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1314.3448057174683, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 25.42222222222222, "ram_util_percent": 75.9222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952270507812, "policy_loss": -58910785536.0, "vf_loss": 571224896.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 431.0, "diff_num_grad_updates_vs_sampler_policy": 430.0}}, "num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8745.844451672365, "episode_reward_mean": -8554.603449644674, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.141531160880994, "mean_inference_ms": 0.3920687494066462, "mean_action_processing_ms": 0.09435156934267738, "mean_env_wait_ms": 2.9411181939520987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003771066665649414, "StateBufferConnector_ms": 0.002590179443359375, "ViewRequirementAgentConnector_ms": 0.06901049613952637}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8745.844451672365, "episode_reward_mean": -8554.603449644674, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8512.982646993149, -8491.810987657404, -8442.80081810568, -8720.34548087364, -8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.141531160880994, "mean_inference_ms": 0.3920687494066462, "mean_action_processing_ms": 0.09435156934267738, "mean_env_wait_ms": 2.9411181939520987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003771066665649414, "StateBufferConnector_ms": 0.002590179443359375, "ViewRequirementAgentConnector_ms": 0.06901049613952637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360, "num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.553250287617516, "num_env_steps_trained_throughput_per_sec": 38.553250287617516, "timesteps_total": 60360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 60360, "timers": {"training_iteration_time_ms": 3095.16, "sample_time_ms": 3091.365, "load_time_ms": 0.216, "load_throughput": 556581.312, "learn_time_ms": 2.79, "learn_throughput": 43006.373, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360}, "done": false, "episodes_total": 455, "training_iteration": 113, "trial_id": "668a1_00000", "date": "2023-07-25_18-11-20", "timestamp": 1690297880, "time_this_iter_s": 12.453185081481934, "time_total_s": 1382.1615946292877, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1326.7979907989502, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 24.21764705882353, "ram_util_percent": 75.72941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794189453125, "policy_loss": -52517888000.0, "vf_loss": 565833216.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 435.0, "diff_num_grad_updates_vs_sampler_policy": 434.0}}, "num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8745.844451672365, "episode_reward_mean": -8555.390126559772, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.142604860973144, "mean_inference_ms": 0.3920624127350236, "mean_action_processing_ms": 0.0943496405820541, "mean_env_wait_ms": 2.940539513291577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037593841552734375, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.06882882118225098}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8745.844451672365, "episode_reward_mean": -8555.390126559772, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8475.574831263973, -8485.193256848319, -8534.068644470912, -8470.702829026817, -8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.142604860973144, "mean_inference_ms": 0.3920624127350236, "mean_action_processing_ms": 0.0943496405820541, "mean_env_wait_ms": 2.940539513291577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037593841552734375, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.06882882118225098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840, "num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.627823912391925, "num_env_steps_trained_throughput_per_sec": 38.627823912391925, "timesteps_total": 60840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 60840, "timers": {"training_iteration_time_ms": 3090.284, "sample_time_ms": 3086.525, "load_time_ms": 0.214, "load_throughput": 560985.823, "learn_time_ms": 2.754, "learn_throughput": 43566.623, "synch_weights_time_ms": 0.751}, "counters": {"num_env_steps_sampled": 60840, "num_env_steps_trained": 60840, "num_agent_steps_sampled": 60840, "num_agent_steps_trained": 60840}, "done": false, "episodes_total": 459, "training_iteration": 114, "trial_id": "668a1_00000", "date": "2023-07-25_18-11-33", "timestamp": 1690297893, "time_this_iter_s": 12.429301977157593, "time_total_s": 1394.5908966064453, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1339.2272927761078, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 21.583333333333332, "ram_util_percent": 75.8777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -31075858432.0, "vf_loss": 540103936.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 439.0, "diff_num_grad_updates_vs_sampler_policy": 438.0}}, "num_env_steps_sampled": 61320, "num_env_steps_trained": 61320, "num_agent_steps_sampled": 61320, "num_agent_steps_trained": 61320}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.40224549175, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.143452328655435, "mean_inference_ms": 0.39205466031671976, "mean_action_processing_ms": 0.09434761276719726, "mean_env_wait_ms": 2.9399305714471096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037522315979003906, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.06878256797790527}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.40224549175, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8587.964567059971, -8575.86346399014, -8637.687416370172, -8462.851803491416, -8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.143452328655435, "mean_inference_ms": 0.39205466031671976, "mean_action_processing_ms": 0.09434761276719726, "mean_env_wait_ms": 2.9399305714471096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037522315979003906, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.06878256797790527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61320, "num_agent_steps_trained": 61320, "num_env_steps_sampled": 61320, "num_env_steps_trained": 61320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.34708107748606, "num_env_steps_trained_throughput_per_sec": 39.34708107748606, "timesteps_total": 61320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 61320, "timers": {"training_iteration_time_ms": 3083.623, "sample_time_ms": 3079.893, "load_time_ms": 0.213, "load_throughput": 563119.803, "learn_time_ms": 2.74, "learn_throughput": 43798.642, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 61320, "num_env_steps_trained": 61320, "num_agent_steps_sampled": 61320, "num_agent_steps_trained": 61320}, "done": false, "episodes_total": 463, "training_iteration": 115, "trial_id": "668a1_00000", "date": "2023-07-25_18-11-45", "timestamp": 1690297905, "time_this_iter_s": 12.20182490348816, "time_total_s": 1406.7927215099335, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1351.429117679596, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 27.088235294117652, "ram_util_percent": 76.02941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -48255635456.0, "vf_loss": 559783872.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 442.0}}, "num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800}, "sampler_results": {"episode_reward_max": -8366.354662673797, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.339907206793, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.144210176716207, "mean_inference_ms": 0.3920495312671137, "mean_action_processing_ms": 0.09434595247200797, "mean_env_wait_ms": 2.9393404782235213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037412643432617188, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06871747970581055}}, "episode_reward_max": -8366.354662673797, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.339907206793, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8558.511652003814, -8620.429871540415, -8404.979732308813, -8538.372481169356, -8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.144210176716207, "mean_inference_ms": 0.3920495312671137, "mean_action_processing_ms": 0.09434595247200797, "mean_env_wait_ms": 2.9393404782235213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037412643432617188, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06871747970581055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800, "num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.88288862051072, "num_env_steps_trained_throughput_per_sec": 38.88288862051072, "timesteps_total": 61800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 61800, "timers": {"training_iteration_time_ms": 3090.244, "sample_time_ms": 3086.506, "load_time_ms": 0.214, "load_throughput": 560111.818, "learn_time_ms": 2.772, "learn_throughput": 43285.988, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800}, "done": false, "episodes_total": 467, "training_iteration": 116, "trial_id": "668a1_00000", "date": "2023-07-25_18-11-57", "timestamp": 1690297917, "time_this_iter_s": 12.347500085830688, "time_total_s": 1419.1402215957642, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1363.7766177654266, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 25.666666666666668, "ram_util_percent": 76.09444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952270507812, "policy_loss": -50942636032.0, "vf_loss": 529648384.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 447.0, "diff_num_grad_updates_vs_sampler_policy": 446.0}}, "num_env_steps_sampled": 62280, "num_env_steps_trained": 62280, "num_agent_steps_sampled": 62280, "num_agent_steps_trained": 62280}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.066240997385, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.14500965924649, "mean_inference_ms": 0.39204204168481793, "mean_action_processing_ms": 0.09434380461513854, "mean_env_wait_ms": 2.9387594629109834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037305355072021484, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06863117218017578}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.066240997385, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8564.429740660087, -8563.050554110685, -8366.426700100397, -8657.446567395578, -8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.14500965924649, "mean_inference_ms": 0.39204204168481793, "mean_action_processing_ms": 0.09434380461513854, "mean_env_wait_ms": 2.9387594629109834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037305355072021484, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06863117218017578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62280, "num_agent_steps_trained": 62280, "num_env_steps_sampled": 62280, "num_env_steps_trained": 62280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.6207132570197, "num_env_steps_trained_throughput_per_sec": 38.6207132570197, "timesteps_total": 62280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 62280, "timers": {"training_iteration_time_ms": 3095.321, "sample_time_ms": 3091.587, "load_time_ms": 0.216, "load_throughput": 556519.77, "learn_time_ms": 2.761, "learn_throughput": 43470.296, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 62280, "num_env_steps_trained": 62280, "num_agent_steps_sampled": 62280, "num_agent_steps_trained": 62280}, "done": false, "episodes_total": 471, "training_iteration": 117, "trial_id": "668a1_00000", "date": "2023-07-25_18-12-10", "timestamp": 1690297930, "time_this_iter_s": 12.43133020401001, "time_total_s": 1431.5715517997742, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1376.2079479694366, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 24.18888888888889, "ram_util_percent": 75.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -11536253952.0, "vf_loss": 573607424.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 451.0, "diff_num_grad_updates_vs_sampler_policy": 450.0}}, "num_env_steps_sampled": 62760, "num_env_steps_trained": 62760, "num_agent_steps_sampled": 62760, "num_agent_steps_trained": 62760}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.907514910756, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.146009720710417, "mean_inference_ms": 0.3920325307516515, "mean_action_processing_ms": 0.09434142935444212, "mean_env_wait_ms": 2.9381639269711872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037412643432617188, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06862163543701172}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.907514910756, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8466.625814507013, -8544.252775951354, -8539.423881735298, -8678.344993345498, -8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.146009720710417, "mean_inference_ms": 0.3920325307516515, "mean_action_processing_ms": 0.09434142935444212, "mean_env_wait_ms": 2.9381639269711872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037412643432617188, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06862163543701172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62760, "num_agent_steps_trained": 62760, "num_env_steps_sampled": 62760, "num_env_steps_trained": 62760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.453644171422916, "num_env_steps_trained_throughput_per_sec": 38.453644171422916, "timesteps_total": 62760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 62760, "timers": {"training_iteration_time_ms": 3102.082, "sample_time_ms": 3098.378, "load_time_ms": 0.216, "load_throughput": 554618.711, "learn_time_ms": 2.725, "learn_throughput": 44038.155, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 62760, "num_env_steps_trained": 62760, "num_agent_steps_sampled": 62760, "num_agent_steps_trained": 62760}, "done": false, "episodes_total": 475, "training_iteration": 118, "trial_id": "668a1_00000", "date": "2023-07-25_18-12-22", "timestamp": 1690297942, "time_this_iter_s": 12.485942125320435, "time_total_s": 1444.0574939250946, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1388.693890094757, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 23.970588235294116, "ram_util_percent": 76.04117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943115234375, "policy_loss": -90931445760.0, "vf_loss": 562325184.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 454.0}}, "num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8560.391499562533, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.14690586586067, "mean_inference_ms": 0.3920247767739252, "mean_action_processing_ms": 0.0943394551217282, "mean_env_wait_ms": 2.937663967860706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06871914863586426}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8560.391499562533, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8664.377862917458, -8512.412970083296, -8675.514693394784, -8552.904282443931, -8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.14690586586067, "mean_inference_ms": 0.3920247767739252, "mean_action_processing_ms": 0.0943394551217282, "mean_env_wait_ms": 2.937663967860706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06871914863586426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240, "num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.98333429891315, "num_env_steps_trained_throughput_per_sec": 38.98333429891315, "timesteps_total": 63240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 63240, "timers": {"training_iteration_time_ms": 3090.37, "sample_time_ms": 3086.616, "load_time_ms": 0.217, "load_throughput": 553459.952, "learn_time_ms": 2.772, "learn_throughput": 43282.265, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240}, "done": false, "episodes_total": 479, "training_iteration": 119, "trial_id": "668a1_00000", "date": "2023-07-25_18-12-34", "timestamp": 1690297954, "time_this_iter_s": 12.315711259841919, "time_total_s": 1456.3732051849365, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1401.009601354599, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 25.177777777777777, "ram_util_percent": 75.68888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -68301111296.0, "vf_loss": 578311744.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 459.0, "diff_num_grad_updates_vs_sampler_policy": 458.0}}, "num_env_steps_sampled": 63720, "num_env_steps_trained": 63720, "num_agent_steps_sampled": 63720, "num_agent_steps_trained": 63720}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.08173112665, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.14755538911204, "mean_inference_ms": 0.3920180146579608, "mean_action_processing_ms": 0.09433777109161572, "mean_env_wait_ms": 2.937104863331797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737926483154297, "StateBufferConnector_ms": 0.002586841583251953, "ViewRequirementAgentConnector_ms": 0.06865501403808594}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.08173112665, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8503.83806218434, -8519.398956756258, -8559.415091522274, -8620.685449673923, -8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.14755538911204, "mean_inference_ms": 0.3920180146579608, "mean_action_processing_ms": 0.09433777109161572, "mean_env_wait_ms": 2.937104863331797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737926483154297, "StateBufferConnector_ms": 0.002586841583251953, "ViewRequirementAgentConnector_ms": 0.06865501403808594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63720, "num_agent_steps_trained": 63720, "num_env_steps_sampled": 63720, "num_env_steps_trained": 63720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.64678962795014, "num_env_steps_trained_throughput_per_sec": 39.64678962795014, "timesteps_total": 63720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 63720, "timers": {"training_iteration_time_ms": 3080.088, "sample_time_ms": 3076.303, "load_time_ms": 0.218, "load_throughput": 551338.022, "learn_time_ms": 2.8, "learn_throughput": 42857.33, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 63720, "num_env_steps_trained": 63720, "num_agent_steps_sampled": 63720, "num_agent_steps_trained": 63720}, "done": false, "episodes_total": 483, "training_iteration": 120, "trial_id": "668a1_00000", "date": "2023-07-25_18-12-47", "timestamp": 1690297967, "time_this_iter_s": 12.109515905380249, "time_total_s": 1468.4827210903168, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1413.1191172599792, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 26.44705882352941, "ram_util_percent": 75.7764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943725585938, "policy_loss": -17603893248.0, "vf_loss": 562310208.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 463.0, "diff_num_grad_updates_vs_sampler_policy": 462.0}}, "num_env_steps_sampled": 64200, "num_env_steps_trained": 64200, "num_agent_steps_sampled": 64200, "num_agent_steps_trained": 64200}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8558.903239184168, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.148197561281368, "mean_inference_ms": 0.3920092705423957, "mean_action_processing_ms": 0.0943356128547652, "mean_env_wait_ms": 2.9365806307458717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003717184066772461, "StateBufferConnector_ms": 0.002580404281616211, "ViewRequirementAgentConnector_ms": 0.06819844245910645}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8558.903239184168, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8532.133629127697, -8487.814858419044, -8607.313624609233, -8498.316725004112, -8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.148197561281368, "mean_inference_ms": 0.3920092705423957, "mean_action_processing_ms": 0.0943356128547652, "mean_env_wait_ms": 2.9365806307458717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003717184066772461, "StateBufferConnector_ms": 0.002580404281616211, "ViewRequirementAgentConnector_ms": 0.06819844245910645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64200, "num_agent_steps_trained": 64200, "num_env_steps_sampled": 64200, "num_env_steps_trained": 64200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.89274294104471, "num_env_steps_trained_throughput_per_sec": 38.89274294104471, "timesteps_total": 64200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 64200, "timers": {"training_iteration_time_ms": 3063.447, "sample_time_ms": 3059.738, "load_time_ms": 0.215, "load_throughput": 558124.285, "learn_time_ms": 2.747, "learn_throughput": 43684.22, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 64200, "num_env_steps_trained": 64200, "num_agent_steps_sampled": 64200, "num_agent_steps_trained": 64200}, "done": false, "episodes_total": 487, "training_iteration": 121, "trial_id": "668a1_00000", "date": "2023-07-25_18-12-59", "timestamp": 1690297979, "time_this_iter_s": 12.34431505203247, "time_total_s": 1480.8270361423492, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1425.4634323120117, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 24.177777777777777, "ram_util_percent": 75.10555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -37025419264.0, "vf_loss": 536910400.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 467.0, "diff_num_grad_updates_vs_sampler_policy": 466.0}}, "num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.891929134035, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.148677931476662, "mean_inference_ms": 0.39200183752799667, "mean_action_processing_ms": 0.09433377883702293, "mean_env_wait_ms": 2.936093758643017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003717184066772461, "StateBufferConnector_ms": 0.0025856494903564453, "ViewRequirementAgentConnector_ms": 0.06828927993774414}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8559.891929134035, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8441.398739056152, -8719.239402584608, -8496.58091204384, -8411.16689809955, -8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.148677931476662, "mean_inference_ms": 0.39200183752799667, "mean_action_processing_ms": 0.09433377883702293, "mean_env_wait_ms": 2.936093758643017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003717184066772461, "StateBufferConnector_ms": 0.0025856494903564453, "ViewRequirementAgentConnector_ms": 0.06828927993774414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680, "num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.14761332602415, "num_env_steps_trained_throughput_per_sec": 39.14761332602415, "timesteps_total": 64680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 64680, "timers": {"training_iteration_time_ms": 3064.151, "sample_time_ms": 3060.419, "load_time_ms": 0.217, "load_throughput": 554191.235, "learn_time_ms": 2.757, "learn_throughput": 43524.804, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680}, "done": false, "episodes_total": 491, "training_iteration": 122, "trial_id": "668a1_00000", "date": "2023-07-25_18-13-11", "timestamp": 1690297991, "time_this_iter_s": 12.2640061378479, "time_total_s": 1493.0910422801971, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1437.7274384498596, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 24.823529411764707, "ram_util_percent": 73.46470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947387695312, "policy_loss": -26333376512.0, "vf_loss": 561370432.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 471.0, "diff_num_grad_updates_vs_sampler_policy": 470.0}}, "num_env_steps_sampled": 65160, "num_env_steps_trained": 65160, "num_agent_steps_sampled": 65160, "num_agent_steps_trained": 65160}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8558.745285971123, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.149211471421367, "mean_inference_ms": 0.39198668611276744, "mean_action_processing_ms": 0.09433063636387243, "mean_env_wait_ms": 2.935622830993071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003720521926879883, "StateBufferConnector_ms": 0.002592325210571289, "ViewRequirementAgentConnector_ms": 0.06835436820983887}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8558.745285971123, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8620.839281356753, -8563.649298569917, -8410.018910555975, -8567.166107237088, -8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.149211471421367, "mean_inference_ms": 0.39198668611276744, "mean_action_processing_ms": 0.09433063636387243, "mean_env_wait_ms": 2.935622830993071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003720521926879883, "StateBufferConnector_ms": 0.002592325210571289, "ViewRequirementAgentConnector_ms": 0.06835436820983887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65160, "num_agent_steps_trained": 65160, "num_env_steps_sampled": 65160, "num_env_steps_trained": 65160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.223071949692624, "num_env_steps_trained_throughput_per_sec": 39.223071949692624, "timesteps_total": 65160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 65160, "timers": {"training_iteration_time_ms": 3058.67, "sample_time_ms": 3054.913, "load_time_ms": 0.217, "load_throughput": 553459.952, "learn_time_ms": 2.77, "learn_throughput": 43322.501, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 65160, "num_env_steps_trained": 65160, "num_agent_steps_sampled": 65160, "num_agent_steps_trained": 65160}, "done": false, "episodes_total": 495, "training_iteration": 123, "trial_id": "668a1_00000", "date": "2023-07-25_18-13-24", "timestamp": 1690298004, "time_this_iter_s": 12.240317821502686, "time_total_s": 1505.3313601016998, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1449.9677562713623, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 24.322222222222223, "ram_util_percent": 74.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -24452573184.0, "vf_loss": 550952768.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 475.0, "diff_num_grad_updates_vs_sampler_policy": 474.0}}, "num_env_steps_sampled": 65640, "num_env_steps_trained": 65640, "num_agent_steps_sampled": 65640, "num_agent_steps_trained": 65640}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8555.124058870355, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.149569468399086, "mean_inference_ms": 0.3919732512116139, "mean_action_processing_ms": 0.0943278023410772, "mean_env_wait_ms": 2.9351549881987116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.002599954605102539, "ViewRequirementAgentConnector_ms": 0.06828641891479492}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8555.124058870355, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8434.729576671101, -8661.66300687987, -8635.016229138564, -8669.51901549936, -8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.149569468399086, "mean_inference_ms": 0.3919732512116139, "mean_action_processing_ms": 0.0943278023410772, "mean_env_wait_ms": 2.9351549881987116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.002599954605102539, "ViewRequirementAgentConnector_ms": 0.06828641891479492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65640, "num_agent_steps_trained": 65640, "num_env_steps_sampled": 65640, "num_env_steps_trained": 65640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.55659631310092, "num_env_steps_trained_throughput_per_sec": 39.55659631310092, "timesteps_total": 65640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 65640, "timers": {"training_iteration_time_ms": 3049.091, "sample_time_ms": 3045.37, "load_time_ms": 0.216, "load_throughput": 555230.535, "learn_time_ms": 2.738, "learn_throughput": 43826.483, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 65640, "num_env_steps_trained": 65640, "num_agent_steps_sampled": 65640, "num_agent_steps_trained": 65640}, "done": false, "episodes_total": 499, "training_iteration": 124, "trial_id": "668a1_00000", "date": "2023-07-25_18-13-36", "timestamp": 1690298016, "time_this_iter_s": 12.137217998504639, "time_total_s": 1517.4685781002045, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1462.104974269867, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 27.276470588235295, "ram_util_percent": 74.50588235294119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7937622070312, "policy_loss": -30356680704.0, "vf_loss": 590456256.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 479.0, "diff_num_grad_updates_vs_sampler_policy": 478.0}}, "num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8554.540298351641, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.149740170646936, "mean_inference_ms": 0.3919566137023618, "mean_action_processing_ms": 0.09432426741705552, "mean_env_wait_ms": 2.9346465644466737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.0026025772094726562, "ViewRequirementAgentConnector_ms": 0.06827425956726074}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8554.540298351641, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8618.687499164167, -8388.801121606873, -8485.007590242358, -8683.45026619811, -8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.149740170646936, "mean_inference_ms": 0.3919566137023618, "mean_action_processing_ms": 0.09432426741705552, "mean_env_wait_ms": 2.9346465644466737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.0026025772094726562, "ViewRequirementAgentConnector_ms": 0.06827425956726074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120, "num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.82825428933998, "num_env_steps_trained_throughput_per_sec": 39.82825428933998, "timesteps_total": 66120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 66120, "timers": {"training_iteration_time_ms": 3045.477, "sample_time_ms": 3041.745, "load_time_ms": 0.219, "load_throughput": 547202.087, "learn_time_ms": 2.749, "learn_throughput": 43654.288, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120}, "done": false, "episodes_total": 503, "training_iteration": 125, "trial_id": "668a1_00000", "date": "2023-07-25_18-13-48", "timestamp": 1690298028, "time_this_iter_s": 12.05449914932251, "time_total_s": 1529.523077249527, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1474.1594734191895, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 28.31764705882353, "ram_util_percent": 75.10588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7946166992188, "policy_loss": -19347277824.0, "vf_loss": 599231232.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 483.0, "diff_num_grad_updates_vs_sampler_policy": 482.0}}, "num_env_steps_sampled": 66600, "num_env_steps_trained": 66600, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66600}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8554.36491465698, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.149858603731946, "mean_inference_ms": 0.39194009749995123, "mean_action_processing_ms": 0.09432079843912422, "mean_env_wait_ms": 2.9341268773496028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037217140197753906, "StateBufferConnector_ms": 0.002604246139526367, "ViewRequirementAgentConnector_ms": 0.06827521324157715}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8554.36491465698, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8572.061452015812, -8527.786322258724, -8508.633434726384, -8590.905013654698, -8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.149858603731946, "mean_inference_ms": 0.39194009749995123, "mean_action_processing_ms": 0.09432079843912422, "mean_env_wait_ms": 2.9341268773496028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037217140197753906, "StateBufferConnector_ms": 0.002604246139526367, "ViewRequirementAgentConnector_ms": 0.06827521324157715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66600, "num_env_steps_sampled": 66600, "num_env_steps_trained": 66600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.96232852090533, "num_env_steps_trained_throughput_per_sec": 38.96232852090533, "timesteps_total": 66600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 66600, "timers": {"training_iteration_time_ms": 3048.287, "sample_time_ms": 3044.544, "load_time_ms": 0.221, "load_throughput": 543069.141, "learn_time_ms": 2.746, "learn_throughput": 43703.186, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 66600, "num_env_steps_trained": 66600, "num_agent_steps_sampled": 66600, "num_agent_steps_trained": 66600}, "done": false, "episodes_total": 507, "training_iteration": 126, "trial_id": "668a1_00000", "date": "2023-07-25_18-14-00", "timestamp": 1690298040, "time_this_iter_s": 12.322394132614136, "time_total_s": 1541.845471382141, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1486.4818675518036, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 23.84444444444445, "ram_util_percent": 75.15000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7938842773438, "policy_loss": -35924000768.0, "vf_loss": 574013120.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 487.0, "diff_num_grad_updates_vs_sampler_policy": 486.0}}, "num_env_steps_sampled": 67080, "num_env_steps_trained": 67080, "num_agent_steps_sampled": 67080, "num_agent_steps_trained": 67080}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8553.679217654619, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.150074961842503, "mean_inference_ms": 0.39192422525596826, "mean_action_processing_ms": 0.09431755881692012, "mean_env_wait_ms": 2.9336298764184017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037031173706054688, "StateBufferConnector_ms": 0.002608060836791992, "ViewRequirementAgentConnector_ms": 0.0682373046875}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8553.679217654619, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8577.78196164158, -8652.002808218813, -8697.537288812857, -8576.337983251096, -8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.150074961842503, "mean_inference_ms": 0.39192422525596826, "mean_action_processing_ms": 0.09431755881692012, "mean_env_wait_ms": 2.9336298764184017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037031173706054688, "StateBufferConnector_ms": 0.002608060836791992, "ViewRequirementAgentConnector_ms": 0.0682373046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67080, "num_agent_steps_trained": 67080, "num_env_steps_sampled": 67080, "num_env_steps_trained": 67080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.02177330863586, "num_env_steps_trained_throughput_per_sec": 39.02177330863586, "timesteps_total": 67080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 67080, "timers": {"training_iteration_time_ms": 3058.277, "sample_time_ms": 3054.534, "load_time_ms": 0.221, "load_throughput": 542016.455, "learn_time_ms": 2.764, "learn_throughput": 43415.551, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 67080, "num_env_steps_trained": 67080, "num_agent_steps_sampled": 67080, "num_agent_steps_trained": 67080}, "done": false, "episodes_total": 511, "training_iteration": 127, "trial_id": "668a1_00000", "date": "2023-07-25_18-14-12", "timestamp": 1690298052, "time_this_iter_s": 12.303708791732788, "time_total_s": 1554.149180173874, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1498.7855763435364, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 24.647058823529413, "ram_util_percent": 75.12941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -15940083712.0, "vf_loss": 556156416.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 490.0}}, "num_env_steps_sampled": 67560, "num_env_steps_trained": 67560, "num_agent_steps_sampled": 67560, "num_agent_steps_trained": 67560}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8548.059878326587, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.150299883776515, "mean_inference_ms": 0.39191221158344447, "mean_action_processing_ms": 0.09431496921940465, "mean_env_wait_ms": 2.933160862673394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699064254760742, "StateBufferConnector_ms": 0.0026166439056396484, "ViewRequirementAgentConnector_ms": 0.06822037696838379}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8548.059878326587, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8366.354662673797, -8511.047781626085, -8545.902654741743, -8625.110607543786, -8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.150299883776515, "mean_inference_ms": 0.39191221158344447, "mean_action_processing_ms": 0.09431496921940465, "mean_env_wait_ms": 2.933160862673394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699064254760742, "StateBufferConnector_ms": 0.0026166439056396484, "ViewRequirementAgentConnector_ms": 0.06822037696838379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67560, "num_agent_steps_trained": 67560, "num_env_steps_sampled": 67560, "num_env_steps_trained": 67560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.720171375575404, "num_env_steps_trained_throughput_per_sec": 38.720171375575404, "timesteps_total": 67560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 67560, "timers": {"training_iteration_time_ms": 3067.157, "sample_time_ms": 3063.385, "load_time_ms": 0.219, "load_throughput": 547083.13, "learn_time_ms": 2.783, "learn_throughput": 43120.222, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 67560, "num_env_steps_trained": 67560, "num_agent_steps_sampled": 67560, "num_agent_steps_trained": 67560}, "done": false, "episodes_total": 515, "training_iteration": 128, "trial_id": "668a1_00000", "date": "2023-07-25_18-14-25", "timestamp": 1690298065, "time_this_iter_s": 12.39946985244751, "time_total_s": 1566.5486500263214, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1511.185046195984, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 21.988888888888887, "ram_util_percent": 75.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -18729615360.0, "vf_loss": 550745856.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 495.0, "diff_num_grad_updates_vs_sampler_policy": 494.0}}, "num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8548.035257944379, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15036563623289, "mean_inference_ms": 0.3919035685355952, "mean_action_processing_ms": 0.09431305295630706, "mean_env_wait_ms": 2.932704558268853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037043094635009766, "StateBufferConnector_ms": 0.002613067626953125, "ViewRequirementAgentConnector_ms": 0.06825757026672363}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8548.035257944379, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8523.173953599957, -8597.539618288534, -8518.229604488268, -8448.391514134273, -8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15036563623289, "mean_inference_ms": 0.3919035685355952, "mean_action_processing_ms": 0.09431305295630706, "mean_env_wait_ms": 2.932704558268853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037043094635009766, "StateBufferConnector_ms": 0.002613067626953125, "ViewRequirementAgentConnector_ms": 0.06825757026672363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040, "num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.74536790722299, "num_env_steps_trained_throughput_per_sec": 39.74536790722299, "timesteps_total": 68040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 68040, "timers": {"training_iteration_time_ms": 3071.839, "sample_time_ms": 3068.047, "load_time_ms": 0.219, "load_throughput": 547618.845, "learn_time_ms": 2.775, "learn_throughput": 43242.848, "synch_weights_time_ms": 0.756}, "counters": {"num_env_steps_sampled": 68040, "num_env_steps_trained": 68040, "num_agent_steps_sampled": 68040, "num_agent_steps_trained": 68040}, "done": false, "episodes_total": 519, "training_iteration": 129, "trial_id": "668a1_00000", "date": "2023-07-25_18-14-37", "timestamp": 1690298077, "time_this_iter_s": 12.079529047012329, "time_total_s": 1578.6281790733337, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1523.2645752429962, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 26.08823529411765, "ram_util_percent": 74.9470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943115234375, "policy_loss": -29137704960.0, "vf_loss": 586388480.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 499.0, "diff_num_grad_updates_vs_sampler_policy": 498.0}}, "num_env_steps_sampled": 68520, "num_env_steps_trained": 68520, "num_agent_steps_sampled": 68520, "num_agent_steps_trained": 68520}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8549.829367221282, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.150586664088923, "mean_inference_ms": 0.3918916254046756, "mean_action_processing_ms": 0.09431051693249913, "mean_env_wait_ms": 2.9322391005791895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.0026161670684814453, "ViewRequirementAgentConnector_ms": 0.06830334663391113}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8549.829367221282, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8502.872769945176, -8721.979052680646, -8549.591038001352, -8650.924157554957, -8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.150586664088923, "mean_inference_ms": 0.3918916254046756, "mean_action_processing_ms": 0.09431051693249913, "mean_env_wait_ms": 2.9322391005791895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.0026161670684814453, "ViewRequirementAgentConnector_ms": 0.06830334663391113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68520, "num_agent_steps_trained": 68520, "num_env_steps_sampled": 68520, "num_env_steps_trained": 68520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.2284942850823, "num_env_steps_trained_throughput_per_sec": 38.2284942850823, "timesteps_total": 68520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 68520, "timers": {"training_iteration_time_ms": 3099.312, "sample_time_ms": 3095.582, "load_time_ms": 0.218, "load_throughput": 551640.158, "learn_time_ms": 2.741, "learn_throughput": 43786.069, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 68520, "num_env_steps_trained": 68520, "num_agent_steps_sampled": 68520, "num_agent_steps_trained": 68520}, "done": false, "episodes_total": 523, "training_iteration": 130, "trial_id": "668a1_00000", "date": "2023-07-25_18-14-50", "timestamp": 1690298090, "time_this_iter_s": 12.558919906616211, "time_total_s": 1591.18709897995, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1535.8234951496124, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 24.33888888888889, "ram_util_percent": 75.03888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -18687199232.0, "vf_loss": 574920704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 502.0}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 69000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 69000}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8545.884596015072, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15092094554504, "mean_inference_ms": 0.39188078884303423, "mean_action_processing_ms": 0.0943080006338468, "mean_env_wait_ms": 2.9317364059043327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003713369369506836, "StateBufferConnector_ms": 0.002623319625854492, "ViewRequirementAgentConnector_ms": 0.06837272644042969}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8545.884596015072, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8368.433686256958, -8522.330858074805, -8684.23755085357, -8561.538050504256, -8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15092094554504, "mean_inference_ms": 0.39188078884303423, "mean_action_processing_ms": 0.0943080006338468, "mean_env_wait_ms": 2.9317364059043327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003713369369506836, "StateBufferConnector_ms": 0.002623319625854492, "ViewRequirementAgentConnector_ms": 0.06837272644042969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 69000, "num_env_steps_sampled": 69000, "num_env_steps_trained": 69000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.562297811709136, "num_env_steps_trained_throughput_per_sec": 38.562297811709136, "timesteps_total": 69000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 3098.465, "sample_time_ms": 3094.758, "load_time_ms": 0.217, "load_throughput": 554130.221, "learn_time_ms": 2.737, "learn_throughput": 43836.789, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 69000, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 69000}, "done": false, "episodes_total": 527, "training_iteration": 131, "trial_id": "668a1_00000", "date": "2023-07-25_18-15-02", "timestamp": 1690298102, "time_this_iter_s": 12.450130939483643, "time_total_s": 1603.6372299194336, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1548.273626089096, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 23.888235294117646, "ram_util_percent": 75.06470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -27768436736.0, "vf_loss": 559190336.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 507.0, "diff_num_grad_updates_vs_sampler_policy": 506.0}}, "num_env_steps_sampled": 69480, "num_env_steps_trained": 69480, "num_agent_steps_sampled": 69480, "num_agent_steps_trained": 69480}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8543.35901477786, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.151363384080415, "mean_inference_ms": 0.39187208375061033, "mean_action_processing_ms": 0.09430580597369634, "mean_env_wait_ms": 2.93132620900274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710031509399414, "StateBufferConnector_ms": 0.002629518508911133, "ViewRequirementAgentConnector_ms": 0.06840968132019043}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8543.35901477786, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8542.982581022818, -8463.307564304405, -8521.519451290269, -8666.37387951924, -8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.151363384080415, "mean_inference_ms": 0.39187208375061033, "mean_action_processing_ms": 0.09430580597369634, "mean_env_wait_ms": 2.93132620900274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710031509399414, "StateBufferConnector_ms": 0.002629518508911133, "ViewRequirementAgentConnector_ms": 0.06840968132019043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69480, "num_agent_steps_trained": 69480, "num_env_steps_sampled": 69480, "num_env_steps_trained": 69480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.85721229513731, "num_env_steps_trained_throughput_per_sec": 38.85721229513731, "timesteps_total": 69480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 69480, "timers": {"training_iteration_time_ms": 3099.252, "sample_time_ms": 3095.547, "load_time_ms": 0.216, "load_throughput": 554374.358, "learn_time_ms": 2.739, "learn_throughput": 43805.504, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 69480, "num_env_steps_trained": 69480, "num_agent_steps_sampled": 69480, "num_agent_steps_trained": 69480}, "done": false, "episodes_total": 531, "training_iteration": 132, "trial_id": "668a1_00000", "date": "2023-07-25_18-15-14", "timestamp": 1690298114, "time_this_iter_s": 12.355753183364868, "time_total_s": 1615.9929831027985, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1560.629379272461, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 24.233333333333334, "ram_util_percent": 75.1611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7940673828125, "policy_loss": -18935896064.0, "vf_loss": 557435904.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 511.0, "diff_num_grad_updates_vs_sampler_policy": 510.0}}, "num_env_steps_sampled": 69960, "num_env_steps_trained": 69960, "num_agent_steps_sampled": 69960, "num_agent_steps_trained": 69960}, "sampler_results": {"episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8549.025771372417, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15174555744971, "mean_inference_ms": 0.39186326583052306, "mean_action_processing_ms": 0.09430372524027529, "mean_env_wait_ms": 2.930932978721105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037059783935546875, "StateBufferConnector_ms": 0.0026242733001708984, "ViewRequirementAgentConnector_ms": 0.06830477714538574}}, "episode_reward_max": -8341.5698337186, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8549.025771372417, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8575.905888325482, -8485.831631895428, -8499.959814833823, -8673.179303887873, -8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15174555744971, "mean_inference_ms": 0.39186326583052306, "mean_action_processing_ms": 0.09430372524027529, "mean_env_wait_ms": 2.930932978721105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037059783935546875, "StateBufferConnector_ms": 0.0026242733001708984, "ViewRequirementAgentConnector_ms": 0.06830477714538574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69960, "num_agent_steps_trained": 69960, "num_env_steps_sampled": 69960, "num_env_steps_trained": 69960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.40544354715985, "num_env_steps_trained_throughput_per_sec": 39.40544354715985, "timesteps_total": 69960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 69960, "timers": {"training_iteration_time_ms": 3075.468, "sample_time_ms": 3071.759, "load_time_ms": 0.217, "load_throughput": 554252.263, "learn_time_ms": 2.739, "learn_throughput": 43818.471, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 69960, "num_env_steps_trained": 69960, "num_agent_steps_sampled": 69960, "num_agent_steps_trained": 69960}, "done": false, "episodes_total": 535, "training_iteration": 133, "trial_id": "668a1_00000", "date": "2023-07-25_18-15-27", "timestamp": 1690298127, "time_this_iter_s": 12.183823108673096, "time_total_s": 1628.1768062114716, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1572.813202381134, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 24.988235294117644, "ram_util_percent": 75.08823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -9542804480.0, "vf_loss": 530310240.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 515.0, "diff_num_grad_updates_vs_sampler_policy": 514.0}}, "num_env_steps_sampled": 70440, "num_env_steps_trained": 70440, "num_agent_steps_sampled": 70440, "num_agent_steps_trained": 70440}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8546.874091103522, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.152048029643566, "mean_inference_ms": 0.39185769958220734, "mean_action_processing_ms": 0.09430214507397654, "mean_env_wait_ms": 2.930492651701966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.0026280879974365234, "ViewRequirementAgentConnector_ms": 0.06826066970825195}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8546.874091103522, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8633.805109653198, -8574.50838428388, -8428.595766728164, -8639.431458066741, -8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.152048029643566, "mean_inference_ms": 0.39185769958220734, "mean_action_processing_ms": 0.09430214507397654, "mean_env_wait_ms": 2.930492651701966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.0026280879974365234, "ViewRequirementAgentConnector_ms": 0.06826066970825195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70440, "num_agent_steps_trained": 70440, "num_env_steps_sampled": 70440, "num_env_steps_trained": 70440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.09400038009185, "num_env_steps_trained_throughput_per_sec": 39.09400038009185, "timesteps_total": 70440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 70440, "timers": {"training_iteration_time_ms": 3082.457, "sample_time_ms": 3078.743, "load_time_ms": 0.217, "load_throughput": 552669.902, "learn_time_ms": 2.74, "learn_throughput": 43794.45, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 70440, "num_env_steps_trained": 70440, "num_agent_steps_sampled": 70440, "num_agent_steps_trained": 70440}, "done": false, "episodes_total": 539, "training_iteration": 134, "trial_id": "668a1_00000", "date": "2023-07-25_18-15-39", "timestamp": 1690298139, "time_this_iter_s": 12.280816793441772, "time_total_s": 1640.4576230049133, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1585.0940191745758, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 26.458823529411767, "ram_util_percent": 75.18823529411763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -16869328896.0, "vf_loss": 567743040.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 519.0, "diff_num_grad_updates_vs_sampler_policy": 518.0}}, "num_env_steps_sampled": 70920, "num_env_steps_trained": 70920, "num_agent_steps_sampled": 70920, "num_agent_steps_trained": 70920}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8543.80450773494, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.152338737118054, "mean_inference_ms": 0.3918546388185926, "mean_action_processing_ms": 0.09430090711956435, "mean_env_wait_ms": 2.9300821824684538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037078857421875, "StateBufferConnector_ms": 0.0026254653930664062, "ViewRequirementAgentConnector_ms": 0.06825494766235352}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8543.80450773494, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8672.854316582121, -8459.048454511223, -8494.193166440977, -8745.844451672365, -8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.152338737118054, "mean_inference_ms": 0.3918546388185926, "mean_action_processing_ms": 0.09430090711956435, "mean_env_wait_ms": 2.9300821824684538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037078857421875, "StateBufferConnector_ms": 0.0026254653930664062, "ViewRequirementAgentConnector_ms": 0.06825494766235352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70920, "num_agent_steps_trained": 70920, "num_env_steps_sampled": 70920, "num_env_steps_trained": 70920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.058045918085746, "num_env_steps_trained_throughput_per_sec": 39.058045918085746, "timesteps_total": 70920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 70920, "timers": {"training_iteration_time_ms": 3069.488, "sample_time_ms": 3065.771, "load_time_ms": 0.217, "load_throughput": 553825.352, "learn_time_ms": 2.738, "learn_throughput": 43835.262, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 70920, "num_env_steps_trained": 70920, "num_agent_steps_sampled": 70920, "num_agent_steps_trained": 70920}, "done": false, "episodes_total": 543, "training_iteration": 135, "trial_id": "668a1_00000", "date": "2023-07-25_18-15-51", "timestamp": 1690298151, "time_this_iter_s": 12.292112112045288, "time_total_s": 1652.7497351169586, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1597.386131286621, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 25.572222222222223, "ram_util_percent": 75.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -13180880896.0, "vf_loss": 557557568.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 523.0, "diff_num_grad_updates_vs_sampler_policy": 522.0}}, "num_env_steps_sampled": 71400, "num_env_steps_trained": 71400, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71400}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8544.115229503463, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.152721195088898, "mean_inference_ms": 0.3918524601488106, "mean_action_processing_ms": 0.09429984519962475, "mean_env_wait_ms": 2.9296532880263264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037009716033935547, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.06820321083068848}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8544.115229503463, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8696.884353008514, -8538.871645924859, -8558.062518598232, -8490.28415324078, -8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.152721195088898, "mean_inference_ms": 0.3918524601488106, "mean_action_processing_ms": 0.09429984519962475, "mean_env_wait_ms": 2.9296532880263264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037009716033935547, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.06820321083068848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71400, "num_env_steps_sampled": 71400, "num_env_steps_trained": 71400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.040091204843606, "num_env_steps_trained_throughput_per_sec": 39.040091204843606, "timesteps_total": 71400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 71400, "timers": {"training_iteration_time_ms": 3062.877, "sample_time_ms": 3059.185, "load_time_ms": 0.217, "load_throughput": 553216.619, "learn_time_ms": 2.728, "learn_throughput": 43991.197, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 71400, "num_env_steps_trained": 71400, "num_agent_steps_sampled": 71400, "num_agent_steps_trained": 71400}, "done": false, "episodes_total": 547, "training_iteration": 136, "trial_id": "668a1_00000", "date": "2023-07-25_18-16-04", "timestamp": 1690298164, "time_this_iter_s": 12.297821044921875, "time_total_s": 1665.0475561618805, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1609.683952331543, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 25.03529411764706, "ram_util_percent": 75.23529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -10882818048.0, "vf_loss": 564473024.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 526.0}}, "num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8542.303367207589, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153063299861014, "mean_inference_ms": 0.3918514532258972, "mean_action_processing_ms": 0.09429891124012346, "mean_env_wait_ms": 2.9292554355962706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037031173706054688, "StateBufferConnector_ms": 0.0026330947875976562, "ViewRequirementAgentConnector_ms": 0.06818580627441406}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8542.303367207589, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8557.704195424585, -8643.736827076364, -8437.915361439591, -8617.639289167848, -8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153063299861014, "mean_inference_ms": 0.3918514532258972, "mean_action_processing_ms": 0.09429891124012346, "mean_env_wait_ms": 2.9292554355962706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037031173706054688, "StateBufferConnector_ms": 0.0026330947875976562, "ViewRequirementAgentConnector_ms": 0.06818580627441406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880, "num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.815317859898485, "num_env_steps_trained_throughput_per_sec": 38.815317859898485, "timesteps_total": 71880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 71880, "timers": {"training_iteration_time_ms": 3067.476, "sample_time_ms": 3063.748, "load_time_ms": 0.218, "load_throughput": 550795.01, "learn_time_ms": 2.738, "learn_throughput": 43822.286, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 71880, "num_env_steps_trained": 71880, "num_agent_steps_sampled": 71880, "num_agent_steps_trained": 71880}, "done": false, "episodes_total": 551, "training_iteration": 137, "trial_id": "668a1_00000", "date": "2023-07-25_18-16-16", "timestamp": 1690298176, "time_this_iter_s": 12.368963956832886, "time_total_s": 1677.4165201187134, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1622.0529162883759, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 23.750000000000004, "ram_util_percent": 75.22222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7946166992188, "policy_loss": -11580948480.0, "vf_loss": 552763904.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 531.0, "diff_num_grad_updates_vs_sampler_policy": 530.0}}, "num_env_steps_sampled": 72360, "num_env_steps_trained": 72360, "num_agent_steps_sampled": 72360, "num_agent_steps_trained": 72360}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8539.623442816017, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153210060718493, "mean_inference_ms": 0.3918506713483184, "mean_action_processing_ms": 0.09429809597414668, "mean_env_wait_ms": 2.928865727746236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.0026383399963378906, "ViewRequirementAgentConnector_ms": 0.06837344169616699}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8539.623442816017, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8423.397126768148, -8647.598047846417, -8623.979248263271, -8551.633202261823, -8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153210060718493, "mean_inference_ms": 0.3918506713483184, "mean_action_processing_ms": 0.09429809597414668, "mean_env_wait_ms": 2.928865727746236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.0026383399963378906, "ViewRequirementAgentConnector_ms": 0.06837344169616699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72360, "num_agent_steps_trained": 72360, "num_env_steps_sampled": 72360, "num_env_steps_trained": 72360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.39373747352158, "num_env_steps_trained_throughput_per_sec": 39.39373747352158, "timesteps_total": 72360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 72360, "timers": {"training_iteration_time_ms": 3079.578, "sample_time_ms": 3075.815, "load_time_ms": 0.219, "load_throughput": 547440.157, "learn_time_ms": 2.768, "learn_throughput": 43352.726, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 72360, "num_env_steps_trained": 72360, "num_agent_steps_sampled": 72360, "num_agent_steps_trained": 72360}, "done": false, "episodes_total": 555, "training_iteration": 138, "trial_id": "668a1_00000", "date": "2023-07-25_18-16-28", "timestamp": 1690298188, "time_this_iter_s": 12.187504053115845, "time_total_s": 1689.6040241718292, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1634.2404203414917, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.658823529411762, "ram_util_percent": 75.22941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -15110992896.0, "vf_loss": 553688384.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 535.0, "diff_num_grad_updates_vs_sampler_policy": 534.0}}, "num_env_steps_sampled": 72840, "num_env_steps_trained": 72840, "num_agent_steps_sampled": 72840, "num_agent_steps_trained": 72840}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8538.05156630552, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153351155126046, "mean_inference_ms": 0.391848356350192, "mean_action_processing_ms": 0.09429726940099582, "mean_env_wait_ms": 2.9284539594116747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003712892532348633, "StateBufferConnector_ms": 0.0026307106018066406, "ViewRequirementAgentConnector_ms": 0.06840634346008301}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8839.21059967869, "episode_reward_mean": -8538.05156630552, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8464.700857240645, -8627.45285973343, -8839.21059967869, -8435.387138155207, -8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153351155126046, "mean_inference_ms": 0.391848356350192, "mean_action_processing_ms": 0.09429726940099582, "mean_env_wait_ms": 2.9284539594116747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003712892532348633, "StateBufferConnector_ms": 0.0026307106018066406, "ViewRequirementAgentConnector_ms": 0.06840634346008301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72840, "num_agent_steps_trained": 72840, "num_env_steps_sampled": 72840, "num_env_steps_trained": 72840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.70102602418454, "num_env_steps_trained_throughput_per_sec": 38.70102602418454, "timesteps_total": 72840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 72840, "timers": {"training_iteration_time_ms": 3082.829, "sample_time_ms": 3079.071, "load_time_ms": 0.218, "load_throughput": 551096.551, "learn_time_ms": 2.765, "learn_throughput": 43396.46, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 72840, "num_env_steps_trained": 72840, "num_agent_steps_sampled": 72840, "num_agent_steps_trained": 72840}, "done": false, "episodes_total": 559, "training_iteration": 139, "trial_id": "668a1_00000", "date": "2023-07-25_18-16-41", "timestamp": 1690298201, "time_this_iter_s": 12.405601024627686, "time_total_s": 1702.009625196457, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1646.6460213661194, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 25.03888888888889, "ram_util_percent": 74.92222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943115234375, "policy_loss": -13828689920.0, "vf_loss": 578634368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 539.0, "diff_num_grad_updates_vs_sampler_policy": 538.0}}, "num_env_steps_sampled": 73320, "num_env_steps_trained": 73320, "num_agent_steps_sampled": 73320, "num_agent_steps_trained": 73320}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8533.654557743237, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153590341894105, "mean_inference_ms": 0.39184537806840125, "mean_action_processing_ms": 0.0942964151068799, "mean_env_wait_ms": 2.928081287954167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.06844377517700195}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8533.654557743237, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8556.39189698412, -8658.247071996539, -8481.38502372264, -8562.10942971249, -8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153590341894105, "mean_inference_ms": 0.39184537806840125, "mean_action_processing_ms": 0.0942964151068799, "mean_env_wait_ms": 2.928081287954167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.06844377517700195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73320, "num_agent_steps_trained": 73320, "num_env_steps_sampled": 73320, "num_env_steps_trained": 73320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.737168107878674, "num_env_steps_trained_throughput_per_sec": 38.737168107878674, "timesteps_total": 73320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 73320, "timers": {"training_iteration_time_ms": 3085.222, "sample_time_ms": 3081.516, "load_time_ms": 0.214, "load_throughput": 561862.559, "learn_time_ms": 2.745, "learn_throughput": 43711.916, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 73320, "num_env_steps_trained": 73320, "num_agent_steps_sampled": 73320, "num_agent_steps_trained": 73320}, "done": false, "episodes_total": 563, "training_iteration": 140, "trial_id": "668a1_00000", "date": "2023-07-25_18-16-53", "timestamp": 1690298213, "time_this_iter_s": 12.394093990325928, "time_total_s": 1714.4037191867828, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1659.0401153564453, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 23.511764705882353, "ram_util_percent": 74.82941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -22132142080.0, "vf_loss": 545257856.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 543.0, "diff_num_grad_updates_vs_sampler_policy": 542.0}}, "num_env_steps_sampled": 73800, "num_env_steps_trained": 73800, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73800}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8533.307080022298, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153850320606402, "mean_inference_ms": 0.39184243978348904, "mean_action_processing_ms": 0.09429563752788013, "mean_env_wait_ms": 2.9277056560819017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037202835083007812, "StateBufferConnector_ms": 0.0026175975799560547, "ViewRequirementAgentConnector_ms": 0.0684816837310791}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8533.307080022298, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8557.0031006974, -8493.453419460478, -8702.900762205212, -8341.5698337186, -8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153850320606402, "mean_inference_ms": 0.39184243978348904, "mean_action_processing_ms": 0.09429563752788013, "mean_env_wait_ms": 2.9277056560819017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037202835083007812, "StateBufferConnector_ms": 0.0026175975799560547, "ViewRequirementAgentConnector_ms": 0.0684816837310791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73800, "num_env_steps_sampled": 73800, "num_env_steps_trained": 73800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.772830410800786, "num_env_steps_trained_throughput_per_sec": 38.772830410800786, "timesteps_total": 73800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 73800, "timers": {"training_iteration_time_ms": 3090.533, "sample_time_ms": 3086.81, "load_time_ms": 0.214, "load_throughput": 561298.628, "learn_time_ms": 2.75, "learn_throughput": 43641.797, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 73800, "num_env_steps_trained": 73800, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73800}, "done": false, "episodes_total": 567, "training_iteration": 141, "trial_id": "668a1_00000", "date": "2023-07-25_18-17-05", "timestamp": 1690298225, "time_this_iter_s": 12.382587909698486, "time_total_s": 1726.7863070964813, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1671.4227032661438, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 24.572222222222223, "ram_util_percent": 75.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -16556260352.0, "vf_loss": 558178112.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 547.0, "diff_num_grad_updates_vs_sampler_policy": 546.0}}, "num_env_steps_sampled": 74280, "num_env_steps_trained": 74280, "num_agent_steps_sampled": 74280, "num_agent_steps_trained": 74280}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8534.585325317352, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153957086014533, "mean_inference_ms": 0.39184082139096693, "mean_action_processing_ms": 0.09429516602284402, "mean_env_wait_ms": 2.9273322408981857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00373077392578125, "StateBufferConnector_ms": 0.0026247501373291016, "ViewRequirementAgentConnector_ms": 0.0685880184173584}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8534.585325317352, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8474.775869769719, -8545.710827142177, -8571.171167084489, -8643.82308960723, -8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153957086014533, "mean_inference_ms": 0.39184082139096693, "mean_action_processing_ms": 0.09429516602284402, "mean_env_wait_ms": 2.9273322408981857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00373077392578125, "StateBufferConnector_ms": 0.0026247501373291016, "ViewRequirementAgentConnector_ms": 0.0685880184173584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74280, "num_agent_steps_trained": 74280, "num_env_steps_sampled": 74280, "num_env_steps_trained": 74280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.31574487197951, "num_env_steps_trained_throughput_per_sec": 39.31574487197951, "timesteps_total": 74280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 74280, "timers": {"training_iteration_time_ms": 3078.081, "sample_time_ms": 3074.323, "load_time_ms": 0.215, "load_throughput": 557382.591, "learn_time_ms": 2.777, "learn_throughput": 43208.324, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 74280, "num_env_steps_trained": 74280, "num_agent_steps_sampled": 74280, "num_agent_steps_trained": 74280}, "done": false, "episodes_total": 571, "training_iteration": 142, "trial_id": "668a1_00000", "date": "2023-07-25_18-17-18", "timestamp": 1690298238, "time_this_iter_s": 12.211989164352417, "time_total_s": 1738.9982962608337, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1683.6346924304962, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 25.28235294117647, "ram_util_percent": 75.28823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952270507812, "policy_loss": -17566515200.0, "vf_loss": 552710976.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 551.0, "diff_num_grad_updates_vs_sampler_policy": 550.0}}, "num_env_steps_sampled": 74760, "num_env_steps_trained": 74760, "num_agent_steps_sampled": 74760, "num_agent_steps_trained": 74760}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8531.464996510462, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153996925032207, "mean_inference_ms": 0.39184159000091695, "mean_action_processing_ms": 0.09429519561479045, "mean_env_wait_ms": 2.9269513967425214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003724813461303711, "StateBufferConnector_ms": 0.002626180648803711, "ViewRequirementAgentConnector_ms": 0.06857967376708984}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8531.464996510462, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8414.457090372123, -8548.204400071601, -8727.47783805493, -8586.906602218536, -8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153996925032207, "mean_inference_ms": 0.39184159000091695, "mean_action_processing_ms": 0.09429519561479045, "mean_env_wait_ms": 2.9269513967425214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003724813461303711, "StateBufferConnector_ms": 0.002626180648803711, "ViewRequirementAgentConnector_ms": 0.06857967376708984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74760, "num_agent_steps_trained": 74760, "num_env_steps_sampled": 74760, "num_env_steps_trained": 74760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.71169721044937, "num_env_steps_trained_throughput_per_sec": 38.71169721044937, "timesteps_total": 74760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 74760, "timers": {"training_iteration_time_ms": 3094.747, "sample_time_ms": 3090.94, "load_time_ms": 0.217, "load_throughput": 552245.425, "learn_time_ms": 2.834, "learn_throughput": 42340.333, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 74760, "num_env_steps_trained": 74760, "num_agent_steps_sampled": 74760, "num_agent_steps_trained": 74760}, "done": false, "episodes_total": 575, "training_iteration": 143, "trial_id": "668a1_00000", "date": "2023-07-25_18-17-30", "timestamp": 1690298250, "time_this_iter_s": 12.402203798294067, "time_total_s": 1751.4005000591278, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1696.0368962287903, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 24.533333333333335, "ram_util_percent": 75.32777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7948608398438, "policy_loss": -17332187136.0, "vf_loss": 551736960.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 555.0, "diff_num_grad_updates_vs_sampler_policy": 554.0}}, "num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8528.809569173463, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153935900814886, "mean_inference_ms": 0.3918426490048405, "mean_action_processing_ms": 0.0942950842150207, "mean_env_wait_ms": 2.926562282320806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037221908569335938, "StateBufferConnector_ms": 0.002622842788696289, "ViewRequirementAgentConnector_ms": 0.0684969425201416}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8528.809569173463, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8621.62092884391, -8608.43602826128, -8385.862181581757, -8658.313826563952, -8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.153935900814886, "mean_inference_ms": 0.3918426490048405, "mean_action_processing_ms": 0.0942950842150207, "mean_env_wait_ms": 2.926562282320806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037221908569335938, "StateBufferConnector_ms": 0.002622842788696289, "ViewRequirementAgentConnector_ms": 0.0684969425201416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240, "num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.57879569198954, "num_env_steps_trained_throughput_per_sec": 39.57879569198954, "timesteps_total": 75240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 75240, "timers": {"training_iteration_time_ms": 3067.512, "sample_time_ms": 3063.733, "load_time_ms": 0.216, "load_throughput": 554374.358, "learn_time_ms": 2.818, "learn_throughput": 42586.811, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 75240, "num_env_steps_trained": 75240, "num_agent_steps_sampled": 75240, "num_agent_steps_trained": 75240}, "done": false, "episodes_total": 579, "training_iteration": 144, "trial_id": "668a1_00000", "date": "2023-07-25_18-17-42", "timestamp": 1690298262, "time_this_iter_s": 12.130563974380493, "time_total_s": 1763.5310640335083, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1708.1674602031708, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 25.029411764705884, "ram_util_percent": 74.42352941176472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -17947924480.0, "vf_loss": 544817984.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 559.0, "diff_num_grad_updates_vs_sampler_policy": 558.0}}, "num_env_steps_sampled": 75720, "num_env_steps_trained": 75720, "num_agent_steps_sampled": 75720, "num_agent_steps_trained": 75720}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8526.745276503354, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154023801324296, "mean_inference_ms": 0.391843329847979, "mean_action_processing_ms": 0.09429485612313088, "mean_env_wait_ms": 2.9262389106289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037279129028320312, "StateBufferConnector_ms": 0.002623319625854492, "ViewRequirementAgentConnector_ms": 0.06851506233215332}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8526.745276503354, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8499.086541260236, -8449.181585847908, -8664.285914653316, -8572.934324127367, -8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154023801324296, "mean_inference_ms": 0.391843329847979, "mean_action_processing_ms": 0.09429485612313088, "mean_env_wait_ms": 2.9262389106289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037279129028320312, "StateBufferConnector_ms": 0.002623319625854492, "ViewRequirementAgentConnector_ms": 0.06851506233215332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75720, "num_agent_steps_trained": 75720, "num_env_steps_sampled": 75720, "num_env_steps_trained": 75720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.65950092663974, "num_env_steps_trained_throughput_per_sec": 38.65950092663974, "timesteps_total": 75720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 75720, "timers": {"training_iteration_time_ms": 3066.372, "sample_time_ms": 3062.634, "load_time_ms": 0.215, "load_throughput": 557567.83, "learn_time_ms": 2.766, "learn_throughput": 43390.474, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 75720, "num_env_steps_trained": 75720, "num_agent_steps_sampled": 75720, "num_agent_steps_trained": 75720}, "done": false, "episodes_total": 583, "training_iteration": 145, "trial_id": "668a1_00000", "date": "2023-07-25_18-17-55", "timestamp": 1690298275, "time_this_iter_s": 12.418777704238892, "time_total_s": 1775.9498417377472, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1720.5862379074097, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 23.91764705882353, "ram_util_percent": 74.87058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -20584751104.0, "vf_loss": 571091968.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 562.0}}, "num_env_steps_sampled": 76200, "num_env_steps_trained": 76200, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 76200}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8526.385083450938, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15401425202471, "mean_inference_ms": 0.391848224977122, "mean_action_processing_ms": 0.09429535099561939, "mean_env_wait_ms": 2.9259484075809143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003730297088623047, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.0685727596282959}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8526.385083450938, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8562.824997207388, -8655.666156256288, -8594.967800117487, -8410.988878565655, -8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15401425202471, "mean_inference_ms": 0.391848224977122, "mean_action_processing_ms": 0.09429535099561939, "mean_env_wait_ms": 2.9259484075809143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003730297088623047, "StateBufferConnector_ms": 0.0026264190673828125, "ViewRequirementAgentConnector_ms": 0.0685727596282959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 76200, "num_env_steps_sampled": 76200, "num_env_steps_trained": 76200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.19858152976665, "num_env_steps_trained_throughput_per_sec": 39.19858152976665, "timesteps_total": 76200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 76200, "timers": {"training_iteration_time_ms": 3055.283, "sample_time_ms": 3051.584, "load_time_ms": 0.214, "load_throughput": 559987.183, "learn_time_ms": 2.719, "learn_throughput": 44140.114, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 76200, "num_env_steps_trained": 76200, "num_agent_steps_sampled": 76200, "num_agent_steps_trained": 76200}, "done": false, "episodes_total": 587, "training_iteration": 146, "trial_id": "668a1_00000", "date": "2023-07-25_18-18-07", "timestamp": 1690298287, "time_this_iter_s": 12.248045206069946, "time_total_s": 1788.1978869438171, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1732.8342831134796, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 26.244444444444447, "ram_util_percent": 74.96111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7939453125, "policy_loss": -24811743232.0, "vf_loss": 584636160.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 567.0, "diff_num_grad_updates_vs_sampler_policy": 566.0}}, "num_env_steps_sampled": 76680, "num_env_steps_trained": 76680, "num_agent_steps_sampled": 76680, "num_agent_steps_trained": 76680}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8530.977504928142, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15395089748417, "mean_inference_ms": 0.39185464972237627, "mean_action_processing_ms": 0.0942960201899446, "mean_env_wait_ms": 2.9256377188594582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003736257553100586, "StateBufferConnector_ms": 0.002624034881591797, "ViewRequirementAgentConnector_ms": 0.06849479675292969}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8530.977504928142, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8395.621212602913, -8552.041662109681, -8453.740636212666, -8552.318124567591, -8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15395089748417, "mean_inference_ms": 0.39185464972237627, "mean_action_processing_ms": 0.0942960201899446, "mean_env_wait_ms": 2.9256377188594582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003736257553100586, "StateBufferConnector_ms": 0.002624034881591797, "ViewRequirementAgentConnector_ms": 0.06849479675292969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76680, "num_agent_steps_trained": 76680, "num_env_steps_sampled": 76680, "num_env_steps_trained": 76680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.59406205275116, "num_env_steps_trained_throughput_per_sec": 39.59406205275116, "timesteps_total": 76680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 76680, "timers": {"training_iteration_time_ms": 3070.415, "sample_time_ms": 3066.695, "load_time_ms": 0.213, "load_throughput": 562867.904, "learn_time_ms": 2.722, "learn_throughput": 44079.809, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 76680, "num_env_steps_trained": 76680, "num_agent_steps_sampled": 76680, "num_agent_steps_trained": 76680}, "done": false, "episodes_total": 591, "training_iteration": 147, "trial_id": "668a1_00000", "date": "2023-07-25_18-18-19", "timestamp": 1690298299, "time_this_iter_s": 12.125788927078247, "time_total_s": 1800.3236758708954, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1744.9600720405579, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 25.98235294117647, "ram_util_percent": 75.21176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -19140104192.0, "vf_loss": 546715584.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 571.0, "diff_num_grad_updates_vs_sampler_policy": 570.0}}, "num_env_steps_sampled": 77160, "num_env_steps_trained": 77160, "num_agent_steps_sampled": 77160, "num_agent_steps_trained": 77160}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8531.163071973957, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1539916612213, "mean_inference_ms": 0.3918602540305014, "mean_action_processing_ms": 0.0942965756272127, "mean_env_wait_ms": 2.925333794130162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037317276000976562, "StateBufferConnector_ms": 0.002613544464111328, "ViewRequirementAgentConnector_ms": 0.06836199760437012}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8531.163071973957, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8428.728270626709, -8354.383880789213, -8553.398198332645, -8463.040537894449, -8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1539916612213, "mean_inference_ms": 0.3918602540305014, "mean_action_processing_ms": 0.0942965756272127, "mean_env_wait_ms": 2.925333794130162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037317276000976562, "StateBufferConnector_ms": 0.002613544464111328, "ViewRequirementAgentConnector_ms": 0.06836199760437012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77160, "num_agent_steps_trained": 77160, "num_env_steps_sampled": 77160, "num_env_steps_trained": 77160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.69305177839893, "num_env_steps_trained_throughput_per_sec": 38.69305177839893, "timesteps_total": 77160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 77160, "timers": {"training_iteration_time_ms": 3064.441, "sample_time_ms": 3060.725, "load_time_ms": 0.212, "load_throughput": 565397.079, "learn_time_ms": 2.728, "learn_throughput": 43985.43, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 77160, "num_env_steps_trained": 77160, "num_agent_steps_sampled": 77160, "num_agent_steps_trained": 77160}, "done": false, "episodes_total": 595, "training_iteration": 148, "trial_id": "668a1_00000", "date": "2023-07-25_18-18-32", "timestamp": 1690298312, "time_this_iter_s": 12.408274173736572, "time_total_s": 1812.731950044632, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1757.3683462142944, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 23.433333333333334, "ram_util_percent": 74.91666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7937622070312, "policy_loss": -32800630784.0, "vf_loss": 565375488.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 575.0, "diff_num_grad_updates_vs_sampler_policy": 574.0}}, "num_env_steps_sampled": 77640, "num_env_steps_trained": 77640, "num_agent_steps_sampled": 77640, "num_agent_steps_trained": 77640}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8533.345845083808, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154106518462367, "mean_inference_ms": 0.3918664136786032, "mean_action_processing_ms": 0.09429721196830998, "mean_env_wait_ms": 2.925043401009345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.0026035308837890625, "ViewRequirementAgentConnector_ms": 0.06835103034973145}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8803.14255866879, "episode_reward_mean": -8533.345845083808, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8582.100879250791, -8476.142637045694, -8481.165701352224, -8803.14255866879, -8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154106518462367, "mean_inference_ms": 0.3918664136786032, "mean_action_processing_ms": 0.09429721196830998, "mean_env_wait_ms": 2.925043401009345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.0026035308837890625, "ViewRequirementAgentConnector_ms": 0.06835103034973145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77640, "num_agent_steps_trained": 77640, "num_env_steps_sampled": 77640, "num_env_steps_trained": 77640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.194317983377026, "num_env_steps_trained_throughput_per_sec": 39.194317983377026, "timesteps_total": 77640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 77640, "timers": {"training_iteration_time_ms": 3067.563, "sample_time_ms": 3063.847, "load_time_ms": 0.214, "load_throughput": 560236.509, "learn_time_ms": 2.744, "learn_throughput": 43732.425, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 77640, "num_env_steps_trained": 77640, "num_agent_steps_sampled": 77640, "num_agent_steps_trained": 77640}, "done": false, "episodes_total": 599, "training_iteration": 149, "trial_id": "668a1_00000", "date": "2023-07-25_18-18-44", "timestamp": 1690298324, "time_this_iter_s": 12.249533891677856, "time_total_s": 1824.9814839363098, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1769.6178801059723, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 24.50588235294118, "ram_util_percent": 74.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -27631714304.0, "vf_loss": 564215104.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 579.0, "diff_num_grad_updates_vs_sampler_policy": 578.0}}, "num_env_steps_sampled": 78120, "num_env_steps_trained": 78120, "num_agent_steps_sampled": 78120, "num_agent_steps_trained": 78120}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8528.593923023955, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154361531790702, "mean_inference_ms": 0.39187401691803414, "mean_action_processing_ms": 0.09429797578161922, "mean_env_wait_ms": 2.924838076790722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310123443603516, "StateBufferConnector_ms": 0.0026092529296875, "ViewRequirementAgentConnector_ms": 0.06840825080871582}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8528.593923023955, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8407.498530390838, -8487.832398324648, -8509.256101138577, -8753.821077891327, -8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154361531790702, "mean_inference_ms": 0.39187401691803414, "mean_action_processing_ms": 0.09429797578161922, "mean_env_wait_ms": 2.924838076790722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310123443603516, "StateBufferConnector_ms": 0.0026092529296875, "ViewRequirementAgentConnector_ms": 0.06840825080871582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78120, "num_agent_steps_trained": 78120, "num_env_steps_sampled": 78120, "num_env_steps_trained": 78120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.743406119749, "num_env_steps_trained_throughput_per_sec": 38.743406119749, "timesteps_total": 78120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 78120, "timers": {"training_iteration_time_ms": 3066.315, "sample_time_ms": 3062.589, "load_time_ms": 0.217, "load_throughput": 553886.299, "learn_time_ms": 2.747, "learn_throughput": 43679.671, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 78120, "num_env_steps_trained": 78120, "num_agent_steps_sampled": 78120, "num_agent_steps_trained": 78120}, "done": false, "episodes_total": 603, "training_iteration": 150, "trial_id": "668a1_00000", "date": "2023-07-25_18-18-56", "timestamp": 1690298336, "time_this_iter_s": 12.392015218734741, "time_total_s": 1837.3734991550446, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1782.009895324707, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 23.272222222222222, "ram_util_percent": 74.76666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794189453125, "policy_loss": -26141087744.0, "vf_loss": 565126848.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 583.0, "diff_num_grad_updates_vs_sampler_policy": 582.0}}, "num_env_steps_sampled": 78600, "num_env_steps_trained": 78600, "num_agent_steps_sampled": 78600, "num_agent_steps_trained": 78600}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8527.781415120611, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154553090500503, "mean_inference_ms": 0.3918853841652016, "mean_action_processing_ms": 0.09429937856604796, "mean_env_wait_ms": 2.9246355499474292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037391185760498047, "StateBufferConnector_ms": 0.002614736557006836, "ViewRequirementAgentConnector_ms": 0.06845712661743164}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8527.781415120611, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8512.20654284969, -8542.174886662711, -8391.697995262988, -8684.737097643743, -8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154553090500503, "mean_inference_ms": 0.3918853841652016, "mean_action_processing_ms": 0.09429937856604796, "mean_env_wait_ms": 2.9246355499474292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037391185760498047, "StateBufferConnector_ms": 0.002614736557006836, "ViewRequirementAgentConnector_ms": 0.06845712661743164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78600, "num_agent_steps_trained": 78600, "num_env_steps_sampled": 78600, "num_env_steps_trained": 78600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.25953313183938, "num_env_steps_trained_throughput_per_sec": 39.25953313183938, "timesteps_total": 78600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 78600, "timers": {"training_iteration_time_ms": 3079.243, "sample_time_ms": 3075.438, "load_time_ms": 0.227, "load_throughput": 528971.603, "learn_time_ms": 2.791, "learn_throughput": 43001.963, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 78600, "num_env_steps_trained": 78600, "num_agent_steps_sampled": 78600, "num_agent_steps_trained": 78600}, "done": false, "episodes_total": 607, "training_iteration": 151, "trial_id": "668a1_00000", "date": "2023-07-25_18-19-09", "timestamp": 1690298349, "time_this_iter_s": 12.22908091545105, "time_total_s": 1849.6025800704956, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1794.238976240158, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 27.729411764705883, "ram_util_percent": 74.67058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -26292529152.0, "vf_loss": 559468096.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 587.0, "diff_num_grad_updates_vs_sampler_policy": 586.0}}, "num_env_steps_sampled": 79080, "num_env_steps_trained": 79080, "num_agent_steps_sampled": 79080, "num_agent_steps_trained": 79080}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8527.730123283449, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154789785249367, "mean_inference_ms": 0.3918965026345898, "mean_action_processing_ms": 0.09430076045873616, "mean_env_wait_ms": 2.924402542843566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747224807739258, "StateBufferConnector_ms": 0.002615690231323242, "ViewRequirementAgentConnector_ms": 0.06851816177368164}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8527.730123283449, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8462.165028472726, -8487.702751657293, -8483.069907901265, -8508.788421089943, -8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.154789785249367, "mean_inference_ms": 0.3918965026345898, "mean_action_processing_ms": 0.09430076045873616, "mean_env_wait_ms": 2.924402542843566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747224807739258, "StateBufferConnector_ms": 0.002615690231323242, "ViewRequirementAgentConnector_ms": 0.06851816177368164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79080, "num_agent_steps_trained": 79080, "num_env_steps_sampled": 79080, "num_env_steps_trained": 79080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.945833559020386, "num_env_steps_trained_throughput_per_sec": 38.945833559020386, "timesteps_total": 79080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 79080, "timers": {"training_iteration_time_ms": 3088.917, "sample_time_ms": 3085.116, "load_time_ms": 0.227, "load_throughput": 527972.81, "learn_time_ms": 2.79, "learn_throughput": 43009.68, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 79080, "num_env_steps_trained": 79080, "num_agent_steps_sampled": 79080, "num_agent_steps_trained": 79080}, "done": false, "episodes_total": 611, "training_iteration": 152, "trial_id": "668a1_00000", "date": "2023-07-25_18-19-21", "timestamp": 1690298361, "time_this_iter_s": 12.327624082565308, "time_total_s": 1861.930204153061, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1806.5666003227234, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 25.63529411764706, "ram_util_percent": 74.59411764705884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -15828308992.0, "vf_loss": 573239488.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 591.0, "diff_num_grad_updates_vs_sampler_policy": 590.0}}, "num_env_steps_sampled": 79560, "num_env_steps_trained": 79560, "num_agent_steps_sampled": 79560, "num_agent_steps_trained": 79560}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8531.328282521954, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1548495032442, "mean_inference_ms": 0.39190707297421207, "mean_action_processing_ms": 0.09430215102853481, "mean_env_wait_ms": 2.9241338379176818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037474632263183594, "StateBufferConnector_ms": 0.0026090145111083984, "ViewRequirementAgentConnector_ms": 0.06852841377258301}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8531.328282521954, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8423.131784008123, -8402.860240054019, -8734.891663095392, -8485.06998120727, -8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1548495032442, "mean_inference_ms": 0.39190707297421207, "mean_action_processing_ms": 0.09430215102853481, "mean_env_wait_ms": 2.9241338379176818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037474632263183594, "StateBufferConnector_ms": 0.0026090145111083984, "ViewRequirementAgentConnector_ms": 0.06852841377258301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79560, "num_agent_steps_trained": 79560, "num_env_steps_sampled": 79560, "num_env_steps_trained": 79560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.8843218204374, "num_env_steps_trained_throughput_per_sec": 39.8843218204374, "timesteps_total": 79560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 79560, "timers": {"training_iteration_time_ms": 3048.442, "sample_time_ms": 3044.704, "load_time_ms": 0.217, "load_throughput": 552548.556, "learn_time_ms": 2.76, "learn_throughput": 43480.811, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 79560, "num_env_steps_trained": 79560, "num_agent_steps_sampled": 79560, "num_agent_steps_trained": 79560}, "done": false, "episodes_total": 615, "training_iteration": 153, "trial_id": "668a1_00000", "date": "2023-07-25_18-19-33", "timestamp": 1690298373, "time_this_iter_s": 12.037797212600708, "time_total_s": 1873.9680013656616, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1818.604397535324, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 27.033333333333335, "ram_util_percent": 74.51111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -25945948160.0, "vf_loss": 545910720.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 595.0, "diff_num_grad_updates_vs_sampler_policy": 594.0}}, "num_env_steps_sampled": 80040, "num_env_steps_trained": 80040, "num_agent_steps_sampled": 80040, "num_agent_steps_trained": 80040}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8533.213998366828, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155151235568983, "mean_inference_ms": 0.39191465978565304, "mean_action_processing_ms": 0.0943030821825543, "mean_env_wait_ms": 2.923865636009517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748178482055664, "StateBufferConnector_ms": 0.0026092529296875, "ViewRequirementAgentConnector_ms": 0.06849122047424316}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8533.213998366828, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8549.066839724861, -8489.976180930795, -8498.980085677787, -8728.722511867869, -8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155151235568983, "mean_inference_ms": 0.39191465978565304, "mean_action_processing_ms": 0.0943030821825543, "mean_env_wait_ms": 2.923865636009517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748178482055664, "StateBufferConnector_ms": 0.0026092529296875, "ViewRequirementAgentConnector_ms": 0.06849122047424316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80040, "num_agent_steps_trained": 80040, "num_env_steps_sampled": 80040, "num_env_steps_trained": 80040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.54665341204543, "num_env_steps_trained_throughput_per_sec": 38.54665341204543, "timesteps_total": 80040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 80040, "timers": {"training_iteration_time_ms": 3060.463, "sample_time_ms": 3056.748, "load_time_ms": 0.215, "load_throughput": 557259.167, "learn_time_ms": 2.749, "learn_throughput": 43652.016, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 80040, "num_env_steps_trained": 80040, "num_agent_steps_sampled": 80040, "num_agent_steps_trained": 80040}, "done": false, "episodes_total": 619, "training_iteration": 154, "trial_id": "668a1_00000", "date": "2023-07-25_18-19-45", "timestamp": 1690298385, "time_this_iter_s": 12.455376863479614, "time_total_s": 1886.4233782291412, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1831.0597743988037, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 25.794117647058822, "ram_util_percent": 74.82352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7948608398438, "policy_loss": -15229405184.0, "vf_loss": 566996992.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 599.0, "diff_num_grad_updates_vs_sampler_policy": 598.0}}, "num_env_steps_sampled": 80520, "num_env_steps_trained": 80520, "num_agent_steps_sampled": 80520, "num_agent_steps_trained": 80520}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8533.651772671967, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155332850368822, "mean_inference_ms": 0.391920546305032, "mean_action_processing_ms": 0.09430380172948513, "mean_env_wait_ms": 2.9236373101769266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037384033203125, "StateBufferConnector_ms": 0.002608060836791992, "ViewRequirementAgentConnector_ms": 0.06842970848083496}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8533.651772671967, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8456.537438310674, -8530.833096763303, -8414.330409139258, -8629.188953347902, -8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155332850368822, "mean_inference_ms": 0.391920546305032, "mean_action_processing_ms": 0.09430380172948513, "mean_env_wait_ms": 2.9236373101769266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037384033203125, "StateBufferConnector_ms": 0.002608060836791992, "ViewRequirementAgentConnector_ms": 0.06842970848083496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80520, "num_agent_steps_trained": 80520, "num_env_steps_sampled": 80520, "num_env_steps_trained": 80520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.52743960631191, "num_env_steps_trained_throughput_per_sec": 38.52743960631191, "timesteps_total": 80520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 80520, "timers": {"training_iteration_time_ms": 3090.384, "sample_time_ms": 3086.678, "load_time_ms": 0.214, "load_throughput": 560673.365, "learn_time_ms": 2.738, "learn_throughput": 43833.735, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 80520, "num_env_steps_trained": 80520, "num_agent_steps_sampled": 80520, "num_agent_steps_trained": 80520}, "done": false, "episodes_total": 623, "training_iteration": 155, "trial_id": "668a1_00000", "date": "2023-07-25_18-19-58", "timestamp": 1690298398, "time_this_iter_s": 12.461351871490479, "time_total_s": 1898.8847301006317, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1843.5211262702942, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 23.65, "ram_util_percent": 74.86666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -42083344384.0, "vf_loss": 540673920.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 603.0, "diff_num_grad_updates_vs_sampler_policy": 602.0}}, "num_env_steps_sampled": 81000, "num_env_steps_trained": 81000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 81000}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8534.279491293966, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15527124557437, "mean_inference_ms": 0.3919301313634149, "mean_action_processing_ms": 0.09430522349685848, "mean_env_wait_ms": 2.923429142406176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037369728088378906, "StateBufferConnector_ms": 0.002611875534057617, "ViewRequirementAgentConnector_ms": 0.06847739219665527}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8769.415945321392, "episode_reward_mean": -8534.279491293966, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8588.639238693682, -8350.145395862786, -8409.531464528494, -8535.665922883352, -8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15527124557437, "mean_inference_ms": 0.3919301313634149, "mean_action_processing_ms": 0.09430522349685848, "mean_env_wait_ms": 2.923429142406176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037369728088378906, "StateBufferConnector_ms": 0.002611875534057617, "ViewRequirementAgentConnector_ms": 0.06847739219665527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 81000, "num_env_steps_sampled": 81000, "num_env_steps_trained": 81000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.73455690393544, "num_env_steps_trained_throughput_per_sec": 39.73455690393544, "timesteps_total": 81000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 81000, "timers": {"training_iteration_time_ms": 3090.467, "sample_time_ms": 3086.762, "load_time_ms": 0.215, "load_throughput": 559054.182, "learn_time_ms": 2.742, "learn_throughput": 43767.792, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 81000, "num_env_steps_trained": 81000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 81000}, "done": false, "episodes_total": 627, "training_iteration": 156, "trial_id": "668a1_00000", "date": "2023-07-25_18-20-10", "timestamp": 1690298410, "time_this_iter_s": 12.082952737808228, "time_total_s": 1910.96768283844, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1855.6040790081024, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 27.111764705882354, "ram_util_percent": 74.38235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7938232421875, "policy_loss": -20566018048.0, "vf_loss": 598654976.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 607.0, "diff_num_grad_updates_vs_sampler_policy": 606.0}}, "num_env_steps_sampled": 81480, "num_env_steps_trained": 81480, "num_agent_steps_sampled": 81480, "num_agent_steps_trained": 81480}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8541.956412530642, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155307828067556, "mean_inference_ms": 0.39193942002564064, "mean_action_processing_ms": 0.09430652520739645, "mean_env_wait_ms": 2.9231552417223132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741741180419922, "StateBufferConnector_ms": 0.0026102066040039062, "ViewRequirementAgentConnector_ms": 0.06851744651794434}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8541.956412530642, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8657.640127461824, -8769.415945321392, -8737.84579431622, -8595.957268492923, -8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155307828067556, "mean_inference_ms": 0.39193942002564064, "mean_action_processing_ms": 0.09430652520739645, "mean_env_wait_ms": 2.9231552417223132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741741180419922, "StateBufferConnector_ms": 0.0026102066040039062, "ViewRequirementAgentConnector_ms": 0.06851744651794434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81480, "num_agent_steps_trained": 81480, "num_env_steps_sampled": 81480, "num_env_steps_trained": 81480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.6588098069573, "num_env_steps_trained_throughput_per_sec": 38.6588098069573, "timesteps_total": 81480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 81480, "timers": {"training_iteration_time_ms": 3081.249, "sample_time_ms": 3077.517, "load_time_ms": 0.217, "load_throughput": 553825.352, "learn_time_ms": 2.761, "learn_throughput": 43468.044, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 81480, "num_env_steps_trained": 81480, "num_agent_steps_sampled": 81480, "num_agent_steps_trained": 81480}, "done": false, "episodes_total": 631, "training_iteration": 157, "trial_id": "668a1_00000", "date": "2023-07-25_18-20-22", "timestamp": 1690298422, "time_this_iter_s": 12.419126033782959, "time_total_s": 1923.386808872223, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1868.0232050418854, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 21.85, "ram_util_percent": 74.89444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7938232421875, "policy_loss": -24328187904.0, "vf_loss": 570539200.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 611.0, "diff_num_grad_updates_vs_sampler_policy": 610.0}}, "num_env_steps_sampled": 81960, "num_env_steps_trained": 81960, "num_agent_steps_sampled": 81960, "num_agent_steps_trained": 81960}, "sampler_results": {"episode_reward_max": -8316.489416349983, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8534.230538840642, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155417701246517, "mean_inference_ms": 0.3919492688710058, "mean_action_processing_ms": 0.09430796715956358, "mean_env_wait_ms": 2.9229319884850007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037393569946289062, "StateBufferConnector_ms": 0.002619028091430664, "ViewRequirementAgentConnector_ms": 0.06853127479553223}}, "episode_reward_max": -8316.489416349983, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8534.230538840642, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8489.157160354158, -8648.111908662722, -8565.950126686274, -8316.489416349983, -8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155417701246517, "mean_inference_ms": 0.3919492688710058, "mean_action_processing_ms": 0.09430796715956358, "mean_env_wait_ms": 2.9229319884850007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037393569946289062, "StateBufferConnector_ms": 0.002619028091430664, "ViewRequirementAgentConnector_ms": 0.06853127479553223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81960, "num_agent_steps_trained": 81960, "num_env_steps_sampled": 81960, "num_env_steps_trained": 81960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.76602232812804, "num_env_steps_trained_throughput_per_sec": 38.76602232812804, "timesteps_total": 81960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 81960, "timers": {"training_iteration_time_ms": 3083.407, "sample_time_ms": 3079.658, "load_time_ms": 0.217, "load_throughput": 553277.432, "learn_time_ms": 2.763, "learn_throughput": 43434.284, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 81960, "num_env_steps_trained": 81960, "num_agent_steps_sampled": 81960, "num_agent_steps_trained": 81960}, "done": false, "episodes_total": 635, "training_iteration": 158, "trial_id": "668a1_00000", "date": "2023-07-25_18-20-35", "timestamp": 1690298435, "time_this_iter_s": 12.384809017181396, "time_total_s": 1935.7716178894043, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1880.4080140590668, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 24.329411764705885, "ram_util_percent": 74.65882352941175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7946166992188, "policy_loss": -11526451200.0, "vf_loss": 569097984.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 615.0, "diff_num_grad_updates_vs_sampler_policy": 614.0}}, "num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440}, "sampler_results": {"episode_reward_max": -8327.957207082025, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8534.86165723693, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155589914122814, "mean_inference_ms": 0.3919581291318825, "mean_action_processing_ms": 0.09430923319681941, "mean_env_wait_ms": 2.9227474620392115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037314891815185547, "StateBufferConnector_ms": 0.00261688232421875, "ViewRequirementAgentConnector_ms": 0.06849050521850586}}, "episode_reward_max": -8327.957207082025, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8534.86165723693, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8554.409019686917, -8327.957207082025, -8479.69057918026, -8607.325575924557, -8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155589914122814, "mean_inference_ms": 0.3919581291318825, "mean_action_processing_ms": 0.09430923319681941, "mean_env_wait_ms": 2.9227474620392115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037314891815185547, "StateBufferConnector_ms": 0.00261688232421875, "ViewRequirementAgentConnector_ms": 0.06849050521850586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440, "num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.53847633248994, "num_env_steps_trained_throughput_per_sec": 38.53847633248994, "timesteps_total": 82440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 82440, "timers": {"training_iteration_time_ms": 3093.377, "sample_time_ms": 3089.678, "load_time_ms": 0.215, "load_throughput": 558930.017, "learn_time_ms": 2.727, "learn_throughput": 43996.965, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 82440, "num_env_steps_trained": 82440, "num_agent_steps_sampled": 82440, "num_agent_steps_trained": 82440}, "done": false, "episodes_total": 639, "training_iteration": 159, "trial_id": "668a1_00000", "date": "2023-07-25_18-20-47", "timestamp": 1690298447, "time_this_iter_s": 12.457781076431274, "time_total_s": 1948.2293989658356, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1892.865795135498, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 23.783333333333335, "ram_util_percent": 74.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -7265359872.0, "vf_loss": 541852416.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 619.0, "diff_num_grad_updates_vs_sampler_policy": 618.0}}, "num_env_steps_sampled": 82920, "num_env_steps_trained": 82920, "num_agent_steps_sampled": 82920, "num_agent_steps_trained": 82920}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.51326642504, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155701031745643, "mean_inference_ms": 0.39196767365510427, "mean_action_processing_ms": 0.09431058628136384, "mean_env_wait_ms": 2.922555587685906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.00262451171875, "ViewRequirementAgentConnector_ms": 0.06842994689941406}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.51326642504, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8680.553792779883, -8669.859170221596, -8534.915562624043, -8517.684040433496, -8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155701031745643, "mean_inference_ms": 0.39196767365510427, "mean_action_processing_ms": 0.09431058628136384, "mean_env_wait_ms": 2.922555587685906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.00262451171875, "ViewRequirementAgentConnector_ms": 0.06842994689941406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82920, "num_agent_steps_trained": 82920, "num_env_steps_sampled": 82920, "num_env_steps_trained": 82920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.46955223325812, "num_env_steps_trained_throughput_per_sec": 39.46955223325812, "timesteps_total": 82920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 82920, "timers": {"training_iteration_time_ms": 3082.261, "sample_time_ms": 3078.544, "load_time_ms": 0.215, "load_throughput": 558930.017, "learn_time_ms": 2.752, "learn_throughput": 43603.611, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 82920, "num_env_steps_trained": 82920, "num_agent_steps_sampled": 82920, "num_agent_steps_trained": 82920}, "done": false, "episodes_total": 643, "training_iteration": 160, "trial_id": "668a1_00000", "date": "2023-07-25_18-21-00", "timestamp": 1690298460, "time_this_iter_s": 12.164139032363892, "time_total_s": 1960.3935379981995, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1905.029934167862, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 25.170588235294115, "ram_util_percent": 74.85882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -14354056192.0, "vf_loss": 545350144.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 623.0, "diff_num_grad_updates_vs_sampler_policy": 622.0}}, "num_env_steps_sampled": 83400, "num_env_steps_trained": 83400, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83400}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8531.683029535485, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15585117821992, "mean_inference_ms": 0.39197715307719494, "mean_action_processing_ms": 0.09431193395255388, "mean_env_wait_ms": 2.9223545338084125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037393569946289062, "StateBufferConnector_ms": 0.0026314258575439453, "ViewRequirementAgentConnector_ms": 0.06854867935180664}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8531.683029535485, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8598.737529450247, -8485.828282109373, -8426.887219042008, -8591.463410583574, -8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15585117821992, "mean_inference_ms": 0.39197715307719494, "mean_action_processing_ms": 0.09431193395255388, "mean_env_wait_ms": 2.9223545338084125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037393569946289062, "StateBufferConnector_ms": 0.0026314258575439453, "ViewRequirementAgentConnector_ms": 0.06854867935180664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83400, "num_env_steps_sampled": 83400, "num_env_steps_trained": 83400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.8730978374989, "num_env_steps_trained_throughput_per_sec": 38.8730978374989, "timesteps_total": 83400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 83400, "timers": {"training_iteration_time_ms": 3086.004, "sample_time_ms": 3082.286, "load_time_ms": 0.216, "load_throughput": 554374.358, "learn_time_ms": 2.761, "learn_throughput": 43463.915, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 83400, "num_env_steps_trained": 83400, "num_agent_steps_sampled": 83400, "num_agent_steps_trained": 83400}, "done": false, "episodes_total": 647, "training_iteration": 161, "trial_id": "668a1_00000", "date": "2023-07-25_18-21-12", "timestamp": 1690298472, "time_this_iter_s": 12.350956916809082, "time_total_s": 1972.7444949150085, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1917.380891084671, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 26.07222222222222, "ram_util_percent": 74.87777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -10933268480.0, "vf_loss": 550699840.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 627.0, "diff_num_grad_updates_vs_sampler_policy": 626.0}}, "num_env_steps_sampled": 83880, "num_env_steps_trained": 83880, "num_agent_steps_sampled": 83880, "num_agent_steps_trained": 83880}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8534.52973368677, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155969835804516, "mean_inference_ms": 0.39198375542159397, "mean_action_processing_ms": 0.09431284411737163, "mean_env_wait_ms": 2.9221747051634552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037429332733154297, "StateBufferConnector_ms": 0.0026252269744873047, "ViewRequirementAgentConnector_ms": 0.0686178207397461}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8534.52973368677, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8488.343849564224, -8551.720738619892, -8467.579484633323, -8481.359161133581, -8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.155969835804516, "mean_inference_ms": 0.39198375542159397, "mean_action_processing_ms": 0.09431284411737163, "mean_env_wait_ms": 2.9221747051634552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037429332733154297, "StateBufferConnector_ms": 0.0026252269744873047, "ViewRequirementAgentConnector_ms": 0.0686178207397461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83880, "num_agent_steps_trained": 83880, "num_env_steps_sampled": 83880, "num_env_steps_trained": 83880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.86060694219348, "num_env_steps_trained_throughput_per_sec": 38.86060694219348, "timesteps_total": 83880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 83880, "timers": {"training_iteration_time_ms": 3080.182, "sample_time_ms": 3076.434, "load_time_ms": 0.217, "load_throughput": 553886.299, "learn_time_ms": 2.783, "learn_throughput": 43118.744, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 83880, "num_env_steps_trained": 83880, "num_agent_steps_sampled": 83880, "num_agent_steps_trained": 83880}, "done": false, "episodes_total": 651, "training_iteration": 162, "trial_id": "668a1_00000", "date": "2023-07-25_18-21-24", "timestamp": 1690298484, "time_this_iter_s": 12.354575157165527, "time_total_s": 1985.099070072174, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1929.7354662418365, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 22.158823529411766, "ram_util_percent": 74.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -44977573888.0, "vf_loss": 538912512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 631.0, "diff_num_grad_updates_vs_sampler_policy": 630.0}}, "num_env_steps_sampled": 84360, "num_env_steps_trained": 84360, "num_agent_steps_sampled": 84360, "num_agent_steps_trained": 84360}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8535.345922090211, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156147099127757, "mean_inference_ms": 0.39198897884952993, "mean_action_processing_ms": 0.09431352341060034, "mean_env_wait_ms": 2.9220230205380915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037391185760498047, "StateBufferConnector_ms": 0.002627134323120117, "ViewRequirementAgentConnector_ms": 0.06853008270263672}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8535.345922090211, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8519.01358282963, -8546.59818522663, -8546.043216012114, -8477.764990021562, -8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156147099127757, "mean_inference_ms": 0.39198897884952993, "mean_action_processing_ms": 0.09431352341060034, "mean_env_wait_ms": 2.9220230205380915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037391185760498047, "StateBufferConnector_ms": 0.002627134323120117, "ViewRequirementAgentConnector_ms": 0.06853008270263672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84360, "num_agent_steps_trained": 84360, "num_env_steps_sampled": 84360, "num_env_steps_trained": 84360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.95528112274995, "num_env_steps_trained_throughput_per_sec": 38.95528112274995, "timesteps_total": 84360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 84360, "timers": {"training_iteration_time_ms": 3078.039, "sample_time_ms": 3074.261, "load_time_ms": 0.217, "load_throughput": 553095.033, "learn_time_ms": 2.805, "learn_throughput": 42787.741, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 84360, "num_env_steps_trained": 84360, "num_agent_steps_sampled": 84360, "num_agent_steps_trained": 84360}, "done": false, "episodes_total": 655, "training_iteration": 163, "trial_id": "668a1_00000", "date": "2023-07-25_18-21-37", "timestamp": 1690298497, "time_this_iter_s": 12.324593782424927, "time_total_s": 1997.423663854599, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1942.0600600242615, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 24.67777777777778, "ram_util_percent": 74.74444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -41214083072.0, "vf_loss": 564867968.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 634.0}}, "num_env_steps_sampled": 84840, "num_env_steps_trained": 84840, "num_agent_steps_sampled": 84840, "num_agent_steps_trained": 84840}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8535.531096259532, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156272161291145, "mean_inference_ms": 0.39199462616195324, "mean_action_processing_ms": 0.09431422959716874, "mean_env_wait_ms": 2.921864067314202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003743410110473633, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.06849455833435059}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8535.531096259532, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8431.470443912996, -8423.821676031936, -8408.35010542524, -8663.408373209733, -8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156272161291145, "mean_inference_ms": 0.39199462616195324, "mean_action_processing_ms": 0.09431422959716874, "mean_env_wait_ms": 2.921864067314202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003743410110473633, "StateBufferConnector_ms": 0.0026345252990722656, "ViewRequirementAgentConnector_ms": 0.06849455833435059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84840, "num_agent_steps_trained": 84840, "num_env_steps_sampled": 84840, "num_env_steps_trained": 84840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.998767894689884, "num_env_steps_trained_throughput_per_sec": 38.998767894689884, "timesteps_total": 84840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 84840, "timers": {"training_iteration_time_ms": 3072.777, "sample_time_ms": 3069.026, "load_time_ms": 0.216, "load_throughput": 555108.062, "learn_time_ms": 2.775, "learn_throughput": 43246.564, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 84840, "num_env_steps_trained": 84840, "num_agent_steps_sampled": 84840, "num_agent_steps_trained": 84840}, "done": false, "episodes_total": 659, "training_iteration": 164, "trial_id": "668a1_00000", "date": "2023-07-25_18-21-49", "timestamp": 1690298509, "time_this_iter_s": 12.310759782791138, "time_total_s": 2009.7344236373901, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1954.3708198070526, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 24.42941176470588, "ram_util_percent": 74.92941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -37100228608.0, "vf_loss": 541691136.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 639.0, "diff_num_grad_updates_vs_sampler_policy": 638.0}}, "num_env_steps_sampled": 85320, "num_env_steps_trained": 85320, "num_agent_steps_sampled": 85320, "num_agent_steps_trained": 85320}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8533.972951243362, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15634414267474, "mean_inference_ms": 0.39200056689363705, "mean_action_processing_ms": 0.09431496559785618, "mean_env_wait_ms": 2.921677771762719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733396530151367, "StateBufferConnector_ms": 0.002634286880493164, "ViewRequirementAgentConnector_ms": 0.06841254234313965}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8533.972951243362, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8658.937226428889, -8517.261114461498, -8569.011804442209, -8478.175504989153, -8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15634414267474, "mean_inference_ms": 0.39200056689363705, "mean_action_processing_ms": 0.09431496559785618, "mean_env_wait_ms": 2.921677771762719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733396530151367, "StateBufferConnector_ms": 0.002634286880493164, "ViewRequirementAgentConnector_ms": 0.06841254234313965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85320, "num_agent_steps_trained": 85320, "num_env_steps_sampled": 85320, "num_env_steps_trained": 85320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.176106673209034, "num_env_steps_trained_throughput_per_sec": 39.176106673209034, "timesteps_total": 85320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 85320, "timers": {"training_iteration_time_ms": 3082.909, "sample_time_ms": 3079.199, "load_time_ms": 0.214, "load_throughput": 560548.48, "learn_time_ms": 2.743, "learn_throughput": 43744.588, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 85320, "num_env_steps_trained": 85320, "num_agent_steps_sampled": 85320, "num_agent_steps_trained": 85320}, "done": false, "episodes_total": 663, "training_iteration": 165, "trial_id": "668a1_00000", "date": "2023-07-25_18-22-01", "timestamp": 1690298521, "time_this_iter_s": 12.255146026611328, "time_total_s": 2021.9895696640015, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1966.625965833664, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 25.78235294117647, "ram_util_percent": 75.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -39259447296.0, "vf_loss": 572125312.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 643.0, "diff_num_grad_updates_vs_sampler_policy": 642.0}}, "num_env_steps_sampled": 85800, "num_env_steps_trained": 85800, "num_agent_steps_sampled": 85800, "num_agent_steps_trained": 85800}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8535.773878137388, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15634672265445, "mean_inference_ms": 0.3920062155752885, "mean_action_processing_ms": 0.09431570006516854, "mean_env_wait_ms": 2.921495949752252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037419795989990234, "StateBufferConnector_ms": 0.002655506134033203, "ViewRequirementAgentConnector_ms": 0.06855463981628418}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8535.773878137388, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8615.564597811232, -8485.078849983698, -8610.749605523248, -8511.358592269024, -8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15634672265445, "mean_inference_ms": 0.3920062155752885, "mean_action_processing_ms": 0.09431570006516854, "mean_env_wait_ms": 2.921495949752252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037419795989990234, "StateBufferConnector_ms": 0.002655506134033203, "ViewRequirementAgentConnector_ms": 0.06855463981628418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85800, "num_agent_steps_trained": 85800, "num_env_steps_sampled": 85800, "num_env_steps_trained": 85800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.133518349067444, "num_env_steps_trained_throughput_per_sec": 39.133518349067444, "timesteps_total": 85800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 85800, "timers": {"training_iteration_time_ms": 3074.717, "sample_time_ms": 3071.017, "load_time_ms": 0.214, "load_throughput": 560236.509, "learn_time_ms": 2.723, "learn_throughput": 44062.058, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 85800, "num_env_steps_trained": 85800, "num_agent_steps_sampled": 85800, "num_agent_steps_trained": 85800}, "done": false, "episodes_total": 667, "training_iteration": 166, "trial_id": "668a1_00000", "date": "2023-07-25_18-22-14", "timestamp": 1690298534, "time_this_iter_s": 12.268558025360107, "time_total_s": 2034.2581276893616, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1978.894523859024, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 21.988888888888884, "ram_util_percent": 75.27222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -39306534912.0, "vf_loss": 545678400.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 647.0, "diff_num_grad_updates_vs_sampler_policy": 646.0}}, "num_env_steps_sampled": 86280, "num_env_steps_trained": 86280, "num_agent_steps_sampled": 86280, "num_agent_steps_trained": 86280}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8533.919002878247, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15644151681002, "mean_inference_ms": 0.3920104605114274, "mean_action_processing_ms": 0.09431626913527723, "mean_env_wait_ms": 2.9212761600246893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735780715942383, "StateBufferConnector_ms": 0.0026531219482421875, "ViewRequirementAgentConnector_ms": 0.06848669052124023}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8533.919002878247, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8409.86852375653, -8364.970894887754, -8638.227528898959, -8510.38112537117, -8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15644151681002, "mean_inference_ms": 0.3920104605114274, "mean_action_processing_ms": 0.09431626913527723, "mean_env_wait_ms": 2.9212761600246893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735780715942383, "StateBufferConnector_ms": 0.0026531219482421875, "ViewRequirementAgentConnector_ms": 0.06848669052124023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86280, "num_agent_steps_trained": 86280, "num_env_steps_sampled": 86280, "num_env_steps_trained": 86280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.05879457898289, "num_env_steps_trained_throughput_per_sec": 39.05879457898289, "timesteps_total": 86280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 86280, "timers": {"training_iteration_time_ms": 3065.011, "sample_time_ms": 3061.32, "load_time_ms": 0.215, "load_throughput": 558805.907, "learn_time_ms": 2.721, "learn_throughput": 44098.347, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 86280, "num_env_steps_trained": 86280, "num_agent_steps_sampled": 86280, "num_agent_steps_trained": 86280}, "done": false, "episodes_total": 671, "training_iteration": 167, "trial_id": "668a1_00000", "date": "2023-07-25_18-22-26", "timestamp": 1690298546, "time_this_iter_s": 12.291980981826782, "time_total_s": 2046.5501086711884, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1991.1865048408508, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 23.488235294117647, "ram_util_percent": 75.20588235294119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -29979375616.0, "vf_loss": 570357376.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 651.0, "diff_num_grad_updates_vs_sampler_policy": 650.0}}, "num_env_steps_sampled": 86760, "num_env_steps_trained": 86760, "num_agent_steps_sampled": 86760, "num_agent_steps_trained": 86760}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8539.535875258392, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156514957624903, "mean_inference_ms": 0.3920132300453244, "mean_action_processing_ms": 0.09431652353480664, "mean_env_wait_ms": 2.9210796887976005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310123443603516, "StateBufferConnector_ms": 0.002655029296875, "ViewRequirementAgentConnector_ms": 0.06843352317810059}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8539.535875258392, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8489.460373693631, -8534.572587719449, -8467.386463892097, -8520.08377171235, -8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156514957624903, "mean_inference_ms": 0.3920132300453244, "mean_action_processing_ms": 0.09431652353480664, "mean_env_wait_ms": 2.9210796887976005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310123443603516, "StateBufferConnector_ms": 0.002655029296875, "ViewRequirementAgentConnector_ms": 0.06843352317810059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86760, "num_agent_steps_trained": 86760, "num_env_steps_sampled": 86760, "num_env_steps_trained": 86760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.66484513298767, "num_env_steps_trained_throughput_per_sec": 38.66484513298767, "timesteps_total": 86760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 86760, "timers": {"training_iteration_time_ms": 3074.478, "sample_time_ms": 3070.806, "load_time_ms": 0.213, "load_throughput": 563245.837, "learn_time_ms": 2.718, "learn_throughput": 44144.76, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 86760, "num_env_steps_trained": 86760, "num_agent_steps_sampled": 86760, "num_agent_steps_trained": 86760}, "done": false, "episodes_total": 675, "training_iteration": 168, "trial_id": "668a1_00000", "date": "2023-07-25_18-22-38", "timestamp": 1690298558, "time_this_iter_s": 12.417203903198242, "time_total_s": 2058.9673125743866, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2003.603708744049, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 24.26666666666667, "ram_util_percent": 75.07777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7948608398438, "policy_loss": -19121158144.0, "vf_loss": 563840768.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 655.0, "diff_num_grad_updates_vs_sampler_policy": 654.0}}, "num_env_steps_sampled": 87240, "num_env_steps_trained": 87240, "num_agent_steps_sampled": 87240, "num_agent_steps_trained": 87240}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8541.222061790288, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15664756668456, "mean_inference_ms": 0.39201679828846564, "mean_action_processing_ms": 0.09431702963090016, "mean_env_wait_ms": 2.920883319998907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037317276000976562, "StateBufferConnector_ms": 0.0026559829711914062, "ViewRequirementAgentConnector_ms": 0.06845474243164062}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8541.222061790288, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8521.429581909673, -8533.430524041141, -8553.842057754264, -8459.10153453481, -8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15664756668456, "mean_inference_ms": 0.39201679828846564, "mean_action_processing_ms": 0.09431702963090016, "mean_env_wait_ms": 2.920883319998907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037317276000976562, "StateBufferConnector_ms": 0.0026559829711914062, "ViewRequirementAgentConnector_ms": 0.06845474243164062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87240, "num_agent_steps_trained": 87240, "num_env_steps_sampled": 87240, "num_env_steps_trained": 87240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.30761278520833, "num_env_steps_trained_throughput_per_sec": 39.30761278520833, "timesteps_total": 87240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 87240, "timers": {"training_iteration_time_ms": 3081.823, "sample_time_ms": 3078.157, "load_time_ms": 0.213, "load_throughput": 564066.435, "learn_time_ms": 2.721, "learn_throughput": 44100.665, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 87240, "num_env_steps_trained": 87240, "num_agent_steps_sampled": 87240, "num_agent_steps_trained": 87240}, "done": false, "episodes_total": 679, "training_iteration": 169, "trial_id": "668a1_00000", "date": "2023-07-25_18-22-51", "timestamp": 1690298571, "time_this_iter_s": 12.21396517753601, "time_total_s": 2071.1812777519226, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2015.817673921585, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 25.2, "ram_util_percent": 75.0529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -26898481152.0, "vf_loss": 556880128.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 659.0, "diff_num_grad_updates_vs_sampler_policy": 658.0}}, "num_env_steps_sampled": 87720, "num_env_steps_trained": 87720, "num_agent_steps_sampled": 87720, "num_agent_steps_trained": 87720}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8542.57609096071, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156770206418933, "mean_inference_ms": 0.3920189598649666, "mean_action_processing_ms": 0.09431718008697473, "mean_env_wait_ms": 2.920646453301325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037260055541992188, "StateBufferConnector_ms": 0.002656221389770508, "ViewRequirementAgentConnector_ms": 0.06839609146118164}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8542.57609096071, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8524.468617239741, -8546.040438741446, -8417.32293241542, -8661.637072250587, -8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156770206418933, "mean_inference_ms": 0.3920189598649666, "mean_action_processing_ms": 0.09431718008697473, "mean_env_wait_ms": 2.920646453301325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037260055541992188, "StateBufferConnector_ms": 0.002656221389770508, "ViewRequirementAgentConnector_ms": 0.06839609146118164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87720, "num_agent_steps_trained": 87720, "num_env_steps_sampled": 87720, "num_env_steps_trained": 87720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.926341020937286, "num_env_steps_trained_throughput_per_sec": 38.926341020937286, "timesteps_total": 87720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 87720, "timers": {"training_iteration_time_ms": 3083.809, "sample_time_ms": 3080.133, "load_time_ms": 0.214, "load_throughput": 561423.848, "learn_time_ms": 2.723, "learn_throughput": 44062.829, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 87720, "num_env_steps_trained": 87720, "num_agent_steps_sampled": 87720, "num_agent_steps_trained": 87720}, "done": false, "episodes_total": 683, "training_iteration": 170, "trial_id": "668a1_00000", "date": "2023-07-25_18-23-03", "timestamp": 1690298583, "time_this_iter_s": 12.333889961242676, "time_total_s": 2083.5151677131653, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2028.1515638828278, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 25.311111111111114, "ram_util_percent": 75.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -24225816576.0, "vf_loss": 573195392.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 663.0, "diff_num_grad_updates_vs_sampler_policy": 662.0}}, "num_env_steps_sampled": 88200, "num_env_steps_trained": 88200, "num_agent_steps_sampled": 88200, "num_agent_steps_trained": 88200}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8542.758048039976, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156909575471627, "mean_inference_ms": 0.3920210990111627, "mean_action_processing_ms": 0.09431739514330925, "mean_env_wait_ms": 2.9204028260481167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003721475601196289, "StateBufferConnector_ms": 0.002650737762451172, "ViewRequirementAgentConnector_ms": 0.06831073760986328}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8542.758048039976, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8595.390223314396, -8580.862578261995, -8746.53646322072, -8760.900715070133, -8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.156909575471627, "mean_inference_ms": 0.3920210990111627, "mean_action_processing_ms": 0.09431739514330925, "mean_env_wait_ms": 2.9204028260481167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003721475601196289, "StateBufferConnector_ms": 0.002650737762451172, "ViewRequirementAgentConnector_ms": 0.06831073760986328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88200, "num_agent_steps_trained": 88200, "num_env_steps_sampled": 88200, "num_env_steps_trained": 88200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.16990155061387, "num_env_steps_trained_throughput_per_sec": 39.16990155061387, "timesteps_total": 88200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 88200, "timers": {"training_iteration_time_ms": 3069.352, "sample_time_ms": 3065.634, "load_time_ms": 0.216, "load_throughput": 554435.426, "learn_time_ms": 2.748, "learn_throughput": 43667.923, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 88200, "num_env_steps_trained": 88200, "num_agent_steps_sampled": 88200, "num_agent_steps_trained": 88200}, "done": false, "episodes_total": 687, "training_iteration": 171, "trial_id": "668a1_00000", "date": "2023-07-25_18-23-15", "timestamp": 1690298595, "time_this_iter_s": 12.257094860076904, "time_total_s": 2095.772262573242, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2040.4086587429047, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 25.011764705882353, "ram_util_percent": 75.2235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947387695312, "policy_loss": -22997731328.0, "vf_loss": 540180480.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 667.0, "diff_num_grad_updates_vs_sampler_policy": 666.0}}, "num_env_steps_sampled": 88680, "num_env_steps_trained": 88680, "num_agent_steps_sampled": 88680, "num_agent_steps_trained": 88680}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.306187126353, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.157237640716684, "mean_inference_ms": 0.39202110078523533, "mean_action_processing_ms": 0.09431734050231202, "mean_env_wait_ms": 2.920239068627645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.0026650428771972656, "ViewRequirementAgentConnector_ms": 0.06831073760986328}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.306187126353, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8414.998650806265, -8525.27644702109, -8573.951430390673, -8458.051811856392, -8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.157237640716684, "mean_inference_ms": 0.39202110078523533, "mean_action_processing_ms": 0.09431734050231202, "mean_env_wait_ms": 2.920239068627645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.0026650428771972656, "ViewRequirementAgentConnector_ms": 0.06831073760986328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88680, "num_agent_steps_trained": 88680, "num_env_steps_sampled": 88680, "num_env_steps_trained": 88680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.02821222424947, "num_env_steps_trained_throughput_per_sec": 38.02821222424947, "timesteps_total": 88680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 88680, "timers": {"training_iteration_time_ms": 3089.392, "sample_time_ms": 3085.639, "load_time_ms": 0.217, "load_throughput": 553642.592, "learn_time_ms": 2.774, "learn_throughput": 43259.945, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 88680, "num_env_steps_trained": 88680, "num_agent_steps_sampled": 88680, "num_agent_steps_trained": 88680}, "done": false, "episodes_total": 691, "training_iteration": 172, "trial_id": "668a1_00000", "date": "2023-07-25_18-23-28", "timestamp": 1690298608, "time_this_iter_s": 12.624950885772705, "time_total_s": 2108.397213459015, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2053.0336096286774, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 24.21666666666667, "ram_util_percent": 75.17777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -19834521600.0, "vf_loss": 552889600.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 671.0, "diff_num_grad_updates_vs_sampler_policy": 670.0}}, "num_env_steps_sampled": 89160, "num_env_steps_trained": 89160, "num_agent_steps_sampled": 89160, "num_agent_steps_trained": 89160}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.874000443482, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.157449862673733, "mean_inference_ms": 0.39202148805471154, "mean_action_processing_ms": 0.0943172908632856, "mean_env_wait_ms": 2.9200755273046934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718137741088867, "StateBufferConnector_ms": 0.0026733875274658203, "ViewRequirementAgentConnector_ms": 0.06844854354858398}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.874000443482, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8431.569014889783, -8424.335113129426, -8548.147800953087, -8613.77626965569, -8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.157449862673733, "mean_inference_ms": 0.39202148805471154, "mean_action_processing_ms": 0.0943172908632856, "mean_env_wait_ms": 2.9200755273046934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718137741088867, "StateBufferConnector_ms": 0.0026733875274658203, "ViewRequirementAgentConnector_ms": 0.06844854354858398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89160, "num_agent_steps_trained": 89160, "num_env_steps_sampled": 89160, "num_env_steps_trained": 89160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.3691328454122, "num_env_steps_trained_throughput_per_sec": 39.3691328454122, "timesteps_total": 89160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 89160, "timers": {"training_iteration_time_ms": 3089.949, "sample_time_ms": 3086.194, "load_time_ms": 0.217, "load_throughput": 554069.221, "learn_time_ms": 2.78, "learn_throughput": 43162.377, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 89160, "num_env_steps_trained": 89160, "num_agent_steps_sampled": 89160, "num_agent_steps_trained": 89160}, "done": false, "episodes_total": 695, "training_iteration": 173, "trial_id": "668a1_00000", "date": "2023-07-25_18-23-40", "timestamp": 1690298620, "time_this_iter_s": 12.195005893707275, "time_total_s": 2120.592219352722, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2065.2286155223846, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 25.817647058823532, "ram_util_percent": 75.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -21774313472.0, "vf_loss": 549799680.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 675.0, "diff_num_grad_updates_vs_sampler_policy": 674.0}}, "num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8538.940307888453, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15770966276243, "mean_inference_ms": 0.3920214313227565, "mean_action_processing_ms": 0.09431727984355465, "mean_env_wait_ms": 2.9198911912562746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037186145782470703, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.0684363842010498}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8538.940307888453, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8451.526218369203, -8408.33503351587, -8448.678636084378, -8558.819682362806, -8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15770966276243, "mean_inference_ms": 0.3920214313227565, "mean_action_processing_ms": 0.09431727984355465, "mean_env_wait_ms": 2.9198911912562746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037186145782470703, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.0684363842010498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640, "num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.05726243124196, "num_env_steps_trained_throughput_per_sec": 39.05726243124196, "timesteps_total": 89640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 89640, "timers": {"training_iteration_time_ms": 3090.44, "sample_time_ms": 3086.742, "load_time_ms": 0.213, "load_throughput": 562679.128, "learn_time_ms": 2.733, "learn_throughput": 43901.792, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 89640, "num_env_steps_trained": 89640, "num_agent_steps_sampled": 89640, "num_agent_steps_trained": 89640}, "done": false, "episodes_total": 699, "training_iteration": 174, "trial_id": "668a1_00000", "date": "2023-07-25_18-23-52", "timestamp": 1690298632, "time_this_iter_s": 12.292360067367554, "time_total_s": 2132.8845794200897, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2077.520975589752, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 27.155555555555555, "ram_util_percent": 75.37222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952270507812, "policy_loss": -13273850880.0, "vf_loss": 547311744.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 679.0, "diff_num_grad_updates_vs_sampler_policy": 678.0}}, "num_env_steps_sampled": 90120, "num_env_steps_trained": 90120, "num_agent_steps_sampled": 90120, "num_agent_steps_trained": 90120}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8539.4234771249, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.157967651305817, "mean_inference_ms": 0.39202283292529105, "mean_action_processing_ms": 0.09431770760442611, "mean_env_wait_ms": 2.919696337583049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003709554672241211, "StateBufferConnector_ms": 0.0026769638061523438, "ViewRequirementAgentConnector_ms": 0.06842184066772461}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8539.4234771249, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8519.679548715045, -8427.760364812737, -8502.037344543694, -8627.680059339664, -8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.157967651305817, "mean_inference_ms": 0.39202283292529105, "mean_action_processing_ms": 0.09431770760442611, "mean_env_wait_ms": 2.919696337583049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003709554672241211, "StateBufferConnector_ms": 0.0026769638061523438, "ViewRequirementAgentConnector_ms": 0.06842184066772461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90120, "num_agent_steps_trained": 90120, "num_env_steps_sampled": 90120, "num_env_steps_trained": 90120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.76247551721142, "num_env_steps_trained_throughput_per_sec": 38.76247551721142, "timesteps_total": 90120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 90120, "timers": {"training_iteration_time_ms": 3096.27, "sample_time_ms": 3092.552, "load_time_ms": 0.212, "load_throughput": 564762.657, "learn_time_ms": 2.735, "learn_throughput": 43877.298, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 90120, "num_env_steps_trained": 90120, "num_agent_steps_sampled": 90120, "num_agent_steps_trained": 90120}, "done": false, "episodes_total": 703, "training_iteration": 175, "trial_id": "668a1_00000", "date": "2023-07-25_18-24-05", "timestamp": 1690298645, "time_this_iter_s": 12.385860204696655, "time_total_s": 2145.2704396247864, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2089.906835794449, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 24.599999999999998, "ram_util_percent": 75.22352941176472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -13610685440.0, "vf_loss": 565376512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 682.0}}, "num_env_steps_sampled": 90600, "num_env_steps_trained": 90600, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90600}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8539.89467880118, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.158308427009125, "mean_inference_ms": 0.39202029787266296, "mean_action_processing_ms": 0.09431746379382261, "mean_env_wait_ms": 2.9194950705948735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037000179290771484, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06841659545898438}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8539.89467880118, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8495.8961020747, -8560.666300121266, -8482.869623458264, -8586.25531304863, -8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.158308427009125, "mean_inference_ms": 0.39202029787266296, "mean_action_processing_ms": 0.09431746379382261, "mean_env_wait_ms": 2.9194950705948735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037000179290771484, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06841659545898438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90600, "num_env_steps_sampled": 90600, "num_env_steps_trained": 90600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.84148810350528, "num_env_steps_trained_throughput_per_sec": 38.84148810350528, "timesteps_total": 90600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 90600, "timers": {"training_iteration_time_ms": 3082.387, "sample_time_ms": 3078.69, "load_time_ms": 0.213, "load_throughput": 564319.408, "learn_time_ms": 2.725, "learn_throughput": 44044.707, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 90600, "num_env_steps_trained": 90600, "num_agent_steps_sampled": 90600, "num_agent_steps_trained": 90600}, "done": false, "episodes_total": 707, "training_iteration": 176, "trial_id": "668a1_00000", "date": "2023-07-25_18-24-17", "timestamp": 1690298657, "time_this_iter_s": 12.360728979110718, "time_total_s": 2157.631168603897, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2102.2675647735596, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 24.31666666666667, "ram_util_percent": 75.24444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -10878745600.0, "vf_loss": 553540800.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 687.0, "diff_num_grad_updates_vs_sampler_policy": 686.0}}, "num_env_steps_sampled": 91080, "num_env_steps_trained": 91080, "num_agent_steps_sampled": 91080, "num_agent_steps_trained": 91080}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.280207560956, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.158652243298256, "mean_inference_ms": 0.39201767886204364, "mean_action_processing_ms": 0.0943171824858582, "mean_env_wait_ms": 2.9193158850025656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037059783935546875, "StateBufferConnector_ms": 0.002697467803955078, "ViewRequirementAgentConnector_ms": 0.06853699684143066}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.280207560956, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8541.258202115925, -8625.456797549468, -8533.633925489154, -8601.193107816935, -8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.158652243298256, "mean_inference_ms": 0.39201767886204364, "mean_action_processing_ms": 0.0943171824858582, "mean_env_wait_ms": 2.9193158850025656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037059783935546875, "StateBufferConnector_ms": 0.002697467803955078, "ViewRequirementAgentConnector_ms": 0.06853699684143066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91080, "num_agent_steps_trained": 91080, "num_env_steps_sampled": 91080, "num_env_steps_trained": 91080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.764792215810154, "num_env_steps_trained_throughput_per_sec": 38.764792215810154, "timesteps_total": 91080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 91080, "timers": {"training_iteration_time_ms": 3073.803, "sample_time_ms": 3070.01, "load_time_ms": 0.216, "load_throughput": 555169.292, "learn_time_ms": 2.773, "learn_throughput": 43278.172, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 91080, "num_env_steps_trained": 91080, "num_agent_steps_sampled": 91080, "num_agent_steps_trained": 91080}, "done": false, "episodes_total": 711, "training_iteration": 177, "trial_id": "668a1_00000", "date": "2023-07-25_18-24-30", "timestamp": 1690298670, "time_this_iter_s": 12.385167837142944, "time_total_s": 2170.01633644104, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2114.6527326107025, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 23.735294117647054, "ram_util_percent": 75.11764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -12861056000.0, "vf_loss": 564266368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 691.0, "diff_num_grad_updates_vs_sampler_policy": 690.0}}, "num_env_steps_sampled": 91560, "num_env_steps_trained": 91560, "num_agent_steps_sampled": 91560, "num_agent_steps_trained": 91560}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8533.13125653144, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.159049928232616, "mean_inference_ms": 0.3920163018341394, "mean_action_processing_ms": 0.09431703704167013, "mean_env_wait_ms": 2.919171487481486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037038326263427734, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06855034828186035}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8533.13125653144, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8517.337068716468, -8587.194799987174, -8665.205815432928, -8464.787568715738, -8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.159049928232616, "mean_inference_ms": 0.3920163018341394, "mean_action_processing_ms": 0.09431703704167013, "mean_env_wait_ms": 2.919171487481486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037038326263427734, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06855034828186035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91560, "num_agent_steps_trained": 91560, "num_env_steps_sampled": 91560, "num_env_steps_trained": 91560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.4165538623708, "num_env_steps_trained_throughput_per_sec": 39.4165538623708, "timesteps_total": 91560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 91560, "timers": {"training_iteration_time_ms": 3081.789, "sample_time_ms": 3078.001, "load_time_ms": 0.216, "load_throughput": 555536.954, "learn_time_ms": 2.785, "learn_throughput": 43083.68, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 91560, "num_env_steps_trained": 91560, "num_agent_steps_sampled": 91560, "num_agent_steps_trained": 91560}, "done": false, "episodes_total": 715, "training_iteration": 178, "trial_id": "668a1_00000", "date": "2023-07-25_18-24-42", "timestamp": 1690298682, "time_this_iter_s": 12.180281162261963, "time_total_s": 2182.196617603302, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2126.8330137729645, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 26.45294117647059, "ram_util_percent": 75.14117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7944946289062, "policy_loss": -18334986240.0, "vf_loss": 562817152.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 695.0, "diff_num_grad_updates_vs_sampler_policy": 694.0}}, "num_env_steps_sampled": 92040, "num_env_steps_trained": 92040, "num_agent_steps_sampled": 92040, "num_agent_steps_trained": 92040}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8533.865922081079, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.159389648671077, "mean_inference_ms": 0.3920143017223512, "mean_action_processing_ms": 0.09431664812434366, "mean_env_wait_ms": 2.91899369489583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370025634765625, "StateBufferConnector_ms": 0.002700328826904297, "ViewRequirementAgentConnector_ms": 0.06854677200317383}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8533.865922081079, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8518.961763596262, -8583.576809461076, -8587.7019748103, -8620.282500847425, -8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.159389648671077, "mean_inference_ms": 0.3920143017223512, "mean_action_processing_ms": 0.09431664812434366, "mean_env_wait_ms": 2.91899369489583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370025634765625, "StateBufferConnector_ms": 0.002700328826904297, "ViewRequirementAgentConnector_ms": 0.06854677200317383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92040, "num_agent_steps_trained": 92040, "num_env_steps_sampled": 92040, "num_env_steps_trained": 92040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.06373054871529, "num_env_steps_trained_throughput_per_sec": 39.06373054871529, "timesteps_total": 92040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 92040, "timers": {"training_iteration_time_ms": 3070.973, "sample_time_ms": 3067.262, "load_time_ms": 0.215, "load_throughput": 558805.907, "learn_time_ms": 2.747, "learn_throughput": 43684.979, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 92040, "num_env_steps_trained": 92040, "num_agent_steps_sampled": 92040, "num_agent_steps_trained": 92040}, "done": false, "episodes_total": 719, "training_iteration": 179, "trial_id": "668a1_00000", "date": "2023-07-25_18-24-54", "timestamp": 1690298694, "time_this_iter_s": 12.290526151657104, "time_total_s": 2194.487143754959, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2139.1235399246216, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 25.744444444444444, "ram_util_percent": 75.07777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -37908160512.0, "vf_loss": 557607360.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 699.0, "diff_num_grad_updates_vs_sampler_policy": 698.0}}, "num_env_steps_sampled": 92520, "num_env_steps_trained": 92520, "num_agent_steps_sampled": 92520, "num_agent_steps_trained": 92520}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8536.477485303096, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15967200081525, "mean_inference_ms": 0.39201251187906405, "mean_action_processing_ms": 0.09431627953148965, "mean_env_wait_ms": 2.918782752693817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037031173706054688, "StateBufferConnector_ms": 0.0026934146881103516, "ViewRequirementAgentConnector_ms": 0.06852912902832031}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8536.477485303096, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8520.688158918063, -8654.251110665098, -8515.000385679572, -8403.722104498593, -8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.15967200081525, "mean_inference_ms": 0.39201251187906405, "mean_action_processing_ms": 0.09431627953148965, "mean_env_wait_ms": 2.918782752693817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037031173706054688, "StateBufferConnector_ms": 0.0026934146881103516, "ViewRequirementAgentConnector_ms": 0.06852912902832031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92520, "num_agent_steps_trained": 92520, "num_env_steps_sampled": 92520, "num_env_steps_trained": 92520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.03280375613098, "num_env_steps_trained_throughput_per_sec": 39.03280375613098, "timesteps_total": 92520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 92520, "timers": {"training_iteration_time_ms": 3066.351, "sample_time_ms": 3062.663, "load_time_ms": 0.214, "load_throughput": 560860.798, "learn_time_ms": 2.728, "learn_throughput": 43988.89, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 92520, "num_env_steps_trained": 92520, "num_agent_steps_sampled": 92520, "num_agent_steps_trained": 92520}, "done": false, "episodes_total": 723, "training_iteration": 180, "trial_id": "668a1_00000", "date": "2023-07-25_18-25-06", "timestamp": 1690298706, "time_this_iter_s": 12.300128936767578, "time_total_s": 2206.7872726917267, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2151.423668861389, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 24.66470588235294, "ram_util_percent": 75.17647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -25745410048.0, "vf_loss": 566802880.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 703.0, "diff_num_grad_updates_vs_sampler_policy": 702.0}}, "num_env_steps_sampled": 93000, "num_env_steps_trained": 93000, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 93000}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.844100596605, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.160101548698748, "mean_inference_ms": 0.39200897089099357, "mean_action_processing_ms": 0.09431553057433209, "mean_env_wait_ms": 2.9185681251277242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0026912689208984375, "ViewRequirementAgentConnector_ms": 0.06845664978027344}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8835.810575605055, "episode_reward_mean": -8537.844100596605, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8454.241092566936, -8607.219528074684, -8754.402949389165, -8835.810575605055, -8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.160101548698748, "mean_inference_ms": 0.39200897089099357, "mean_action_processing_ms": 0.09431553057433209, "mean_env_wait_ms": 2.9185681251277242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0026912689208984375, "ViewRequirementAgentConnector_ms": 0.06845664978027344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 93000, "num_env_steps_sampled": 93000, "num_env_steps_trained": 93000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.89688476332826, "num_env_steps_trained_throughput_per_sec": 38.89688476332826, "timesteps_total": 93000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 93000, "timers": {"training_iteration_time_ms": 3069.714, "sample_time_ms": 3066.004, "load_time_ms": 0.219, "load_throughput": 548932.795, "learn_time_ms": 2.739, "learn_throughput": 43815.419, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 93000, "num_env_steps_trained": 93000, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 93000}, "done": false, "episodes_total": 727, "training_iteration": 181, "trial_id": "668a1_00000", "date": "2023-07-25_18-25-19", "timestamp": 1690298719, "time_this_iter_s": 12.343008995056152, "time_total_s": 2219.130281686783, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2163.7666778564453, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 24.061111111111114, "ram_util_percent": 75.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -15208650752.0, "vf_loss": 550092032.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 707.0, "diff_num_grad_updates_vs_sampler_policy": 706.0}}, "num_env_steps_sampled": 93480, "num_env_steps_trained": 93480, "num_agent_steps_sampled": 93480, "num_agent_steps_trained": 93480}, "sampler_results": {"episode_reward_max": -8332.240482983736, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8534.643423268977, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16037195480354, "mean_inference_ms": 0.39200517336198054, "mean_action_processing_ms": 0.0943147573750461, "mean_env_wait_ms": 2.9183916730552375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06844139099121094}}, "episode_reward_max": -8332.240482983736, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8534.643423268977, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8543.327994503801, -8473.196390141968, -8332.240482983736, -8639.506898962785, -8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16037195480354, "mean_inference_ms": 0.39200517336198054, "mean_action_processing_ms": 0.0943147573750461, "mean_env_wait_ms": 2.9183916730552375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06844139099121094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93480, "num_agent_steps_trained": 93480, "num_env_steps_sampled": 93480, "num_env_steps_trained": 93480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.40939134665675, "num_env_steps_trained_throughput_per_sec": 39.40939134665675, "timesteps_total": 93480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 93480, "timers": {"training_iteration_time_ms": 3056.945, "sample_time_ms": 3053.237, "load_time_ms": 0.219, "load_throughput": 547559.269, "learn_time_ms": 2.742, "learn_throughput": 43765.889, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 93480, "num_env_steps_trained": 93480, "num_agent_steps_sampled": 93480, "num_agent_steps_trained": 93480}, "done": false, "episodes_total": 731, "training_iteration": 182, "trial_id": "668a1_00000", "date": "2023-07-25_18-25-31", "timestamp": 1690298731, "time_this_iter_s": 12.182536840438843, "time_total_s": 2231.3128185272217, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2175.949214696884, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 24.752941176470586, "ram_util_percent": 75.37647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -20690059264.0, "vf_loss": 547284608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 711.0, "diff_num_grad_updates_vs_sampler_policy": 710.0}}, "num_env_steps_sampled": 93960, "num_env_steps_trained": 93960, "num_agent_steps_sampled": 93960, "num_agent_steps_trained": 93960}, "sampler_results": {"episode_reward_max": -8341.996351658614, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8537.990775349905, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.160562059766498, "mean_inference_ms": 0.3920043683380272, "mean_action_processing_ms": 0.09431446594593479, "mean_env_wait_ms": 2.918139012875953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002696990966796875, "ViewRequirementAgentConnector_ms": 0.06846475601196289}}, "episode_reward_max": -8341.996351658614, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8537.990775349905, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8599.383221918266, -8483.908622686193, -8372.9078144512, -8626.620792626427, -8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.160562059766498, "mean_inference_ms": 0.3920043683380272, "mean_action_processing_ms": 0.09431446594593479, "mean_env_wait_ms": 2.918139012875953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002696990966796875, "ViewRequirementAgentConnector_ms": 0.06846475601196289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93960, "num_agent_steps_trained": 93960, "num_env_steps_sampled": 93960, "num_env_steps_trained": 93960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.77109414891776, "num_env_steps_trained_throughput_per_sec": 39.77109414891776, "timesteps_total": 93960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 93960, "timers": {"training_iteration_time_ms": 3057.913, "sample_time_ms": 3054.21, "load_time_ms": 0.214, "load_throughput": 559489.195, "learn_time_ms": 2.74, "learn_throughput": 43797.499, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 93960, "num_env_steps_trained": 93960, "num_agent_steps_sampled": 93960, "num_agent_steps_trained": 93960}, "done": false, "episodes_total": 735, "training_iteration": 183, "trial_id": "668a1_00000", "date": "2023-07-25_18-25-43", "timestamp": 1690298743, "time_this_iter_s": 12.071812868118286, "time_total_s": 2243.38463139534, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2188.0210275650024, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 25.47647058823529, "ram_util_percent": 75.41176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947387695312, "policy_loss": -27538831360.0, "vf_loss": 567397504.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 715.0, "diff_num_grad_updates_vs_sampler_policy": 714.0}}, "num_env_steps_sampled": 94440, "num_env_steps_trained": 94440, "num_agent_steps_sampled": 94440, "num_agent_steps_trained": 94440}, "sampler_results": {"episode_reward_max": -8341.996351658614, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8537.450322760975, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.160699672797804, "mean_inference_ms": 0.39200351873179246, "mean_action_processing_ms": 0.09431422000608457, "mean_env_wait_ms": 2.9178859703980664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.002696514129638672, "ViewRequirementAgentConnector_ms": 0.06855154037475586}}, "episode_reward_max": -8341.996351658614, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8537.450322760975, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8511.54231809204, -8705.75230836502, -8549.883045580289, -8467.365628647203, -8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.160699672797804, "mean_inference_ms": 0.39200351873179246, "mean_action_processing_ms": 0.09431422000608457, "mean_env_wait_ms": 2.9178859703980664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.002696514129638672, "ViewRequirementAgentConnector_ms": 0.06855154037475586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94440, "num_agent_steps_trained": 94440, "num_env_steps_sampled": 94440, "num_env_steps_trained": 94440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.81735572575908, "num_env_steps_trained_throughput_per_sec": 38.81735572575908, "timesteps_total": 94440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 94440, "timers": {"training_iteration_time_ms": 3058.675, "sample_time_ms": 3054.931, "load_time_ms": 0.215, "load_throughput": 558186.182, "learn_time_ms": 2.771, "learn_throughput": 43309.826, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 94440, "num_env_steps_trained": 94440, "num_agent_steps_sampled": 94440, "num_agent_steps_trained": 94440}, "done": false, "episodes_total": 739, "training_iteration": 184, "trial_id": "668a1_00000", "date": "2023-07-25_18-25-56", "timestamp": 1690298756, "time_this_iter_s": 12.368484735488892, "time_total_s": 2255.753116130829, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2200.3895123004913, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 23.450000000000003, "ram_util_percent": 75.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -19000958976.0, "vf_loss": 559286848.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 719.0, "diff_num_grad_updates_vs_sampler_policy": 718.0}}, "num_env_steps_sampled": 94920, "num_env_steps_trained": 94920, "num_agent_steps_sampled": 94920, "num_agent_steps_trained": 94920}, "sampler_results": {"episode_reward_max": -8341.996351658614, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8537.144821394217, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16090196964197, "mean_inference_ms": 0.39199997883818083, "mean_action_processing_ms": 0.09431365414188399, "mean_env_wait_ms": 2.917621185196725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037076473236083984, "StateBufferConnector_ms": 0.002690553665161133, "ViewRequirementAgentConnector_ms": 0.06860232353210449}}, "episode_reward_max": -8341.996351658614, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8537.144821394217, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8341.996351658614, -8559.142113042968, -8467.152969290191, -8451.697443111783, -8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16090196964197, "mean_inference_ms": 0.39199997883818083, "mean_action_processing_ms": 0.09431365414188399, "mean_env_wait_ms": 2.917621185196725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037076473236083984, "StateBufferConnector_ms": 0.002690553665161133, "ViewRequirementAgentConnector_ms": 0.06860232353210449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94920, "num_agent_steps_trained": 94920, "num_env_steps_sampled": 94920, "num_env_steps_trained": 94920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.20920894680759, "num_env_steps_trained_throughput_per_sec": 39.20920894680759, "timesteps_total": 94920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 94920, "timers": {"training_iteration_time_ms": 3056.677, "sample_time_ms": 3052.941, "load_time_ms": 0.214, "load_throughput": 560111.818, "learn_time_ms": 2.769, "learn_throughput": 43342.273, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 94920, "num_env_steps_trained": 94920, "num_agent_steps_sampled": 94920, "num_agent_steps_trained": 94920}, "done": false, "episodes_total": 743, "training_iteration": 185, "trial_id": "668a1_00000", "date": "2023-07-25_18-26-08", "timestamp": 1690298768, "time_this_iter_s": 12.244793891906738, "time_total_s": 2267.9979100227356, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2212.634306192398, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 24.394117647058824, "ram_util_percent": 75.37647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7939453125, "policy_loss": -31649484800.0, "vf_loss": 579382656.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 723.0, "diff_num_grad_updates_vs_sampler_policy": 722.0}}, "num_env_steps_sampled": 95400, "num_env_steps_trained": 95400, "num_agent_steps_sampled": 95400, "num_agent_steps_trained": 95400}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8543.585190964499, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161031442421702, "mean_inference_ms": 0.39199642950596375, "mean_action_processing_ms": 0.09431308013909045, "mean_env_wait_ms": 2.9173850795369076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002685546875, "ViewRequirementAgentConnector_ms": 0.06848597526550293}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8833.390237451962, "episode_reward_mean": -8543.585190964499, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8642.882805818792, -8431.277102422948, -8833.390237451962, -8480.036710619974, -8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161031442421702, "mean_inference_ms": 0.39199642950596375, "mean_action_processing_ms": 0.09431308013909045, "mean_env_wait_ms": 2.9173850795369076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002685546875, "ViewRequirementAgentConnector_ms": 0.06848597526550293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95400, "num_agent_steps_trained": 95400, "num_env_steps_sampled": 95400, "num_env_steps_trained": 95400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.15969531051161, "num_env_steps_trained_throughput_per_sec": 39.15969531051161, "timesteps_total": 95400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 95400, "timers": {"training_iteration_time_ms": 3053.764, "sample_time_ms": 3050.037, "load_time_ms": 0.214, "load_throughput": 561486.479, "learn_time_ms": 2.769, "learn_throughput": 43330.706, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 95400, "num_env_steps_trained": 95400, "num_agent_steps_sampled": 95400, "num_agent_steps_trained": 95400}, "done": false, "episodes_total": 747, "training_iteration": 186, "trial_id": "668a1_00000", "date": "2023-07-25_18-26-20", "timestamp": 1690298780, "time_this_iter_s": 12.26015305519104, "time_total_s": 2280.2580630779266, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2224.894459247589, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 24.51764705882353, "ram_util_percent": 75.51176470588237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7942504882812, "policy_loss": -22376912896.0, "vf_loss": 558952704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 727.0, "diff_num_grad_updates_vs_sampler_policy": 726.0}}, "num_env_steps_sampled": 95880, "num_env_steps_trained": 95880, "num_agent_steps_sampled": 95880, "num_agent_steps_trained": 95880}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8539.793312563179, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161015788959777, "mean_inference_ms": 0.39199586337742426, "mean_action_processing_ms": 0.09431295831586077, "mean_env_wait_ms": 2.9171350255211608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037004947662353516, "StateBufferConnector_ms": 0.0026903152465820312, "ViewRequirementAgentConnector_ms": 0.06844139099121094}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8539.793312563179, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8637.796942281384, -8563.884989957853, -8467.736986928487, -8401.203155127376, -8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161015788959777, "mean_inference_ms": 0.39199586337742426, "mean_action_processing_ms": 0.09431295831586077, "mean_env_wait_ms": 2.9171350255211608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037004947662353516, "StateBufferConnector_ms": 0.0026903152465820312, "ViewRequirementAgentConnector_ms": 0.06844139099121094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95880, "num_agent_steps_trained": 95880, "num_env_steps_sampled": 95880, "num_env_steps_trained": 95880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.94052524395815, "num_env_steps_trained_throughput_per_sec": 39.94052524395815, "timesteps_total": 95880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 95880, "timers": {"training_iteration_time_ms": 3044.775, "sample_time_ms": 3041.075, "load_time_ms": 0.214, "load_throughput": 560111.818, "learn_time_ms": 2.748, "learn_throughput": 43660.347, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 95880, "num_env_steps_trained": 95880, "num_agent_steps_sampled": 95880, "num_agent_steps_trained": 95880}, "done": false, "episodes_total": 751, "training_iteration": 187, "trial_id": "668a1_00000", "date": "2023-07-25_18-26-32", "timestamp": 1690298792, "time_this_iter_s": 12.020557165145874, "time_total_s": 2292.2786202430725, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2236.915016412735, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 27.61764705882353, "ram_util_percent": 75.36470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -41145495552.0, "vf_loss": 557609216.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 731.0, "diff_num_grad_updates_vs_sampler_policy": 730.0}}, "num_env_steps_sampled": 96360, "num_env_steps_trained": 96360, "num_agent_steps_sampled": 96360, "num_agent_steps_trained": 96360}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8542.448203202895, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161084159642495, "mean_inference_ms": 0.3919955720185327, "mean_action_processing_ms": 0.09431289980306207, "mean_env_wait_ms": 2.9168408200533262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702402114868164, "StateBufferConnector_ms": 0.002684354782104492, "ViewRequirementAgentConnector_ms": 0.06849789619445801}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8542.448203202895, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8510.015600207837, -8451.056295727753, -8577.047476383435, -8569.81801870325, -8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161084159642495, "mean_inference_ms": 0.3919955720185327, "mean_action_processing_ms": 0.09431289980306207, "mean_env_wait_ms": 2.9168408200533262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702402114868164, "StateBufferConnector_ms": 0.002684354782104492, "ViewRequirementAgentConnector_ms": 0.06849789619445801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96360, "num_agent_steps_trained": 96360, "num_env_steps_sampled": 96360, "num_env_steps_trained": 96360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.68344182896979, "num_env_steps_trained_throughput_per_sec": 38.68344182896979, "timesteps_total": 96360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 96360, "timers": {"training_iteration_time_ms": 3073.393, "sample_time_ms": 3069.692, "load_time_ms": 0.214, "load_throughput": 559800.334, "learn_time_ms": 2.739, "learn_throughput": 43811.986, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 96360, "num_env_steps_trained": 96360, "num_agent_steps_sampled": 96360, "num_agent_steps_trained": 96360}, "done": false, "episodes_total": 755, "training_iteration": 188, "trial_id": "668a1_00000", "date": "2023-07-25_18-26-45", "timestamp": 1690298805, "time_this_iter_s": 12.41115689277649, "time_total_s": 2304.689777135849, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2249.3261733055115, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 24.27777777777778, "ram_util_percent": 75.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -13662871552.0, "vf_loss": 562520000.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 735.0, "diff_num_grad_updates_vs_sampler_policy": 734.0}}, "num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8541.430333905084, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161214658094476, "mean_inference_ms": 0.3919951482218276, "mean_action_processing_ms": 0.09431288910102134, "mean_env_wait_ms": 2.9165380847438427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701925277709961, "StateBufferConnector_ms": 0.0026810169219970703, "ViewRequirementAgentConnector_ms": 0.06853437423706055}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8541.430333905084, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8404.829002283965, -8594.186040435377, -8368.594978523912, -8403.62607571949, -8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161214658094476, "mean_inference_ms": 0.3919951482218276, "mean_action_processing_ms": 0.09431288910102134, "mean_env_wait_ms": 2.9165380847438427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701925277709961, "StateBufferConnector_ms": 0.0026810169219970703, "ViewRequirementAgentConnector_ms": 0.06853437423706055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840, "num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.63572087438532, "num_env_steps_trained_throughput_per_sec": 38.63572087438532, "timesteps_total": 96840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 96840, "timers": {"training_iteration_time_ms": 3095.927, "sample_time_ms": 3092.21, "load_time_ms": 0.215, "load_throughput": 557320.873, "learn_time_ms": 2.749, "learn_throughput": 43659.59, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 96840, "num_env_steps_trained": 96840, "num_agent_steps_sampled": 96840, "num_agent_steps_trained": 96840}, "done": false, "episodes_total": 759, "training_iteration": 189, "trial_id": "668a1_00000", "date": "2023-07-25_18-26-57", "timestamp": 1690298817, "time_this_iter_s": 12.42657995223999, "time_total_s": 2317.116357088089, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2261.7527532577515, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 23.15555555555555, "ram_util_percent": 75.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794189453125, "policy_loss": -11861052416.0, "vf_loss": 554658176.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 739.0, "diff_num_grad_updates_vs_sampler_policy": 738.0}}, "num_env_steps_sampled": 97320, "num_env_steps_trained": 97320, "num_agent_steps_sampled": 97320, "num_agent_steps_trained": 97320}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8547.7656515096, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16138385196233, "mean_inference_ms": 0.39199648384457164, "mean_action_processing_ms": 0.09431309275716121, "mean_env_wait_ms": 2.9162675233279316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037126541137695312, "StateBufferConnector_ms": 0.002691984176635742, "ViewRequirementAgentConnector_ms": 0.06880664825439453}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8547.7656515096, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8563.940459763857, -8566.94865179912, -8650.9080487233, -8621.681179438026, -8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16138385196233, "mean_inference_ms": 0.39199648384457164, "mean_action_processing_ms": 0.09431309275716121, "mean_env_wait_ms": 2.9162675233279316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037126541137695312, "StateBufferConnector_ms": 0.002691984176635742, "ViewRequirementAgentConnector_ms": 0.06880664825439453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97320, "num_agent_steps_trained": 97320, "num_env_steps_sampled": 97320, "num_env_steps_trained": 97320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.69957537583512, "num_env_steps_trained_throughput_per_sec": 38.69957537583512, "timesteps_total": 97320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 97320, "timers": {"training_iteration_time_ms": 3089.496, "sample_time_ms": 3085.797, "load_time_ms": 0.215, "load_throughput": 558248.092, "learn_time_ms": 2.74, "learn_throughput": 43791.783, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 97320, "num_env_steps_trained": 97320, "num_agent_steps_sampled": 97320, "num_agent_steps_trained": 97320}, "done": false, "episodes_total": 763, "training_iteration": 190, "trial_id": "668a1_00000", "date": "2023-07-25_18-27-09", "timestamp": 1690298829, "time_this_iter_s": 12.406064748764038, "time_total_s": 2329.522421836853, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2274.1588180065155, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 25.93529411764706, "ram_util_percent": 75.30588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -8924168192.0, "vf_loss": 554944320.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 742.0}}, "num_env_steps_sampled": 97800, "num_env_steps_trained": 97800, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97800}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8544.443656795449, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161508830353796, "mean_inference_ms": 0.3919967651870553, "mean_action_processing_ms": 0.09431303417899464, "mean_env_wait_ms": 2.9160217122717373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703594207763672, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06863927841186523}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8544.443656795449, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8551.02712283025, -8418.193791992064, -8625.259424696591, -8442.783780154175, -8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161508830353796, "mean_inference_ms": 0.3919967651870553, "mean_action_processing_ms": 0.09431303417899464, "mean_env_wait_ms": 2.9160217122717373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703594207763672, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06863927841186523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97800, "num_env_steps_sampled": 97800, "num_env_steps_trained": 97800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.30781616149681, "num_env_steps_trained_throughput_per_sec": 39.30781616149681, "timesteps_total": 97800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 97800, "timers": {"training_iteration_time_ms": 3084.605, "sample_time_ms": 3080.9, "load_time_ms": 0.214, "load_throughput": 560610.916, "learn_time_ms": 2.751, "learn_throughput": 43614.19, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 97800, "num_env_steps_trained": 97800, "num_agent_steps_sampled": 97800, "num_agent_steps_trained": 97800}, "done": false, "episodes_total": 767, "training_iteration": 191, "trial_id": "668a1_00000", "date": "2023-07-25_18-27-22", "timestamp": 1690298842, "time_this_iter_s": 12.213973045349121, "time_total_s": 2341.736394882202, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2286.3727910518646, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 25.366666666666664, "ram_util_percent": 75.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952880859375, "policy_loss": -14068048896.0, "vf_loss": 558995968.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 747.0, "diff_num_grad_updates_vs_sampler_policy": 746.0}}, "num_env_steps_sampled": 98280, "num_env_steps_trained": 98280, "num_agent_steps_sampled": 98280, "num_agent_steps_trained": 98280}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8546.716274654122, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161676604749637, "mean_inference_ms": 0.39199833012701873, "mean_action_processing_ms": 0.09431302108106648, "mean_env_wait_ms": 2.9157798639075567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003709077835083008, "StateBufferConnector_ms": 0.002674102783203125, "ViewRequirementAgentConnector_ms": 0.06867074966430664}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8546.716274654122, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8584.421841717885, -8638.736717040956, -8615.483638774727, -8646.493113395522, -8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161676604749637, "mean_inference_ms": 0.39199833012701873, "mean_action_processing_ms": 0.09431302108106648, "mean_env_wait_ms": 2.9157798639075567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003709077835083008, "StateBufferConnector_ms": 0.002674102783203125, "ViewRequirementAgentConnector_ms": 0.06867074966430664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98280, "num_agent_steps_trained": 98280, "num_env_steps_sampled": 98280, "num_env_steps_trained": 98280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.727723223186786, "num_env_steps_trained_throughput_per_sec": 38.727723223186786, "timesteps_total": 98280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 98280, "timers": {"training_iteration_time_ms": 3099.399, "sample_time_ms": 3095.651, "load_time_ms": 0.215, "load_throughput": 558371.955, "learn_time_ms": 2.781, "learn_throughput": 43150.906, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 98280, "num_env_steps_trained": 98280, "num_agent_steps_sampled": 98280, "num_agent_steps_trained": 98280}, "done": false, "episodes_total": 771, "training_iteration": 192, "trial_id": "668a1_00000", "date": "2023-07-25_18-27-34", "timestamp": 1690298854, "time_this_iter_s": 12.396939039230347, "time_total_s": 2354.1333339214325, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2298.769730091095, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 26.111764705882354, "ram_util_percent": 75.37058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -17164152832.0, "vf_loss": 545911040.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 751.0, "diff_num_grad_updates_vs_sampler_policy": 750.0}}, "num_env_steps_sampled": 98760, "num_env_steps_trained": 98760, "num_agent_steps_sampled": 98760, "num_agent_steps_trained": 98760}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8545.21852822587, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161810385974615, "mean_inference_ms": 0.39200229430567035, "mean_action_processing_ms": 0.09431346519561691, "mean_env_wait_ms": 2.915537550368703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.06866955757141113}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8545.21852822587, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8443.220593364285, -8513.787120053976, -8616.859889455523, -8606.254247333181, -8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161810385974615, "mean_inference_ms": 0.39200229430567035, "mean_action_processing_ms": 0.09431346519561691, "mean_env_wait_ms": 2.915537550368703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.06866955757141113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98760, "num_agent_steps_trained": 98760, "num_env_steps_sampled": 98760, "num_env_steps_trained": 98760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.83915623480484, "num_env_steps_trained_throughput_per_sec": 38.83915623480484, "timesteps_total": 98760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 98760, "timers": {"training_iteration_time_ms": 3094.067, "sample_time_ms": 3090.345, "load_time_ms": 0.215, "load_throughput": 558495.872, "learn_time_ms": 2.756, "learn_throughput": 43547.022, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 98760, "num_env_steps_trained": 98760, "num_agent_steps_sampled": 98760, "num_agent_steps_trained": 98760}, "done": false, "episodes_total": 775, "training_iteration": 193, "trial_id": "668a1_00000", "date": "2023-07-25_18-27-47", "timestamp": 1690298867, "time_this_iter_s": 12.36148476600647, "time_total_s": 2366.494818687439, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2311.1312148571014, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 23.883333333333333, "ram_util_percent": 75.3388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -63008665600.0, "vf_loss": 553558080.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 755.0, "diff_num_grad_updates_vs_sampler_policy": 754.0}}, "num_env_steps_sampled": 99240, "num_env_steps_trained": 99240, "num_agent_steps_sampled": 99240, "num_agent_steps_trained": 99240}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8546.018253399136, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16205723810114, "mean_inference_ms": 0.39200465333492573, "mean_action_processing_ms": 0.09431354944468827, "mean_env_wait_ms": 2.915312863677701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.002679109573364258, "ViewRequirementAgentConnector_ms": 0.0687253475189209}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8546.018253399136, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8607.301270031185, -8590.785051678005, -8490.203598763526, -8514.916694809664, -8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16205723810114, "mean_inference_ms": 0.39200465333492573, "mean_action_processing_ms": 0.09431354944468827, "mean_env_wait_ms": 2.915312863677701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.002679109573364258, "ViewRequirementAgentConnector_ms": 0.0687253475189209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99240, "num_agent_steps_trained": 99240, "num_env_steps_sampled": 99240, "num_env_steps_trained": 99240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.43942936080159, "num_env_steps_trained_throughput_per_sec": 38.43942936080159, "timesteps_total": 99240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 99240, "timers": {"training_iteration_time_ms": 3090.958, "sample_time_ms": 3087.28, "load_time_ms": 0.214, "load_throughput": 561737.143, "learn_time_ms": 2.722, "learn_throughput": 44091.393, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 99240, "num_env_steps_trained": 99240, "num_agent_steps_sampled": 99240, "num_agent_steps_trained": 99240}, "done": false, "episodes_total": 779, "training_iteration": 194, "trial_id": "668a1_00000", "date": "2023-07-25_18-27-59", "timestamp": 1690298879, "time_this_iter_s": 12.490010738372803, "time_total_s": 2378.9848294258118, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2323.6212255954742, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 23.605882352941173, "ram_util_percent": 75.35294117647061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7946166992188, "policy_loss": -17491769344.0, "vf_loss": 566993344.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 759.0, "diff_num_grad_updates_vs_sampler_policy": 758.0}}, "num_env_steps_sampled": 99720, "num_env_steps_trained": 99720, "num_agent_steps_sampled": 99720, "num_agent_steps_trained": 99720}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8547.558426911086, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.162315874718832, "mean_inference_ms": 0.3920083824900513, "mean_action_processing_ms": 0.09431379783924321, "mean_env_wait_ms": 2.9151324074910043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037217140197753906, "StateBufferConnector_ms": 0.0026891231536865234, "ViewRequirementAgentConnector_ms": 0.0689551830291748}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8547.558426911086, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8564.17411344857, -8498.12623227881, -8493.795194825938, -8611.569228020213, -8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.162315874718832, "mean_inference_ms": 0.3920083824900513, "mean_action_processing_ms": 0.09431379783924321, "mean_env_wait_ms": 2.9151324074910043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037217140197753906, "StateBufferConnector_ms": 0.0026891231536865234, "ViewRequirementAgentConnector_ms": 0.0689551830291748}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99720, "num_agent_steps_trained": 99720, "num_env_steps_sampled": 99720, "num_env_steps_trained": 99720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.50642205344284, "num_env_steps_trained_throughput_per_sec": 38.50642205344284, "timesteps_total": 99720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 99720, "timers": {"training_iteration_time_ms": 3099.5, "sample_time_ms": 3095.834, "load_time_ms": 0.212, "load_throughput": 565778.417, "learn_time_ms": 2.715, "learn_throughput": 44193.987, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 99720, "num_env_steps_trained": 99720, "num_agent_steps_sampled": 99720, "num_agent_steps_trained": 99720}, "done": false, "episodes_total": 783, "training_iteration": 195, "trial_id": "668a1_00000", "date": "2023-07-25_18-28-12", "timestamp": 1690298892, "time_this_iter_s": 12.46815013885498, "time_total_s": 2391.4529795646667, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2336.089375734329, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 25.166666666666668, "ram_util_percent": 75.48888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794189453125, "policy_loss": -74864287744.0, "vf_loss": 562282240.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 763.0, "diff_num_grad_updates_vs_sampler_policy": 762.0}}, "num_env_steps_sampled": 100200, "num_env_steps_trained": 100200, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 100200}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8548.216229292659, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.162535402815273, "mean_inference_ms": 0.39200845585007826, "mean_action_processing_ms": 0.09431334616337762, "mean_env_wait_ms": 2.914985672329451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037178993225097656, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06894636154174805}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8548.216229292659, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8624.298347928914, -8545.5312994957, -8566.127359807002, -8402.546881273229, -8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.162535402815273, "mean_inference_ms": 0.39200845585007826, "mean_action_processing_ms": 0.09431334616337762, "mean_env_wait_ms": 2.914985672329451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037178993225097656, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06894636154174805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 100200, "num_env_steps_sampled": 100200, "num_env_steps_trained": 100200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.269071481101605, "num_env_steps_trained_throughput_per_sec": 39.269071481101605, "timesteps_total": 100200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 100200, "timers": {"training_iteration_time_ms": 3109.597, "sample_time_ms": 3105.914, "load_time_ms": 0.213, "load_throughput": 563182.813, "learn_time_ms": 2.726, "learn_throughput": 44018.128, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 100200, "num_env_steps_trained": 100200, "num_agent_steps_sampled": 100200, "num_agent_steps_trained": 100200}, "done": false, "episodes_total": 787, "training_iteration": 196, "trial_id": "668a1_00000", "date": "2023-07-25_18-28-24", "timestamp": 1690298904, "time_this_iter_s": 12.226080179214478, "time_total_s": 2403.679059743881, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2348.3154559135437, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 26.61176470588235, "ram_util_percent": 75.46470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943115234375, "policy_loss": -62006165504.0, "vf_loss": 556458944.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 767.0, "diff_num_grad_updates_vs_sampler_policy": 766.0}}, "num_env_steps_sampled": 100680, "num_env_steps_trained": 100680, "num_agent_steps_sampled": 100680, "num_agent_steps_trained": 100680}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8549.567294120696, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16272018002811, "mean_inference_ms": 0.3920081623795093, "mean_action_processing_ms": 0.09431280085881194, "mean_env_wait_ms": 2.914778587962201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037124156951904297, "StateBufferConnector_ms": 0.0026710033416748047, "ViewRequirementAgentConnector_ms": 0.06891417503356934}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8549.567294120696, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8529.947634117943, -8454.248913893225, -8541.86480851633, -8502.998315259876, -8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16272018002811, "mean_inference_ms": 0.3920081623795093, "mean_action_processing_ms": 0.09431280085881194, "mean_env_wait_ms": 2.914778587962201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037124156951904297, "StateBufferConnector_ms": 0.0026710033416748047, "ViewRequirementAgentConnector_ms": 0.06891417503356934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100680, "num_agent_steps_trained": 100680, "num_env_steps_sampled": 100680, "num_env_steps_trained": 100680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.55580490420981, "num_env_steps_trained_throughput_per_sec": 38.55580490420981, "timesteps_total": 100680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 100680, "timers": {"training_iteration_time_ms": 3094.35, "sample_time_ms": 3090.664, "load_time_ms": 0.215, "load_throughput": 558619.845, "learn_time_ms": 2.724, "learn_throughput": 44045.863, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 100680, "num_env_steps_trained": 100680, "num_agent_steps_sampled": 100680, "num_agent_steps_trained": 100680}, "done": false, "episodes_total": 791, "training_iteration": 197, "trial_id": "668a1_00000", "date": "2023-07-25_18-28-36", "timestamp": 1690298916, "time_this_iter_s": 12.452518939971924, "time_total_s": 2416.131578683853, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2360.7679748535156, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 24.977777777777778, "ram_util_percent": 75.18888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -59420471296.0, "vf_loss": 564601152.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 771.0, "diff_num_grad_updates_vs_sampler_policy": 770.0}}, "num_env_steps_sampled": 101160, "num_env_steps_trained": 101160, "num_agent_steps_sampled": 101160, "num_agent_steps_trained": 101160}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8551.005234299084, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.162987687487284, "mean_inference_ms": 0.39200740945815615, "mean_action_processing_ms": 0.09431221882136029, "mean_env_wait_ms": 2.914569959855561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710508346557617, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06885886192321777}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8551.005234299084, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8416.28860834687, -8546.900063018578, -8692.885558009511, -8468.384713750283, -8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.162987687487284, "mean_inference_ms": 0.39200740945815615, "mean_action_processing_ms": 0.09431221882136029, "mean_env_wait_ms": 2.914569959855561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710508346557617, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06885886192321777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101160, "num_agent_steps_trained": 101160, "num_env_steps_sampled": 101160, "num_env_steps_trained": 101160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.82976415740907, "num_env_steps_trained_throughput_per_sec": 38.82976415740907, "timesteps_total": 101160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 101160, "timers": {"training_iteration_time_ms": 3084.619, "sample_time_ms": 3080.921, "load_time_ms": 0.216, "load_throughput": 555353.062, "learn_time_ms": 2.731, "learn_throughput": 43934.749, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 101160, "num_env_steps_trained": 101160, "num_agent_steps_sampled": 101160, "num_agent_steps_trained": 101160}, "done": false, "episodes_total": 795, "training_iteration": 198, "trial_id": "668a1_00000", "date": "2023-07-25_18-28-49", "timestamp": 1690298929, "time_this_iter_s": 12.364445209503174, "time_total_s": 2428.4960238933563, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2373.132420063019, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 23.65, "ram_util_percent": 75.31111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -83927105536.0, "vf_loss": 564070720.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 775.0, "diff_num_grad_updates_vs_sampler_policy": 774.0}}, "num_env_steps_sampled": 101640, "num_env_steps_trained": 101640, "num_agent_steps_sampled": 101640, "num_agent_steps_trained": 101640}, "sampler_results": {"episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8552.126025698904, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1632801056217, "mean_inference_ms": 0.3920058853931051, "mean_action_processing_ms": 0.09431147519608281, "mean_env_wait_ms": 2.9143869638441107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037131309509277344, "StateBufferConnector_ms": 0.002669095993041992, "ViewRequirementAgentConnector_ms": 0.0688774585723877}}, "episode_reward_max": -8352.800945565095, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8552.126025698904, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8540.483265994248, -8452.163800890563, -8453.311298296903, -8469.718128795206, -8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1632801056217, "mean_inference_ms": 0.3920058853931051, "mean_action_processing_ms": 0.09431147519608281, "mean_env_wait_ms": 2.9143869638441107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037131309509277344, "StateBufferConnector_ms": 0.002669095993041992, "ViewRequirementAgentConnector_ms": 0.0688774585723877}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101640, "num_agent_steps_trained": 101640, "num_env_steps_sampled": 101640, "num_env_steps_trained": 101640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.6981397130096, "num_env_steps_trained_throughput_per_sec": 38.6981397130096, "timesteps_total": 101640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 101640, "timers": {"training_iteration_time_ms": 3080.652, "sample_time_ms": 3076.943, "load_time_ms": 0.217, "load_throughput": 554130.221, "learn_time_ms": 2.749, "learn_throughput": 43656.939, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 101640, "num_env_steps_trained": 101640, "num_agent_steps_sampled": 101640, "num_agent_steps_trained": 101640}, "done": false, "episodes_total": 799, "training_iteration": 199, "trial_id": "668a1_00000", "date": "2023-07-25_18-29-01", "timestamp": 1690298941, "time_this_iter_s": 12.406306028366089, "time_total_s": 2440.9023299217224, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2385.538726091385, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 23.741176470588233, "ram_util_percent": 75.35882352941178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947387695312, "policy_loss": -20636121088.0, "vf_loss": 558715520.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 779.0, "diff_num_grad_updates_vs_sampler_policy": 778.0}}, "num_env_steps_sampled": 102120, "num_env_steps_trained": 102120, "num_agent_steps_sampled": 102120, "num_agent_steps_trained": 102120}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8552.150349959862, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1635504802269, "mean_inference_ms": 0.3920049619804559, "mean_action_processing_ms": 0.09431082273999156, "mean_env_wait_ms": 2.91419623193459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726959228515625, "StateBufferConnector_ms": 0.002672910690307617, "ViewRequirementAgentConnector_ms": 0.06897211074829102}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8552.150349959862, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8391.241892121378, -8630.167630687176, -8524.054623730815, -8578.81333849992, -8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1635504802269, "mean_inference_ms": 0.3920049619804559, "mean_action_processing_ms": 0.09431082273999156, "mean_env_wait_ms": 2.91419623193459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726959228515625, "StateBufferConnector_ms": 0.002672910690307617, "ViewRequirementAgentConnector_ms": 0.06897211074829102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102120, "num_agent_steps_trained": 102120, "num_env_steps_sampled": 102120, "num_env_steps_trained": 102120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.94034286069734, "num_env_steps_trained_throughput_per_sec": 38.94034286069734, "timesteps_total": 102120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 102120, "timers": {"training_iteration_time_ms": 3096.95, "sample_time_ms": 3093.217, "load_time_ms": 0.215, "load_throughput": 556950.847, "learn_time_ms": 2.764, "learn_throughput": 43409.185, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 102120, "num_env_steps_trained": 102120, "num_agent_steps_sampled": 102120, "num_agent_steps_trained": 102120}, "done": false, "episodes_total": 803, "training_iteration": 200, "trial_id": "668a1_00000", "date": "2023-07-25_18-29-13", "timestamp": 1690298953, "time_this_iter_s": 12.329295873641968, "time_total_s": 2453.2316257953644, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2397.868021965027, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 25.91111111111111, "ram_util_percent": 75.30555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -55333351424.0, "vf_loss": 544056256.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 783.0, "diff_num_grad_updates_vs_sampler_policy": 782.0}}, "num_env_steps_sampled": 102600, "num_env_steps_trained": 102600, "num_agent_steps_sampled": 102600, "num_agent_steps_trained": 102600}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8551.705145486445, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16385807355932, "mean_inference_ms": 0.39200488910568976, "mean_action_processing_ms": 0.09431027175629886, "mean_env_wait_ms": 2.9140111702299225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037314891815185547, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.06899619102478027}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8551.705145486445, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8446.89428075988, -8417.84569471058, -8474.69218911154, -8524.80805009824, -8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16385807355932, "mean_inference_ms": 0.39200488910568976, "mean_action_processing_ms": 0.09431027175629886, "mean_env_wait_ms": 2.9140111702299225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037314891815185547, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.06899619102478027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102600, "num_agent_steps_trained": 102600, "num_env_steps_sampled": 102600, "num_env_steps_trained": 102600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.49633997495831, "num_env_steps_trained_throughput_per_sec": 38.49633997495831, "timesteps_total": 102600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 102600, "timers": {"training_iteration_time_ms": 3113.742, "sample_time_ms": 3110.036, "load_time_ms": 0.214, "load_throughput": 560923.303, "learn_time_ms": 2.739, "learn_throughput": 43805.885, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 102600, "num_env_steps_trained": 102600, "num_agent_steps_sampled": 102600, "num_agent_steps_trained": 102600}, "done": false, "episodes_total": 807, "training_iteration": 201, "trial_id": "668a1_00000", "date": "2023-07-25_18-29-26", "timestamp": 1690298966, "time_this_iter_s": 12.47148323059082, "time_total_s": 2465.703109025955, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2410.3395051956177, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 24.741176470588233, "ram_util_percent": 75.09411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794677734375, "policy_loss": -55964188672.0, "vf_loss": 569498560.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 787.0, "diff_num_grad_updates_vs_sampler_policy": 786.0}}, "num_env_steps_sampled": 103080, "num_env_steps_trained": 103080, "num_agent_steps_sampled": 103080, "num_agent_steps_trained": 103080}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8554.848777091489, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1641366337261, "mean_inference_ms": 0.3920056574970475, "mean_action_processing_ms": 0.09430981624957573, "mean_env_wait_ms": 2.9138289745271724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003725290298461914, "StateBufferConnector_ms": 0.0026581287384033203, "ViewRequirementAgentConnector_ms": 0.06895303726196289}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8554.848777091489, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8459.4528311857, -8487.388973396555, -8352.800945565095, -8587.004179872732, -8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1641366337261, "mean_inference_ms": 0.3920056574970475, "mean_action_processing_ms": 0.09430981624957573, "mean_env_wait_ms": 2.9138289745271724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003725290298461914, "StateBufferConnector_ms": 0.0026581287384033203, "ViewRequirementAgentConnector_ms": 0.06895303726196289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103080, "num_agent_steps_trained": 103080, "num_env_steps_sampled": 103080, "num_env_steps_trained": 103080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.91856707270337, "num_env_steps_trained_throughput_per_sec": 38.91856707270337, "timesteps_total": 103080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 103080, "timers": {"training_iteration_time_ms": 3090.666, "sample_time_ms": 3086.958, "load_time_ms": 0.214, "load_throughput": 560423.65, "learn_time_ms": 2.749, "learn_throughput": 43649.745, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 103080, "num_env_steps_trained": 103080, "num_agent_steps_sampled": 103080, "num_agent_steps_trained": 103080}, "done": false, "episodes_total": 811, "training_iteration": 202, "trial_id": "668a1_00000", "date": "2023-07-25_18-29-38", "timestamp": 1690298978, "time_this_iter_s": 12.336229801177979, "time_total_s": 2478.039338827133, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2422.6757349967957, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 22.950000000000003, "ram_util_percent": 75.1388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -80449814528.0, "vf_loss": 573283968.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 791.0, "diff_num_grad_updates_vs_sampler_policy": 790.0}}, "num_env_steps_sampled": 103560, "num_env_steps_trained": 103560, "num_agent_steps_sampled": 103560, "num_agent_steps_trained": 103560}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8561.482722854473, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.164495071647657, "mean_inference_ms": 0.3920035690794223, "mean_action_processing_ms": 0.09430891074966219, "mean_env_wait_ms": 2.9136341673557116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003731966018676758, "StateBufferConnector_ms": 0.002668619155883789, "ViewRequirementAgentConnector_ms": 0.06900954246520996}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8561.482722854473, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8549.231799159697, -8531.91845870799, -8669.561224053428, -8557.280325894906, -8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.164495071647657, "mean_inference_ms": 0.3920035690794223, "mean_action_processing_ms": 0.09430891074966219, "mean_env_wait_ms": 2.9136341673557116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003731966018676758, "StateBufferConnector_ms": 0.002668619155883789, "ViewRequirementAgentConnector_ms": 0.06900954246520996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103560, "num_agent_steps_trained": 103560, "num_env_steps_sampled": 103560, "num_env_steps_trained": 103560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.99014266493199, "num_env_steps_trained_throughput_per_sec": 38.99014266493199, "timesteps_total": 103560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 103560, "timers": {"training_iteration_time_ms": 3072.047, "sample_time_ms": 3068.325, "load_time_ms": 0.216, "load_throughput": 554924.454, "learn_time_ms": 2.75, "learn_throughput": 43634.23, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 103560, "num_env_steps_trained": 103560, "num_agent_steps_sampled": 103560, "num_agent_steps_trained": 103560}, "done": false, "episodes_total": 815, "training_iteration": 203, "trial_id": "668a1_00000", "date": "2023-07-25_18-29-51", "timestamp": 1690298991, "time_this_iter_s": 12.313699007034302, "time_total_s": 2490.3530378341675, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2434.98943400383, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 25.27058823529412, "ram_util_percent": 75.12352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -83513942016.0, "vf_loss": 555912640.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 795.0, "diff_num_grad_updates_vs_sampler_policy": 794.0}}, "num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8559.718680795504, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.164814007854325, "mean_inference_ms": 0.39200056656508186, "mean_action_processing_ms": 0.094307941410888, "mean_env_wait_ms": 2.9134582424818323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037338733673095703, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.06902265548706055}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8778.962748549238, "episode_reward_mean": -8559.718680795504, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8778.962748549238, -8524.64148429046, -8736.305943497398, -8531.769194579734, -8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.164814007854325, "mean_inference_ms": 0.39200056656508186, "mean_action_processing_ms": 0.094307941410888, "mean_env_wait_ms": 2.9134582424818323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037338733673095703, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.06902265548706055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040, "num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.22801819144649, "num_env_steps_trained_throughput_per_sec": 39.22801819144649, "timesteps_total": 104040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 104040, "timers": {"training_iteration_time_ms": 3068.108, "sample_time_ms": 3064.341, "load_time_ms": 0.219, "load_throughput": 548514.037, "learn_time_ms": 2.779, "learn_throughput": 43177.188, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 104040, "num_env_steps_trained": 104040, "num_agent_steps_sampled": 104040, "num_agent_steps_trained": 104040}, "done": false, "episodes_total": 819, "training_iteration": 204, "trial_id": "668a1_00000", "date": "2023-07-25_18-30-03", "timestamp": 1690299003, "time_this_iter_s": 12.239097118377686, "time_total_s": 2502.592134952545, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2447.2285311222076, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 25.56666666666667, "ram_util_percent": 75.23333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943725585938, "policy_loss": -75827429376.0, "vf_loss": 566940800.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 799.0, "diff_num_grad_updates_vs_sampler_policy": 798.0}}, "num_env_steps_sampled": 104520, "num_env_steps_trained": 104520, "num_agent_steps_sampled": 104520, "num_agent_steps_trained": 104520}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8556.52856737012, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.165162187762157, "mean_inference_ms": 0.39199861541924536, "mean_action_processing_ms": 0.09430726563170873, "mean_env_wait_ms": 2.9132683735403533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737926483154297, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06908988952636719}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8556.52856737012, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8520.616206480492, -8511.744018559082, -8624.53648422422, -8573.426579848247, -8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.165162187762157, "mean_inference_ms": 0.39199861541924536, "mean_action_processing_ms": 0.09430726563170873, "mean_env_wait_ms": 2.9132683735403533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737926483154297, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06908988952636719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104520, "num_agent_steps_trained": 104520, "num_env_steps_sampled": 104520, "num_env_steps_trained": 104520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.906395807244564, "num_env_steps_trained_throughput_per_sec": 38.906395807244564, "timesteps_total": 104520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 104520, "timers": {"training_iteration_time_ms": 3092.467, "sample_time_ms": 3088.734, "load_time_ms": 0.218, "load_throughput": 551398.422, "learn_time_ms": 2.761, "learn_throughput": 43455.659, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 104520, "num_env_steps_trained": 104520, "num_agent_steps_sampled": 104520, "num_agent_steps_trained": 104520}, "done": false, "episodes_total": 823, "training_iteration": 205, "trial_id": "668a1_00000", "date": "2023-07-25_18-30-15", "timestamp": 1690299015, "time_this_iter_s": 12.340195178985596, "time_total_s": 2514.9323301315308, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2459.5687263011932, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 27.435294117647057, "ram_util_percent": 74.83529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -62609526784.0, "vf_loss": 547473344.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 803.0, "diff_num_grad_updates_vs_sampler_policy": 802.0}}, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8556.808912571601, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.165530593776793, "mean_inference_ms": 0.39199686984480797, "mean_action_processing_ms": 0.09430671291133384, "mean_env_wait_ms": 2.9130762594175574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037403106689453125, "StateBufferConnector_ms": 0.0026731491088867188, "ViewRequirementAgentConnector_ms": 0.06915640830993652}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8556.808912571601, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8652.509614420034, -8680.315448337995, -8527.925870583744, -8470.855479531403, -8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.165530593776793, "mean_inference_ms": 0.39199686984480797, "mean_action_processing_ms": 0.09430671291133384, "mean_env_wait_ms": 2.9130762594175574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037403106689453125, "StateBufferConnector_ms": 0.0026731491088867188, "ViewRequirementAgentConnector_ms": 0.06915640830993652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.73827124291287, "num_env_steps_trained_throughput_per_sec": 38.73827124291287, "timesteps_total": 105000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 105000, "timers": {"training_iteration_time_ms": 3089.598, "sample_time_ms": 3085.861, "load_time_ms": 0.217, "load_throughput": 552487.903, "learn_time_ms": 2.767, "learn_throughput": 43364.679, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "done": false, "episodes_total": 827, "training_iteration": 206, "trial_id": "668a1_00000", "date": "2023-07-25_18-30-28", "timestamp": 1690299028, "time_this_iter_s": 12.393635988235474, "time_total_s": 2527.3259661197662, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2471.9623622894287, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 24.43888888888889, "ram_util_percent": 75.3388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7944946289062, "policy_loss": -62423220224.0, "vf_loss": 557636800.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 807.0, "diff_num_grad_updates_vs_sampler_policy": 806.0}}, "num_env_steps_sampled": 105480, "num_env_steps_trained": 105480, "num_agent_steps_sampled": 105480, "num_agent_steps_trained": 105480}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8554.997835836046, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16598351079272, "mean_inference_ms": 0.39199417682889615, "mean_action_processing_ms": 0.09430605580028377, "mean_env_wait_ms": 2.912883157428991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003738880157470703, "StateBufferConnector_ms": 0.00266265869140625, "ViewRequirementAgentConnector_ms": 0.0691518783569336}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8554.997835836046, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8635.938725232954, -8543.434101158717, -8710.801327249506, -8432.832821043841, -8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16598351079272, "mean_inference_ms": 0.39199417682889615, "mean_action_processing_ms": 0.09430605580028377, "mean_env_wait_ms": 2.912883157428991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003738880157470703, "StateBufferConnector_ms": 0.00266265869140625, "ViewRequirementAgentConnector_ms": 0.0691518783569336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105480, "num_agent_steps_trained": 105480, "num_env_steps_sampled": 105480, "num_env_steps_trained": 105480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.82405158022524, "num_env_steps_trained_throughput_per_sec": 38.82405158022524, "timesteps_total": 105480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 105480, "timers": {"training_iteration_time_ms": 3076.684, "sample_time_ms": 3072.967, "load_time_ms": 0.214, "load_throughput": 559924.886, "learn_time_ms": 2.755, "learn_throughput": 43554.559, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 105480, "num_env_steps_trained": 105480, "num_agent_steps_sampled": 105480, "num_agent_steps_trained": 105480}, "done": false, "episodes_total": 831, "training_iteration": 207, "trial_id": "668a1_00000", "date": "2023-07-25_18-30-40", "timestamp": 1690299040, "time_this_iter_s": 12.366135120391846, "time_total_s": 2539.692101240158, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2484.3284974098206, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 24.376470588235293, "ram_util_percent": 75.01764705882351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -49717411840.0, "vf_loss": 572773568.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 811.0, "diff_num_grad_updates_vs_sampler_policy": 810.0}}, "num_env_steps_sampled": 105960, "num_env_steps_trained": 105960, "num_agent_steps_sampled": 105960, "num_agent_steps_trained": 105960}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8554.099597356244, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.166489909802777, "mean_inference_ms": 0.391988554771101, "mean_action_processing_ms": 0.09430482064363696, "mean_env_wait_ms": 2.912750909953772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037419795989990234, "StateBufferConnector_ms": 0.002660036087036133, "ViewRequirementAgentConnector_ms": 0.0691537857055664}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8554.099597356244, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8438.577357268867, -8444.60874526251, -8550.106448684024, -8595.482641573737, -8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.166489909802777, "mean_inference_ms": 0.391988554771101, "mean_action_processing_ms": 0.09430482064363696, "mean_env_wait_ms": 2.912750909953772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037419795989990234, "StateBufferConnector_ms": 0.002660036087036133, "ViewRequirementAgentConnector_ms": 0.0691537857055664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105960, "num_agent_steps_trained": 105960, "num_env_steps_sampled": 105960, "num_env_steps_trained": 105960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.99951655122908, "num_env_steps_trained_throughput_per_sec": 38.99951655122908, "timesteps_total": 105960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 105960, "timers": {"training_iteration_time_ms": 3073.137, "sample_time_ms": 3069.434, "load_time_ms": 0.213, "load_throughput": 562930.858, "learn_time_ms": 2.744, "learn_throughput": 43732.045, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 105960, "num_env_steps_trained": 105960, "num_agent_steps_sampled": 105960, "num_agent_steps_trained": 105960}, "done": false, "episodes_total": 835, "training_iteration": 208, "trial_id": "668a1_00000", "date": "2023-07-25_18-30-52", "timestamp": 1690299052, "time_this_iter_s": 12.310636758804321, "time_total_s": 2552.0027379989624, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2496.639134168625, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 23.811111111111114, "ram_util_percent": 75.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -39691886592.0, "vf_loss": 547186304.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 815.0, "diff_num_grad_updates_vs_sampler_policy": 814.0}}, "num_env_steps_sampled": 106440, "num_env_steps_trained": 106440, "num_agent_steps_sampled": 106440, "num_agent_steps_trained": 106440}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8553.892625872448, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16693977762131, "mean_inference_ms": 0.3919835678504938, "mean_action_processing_ms": 0.09430365428368535, "mean_env_wait_ms": 2.9126228139399153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.00266265869140625, "ViewRequirementAgentConnector_ms": 0.06920981407165527}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8553.892625872448, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8665.186177878866, -8660.977716120906, -8362.322414602873, -8515.506855406215, -8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16693977762131, "mean_inference_ms": 0.3919835678504938, "mean_action_processing_ms": 0.09430365428368535, "mean_env_wait_ms": 2.9126228139399153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751039505004883, "StateBufferConnector_ms": 0.00266265869140625, "ViewRequirementAgentConnector_ms": 0.06920981407165527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106440, "num_agent_steps_trained": 106440, "num_env_steps_sampled": 106440, "num_env_steps_trained": 106440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.17650080032682, "num_env_steps_trained_throughput_per_sec": 39.17650080032682, "timesteps_total": 106440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 106440, "timers": {"training_iteration_time_ms": 3085.803, "sample_time_ms": 3082.076, "load_time_ms": 0.215, "load_throughput": 557259.167, "learn_time_ms": 2.752, "learn_throughput": 43607.011, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 106440, "num_env_steps_trained": 106440, "num_agent_steps_sampled": 106440, "num_agent_steps_trained": 106440}, "done": false, "episodes_total": 839, "training_iteration": 209, "trial_id": "668a1_00000", "date": "2023-07-25_18-31-05", "timestamp": 1690299065, "time_this_iter_s": 12.25495719909668, "time_total_s": 2564.257695198059, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2508.8940913677216, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 25.529411764705884, "ram_util_percent": 75.2764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -85090410496.0, "vf_loss": 551250688.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 819.0, "diff_num_grad_updates_vs_sampler_policy": 818.0}}, "num_env_steps_sampled": 106920, "num_env_steps_trained": 106920, "num_agent_steps_sampled": 106920, "num_agent_steps_trained": 106920}, "sampler_results": {"episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8554.046441720004, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.167477403856683, "mean_inference_ms": 0.3919793468099826, "mean_action_processing_ms": 0.09430261692838793, "mean_env_wait_ms": 2.912496294269065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037603378295898438, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06926751136779785}}, "episode_reward_max": -8338.198019006544, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8554.046441720004, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8508.289615398307, -8644.872207079345, -8612.49132567804, -8698.372685975955, -8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.167477403856683, "mean_inference_ms": 0.3919793468099826, "mean_action_processing_ms": 0.09430261692838793, "mean_env_wait_ms": 2.912496294269065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037603378295898438, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06926751136779785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106920, "num_agent_steps_trained": 106920, "num_env_steps_sampled": 106920, "num_env_steps_trained": 106920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.525682721079455, "num_env_steps_trained_throughput_per_sec": 38.525682721079455, "timesteps_total": 106920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 106920, "timers": {"training_iteration_time_ms": 3099.403, "sample_time_ms": 3095.676, "load_time_ms": 0.215, "load_throughput": 559427.009, "learn_time_ms": 2.749, "learn_throughput": 43649.745, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 106920, "num_env_steps_trained": 106920, "num_agent_steps_sampled": 106920, "num_agent_steps_trained": 106920}, "done": false, "episodes_total": 843, "training_iteration": 210, "trial_id": "668a1_00000", "date": "2023-07-25_18-31-17", "timestamp": 1690299077, "time_this_iter_s": 12.462213039398193, "time_total_s": 2576.7199082374573, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2521.3563044071198, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 23.755555555555556, "ram_util_percent": 75.07777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7942504882812, "policy_loss": -159455723520.0, "vf_loss": 582023040.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 823.0, "diff_num_grad_updates_vs_sampler_policy": 822.0}}, "num_env_steps_sampled": 107400, "num_env_steps_trained": 107400, "num_agent_steps_sampled": 107400, "num_agent_steps_trained": 107400}, "sampler_results": {"episode_reward_max": -8327.670364732561, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8551.037915616796, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.168094812369464, "mean_inference_ms": 0.3919754108541353, "mean_action_processing_ms": 0.09430173773796748, "mean_env_wait_ms": 2.912378019531617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037534236907958984, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06926774978637695}}, "episode_reward_max": -8327.670364732561, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8551.037915616796, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8545.45697930402, -8501.302504899839, -8419.174005084626, -8542.465526893262, -8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.168094812369464, "mean_inference_ms": 0.3919754108541353, "mean_action_processing_ms": 0.09430173773796748, "mean_env_wait_ms": 2.912378019531617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037534236907958984, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06926774978637695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107400, "num_agent_steps_trained": 107400, "num_env_steps_sampled": 107400, "num_env_steps_trained": 107400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.47873312097585, "num_env_steps_trained_throughput_per_sec": 38.47873312097585, "timesteps_total": 107400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 107400, "timers": {"training_iteration_time_ms": 3098.102, "sample_time_ms": 3094.372, "load_time_ms": 0.215, "load_throughput": 557629.603, "learn_time_ms": 2.749, "learn_throughput": 43654.288, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 107400, "num_env_steps_trained": 107400, "num_agent_steps_sampled": 107400, "num_agent_steps_trained": 107400}, "done": false, "episodes_total": 847, "training_iteration": 211, "trial_id": "668a1_00000", "date": "2023-07-25_18-31-30", "timestamp": 1690299090, "time_this_iter_s": 12.477420091629028, "time_total_s": 2589.1973283290863, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2533.833724498749, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 24.172222222222224, "ram_util_percent": 75.12777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943725585938, "policy_loss": -79482454016.0, "vf_loss": 583136512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 827.0, "diff_num_grad_updates_vs_sampler_policy": 826.0}}, "num_env_steps_sampled": 107880, "num_env_steps_trained": 107880, "num_agent_steps_sampled": 107880, "num_agent_steps_trained": 107880}, "sampler_results": {"episode_reward_max": -8327.670364732561, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8554.368451097203, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.168861756233454, "mean_inference_ms": 0.3919705073682859, "mean_action_processing_ms": 0.0943007269787445, "mean_env_wait_ms": 2.9122732918066414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037534236907958984, "StateBufferConnector_ms": 0.002671957015991211, "ViewRequirementAgentConnector_ms": 0.06925749778747559}}, "episode_reward_max": -8327.670364732561, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8554.368451097203, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8632.70564345201, -8635.397846573032, -8529.3468370081, -8538.660811233478, -8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.168861756233454, "mean_inference_ms": 0.3919705073682859, "mean_action_processing_ms": 0.0943007269787445, "mean_env_wait_ms": 2.9122732918066414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037534236907958984, "StateBufferConnector_ms": 0.002671957015991211, "ViewRequirementAgentConnector_ms": 0.06925749778747559}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107880, "num_agent_steps_trained": 107880, "num_env_steps_sampled": 107880, "num_env_steps_trained": 107880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.7523275513887, "num_env_steps_trained_throughput_per_sec": 38.7523275513887, "timesteps_total": 107880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 107880, "timers": {"training_iteration_time_ms": 3093.828, "sample_time_ms": 3090.099, "load_time_ms": 0.214, "load_throughput": 561611.783, "learn_time_ms": 2.765, "learn_throughput": 43398.331, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 107880, "num_env_steps_trained": 107880, "num_agent_steps_sampled": 107880, "num_agent_steps_trained": 107880}, "done": false, "episodes_total": 851, "training_iteration": 212, "trial_id": "668a1_00000", "date": "2023-07-25_18-31-42", "timestamp": 1690299102, "time_this_iter_s": 12.389292001724243, "time_total_s": 2601.5866203308105, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2546.223016500473, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 26.20588235294118, "ram_util_percent": 75.14117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7935180664062, "policy_loss": -46270119936.0, "vf_loss": 567831104.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 831.0, "diff_num_grad_updates_vs_sampler_policy": 830.0}}, "num_env_steps_sampled": 108360, "num_env_steps_trained": 108360, "num_agent_steps_sampled": 108360, "num_agent_steps_trained": 108360}, "sampler_results": {"episode_reward_max": -8327.670364732561, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8553.444916337892, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16950855887785, "mean_inference_ms": 0.3919657850095011, "mean_action_processing_ms": 0.09429971951139766, "mean_env_wait_ms": 2.9121774601124515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751993179321289, "StateBufferConnector_ms": 0.0026841163635253906, "ViewRequirementAgentConnector_ms": 0.06920742988586426}}, "episode_reward_max": -8327.670364732561, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8553.444916337892, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8441.055565081508, -8512.14332429408, -8492.17196794192, -8560.779603923656, -8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16950855887785, "mean_inference_ms": 0.3919657850095011, "mean_action_processing_ms": 0.09429971951139766, "mean_env_wait_ms": 2.9121774601124515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751993179321289, "StateBufferConnector_ms": 0.0026841163635253906, "ViewRequirementAgentConnector_ms": 0.06920742988586426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108360, "num_agent_steps_trained": 108360, "num_env_steps_sampled": 108360, "num_env_steps_trained": 108360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.49375342545403, "num_env_steps_trained_throughput_per_sec": 39.49375342545403, "timesteps_total": 108360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 108360, "timers": {"training_iteration_time_ms": 3078.499, "sample_time_ms": 3074.758, "load_time_ms": 0.215, "load_throughput": 558248.092, "learn_time_ms": 2.76, "learn_throughput": 43477.055, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 108360, "num_env_steps_trained": 108360, "num_agent_steps_sampled": 108360, "num_agent_steps_trained": 108360}, "done": false, "episodes_total": 855, "training_iteration": 213, "trial_id": "668a1_00000", "date": "2023-07-25_18-31-54", "timestamp": 1690299114, "time_this_iter_s": 12.156614065170288, "time_total_s": 2613.743234395981, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2558.3796305656433, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 24.91111111111111, "ram_util_percent": 75.52222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -69744918528.0, "vf_loss": 523859104.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 835.0, "diff_num_grad_updates_vs_sampler_policy": 834.0}}, "num_env_steps_sampled": 108840, "num_env_steps_trained": 108840, "num_agent_steps_sampled": 108840, "num_agent_steps_trained": 108840}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8553.392424273068, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1701227607692, "mean_inference_ms": 0.3919625868781036, "mean_action_processing_ms": 0.09429895281895724, "mean_env_wait_ms": 2.9120861255778423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037529468536376953, "StateBufferConnector_ms": 0.0026824474334716797, "ViewRequirementAgentConnector_ms": 0.06917977333068848}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8553.392424273068, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8671.126703074882, -8583.760048229502, -8607.842406600746, -8542.038699509292, -8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1701227607692, "mean_inference_ms": 0.3919625868781036, "mean_action_processing_ms": 0.09429895281895724, "mean_env_wait_ms": 2.9120861255778423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037529468536376953, "StateBufferConnector_ms": 0.0026824474334716797, "ViewRequirementAgentConnector_ms": 0.06917977333068848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108840, "num_agent_steps_trained": 108840, "num_env_steps_sampled": 108840, "num_env_steps_trained": 108840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.76855296242165, "num_env_steps_trained_throughput_per_sec": 38.76855296242165, "timesteps_total": 108840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 108840, "timers": {"training_iteration_time_ms": 3077.71, "sample_time_ms": 3073.965, "load_time_ms": 0.214, "load_throughput": 559924.886, "learn_time_ms": 2.766, "learn_throughput": 43387.108, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 108840, "num_env_steps_trained": 108840, "num_agent_steps_sampled": 108840, "num_agent_steps_trained": 108840}, "done": false, "episodes_total": 859, "training_iteration": 214, "trial_id": "668a1_00000", "date": "2023-07-25_18-32-07", "timestamp": 1690299127, "time_this_iter_s": 12.384037733078003, "time_total_s": 2626.127272129059, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2570.7636682987213, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 25.617647058823525, "ram_util_percent": 75.51764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -15549176832.0, "vf_loss": 552917120.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 839.0, "diff_num_grad_updates_vs_sampler_policy": 838.0}}, "num_env_steps_sampled": 109320, "num_env_steps_trained": 109320, "num_agent_steps_sampled": 109320, "num_agent_steps_trained": 109320}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8548.94447751562, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17076019788921, "mean_inference_ms": 0.39195877621497244, "mean_action_processing_ms": 0.09429824349185828, "mean_env_wait_ms": 2.9119882768717207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037488937377929688, "StateBufferConnector_ms": 0.0026726722717285156, "ViewRequirementAgentConnector_ms": 0.0690004825592041}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8763.318025489047, "episode_reward_mean": -8548.94447751562, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8594.936912352232, -8370.000474102799, -8614.157958599859, -8492.183523254265, -8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17076019788921, "mean_inference_ms": 0.39195877621497244, "mean_action_processing_ms": 0.09429824349185828, "mean_env_wait_ms": 2.9119882768717207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037488937377929688, "StateBufferConnector_ms": 0.0026726722717285156, "ViewRequirementAgentConnector_ms": 0.0690004825592041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109320, "num_agent_steps_trained": 109320, "num_env_steps_sampled": 109320, "num_env_steps_trained": 109320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.51034277386701, "num_env_steps_trained_throughput_per_sec": 38.51034277386701, "timesteps_total": 109320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 109320, "timers": {"training_iteration_time_ms": 3090.784, "sample_time_ms": 3087.015, "load_time_ms": 0.215, "load_throughput": 558000.532, "learn_time_ms": 2.778, "learn_throughput": 43197.569, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 109320, "num_env_steps_trained": 109320, "num_agent_steps_sampled": 109320, "num_agent_steps_trained": 109320}, "done": false, "episodes_total": 863, "training_iteration": 215, "trial_id": "668a1_00000", "date": "2023-07-25_18-32-19", "timestamp": 1690299139, "time_this_iter_s": 12.467076063156128, "time_total_s": 2638.594348192215, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2583.2307443618774, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 23.205555555555556, "ram_util_percent": 75.51111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7944946289062, "policy_loss": -71880679424.0, "vf_loss": 610134976.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 843.0, "diff_num_grad_updates_vs_sampler_policy": 842.0}}, "num_env_steps_sampled": 109800, "num_env_steps_trained": 109800, "num_agent_steps_sampled": 109800, "num_agent_steps_trained": 109800}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8553.160816717102, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.171457444465123, "mean_inference_ms": 0.39196701532140193, "mean_action_processing_ms": 0.09429933668528342, "mean_env_wait_ms": 2.9119353515888666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003773212432861328, "StateBufferConnector_ms": 0.002680540084838867, "ViewRequirementAgentConnector_ms": 0.06933403015136719}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8553.160816717102, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8476.190713799833, -8601.738132198523, -8647.830708083757, -8538.766351458253, -8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.171457444465123, "mean_inference_ms": 0.39196701532140193, "mean_action_processing_ms": 0.09429933668528342, "mean_env_wait_ms": 2.9119353515888666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003773212432861328, "StateBufferConnector_ms": 0.002680540084838867, "ViewRequirementAgentConnector_ms": 0.06933403015136719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109800, "num_agent_steps_trained": 109800, "num_env_steps_sampled": 109800, "num_env_steps_trained": 109800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.35752116405816, "num_env_steps_trained_throughput_per_sec": 38.35752116405816, "timesteps_total": 109800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 109800, "timers": {"training_iteration_time_ms": 3105.819, "sample_time_ms": 3101.613, "load_time_ms": 0.25, "load_throughput": 479760.252, "learn_time_ms": 3.117, "learn_throughput": 38497.218, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 109800, "num_env_steps_trained": 109800, "num_agent_steps_sampled": 109800, "num_agent_steps_trained": 109800}, "done": false, "episodes_total": 867, "training_iteration": 216, "trial_id": "668a1_00000", "date": "2023-07-25_18-32-32", "timestamp": 1690299152, "time_this_iter_s": 12.517109870910645, "time_total_s": 2651.1114580631256, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2595.747854232788, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 30.399999999999995, "ram_util_percent": 77.05555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -74105110528.0, "vf_loss": 559825344.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 847.0, "diff_num_grad_updates_vs_sampler_policy": 846.0}}, "num_env_steps_sampled": 110280, "num_env_steps_trained": 110280, "num_agent_steps_sampled": 110280, "num_agent_steps_trained": 110280}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8552.306966813605, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.172043488185526, "mean_inference_ms": 0.39197359738896087, "mean_action_processing_ms": 0.09430019618157587, "mean_env_wait_ms": 2.9118821030698228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037674903869628906, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06926965713500977}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8552.306966813605, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8638.509092250166, -8603.258944921736, -8652.99815776105, -8440.594473170944, -8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.172043488185526, "mean_inference_ms": 0.39197359738896087, "mean_action_processing_ms": 0.09430019618157587, "mean_env_wait_ms": 2.9118821030698228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037674903869628906, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06926965713500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110280, "num_agent_steps_trained": 110280, "num_env_steps_sampled": 110280, "num_env_steps_trained": 110280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.587886526961974, "num_env_steps_trained_throughput_per_sec": 39.587886526961974, "timesteps_total": 110280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 110280, "timers": {"training_iteration_time_ms": 3075.978, "sample_time_ms": 3071.734, "load_time_ms": 0.255, "load_throughput": 471270.112, "learn_time_ms": 3.153, "learn_throughput": 38057.957, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 110280, "num_env_steps_trained": 110280, "num_agent_steps_sampled": 110280, "num_agent_steps_trained": 110280}, "done": false, "episodes_total": 871, "training_iteration": 217, "trial_id": "668a1_00000", "date": "2023-07-25_18-32-44", "timestamp": 1690299164, "time_this_iter_s": 12.127559900283813, "time_total_s": 2663.2390179634094, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2607.875414133072, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 25.823529411764707, "ram_util_percent": 77.05882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7948608398438, "policy_loss": -12043810816.0, "vf_loss": 549827008.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 850.0}}, "num_env_steps_sampled": 110760, "num_env_steps_trained": 110760, "num_agent_steps_sampled": 110760, "num_agent_steps_trained": 110760}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.035775539878, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17255555563338, "mean_inference_ms": 0.39197777727387134, "mean_action_processing_ms": 0.09430062211832474, "mean_env_wait_ms": 2.911813004954795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037679672241210938, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06929373741149902}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.035775539878, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8698.722027677193, -8493.01197572083, -8583.521222527115, -8484.839141608432, -8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17255555563338, "mean_inference_ms": 0.39197777727387134, "mean_action_processing_ms": 0.09430062211832474, "mean_env_wait_ms": 2.911813004954795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037679672241210938, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06929373741149902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110760, "num_agent_steps_trained": 110760, "num_env_steps_sampled": 110760, "num_env_steps_trained": 110760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.55159639550042, "num_env_steps_trained_throughput_per_sec": 39.55159639550042, "timesteps_total": 110760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 110760, "timers": {"training_iteration_time_ms": 3046.015, "sample_time_ms": 3042.242, "load_time_ms": 0.219, "load_throughput": 547976.57, "learn_time_ms": 2.804, "learn_throughput": 42800.476, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 110760, "num_env_steps_trained": 110760, "num_agent_steps_sampled": 110760, "num_agent_steps_trained": 110760}, "done": false, "episodes_total": 875, "training_iteration": 218, "trial_id": "668a1_00000", "date": "2023-07-25_18-32-56", "timestamp": 1690299176, "time_this_iter_s": 12.138862133026123, "time_total_s": 2675.3778800964355, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2620.014276266098, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 29.405882352941177, "ram_util_percent": 76.84705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -50740469760.0, "vf_loss": 564696384.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 855.0, "diff_num_grad_updates_vs_sampler_policy": 854.0}}, "num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.159999283787, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1730066124708, "mean_inference_ms": 0.39198440886263713, "mean_action_processing_ms": 0.09430157247186532, "mean_env_wait_ms": 2.9117302312010906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003777027130126953, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.06940913200378418}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.159999283787, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8593.737260947943, -8653.272107377594, -8515.114989464953, -8595.099608686907, -8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.1730066124708, "mean_inference_ms": 0.39198440886263713, "mean_action_processing_ms": 0.09430157247186532, "mean_env_wait_ms": 2.9117302312010906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003777027130126953, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.06940913200378418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240, "num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.91960457337163, "num_env_steps_trained_throughput_per_sec": 38.91960457337163, "timesteps_total": 111240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 111240, "timers": {"training_iteration_time_ms": 3058.099, "sample_time_ms": 3054.356, "load_time_ms": 0.213, "load_throughput": 562553.347, "learn_time_ms": 2.791, "learn_throughput": 42998.29, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 111240, "num_env_steps_trained": 111240, "num_agent_steps_sampled": 111240, "num_agent_steps_trained": 111240}, "done": false, "episodes_total": 879, "training_iteration": 219, "trial_id": "668a1_00000", "date": "2023-07-25_18-33-08", "timestamp": 1690299188, "time_this_iter_s": 12.335744857788086, "time_total_s": 2687.7136249542236, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2632.350021123886, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 23.549999999999997, "ram_util_percent": 76.83888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7943725585938, "policy_loss": -32574169088.0, "vf_loss": 566001088.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 859.0, "diff_num_grad_updates_vs_sampler_policy": 858.0}}, "num_env_steps_sampled": 111720, "num_env_steps_trained": 111720, "num_agent_steps_sampled": 111720, "num_agent_steps_trained": 111720}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8549.947463444823, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.173441340700396, "mean_inference_ms": 0.39199076552542594, "mean_action_processing_ms": 0.09430259596395887, "mean_env_wait_ms": 2.911612129690734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003763437271118164, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06923413276672363}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8549.947463444823, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8607.575797427604, -8583.327442016503, -8503.356410098459, -8539.185357188491, -8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.173441340700396, "mean_inference_ms": 0.39199076552542594, "mean_action_processing_ms": 0.09430259596395887, "mean_env_wait_ms": 2.911612129690734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003763437271118164, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06923413276672363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111720, "num_agent_steps_trained": 111720, "num_env_steps_sampled": 111720, "num_env_steps_trained": 111720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.84105722621424, "num_env_steps_trained_throughput_per_sec": 38.84105722621424, "timesteps_total": 111720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 111720, "timers": {"training_iteration_time_ms": 3063.449, "sample_time_ms": 3059.662, "load_time_ms": 0.214, "load_throughput": 561173.464, "learn_time_ms": 2.821, "learn_throughput": 42530.672, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 111720, "num_env_steps_trained": 111720, "num_agent_steps_sampled": 111720, "num_agent_steps_trained": 111720}, "done": false, "episodes_total": 883, "training_iteration": 220, "trial_id": "668a1_00000", "date": "2023-07-25_18-33-21", "timestamp": 1690299201, "time_this_iter_s": 12.36090898513794, "time_total_s": 2700.0745339393616, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2644.710930109024, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 23.683333333333334, "ram_util_percent": 76.61666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -74516553728.0, "vf_loss": 566914752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 863.0, "diff_num_grad_updates_vs_sampler_policy": 862.0}}, "num_env_steps_sampled": 112200, "num_env_steps_trained": 112200, "num_agent_steps_sampled": 112200, "num_agent_steps_trained": 112200}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.021832691245, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17387350079598, "mean_inference_ms": 0.3919985565541814, "mean_action_processing_ms": 0.09430392542800195, "mean_env_wait_ms": 2.911474518636761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003766298294067383, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.06926512718200684}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.021832691245, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8616.182937664566, -8492.525074662353, -8603.951122113665, -8560.951236867788, -8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17387350079598, "mean_inference_ms": 0.3919985565541814, "mean_action_processing_ms": 0.09430392542800195, "mean_env_wait_ms": 2.911474518636761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003766298294067383, "StateBufferConnector_ms": 0.002670764923095703, "ViewRequirementAgentConnector_ms": 0.06926512718200684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112200, "num_agent_steps_trained": 112200, "num_env_steps_sampled": 112200, "num_env_steps_trained": 112200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.46091166186407, "num_env_steps_trained_throughput_per_sec": 39.46091166186407, "timesteps_total": 112200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 112200, "timers": {"training_iteration_time_ms": 3056.09, "sample_time_ms": 3052.348, "load_time_ms": 0.214, "load_throughput": 560548.48, "learn_time_ms": 2.773, "learn_throughput": 43266.639, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 112200, "num_env_steps_trained": 112200, "num_agent_steps_sampled": 112200, "num_agent_steps_trained": 112200}, "done": false, "episodes_total": 887, "training_iteration": 221, "trial_id": "668a1_00000", "date": "2023-07-25_18-33-33", "timestamp": 1690299213, "time_this_iter_s": 12.166965007781982, "time_total_s": 2712.2414989471436, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2656.877895116806, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 27.176470588235293, "ram_util_percent": 76.36470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7950439453125, "policy_loss": -17525778432.0, "vf_loss": 548781248.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 867.0, "diff_num_grad_updates_vs_sampler_policy": 866.0}}, "num_env_steps_sampled": 112680, "num_env_steps_trained": 112680, "num_agent_steps_sampled": 112680, "num_agent_steps_trained": 112680}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8549.944376019606, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.174116387869475, "mean_inference_ms": 0.39200672934065833, "mean_action_processing_ms": 0.0943053660370531, "mean_env_wait_ms": 2.911374226697088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003770112991333008, "StateBufferConnector_ms": 0.0026738643646240234, "ViewRequirementAgentConnector_ms": 0.06927680969238281}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8549.944376019606, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8452.133626419376, -8604.836758196625, -8531.079032975082, -8584.80427203519, -8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.174116387869475, "mean_inference_ms": 0.39200672934065833, "mean_action_processing_ms": 0.0943053660370531, "mean_env_wait_ms": 2.911374226697088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003770112991333008, "StateBufferConnector_ms": 0.0026738643646240234, "ViewRequirementAgentConnector_ms": 0.06927680969238281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112680, "num_agent_steps_trained": 112680, "num_env_steps_sampled": 112680, "num_env_steps_trained": 112680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.74179418139727, "num_env_steps_trained_throughput_per_sec": 39.74179418139727, "timesteps_total": 112680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 112680, "timers": {"training_iteration_time_ms": 3046.093, "sample_time_ms": 3042.343, "load_time_ms": 0.215, "load_throughput": 557259.167, "learn_time_ms": 2.771, "learn_throughput": 43305.354, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 112680, "num_env_steps_trained": 112680, "num_agent_steps_sampled": 112680, "num_agent_steps_trained": 112680}, "done": false, "episodes_total": 891, "training_iteration": 222, "trial_id": "668a1_00000", "date": "2023-07-25_18-33-45", "timestamp": 1690299225, "time_this_iter_s": 12.080702304840088, "time_total_s": 2724.3222012519836, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2668.958597421646, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 28.288235294117644, "ram_util_percent": 76.2764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -67820822528.0, "vf_loss": 568970752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 871.0, "diff_num_grad_updates_vs_sampler_policy": 870.0}}, "num_env_steps_sampled": 113160, "num_env_steps_trained": 113160, "num_agent_steps_sampled": 113160, "num_agent_steps_trained": 113160}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.583594994734, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17425954297495, "mean_inference_ms": 0.39201653076927256, "mean_action_processing_ms": 0.09430707425094098, "mean_env_wait_ms": 2.911231338241448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003787994384765625, "StateBufferConnector_ms": 0.0026814937591552734, "ViewRequirementAgentConnector_ms": 0.06950616836547852}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.583594994734, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8689.373076684811, -8523.799964611504, -8456.11794524706, -8567.247096563673, -8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17425954297495, "mean_inference_ms": 0.39201653076927256, "mean_action_processing_ms": 0.09430707425094098, "mean_env_wait_ms": 2.911231338241448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003787994384765625, "StateBufferConnector_ms": 0.0026814937591552734, "ViewRequirementAgentConnector_ms": 0.06950616836547852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113160, "num_agent_steps_trained": 113160, "num_env_steps_sampled": 113160, "num_env_steps_trained": 113160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.98795395378575, "num_env_steps_trained_throughput_per_sec": 39.98795395378575, "timesteps_total": 113160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 113160, "timers": {"training_iteration_time_ms": 3037.719, "sample_time_ms": 3033.989, "load_time_ms": 0.216, "load_throughput": 555475.643, "learn_time_ms": 2.756, "learn_throughput": 43535.722, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 113160, "num_env_steps_trained": 113160, "num_agent_steps_sampled": 113160, "num_agent_steps_trained": 113160}, "done": false, "episodes_total": 895, "training_iteration": 223, "trial_id": "668a1_00000", "date": "2023-07-25_18-33-57", "timestamp": 1690299237, "time_this_iter_s": 12.00635814666748, "time_total_s": 2736.328559398651, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2680.9649555683136, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 35.86470588235294, "ram_util_percent": 76.45882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7944946289062, "policy_loss": -96887685120.0, "vf_loss": 556555648.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 875.0, "diff_num_grad_updates_vs_sampler_policy": 874.0}}, "num_env_steps_sampled": 113640, "num_env_steps_trained": 113640, "num_agent_steps_sampled": 113640, "num_agent_steps_trained": 113640}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.583111223017, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.174354219864636, "mean_inference_ms": 0.3920264341963653, "mean_action_processing_ms": 0.0943087992012262, "mean_env_wait_ms": 2.9110733967905684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003790616989135742, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06948399543762207}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8550.583111223017, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8338.198019006544, -8649.121487395807, -8437.419981087627, -8493.369432582665, -8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.174354219864636, "mean_inference_ms": 0.3920264341963653, "mean_action_processing_ms": 0.0943087992012262, "mean_env_wait_ms": 2.9110733967905684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003790616989135742, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06948399543762207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113640, "num_agent_steps_trained": 113640, "num_env_steps_sampled": 113640, "num_env_steps_trained": 113640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.18519877214907, "num_env_steps_trained_throughput_per_sec": 39.18519877214907, "timesteps_total": 113640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 113640, "timers": {"training_iteration_time_ms": 3029.241, "sample_time_ms": 3025.474, "load_time_ms": 0.216, "load_throughput": 556519.77, "learn_time_ms": 2.779, "learn_throughput": 43183.856, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 113640, "num_env_steps_trained": 113640, "num_agent_steps_sampled": 113640, "num_agent_steps_trained": 113640}, "done": false, "episodes_total": 899, "training_iteration": 224, "trial_id": "668a1_00000", "date": "2023-07-25_18-34-09", "timestamp": 1690299249, "time_this_iter_s": 12.25235104560852, "time_total_s": 2748.5809104442596, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2693.217306613922, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 25.238888888888887, "ram_util_percent": 76.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7949829101562, "policy_loss": -14054624256.0, "vf_loss": 558290048.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 879.0, "diff_num_grad_updates_vs_sampler_policy": 878.0}}, "num_env_steps_sampled": 114120, "num_env_steps_trained": 114120, "num_agent_steps_sampled": 114120, "num_agent_steps_trained": 114120}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8554.922806536655, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17445539465117, "mean_inference_ms": 0.39203430360323255, "mean_action_processing_ms": 0.09431019647085032, "mean_env_wait_ms": 2.910906744528418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037741661071777344, "StateBufferConnector_ms": 0.002685070037841797, "ViewRequirementAgentConnector_ms": 0.06933760643005371}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8554.922806536655, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8438.55883265489, -8688.669786677281, -8531.529434902615, -8420.998983462925, -8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17445539465117, "mean_inference_ms": 0.39203430360323255, "mean_action_processing_ms": 0.09431019647085032, "mean_env_wait_ms": 2.910906744528418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037741661071777344, "StateBufferConnector_ms": 0.002685070037841797, "ViewRequirementAgentConnector_ms": 0.06933760643005371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114120, "num_agent_steps_trained": 114120, "num_env_steps_sampled": 114120, "num_env_steps_trained": 114120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.9704526264445, "num_env_steps_trained_throughput_per_sec": 38.9704526264445, "timesteps_total": 114120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 114120, "timers": {"training_iteration_time_ms": 3061.554, "sample_time_ms": 3057.79, "load_time_ms": 0.216, "load_throughput": 555966.508, "learn_time_ms": 2.799, "learn_throughput": 42878.141, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 114120, "num_env_steps_trained": 114120, "num_agent_steps_sampled": 114120, "num_agent_steps_trained": 114120}, "done": false, "episodes_total": 903, "training_iteration": 225, "trial_id": "668a1_00000", "date": "2023-07-25_18-34-22", "timestamp": 1690299262, "time_this_iter_s": 12.319894790649414, "time_total_s": 2760.900805234909, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2705.5372014045715, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 24.235294117647054, "ram_util_percent": 76.04117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7941284179688, "policy_loss": -65918853120.0, "vf_loss": 583495168.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 883.0, "diff_num_grad_updates_vs_sampler_policy": 882.0}}, "num_env_steps_sampled": 114600, "num_env_steps_trained": 114600, "num_agent_steps_sampled": 114600, "num_agent_steps_trained": 114600}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8557.505114492036, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17440791218069, "mean_inference_ms": 0.3920424183713989, "mean_action_processing_ms": 0.09431163423357905, "mean_env_wait_ms": 2.9107297970817525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037817955017089844, "StateBufferConnector_ms": 0.002693653106689453, "ViewRequirementAgentConnector_ms": 0.0695500373840332}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8557.505114492036, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8654.04585960505, -8484.945402489058, -8454.23439696975, -8585.377716120707, -8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.17440791218069, "mean_inference_ms": 0.3920424183713989, "mean_action_processing_ms": 0.09431163423357905, "mean_env_wait_ms": 2.9107297970817525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037817955017089844, "StateBufferConnector_ms": 0.002693653106689453, "ViewRequirementAgentConnector_ms": 0.0695500373840332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114600, "num_agent_steps_trained": 114600, "num_env_steps_sampled": 114600, "num_env_steps_trained": 114600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.77111379039551, "num_env_steps_trained_throughput_per_sec": 39.77111379039551, "timesteps_total": 114600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 114600, "timers": {"training_iteration_time_ms": 3044.801, "sample_time_ms": 3041.03, "load_time_ms": 0.217, "load_throughput": 553642.592, "learn_time_ms": 2.801, "learn_throughput": 42837.997, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 114600, "num_env_steps_trained": 114600, "num_agent_steps_sampled": 114600, "num_agent_steps_trained": 114600}, "done": false, "episodes_total": 907, "training_iteration": 226, "trial_id": "668a1_00000", "date": "2023-07-25_18-34-34", "timestamp": 1690299274, "time_this_iter_s": 12.071953773498535, "time_total_s": 2772.9727590084076, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2717.60915517807, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 29.629411764705885, "ram_util_percent": 75.83529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7951049804688, "policy_loss": -54403088384.0, "vf_loss": 552121280.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 887.0, "diff_num_grad_updates_vs_sampler_policy": 886.0}}, "num_env_steps_sampled": 115080, "num_env_steps_trained": 115080, "num_agent_steps_sampled": 115080, "num_agent_steps_trained": 115080}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8555.829143843299, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.174299214720396, "mean_inference_ms": 0.3920527279212223, "mean_action_processing_ms": 0.09431419385762924, "mean_env_wait_ms": 2.91056291544006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037796497344970703, "StateBufferConnector_ms": 0.002685070037841797, "ViewRequirementAgentConnector_ms": 0.06949877738952637}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8555.829143843299, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8492.706951827635, -8659.236548354229, -8763.318025489047, -8634.779980647407, -8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.174299214720396, "mean_inference_ms": 0.3920527279212223, "mean_action_processing_ms": 0.09431419385762924, "mean_env_wait_ms": 2.91056291544006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037796497344970703, "StateBufferConnector_ms": 0.002685070037841797, "ViewRequirementAgentConnector_ms": 0.06949877738952637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115080, "num_agent_steps_trained": 115080, "num_env_steps_sampled": 115080, "num_env_steps_trained": 115080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.32008095468499, "num_env_steps_trained_throughput_per_sec": 39.32008095468499, "timesteps_total": 115080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 115080, "timers": {"training_iteration_time_ms": 3052.768, "sample_time_ms": 3048.984, "load_time_ms": 0.217, "load_throughput": 553703.498, "learn_time_ms": 2.8, "learn_throughput": 42856.965, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 115080, "num_env_steps_trained": 115080, "num_agent_steps_sampled": 115080, "num_agent_steps_trained": 115080}, "done": false, "episodes_total": 911, "training_iteration": 227, "trial_id": "668a1_00000", "date": "2023-07-25_18-34-46", "timestamp": 1690299286, "time_this_iter_s": 12.210670948028564, "time_total_s": 2785.183429956436, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2729.8198261260986, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 27.055555555555557, "ram_util_percent": 76.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7952270507812, "policy_loss": -51686555648.0, "vf_loss": 531638560.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 891.0, "diff_num_grad_updates_vs_sampler_policy": 890.0}}, "num_env_steps_sampled": 115560, "num_env_steps_trained": 115560, "num_agent_steps_sampled": 115560, "num_agent_steps_trained": 115560}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8552.984925041746, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.174048913305125, "mean_inference_ms": 0.3920626429751857, "mean_action_processing_ms": 0.0943167186601408, "mean_env_wait_ms": 2.9103811931874763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037763118743896484, "StateBufferConnector_ms": 0.0026700496673583984, "ViewRequirementAgentConnector_ms": 0.06942009925842285}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8552.984925041746, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8448.135751647831, -8541.57134624982, -8558.391736925154, -8583.488767096616, -8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.174048913305125, "mean_inference_ms": 0.3920626429751857, "mean_action_processing_ms": 0.0943167186601408, "mean_env_wait_ms": 2.9103811931874763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037763118743896484, "StateBufferConnector_ms": 0.0026700496673583984, "ViewRequirementAgentConnector_ms": 0.06942009925842285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115560, "num_agent_steps_trained": 115560, "num_env_steps_sampled": 115560, "num_env_steps_trained": 115560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.37398417091634, "num_env_steps_trained_throughput_per_sec": 40.37398417091634, "timesteps_total": 115560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 115560, "timers": {"training_iteration_time_ms": 3023.531, "sample_time_ms": 3019.763, "load_time_ms": 0.215, "load_throughput": 558433.907, "learn_time_ms": 2.779, "learn_throughput": 43188.303, "synch_weights_time_ms": 0.733}, "counters": {"num_env_steps_sampled": 115560, "num_env_steps_trained": 115560, "num_agent_steps_sampled": 115560, "num_agent_steps_trained": 115560}, "done": false, "episodes_total": 915, "training_iteration": 228, "trial_id": "668a1_00000", "date": "2023-07-25_18-34-58", "timestamp": 1690299298, "time_this_iter_s": 11.891553163528442, "time_total_s": 2797.0749831199646, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2741.711379289627, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 31.717647058823527, "ram_util_percent": 76.32941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.79443359375, "policy_loss": -59156094976.0, "vf_loss": 551396608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 895.0, "diff_num_grad_updates_vs_sampler_policy": 894.0}}, "num_env_steps_sampled": 116040, "num_env_steps_trained": 116040, "num_agent_steps_sampled": 116040, "num_agent_steps_trained": 116040}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8555.774939895806, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.173770944166286, "mean_inference_ms": 0.39207314104911023, "mean_action_processing_ms": 0.09431929381528086, "mean_env_wait_ms": 2.9101900312831406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003772258758544922, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06949305534362793}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8555.774939895806, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8541.547370376402, -8573.473222428853, -8507.15957545138, -8630.487860121802, -8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.173770944166286, "mean_inference_ms": 0.39207314104911023, "mean_action_processing_ms": 0.09431929381528086, "mean_env_wait_ms": 2.9101900312831406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003772258758544922, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06949305534362793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116040, "num_agent_steps_trained": 116040, "num_env_steps_sampled": 116040, "num_env_steps_trained": 116040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.59493029990349, "num_env_steps_trained_throughput_per_sec": 39.59493029990349, "timesteps_total": 116040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 116040, "timers": {"training_iteration_time_ms": 3015.225, "sample_time_ms": 3011.499, "load_time_ms": 0.215, "load_throughput": 558992.092, "learn_time_ms": 2.751, "learn_throughput": 43617.592, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 116040, "num_env_steps_trained": 116040, "num_agent_steps_sampled": 116040, "num_agent_steps_trained": 116040}, "done": false, "episodes_total": 919, "training_iteration": 229, "trial_id": "668a1_00000", "date": "2023-07-25_18-35-10", "timestamp": 1690299310, "time_this_iter_s": 12.125553846359253, "time_total_s": 2809.200536966324, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2753.8369331359863, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 26.970588235294116, "ram_util_percent": 76.57647058823531}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7938842773438, "policy_loss": -61473013760.0, "vf_loss": 567141760.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 899.0, "diff_num_grad_updates_vs_sampler_policy": 898.0}}, "num_env_steps_sampled": 116520, "num_env_steps_trained": 116520, "num_agent_steps_sampled": 116520, "num_agent_steps_trained": 116520}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8558.691282324871, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.173380509417626, "mean_inference_ms": 0.3920834367624573, "mean_action_processing_ms": 0.09432172466715989, "mean_env_wait_ms": 2.9100174670946894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037665367126464844, "StateBufferConnector_ms": 0.002672910690307617, "ViewRequirementAgentConnector_ms": 0.06947803497314453}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8558.691282324871, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8548.682925356621, -8630.275966935471, -8641.175158548667, -8438.223758419264, -8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.173380509417626, "mean_inference_ms": 0.3920834367624573, "mean_action_processing_ms": 0.09432172466715989, "mean_env_wait_ms": 2.9100174670946894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037665367126464844, "StateBufferConnector_ms": 0.002672910690307617, "ViewRequirementAgentConnector_ms": 0.06947803497314453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116520, "num_agent_steps_trained": 116520, "num_env_steps_sampled": 116520, "num_env_steps_trained": 116520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.73176764402654, "num_env_steps_trained_throughput_per_sec": 39.73176764402654, "timesteps_total": 116520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 116520, "timers": {"training_iteration_time_ms": 3014.899, "sample_time_ms": 3011.231, "load_time_ms": 0.211, "load_throughput": 567628.826, "learn_time_ms": 2.712, "learn_throughput": 44243.324, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 116520, "num_env_steps_trained": 116520, "num_agent_steps_sampled": 116520, "num_agent_steps_trained": 116520}, "done": false, "episodes_total": 923, "training_iteration": 230, "trial_id": "668a1_00000", "date": "2023-07-25_18-35-22", "timestamp": 1690299322, "time_this_iter_s": 12.083831071853638, "time_total_s": 2821.2843680381775, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2765.92076420784, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 25.847058823529412, "ram_util_percent": 76.52352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7941284179688, "policy_loss": -60414222336.0, "vf_loss": 578665280.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 903.0, "diff_num_grad_updates_vs_sampler_policy": 902.0}}, "num_env_steps_sampled": 117000, "num_env_steps_trained": 117000, "num_agent_steps_sampled": 117000, "num_agent_steps_trained": 117000}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8558.897032576078, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.172907075463154, "mean_inference_ms": 0.3920917907383409, "mean_action_processing_ms": 0.09432388086082089, "mean_env_wait_ms": 2.909847823167327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003770589828491211, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.06950068473815918}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8558.897032576078, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8635.586159686662, -8577.536689880437, -8436.285290955277, -8501.090598795126, -8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.172907075463154, "mean_inference_ms": 0.3920917907383409, "mean_action_processing_ms": 0.09432388086082089, "mean_env_wait_ms": 2.909847823167327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003770589828491211, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.06950068473815918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117000, "num_agent_steps_trained": 117000, "num_env_steps_sampled": 117000, "num_env_steps_trained": 117000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.43899957982347, "num_env_steps_trained_throughput_per_sec": 39.43899957982347, "timesteps_total": 117000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 117000, "timers": {"training_iteration_time_ms": 3026.247, "sample_time_ms": 3022.566, "load_time_ms": 0.213, "load_throughput": 563245.837, "learn_time_ms": 2.719, "learn_throughput": 44131.987, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 117000, "num_env_steps_trained": 117000, "num_agent_steps_sampled": 117000, "num_agent_steps_trained": 117000}, "done": false, "episodes_total": 927, "training_iteration": 231, "trial_id": "668a1_00000", "date": "2023-07-25_18-35-34", "timestamp": 1690299334, "time_this_iter_s": 12.173511981964111, "time_total_s": 2833.4578800201416, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2778.094276189804, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 25.1, "ram_util_percent": 76.54117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -45281189888.0, "vf_loss": 583396352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 907.0, "diff_num_grad_updates_vs_sampler_policy": 906.0}}, "num_env_steps_sampled": 117480, "num_env_steps_trained": 117480, "num_agent_steps_sampled": 117480, "num_agent_steps_trained": 117480}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8560.111006688725, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.172341744122924, "mean_inference_ms": 0.3921017006875473, "mean_action_processing_ms": 0.09432624427548357, "mean_env_wait_ms": 2.9096837448092883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037717819213867188, "StateBufferConnector_ms": 0.002676248550415039, "ViewRequirementAgentConnector_ms": 0.0695047378540039}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8560.111006688725, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8492.158836616645, -8657.386344676406, -8452.622553030973, -8631.01539238088, -8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.172341744122924, "mean_inference_ms": 0.3921017006875473, "mean_action_processing_ms": 0.09432624427548357, "mean_env_wait_ms": 2.9096837448092883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037717819213867188, "StateBufferConnector_ms": 0.002676248550415039, "ViewRequirementAgentConnector_ms": 0.0695047378540039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117480, "num_agent_steps_trained": 117480, "num_env_steps_sampled": 117480, "num_env_steps_trained": 117480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.559734146541025, "num_env_steps_trained_throughput_per_sec": 39.559734146541025, "timesteps_total": 117480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 117480, "timers": {"training_iteration_time_ms": 3039.353, "sample_time_ms": 3035.611, "load_time_ms": 0.218, "load_throughput": 550132.78, "learn_time_ms": 2.777, "learn_throughput": 43217.97, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 117480, "num_env_steps_trained": 117480, "num_agent_steps_sampled": 117480, "num_agent_steps_trained": 117480}, "done": false, "episodes_total": 931, "training_iteration": 232, "trial_id": "668a1_00000", "date": "2023-07-25_18-35-47", "timestamp": 1690299347, "time_this_iter_s": 12.13634204864502, "time_total_s": 2845.5942220687866, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2790.230618238449, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 28.061111111111114, "ram_util_percent": 76.68888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794189453125, "policy_loss": -70356058112.0, "vf_loss": 568794048.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 911.0, "diff_num_grad_updates_vs_sampler_policy": 910.0}}, "num_env_steps_sampled": 117960, "num_env_steps_trained": 117960, "num_agent_steps_sampled": 117960, "num_agent_steps_trained": 117960}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8557.00039786517, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.171862697599487, "mean_inference_ms": 0.3921111546391644, "mean_action_processing_ms": 0.09432847294999315, "mean_env_wait_ms": 2.909516081783595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037772655487060547, "StateBufferConnector_ms": 0.0026845932006835938, "ViewRequirementAgentConnector_ms": 0.06963801383972168}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8557.00039786517, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8529.30559374666, -8466.508658734965, -8559.5375646725, -8452.726227255436, -8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.171862697599487, "mean_inference_ms": 0.3921111546391644, "mean_action_processing_ms": 0.09432847294999315, "mean_env_wait_ms": 2.909516081783595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037772655487060547, "StateBufferConnector_ms": 0.0026845932006835938, "ViewRequirementAgentConnector_ms": 0.06963801383972168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117960, "num_agent_steps_trained": 117960, "num_env_steps_sampled": 117960, "num_env_steps_trained": 117960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.32618878159587, "num_env_steps_trained_throughput_per_sec": 38.32618878159587, "timesteps_total": 117960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 117960, "timers": {"training_iteration_time_ms": 3079.472, "sample_time_ms": 3075.703, "load_time_ms": 0.216, "load_throughput": 554313.304, "learn_time_ms": 2.791, "learn_throughput": 42996.82, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 117960, "num_env_steps_trained": 117960, "num_agent_steps_sampled": 117960, "num_agent_steps_trained": 117960}, "done": false, "episodes_total": 935, "training_iteration": 233, "trial_id": "668a1_00000", "date": "2023-07-25_18-35-59", "timestamp": 1690299359, "time_this_iter_s": 12.52688217163086, "time_total_s": 2858.1211042404175, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2802.75750041008, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 23.43888888888889, "ram_util_percent": 76.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7940063476562, "policy_loss": -82722430976.0, "vf_loss": 578623232.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 915.0, "diff_num_grad_updates_vs_sampler_policy": 914.0}}, "num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8561.256482961633, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.171434606295705, "mean_inference_ms": 0.3921198359702383, "mean_action_processing_ms": 0.0943306746661434, "mean_env_wait_ms": 2.9093094240608837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037734508514404297, "StateBufferConnector_ms": 0.0026819705963134766, "ViewRequirementAgentConnector_ms": 0.0695652961730957}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8561.256482961633, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8539.353505898014, -8609.034364081404, -8622.49645390981, -8448.490424875137, -8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.171434606295705, "mean_inference_ms": 0.3921198359702383, "mean_action_processing_ms": 0.0943306746661434, "mean_env_wait_ms": 2.9093094240608837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037734508514404297, "StateBufferConnector_ms": 0.0026819705963134766, "ViewRequirementAgentConnector_ms": 0.0695652961730957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440, "num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.1276978025771, "num_env_steps_trained_throughput_per_sec": 39.1276978025771, "timesteps_total": 118440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 118440, "timers": {"training_iteration_time_ms": 3076.65, "sample_time_ms": 3072.852, "load_time_ms": 0.217, "load_throughput": 553825.352, "learn_time_ms": 2.808, "learn_throughput": 42731.798, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 118440, "num_env_steps_trained": 118440, "num_agent_steps_sampled": 118440, "num_agent_steps_trained": 118440}, "done": false, "episodes_total": 939, "training_iteration": 234, "trial_id": "668a1_00000", "date": "2023-07-25_18-36-12", "timestamp": 1690299372, "time_this_iter_s": 12.270262956619263, "time_total_s": 2870.3913671970367, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2815.027763366699, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 25.2764705882353, "ram_util_percent": 75.93529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7935791015625, "policy_loss": -25697210368.0, "vf_loss": 572519424.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 919.0, "diff_num_grad_updates_vs_sampler_policy": 918.0}}, "num_env_steps_sampled": 118920, "num_env_steps_trained": 118920, "num_agent_steps_sampled": 118920, "num_agent_steps_trained": 118920}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8561.624290879605, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.170921314520925, "mean_inference_ms": 0.39212818818279843, "mean_action_processing_ms": 0.0943328367424283, "mean_env_wait_ms": 2.9091140711556935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037648677825927734, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06944847106933594}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8561.624290879605, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8327.670364732561, -8538.540961972332, -8603.15798481629, -8693.803912290026, -8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.170921314520925, "mean_inference_ms": 0.39212818818279843, "mean_action_processing_ms": 0.0943328367424283, "mean_env_wait_ms": 2.9091140711556935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037648677825927734, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06944847106933594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118920, "num_agent_steps_trained": 118920, "num_env_steps_sampled": 118920, "num_env_steps_trained": 118920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.13520406779748, "num_env_steps_trained_throughput_per_sec": 39.13520406779748, "timesteps_total": 118920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 118920, "timers": {"training_iteration_time_ms": 3062.259, "sample_time_ms": 3058.501, "load_time_ms": 0.215, "load_throughput": 558557.852, "learn_time_ms": 2.783, "learn_throughput": 43117.636, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 118920, "num_env_steps_trained": 118920, "num_agent_steps_sampled": 118920, "num_agent_steps_trained": 118920}, "done": false, "episodes_total": 943, "training_iteration": 235, "trial_id": "668a1_00000", "date": "2023-07-25_18-36-24", "timestamp": 1690299384, "time_this_iter_s": 12.26794981956482, "time_total_s": 2882.6593170166016, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2827.295713186264, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 23.72222222222222, "ram_util_percent": 76.54444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7940063476562, "policy_loss": -52941615104.0, "vf_loss": 577803776.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 922.0}}, "num_env_steps_sampled": 119400, "num_env_steps_trained": 119400, "num_agent_steps_sampled": 119400, "num_agent_steps_trained": 119400}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8562.987183539411, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.170243700161873, "mean_inference_ms": 0.3921371797663506, "mean_action_processing_ms": 0.09433497883273922, "mean_env_wait_ms": 2.908934227905131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003768444061279297, "StateBufferConnector_ms": 0.0026712417602539062, "ViewRequirementAgentConnector_ms": 0.06946754455566406}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8562.987183539411, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8477.17070805924, -8535.975963440425, -8618.052092112373, -8710.253800610306, -8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.170243700161873, "mean_inference_ms": 0.3921371797663506, "mean_action_processing_ms": 0.09433497883273922, "mean_env_wait_ms": 2.908934227905131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003768444061279297, "StateBufferConnector_ms": 0.0026712417602539062, "ViewRequirementAgentConnector_ms": 0.06946754455566406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119400, "num_agent_steps_trained": 119400, "num_env_steps_sampled": 119400, "num_env_steps_trained": 119400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.74940059483548, "num_env_steps_trained_throughput_per_sec": 39.74940059483548, "timesteps_total": 119400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 119400, "timers": {"training_iteration_time_ms": 3053.132, "sample_time_ms": 3049.361, "load_time_ms": 0.216, "load_throughput": 555598.278, "learn_time_ms": 2.797, "learn_throughput": 42898.606, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 119400, "num_env_steps_trained": 119400, "num_agent_steps_sampled": 119400, "num_agent_steps_trained": 119400}, "done": false, "episodes_total": 947, "training_iteration": 236, "trial_id": "668a1_00000", "date": "2023-07-25_18-36-36", "timestamp": 1690299396, "time_this_iter_s": 12.07844877243042, "time_total_s": 2894.737765789032, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2839.3741619586945, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 26.6, "ram_util_percent": 76.50588235294119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -46741979136.0, "vf_loss": 571474944.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 927.0, "diff_num_grad_updates_vs_sampler_policy": 926.0}}, "num_env_steps_sampled": 119880, "num_env_steps_trained": 119880, "num_agent_steps_sampled": 119880, "num_agent_steps_trained": 119880}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8561.149267734541, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.169530747734616, "mean_inference_ms": 0.3921473576440292, "mean_action_processing_ms": 0.09433731187550577, "mean_env_wait_ms": 2.9087466904576336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003764629364013672, "StateBufferConnector_ms": 0.0026688575744628906, "ViewRequirementAgentConnector_ms": 0.06944608688354492}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8561.149267734541, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8493.994237898822, -8508.252510488684, -8606.008316585692, -8635.50259736224, -8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.169530747734616, "mean_inference_ms": 0.3921473576440292, "mean_action_processing_ms": 0.09433731187550577, "mean_env_wait_ms": 2.9087466904576336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003764629364013672, "StateBufferConnector_ms": 0.0026688575744628906, "ViewRequirementAgentConnector_ms": 0.06944608688354492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119880, "num_agent_steps_trained": 119880, "num_env_steps_sampled": 119880, "num_env_steps_trained": 119880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.116580983913785, "num_env_steps_trained_throughput_per_sec": 39.116580983913785, "timesteps_total": 119880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 119880, "timers": {"training_iteration_time_ms": 3068.562, "sample_time_ms": 3064.717, "load_time_ms": 0.222, "load_throughput": 540677.28, "learn_time_ms": 2.845, "learn_throughput": 42175.003, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 119880, "num_env_steps_trained": 119880, "num_agent_steps_sampled": 119880, "num_agent_steps_trained": 119880}, "done": false, "episodes_total": 951, "training_iteration": 237, "trial_id": "668a1_00000", "date": "2023-07-25_18-36-48", "timestamp": 1690299408, "time_this_iter_s": 12.273903846740723, "time_total_s": 2907.0116696357727, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2851.648065805435, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 25.394117647058827, "ram_util_percent": 76.55294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7944946289062, "policy_loss": -75860180992.0, "vf_loss": 563869120.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 931.0, "diff_num_grad_updates_vs_sampler_policy": 930.0}}, "num_env_steps_sampled": 120360, "num_env_steps_trained": 120360, "num_agent_steps_sampled": 120360, "num_agent_steps_trained": 120360}, "sampler_results": {"episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8560.670683736278, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.168894357548215, "mean_inference_ms": 0.39215696453229343, "mean_action_processing_ms": 0.09433962588083564, "mean_env_wait_ms": 2.908578771579841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037686824798583984, "StateBufferConnector_ms": 0.002661466598510742, "ViewRequirementAgentConnector_ms": 0.06947970390319824}}, "episode_reward_max": -8279.694846105116, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8560.670683736278, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8588.414066809028, -8522.059409801854, -8610.732932042907, -8279.694846105116, -8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.168894357548215, "mean_inference_ms": 0.39215696453229343, "mean_action_processing_ms": 0.09433962588083564, "mean_env_wait_ms": 2.908578771579841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037686824798583984, "StateBufferConnector_ms": 0.002661466598510742, "ViewRequirementAgentConnector_ms": 0.06947970390319824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120360, "num_agent_steps_trained": 120360, "num_env_steps_sampled": 120360, "num_env_steps_trained": 120360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.73864095627818, "num_env_steps_trained_throughput_per_sec": 38.73864095627818, "timesteps_total": 120360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 120360, "timers": {"training_iteration_time_ms": 3065.323, "sample_time_ms": 3061.508, "load_time_ms": 0.222, "load_throughput": 540967.842, "learn_time_ms": 2.823, "learn_throughput": 42504.812, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 120360, "num_env_steps_trained": 120360, "num_agent_steps_sampled": 120360, "num_agent_steps_trained": 120360}, "done": false, "episodes_total": 955, "training_iteration": 238, "trial_id": "668a1_00000", "date": "2023-07-25_18-37-01", "timestamp": 1690299421, "time_this_iter_s": 12.393526077270508, "time_total_s": 2919.405195713043, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2864.0415918827057, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 23.294444444444444, "ram_util_percent": 76.46111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7948608398438, "policy_loss": -43519803392.0, "vf_loss": 557691264.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 935.0, "diff_num_grad_updates_vs_sampler_policy": 934.0}}, "num_env_steps_sampled": 120840, "num_env_steps_trained": 120840, "num_agent_steps_sampled": 120840, "num_agent_steps_trained": 120840}, "sampler_results": {"episode_reward_max": -8347.098233329905, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8561.824250248279, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.168200107187896, "mean_inference_ms": 0.3921706798903479, "mean_action_processing_ms": 0.09434270924819295, "mean_env_wait_ms": 2.9084313593602826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038008689880371094, "StateBufferConnector_ms": 0.0026831626892089844, "ViewRequirementAgentConnector_ms": 0.07008838653564453}}, "episode_reward_max": -8347.098233329905, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8561.824250248279, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8470.280824233487, -8458.641986511613, -8517.04679916253, -8514.003571761794, -8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.168200107187896, "mean_inference_ms": 0.3921706798903479, "mean_action_processing_ms": 0.09434270924819295, "mean_env_wait_ms": 2.9084313593602826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038008689880371094, "StateBufferConnector_ms": 0.0026831626892089844, "ViewRequirementAgentConnector_ms": 0.07008838653564453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120840, "num_agent_steps_trained": 120840, "num_env_steps_sampled": 120840, "num_env_steps_trained": 120840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.060207868313746, "num_env_steps_trained_throughput_per_sec": 39.060207868313746, "timesteps_total": 120840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 120840, "timers": {"training_iteration_time_ms": 3071.438, "sample_time_ms": 3067.62, "load_time_ms": 0.222, "load_throughput": 541316.928, "learn_time_ms": 2.827, "learn_throughput": 42443.878, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 120840, "num_env_steps_trained": 120840, "num_agent_steps_sampled": 120840, "num_agent_steps_trained": 120840}, "done": false, "episodes_total": 959, "training_iteration": 239, "trial_id": "668a1_00000", "date": "2023-07-25_18-37-13", "timestamp": 1690299433, "time_this_iter_s": 12.291445016860962, "time_total_s": 2931.696640729904, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2876.3330368995667, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 25.22941176470588, "ram_util_percent": 76.4470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.795166015625, "policy_loss": -43860860928.0, "vf_loss": 564825984.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 939.0, "diff_num_grad_updates_vs_sampler_policy": 938.0}}, "num_env_steps_sampled": 121320, "num_env_steps_trained": 121320, "num_agent_steps_sampled": 121320, "num_agent_steps_trained": 121320}, "sampler_results": {"episode_reward_max": -8347.098233329905, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8562.109620507508, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.167431963642763, "mean_inference_ms": 0.3921842060775127, "mean_action_processing_ms": 0.09434571616091633, "mean_env_wait_ms": 2.908290192349001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003801107406616211, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.07009172439575195}}, "episode_reward_max": -8347.098233329905, "episode_reward_min": -8843.335290005398, "episode_reward_mean": -8562.109620507508, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8505.679445121532, -8634.016769603057, -8509.881283727422, -8843.335290005398, -8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.167431963642763, "mean_inference_ms": 0.3921842060775127, "mean_action_processing_ms": 0.09434571616091633, "mean_env_wait_ms": 2.908290192349001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003801107406616211, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.07009172439575195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121320, "num_agent_steps_trained": 121320, "num_env_steps_sampled": 121320, "num_env_steps_trained": 121320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.08623824670141, "num_env_steps_trained_throughput_per_sec": 39.08623824670141, "timesteps_total": 121320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 121320, "timers": {"training_iteration_time_ms": 3060.754, "sample_time_ms": 3057.057, "load_time_ms": 0.214, "load_throughput": 561361.231, "learn_time_ms": 2.733, "learn_throughput": 43901.792, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 121320, "num_env_steps_trained": 121320, "num_agent_steps_sampled": 121320, "num_agent_steps_trained": 121320}, "done": false, "episodes_total": 963, "training_iteration": 240, "trial_id": "668a1_00000", "date": "2023-07-25_18-37-25", "timestamp": 1690299445, "time_this_iter_s": 12.283324956893921, "time_total_s": 2943.979965686798, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2888.6163618564606, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 25.527777777777775, "ram_util_percent": 76.31666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7945556640625, "policy_loss": -45596020736.0, "vf_loss": 565723520.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 943.0, "diff_num_grad_updates_vs_sampler_policy": 942.0}}, "num_env_steps_sampled": 121800, "num_env_steps_trained": 121800, "num_agent_steps_sampled": 121800, "num_agent_steps_trained": 121800}, "sampler_results": {"episode_reward_max": -8347.098233329905, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8559.109273671047, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16657743169354, "mean_inference_ms": 0.39218801375658996, "mean_action_processing_ms": 0.09434736944247525, "mean_env_wait_ms": 2.908085037755527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780841827392578, "StateBufferConnector_ms": 0.0026712417602539062, "ViewRequirementAgentConnector_ms": 0.06980299949645996}}, "episode_reward_max": -8347.098233329905, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8559.109273671047, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8604.998007278757, -8507.275383400438, -8499.487261958147, -8567.380262553252, -8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16657743169354, "mean_inference_ms": 0.39218801375658996, "mean_action_processing_ms": 0.09434736944247525, "mean_env_wait_ms": 2.908085037755527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780841827392578, "StateBufferConnector_ms": 0.0026712417602539062, "ViewRequirementAgentConnector_ms": 0.06980299949645996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121800, "num_agent_steps_trained": 121800, "num_env_steps_sampled": 121800, "num_env_steps_trained": 121800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.79669874144195, "num_env_steps_trained_throughput_per_sec": 39.79669874144195, "timesteps_total": 121800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 121800, "timers": {"training_iteration_time_ms": 3063.212, "sample_time_ms": 3059.48, "load_time_ms": 0.214, "load_throughput": 560985.823, "learn_time_ms": 2.752, "learn_throughput": 43606.633, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 121800, "num_env_steps_trained": 121800, "num_agent_steps_sampled": 121800, "num_agent_steps_trained": 121800}, "done": false, "episodes_total": 967, "training_iteration": 241, "trial_id": "668a1_00000", "date": "2023-07-25_18-37-37", "timestamp": 1690299457, "time_this_iter_s": 12.06406307220459, "time_total_s": 2956.0440287590027, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2900.680424928665, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 26.352941176470587, "ram_util_percent": 76.25882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.794921875, "policy_loss": -29759328256.0, "vf_loss": 547952768.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 947.0, "diff_num_grad_updates_vs_sampler_policy": 946.0}}, "num_env_steps_sampled": 122280, "num_env_steps_trained": 122280, "num_agent_steps_sampled": 122280, "num_agent_steps_trained": 122280}, "sampler_results": {"episode_reward_max": -8347.098233329905, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8559.823067874859, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162, -8577.90392085957, -8444.947155288899, -8735.236070171622, -8492.433189251751], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16581412991307, "mean_inference_ms": 0.39219266194714025, "mean_action_processing_ms": 0.094349254692467, "mean_env_wait_ms": 2.907878250137601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003798961639404297, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06981587409973145}}, "episode_reward_max": -8347.098233329905, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8559.823067874859, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8565.01001301163, -8611.701711636957, -8461.107752063535, -8470.422064018996, -8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162, -8577.90392085957, -8444.947155288899, -8735.236070171622, -8492.433189251751], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16581412991307, "mean_inference_ms": 0.39219266194714025, "mean_action_processing_ms": 0.094349254692467, "mean_env_wait_ms": 2.907878250137601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003798961639404297, "StateBufferConnector_ms": 0.0026705265045166016, "ViewRequirementAgentConnector_ms": 0.06981587409973145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122280, "num_agent_steps_trained": 122280, "num_env_steps_sampled": 122280, "num_env_steps_trained": 122280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.87497512948117, "num_env_steps_trained_throughput_per_sec": 38.87497512948117, "timesteps_total": 122280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 122280, "timers": {"training_iteration_time_ms": 3065.056, "sample_time_ms": 3061.289, "load_time_ms": 0.214, "load_throughput": 559613.609, "learn_time_ms": 2.777, "learn_throughput": 43208.695, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 122280, "num_env_steps_trained": 122280, "num_agent_steps_sampled": 122280, "num_agent_steps_trained": 122280}, "done": false, "episodes_total": 971, "training_iteration": 242, "trial_id": "668a1_00000", "date": "2023-07-25_18-37-50", "timestamp": 1690299470, "time_this_iter_s": 12.350043058395386, "time_total_s": 2968.394071817398, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2913.0304679870605, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 25.21111111111111, "ram_util_percent": 76.09444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7933349609375, "policy_loss": -28709763072.0, "vf_loss": 592952512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 951.0, "diff_num_grad_updates_vs_sampler_policy": 950.0}}, "num_env_steps_sampled": 122760, "num_env_steps_trained": 122760, "num_agent_steps_sampled": 122760, "num_agent_steps_trained": 122760}, "sampler_results": {"episode_reward_max": -8347.098233329905, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8562.432216581537, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162, -8577.90392085957, -8444.947155288899, -8735.236070171622, -8492.433189251751, -8508.041069246437, -8551.135816243177, -8514.796827865244, -8795.182698043789], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.165134807770936, "mean_inference_ms": 0.39220251218136554, "mean_action_processing_ms": 0.09435206187721723, "mean_env_wait_ms": 2.907691833735973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038123130798339844, "StateBufferConnector_ms": 0.0026764869689941406, "ViewRequirementAgentConnector_ms": 0.0700833797454834}}, "episode_reward_max": -8347.098233329905, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8562.432216581537, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8557.379047273735, -8558.98737058321, -8530.813456517517, -8625.336867550173, -8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162, -8577.90392085957, -8444.947155288899, -8735.236070171622, -8492.433189251751, -8508.041069246437, -8551.135816243177, -8514.796827865244, -8795.182698043789], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.165134807770936, "mean_inference_ms": 0.39220251218136554, "mean_action_processing_ms": 0.09435206187721723, "mean_env_wait_ms": 2.907691833735973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038123130798339844, "StateBufferConnector_ms": 0.0026764869689941406, "ViewRequirementAgentConnector_ms": 0.0700833797454834}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122760, "num_agent_steps_trained": 122760, "num_env_steps_sampled": 122760, "num_env_steps_trained": 122760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.648874074526844, "num_env_steps_trained_throughput_per_sec": 38.648874074526844, "timesteps_total": 122760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 122760, "timers": {"training_iteration_time_ms": 3071.057, "sample_time_ms": 3067.238, "load_time_ms": 0.226, "load_throughput": 529806.821, "learn_time_ms": 2.826, "learn_throughput": 42457.483, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 122760, "num_env_steps_trained": 122760, "num_agent_steps_sampled": 122760, "num_agent_steps_trained": 122760}, "done": false, "episodes_total": 975, "training_iteration": 243, "trial_id": "668a1_00000", "date": "2023-07-25_18-38-02", "timestamp": 1690299482, "time_this_iter_s": 12.42238473892212, "time_total_s": 2980.81645655632, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2925.4528527259827, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 29.029411764705884, "ram_util_percent": 76.51176470588234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947387695312, "policy_loss": -77683105792.0, "vf_loss": 553926016.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 955.0, "diff_num_grad_updates_vs_sampler_policy": 954.0}}, "num_env_steps_sampled": 123240, "num_env_steps_trained": 123240, "num_agent_steps_sampled": 123240, "num_agent_steps_trained": 123240}, "sampler_results": {"episode_reward_max": -8347.098233329905, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8561.722257583719, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162, -8577.90392085957, -8444.947155288899, -8735.236070171622, -8492.433189251751, -8508.041069246437, -8551.135816243177, -8514.796827865244, -8795.182698043789, -8628.409345219918, -8445.889673391275, -8632.212514137618, -8495.009309394032], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16445872995654, "mean_inference_ms": 0.39221312395760877, "mean_action_processing_ms": 0.09435495853797846, "mean_env_wait_ms": 2.9075001602275337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00382232666015625, "StateBufferConnector_ms": 0.0026824474334716797, "ViewRequirementAgentConnector_ms": 0.07016158103942871}}, "episode_reward_max": -8347.098233329905, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8561.722257583719, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8621.277268728887, -8347.098233329905, -8775.113877009393, -8592.481003512758, -8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162, -8577.90392085957, -8444.947155288899, -8735.236070171622, -8492.433189251751, -8508.041069246437, -8551.135816243177, -8514.796827865244, -8795.182698043789, -8628.409345219918, -8445.889673391275, -8632.212514137618, -8495.009309394032], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.16445872995654, "mean_inference_ms": 0.39221312395760877, "mean_action_processing_ms": 0.09435495853797846, "mean_env_wait_ms": 2.9075001602275337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00382232666015625, "StateBufferConnector_ms": 0.0026824474334716797, "ViewRequirementAgentConnector_ms": 0.07016158103942871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123240, "num_agent_steps_trained": 123240, "num_env_steps_sampled": 123240, "num_env_steps_trained": 123240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.94250686520067, "num_env_steps_trained_throughput_per_sec": 38.94250686520067, "timesteps_total": 123240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 123240, "timers": {"training_iteration_time_ms": 3076.178, "sample_time_ms": 3072.213, "load_time_ms": 0.249, "load_throughput": 481504.334, "learn_time_ms": 2.903, "learn_throughput": 41333.373, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 123240, "num_env_steps_trained": 123240, "num_agent_steps_sampled": 123240, "num_agent_steps_trained": 123240}, "done": false, "episodes_total": 979, "training_iteration": 244, "trial_id": "668a1_00000", "date": "2023-07-25_18-38-15", "timestamp": 1690299495, "time_this_iter_s": 12.328664064407349, "time_total_s": 2993.1451206207275, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2937.78151679039, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 31.688888888888886, "ram_util_percent": 75.74999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": -926.7947998046875, "policy_loss": -25338884096.0, "vf_loss": 558599808.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 958.0}}, "num_env_steps_sampled": 123720, "num_env_steps_trained": 123720, "num_agent_steps_sampled": 123720, "num_agent_steps_trained": 123720}, "sampler_results": {"episode_reward_max": -8363.245104686366, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8562.117308541474, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162, -8577.90392085957, -8444.947155288899, -8735.236070171622, -8492.433189251751, -8508.041069246437, -8551.135816243177, -8514.796827865244, -8795.182698043789, -8628.409345219918, -8445.889673391275, -8632.212514137618, -8495.009309394032, -8486.646267118675, -8707.353809140304, -8641.26052719675, -8540.214874901032], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.163709319268783, "mean_inference_ms": 0.39222418099183753, "mean_action_processing_ms": 0.09435782706869653, "mean_env_wait_ms": 2.9073191067471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038323402404785156, "StateBufferConnector_ms": 0.0026807785034179688, "ViewRequirementAgentConnector_ms": 0.07025337219238281}}, "episode_reward_max": -8363.245104686366, "episode_reward_min": -8821.671208364927, "episode_reward_mean": -8562.117308541474, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8573.211918459925, -8607.432726546032, -8493.99188074722, -8566.245405620066, -8565.08578405167, -8604.055289991267, -8633.243828823794, -8463.479801277863, -8424.862238440965, -8641.32958017826, -8531.74595188056, -8638.837816639145, -8478.85867943206, -8606.513320689037, -8593.268408201327, -8557.84929761296, -8613.936246277735, -8702.866476879144, -8521.565394607282, -8513.710333672378, -8512.0143747433, -8659.29464566261, -8453.965855497861, -8712.712957332044, -8514.161147265531, -8405.651490869439, -8584.875313964083, -8506.318358211802, -8725.12487379431, -8531.942930490259, -8645.306717192254, -8363.245104686366, -8821.671208364927, -8492.476298482357, -8637.681042454304, -8458.760538023565, -8568.520045153038, -8559.945208398367, -8764.061313382466, -8651.775704351183, -8551.702639511674, -8549.521930203553, -8471.009196214916, -8706.699068450409, -8508.672170000502, -8486.73988374014, -8584.061127980829, -8692.422968860774, -8474.143194798005, -8437.110416932444, -8426.890894298198, -8583.977738320573, -8509.668990065433, -8690.822956283087, -8513.016705460645, -8720.17790224678, -8472.320120416274, -8576.965665680182, -8530.916131612348, -8675.95362285266, -8510.64245986991, -8641.849761927506, -8493.21376602658, -8653.756501968204, -8632.87706398225, -8483.598375233629, -8404.736699941135, -8636.448844578284, -8575.954195799424, -8523.502540369303, -8514.49148436993, -8581.951041970486, -8404.458160669215, -8754.662512340768, -8396.687721076181, -8560.449511872714, -8550.294083902472, -8455.702479407564, -8459.966652576035, -8522.546991706338, -8553.895421308283, -8515.913135934265, -8522.089429366668, -8600.980118202162, -8577.90392085957, -8444.947155288899, -8735.236070171622, -8492.433189251751, -8508.041069246437, -8551.135816243177, -8514.796827865244, -8795.182698043789, -8628.409345219918, -8445.889673391275, -8632.212514137618, -8495.009309394032, -8486.646267118675, -8707.353809140304, -8641.26052719675, -8540.214874901032], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.163709319268783, "mean_inference_ms": 0.39222418099183753, "mean_action_processing_ms": 0.09435782706869653, "mean_env_wait_ms": 2.9073191067471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038323402404785156, "StateBufferConnector_ms": 0.0026807785034179688, "ViewRequirementAgentConnector_ms": 0.07025337219238281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123720, "num_agent_steps_trained": 123720, "num_env_steps_sampled": 123720, "num_env_steps_trained": 123720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.42865264237842, "num_env_steps_trained_throughput_per_sec": 39.42865264237842, "timesteps_total": 123720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 123720, "timers": {"training_iteration_time_ms": 3081.991, "sample_time_ms": 3078.04, "load_time_ms": 0.249, "load_throughput": 481228.11, "learn_time_ms": 2.898, "learn_throughput": 41410.228, "synch_weights_time_ms": 0.759}, "counters": {"num_env_steps_sampled": 123720, "num_env_steps_trained": 123720, "num_agent_steps_sampled": 123720, "num_agent_steps_trained": 123720}, "done": true, "episodes_total": 983, "training_iteration": 245, "trial_id": "668a1_00000", "date": "2023-07-25_18-38-27", "timestamp": 1690299507, "time_this_iter_s": 12.17648696899414, "time_total_s": 3005.3216075897217, "pid": 74771, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.02], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c03b280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2949.958003759384, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 25.05882352941176, "ram_util_percent": 74.51176470588236}}
